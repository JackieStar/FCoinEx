(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-public-kline~pages-trade-trade"],{"4dcb":function(t,e,a){"use strict";var i=a("4ea4");a("a4d3"),a("e01a"),a("99af"),a("cb29"),a("a630"),a("c975"),a("fb6a"),a("4e82"),a("a434"),a("4ec9"),a("a9e3"),a("d3b7"),a("acd8"),a("e25e"),a("ac1f"),a("25f0"),a("3ca3"),a("5319"),a("1276"),a("ddb0");var r=i(a("b85c")),n=a("a0cd"),s=a("8f32"),o=a("a401"),h=a("8cb2"),l=a("5946"),u=a("b849"),C=a("cac6"),D=a("e78a"),m=a("9132"),S=a("9dc6"),c=a("90f8"),f=a("f96d"),d=a("621d"),I=a("dbf1");function v(){this.Height,this.Width,this.ID,this.WebGLCanvas,this.IsUniApp=!1,this.CanvasNode=null,this.ComponentObject=null,this.GetContext=function(){var t;if(this.CanvasNode&&this.CanvasNode.node){var e=this.CanvasNode.width,a=this.CanvasNode.height,i=this.CanvasNode.node;i._height=a,i._width=e,n.JSConsole.Chart.Log("[JSCanvasElement::GetContext] create by getContext('2d')"),t=i.getContext("2d");var r=wx.getSystemInfoSync().pixelRatio;i.width=e*r,i.height=a*r,t.restore(),t.save(),t.scale(r,r),t.draw=function(t,e){e&&e()},t.DomNode=i}else t=this.ComponentObject?wx.createCanvasContext(this.ID,this.ComponentObject):wx.createCanvasContext(this.ID);return this.IsUniApp&&(n.JSConsole.Chart.Log("[JSCanvasElement::GetContext] measureText() => JSUniAppCanvasHelper.MeasureText()"),t.measureText=function(e){var a=f.JSCommonUniApp.JSUniAppCanvasHelper.MeasureText(e,t);return{width:a}},t.fillText_backup=t.fillText,t.fillText=function(e,a,i,r){t.fillText_backup(e,a,i)}),t},this.GetWebGLCanvas=function(t){var e=this,a=wx.createSelectorQuery();a.select(t).node().exec((function(t){n.JSConsole.Chart.Log("[JSCanvasElement::GetWebGLCanvas] res ",t),e.WebGLCanvas=t[0].node}))}}function p(t){this.JSChartContainer,this.CanvasElement=t,this.AddEventCallback=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.AddEventCallback&&(n.JSConsole.Chart.Log("[JSChart:AddEventCallback] ",t),this.JSChartContainer.AddEventCallback(t))},this.OnSize=function(t){t&&(d.JSCommonSplit_IFrameSplitOperator.IsNumber(t.Width)&&(this.CanvasElement.Width=t.Width),d.JSCommonSplit_IFrameSplitOperator.IsNumber(t.Height)&&(this.CanvasElement.Height=t.Height)),this.JSChartContainer&&(t&&1==t.Type&&this.JSChartContainer.OnSize?this.JSChartContainer.OnSize():(this.JSChartContainer.Frame&&this.JSChartContainer.Frame.SetSizeChage(!0),this.JSChartContainer.Draw()))},this.CreateKLineChartContainer=function(t){var e=null;if(e="历史K线图横屏"===t.Type?new nt(this.CanvasElement):new et(this.CanvasElement),t.NetworkFilter&&(e.NetworkFilter=t.NetworkFilter),t.KLine&&(t.KLine.DragMode>=0&&(e.DragMode=t.KLine.DragMode),t.KLine.Right>=0&&(e.Right=t.KLine.Right),t.KLine.Period>=0&&(e.Period=t.KLine.Period),t.KLine.MaxReqeustDataCount>0&&(e.MaxReqeustDataCount=t.KLine.MaxReqeustDataCount),t.KLine.Info&&t.KLine.Info.length>0&&e.SetKLineInfo(t.KLine.Info,!1),t.KLine.Policy&&t.KLine.Policy.length>0&&e.SetPolicyInfo(t.KLine.Policy,!1),0==t.KLine.KLineDoubleClick&&(e.MinuteDialog=this.MinuteDialog=null),t.KLine.MaxRequestMinuteDayCount>0&&(e.MaxRequestMinuteDayCount=t.KLine.MaxRequestMinuteDayCount),t.KLine.DrawType&&(e.KLineDrawType=t.KLine.DrawType),t.KLine.RightSpaceCount>=0&&(e.RightSpaceCount=t.KLine.RightSpaceCount),t.KLine.DataWidth>=1&&(e.KLineSize={DataWidth:t.KLine.DataWidth})),t.SplashTitle&&(e.LoadDataSplashTitle=t.SplashTitle),!t.Windows||t.Windows.length<=0)return null;if(t.Language&&("CN"===t.Language?e.LanguageID=c.JSCommonResource_JSCHART_LANGUAGE_ID.LANGUAGE_CHINESE_ID:"EN"===t.Language&&(e.LanguageID=c.JSCommonResource_JSCHART_LANGUAGE_ID.LANGUAGE_ENGLISH_ID)),t.SourceDatatLimit&&e.SetSourceDatatLimit(t.SourceDatatLimit),t.EnableZoomUpDown&&(e.EnableZoomUpDown=t.EnableZoomUpDown),t.ZoomStepPixel>0&&(e.ZoomStepPixel=t.ZoomStepPixel),d.JSCommonSplit_IFrameSplitOperator.IsNumber(t.DrawMoveWaitTime)&&(e.DrawMoveWaitTime=t.DrawMoveWaitTime),e.Create(t.Windows.length),t.Border&&(isNaN(t.Border.Left)||(e.Frame.ChartBorder.Left=t.Border.Left),isNaN(t.Border.Right)||(e.Frame.ChartBorder.Right=t.Border.Right),isNaN(t.Border.Top)||(e.Frame.ChartBorder.Top=t.Border.Top),isNaN(t.Border.Bottom)||(e.Frame.ChartBorder.Bottom=t.Border.Bottom)),t.KLine){if(t.KLine.PageSize>0){var a=e.GetMaxPageSize();a<t.KLine.PageSize?e.PageSize=a:e.PageSize=t.KLine.PageSize}t.KLine.InfoDrawType&&(e.ChartPaint[0].InfoDrawType=t.KLine.InfoDrawType)}if(t.DragDownload&&(t.DragDownload.Day&&1==t.DragDownload.Day.Enable&&(e.DragDownload.Day.Enable=!0),t.DragDownload.Minute&&1==t.DragDownload.Minute.Enable&&(e.DragDownload.Minute.Enable=!0)),1==t.IsApiPeriod&&(e.IsApiPeriod=t.IsApiPeriod),1==t.CorssCursorTouchEnd&&(e.CorssCursorTouchEnd=t.CorssCursorTouchEnd),1==t.IsClickShowCorssCursor&&(e.IsClickShowCorssCursor=t.IsClickShowCorssCursor),1==t.IsFullDraw&&(e.IsFullDraw=t.IsFullDraw),t.CorssCursorInfo&&(isNaN(t.CorssCursorInfo.Left)||(e.ChartCorssCursor.ShowTextMode.Left=t.CorssCursorInfo.Left),isNaN(t.CorssCursorInfo.Right)||(e.ChartCorssCursor.ShowTextMode.Right=t.CorssCursorInfo.Right),isNaN(t.CorssCursorInfo.Bottom)||(e.ChartCorssCursor.ShowTextMode.Bottom=t.CorssCursorInfo.Bottom),!1===t.CorssCursorInfo.IsShowCorss&&(e.ChartCorssCursor.IsShowCorss=t.CorssCursorInfo.IsShowCorss),1==t.CorssCursorInfo.IsShowClose&&(e.ChartCorssCursor.IsShowClose=t.CorssCursorInfo.IsShowClose),d.JSCommonSplit_IFrameSplitOperator.IsNumber(t.CorssCursorInfo.HPenType)&&(e.ChartCorssCursor.HPenType=t.CorssCursorInfo.HPenType),t.CorssCursorInfo.VPenType>0&&(e.ChartCorssCursor.VPenType=t.CorssCursorInfo.VPenType)),"function"==typeof t.UpdateUICallback&&(e.UpdateUICallback=t.UpdateUICallback),t.Frame)for(var i in t.Frame){var r=t.Frame[i];e.Frame.SubFrame[i]&&(r.SplitCount&&(e.Frame.SubFrame[i].Frame.YSplitOperator.SplitCount=r.SplitCount),r.StringFormat&&(e.Frame.SubFrame[i].Frame.YSplitOperator.StringFormat=r.StringFormat),isNaN(r.Height)||(e.Frame.SubFrame[i].Height=r.Height),0==r.IsShowBorder&&(e.Frame.SubFrame[i].Frame.IsShowBorder=r.IsShowBorder),0==r.IsShowXLine&&(e.Frame.SubFrame[i].Frame.IsShowXLine=r.IsShowXLine),0==r.IsShowYLine&&(e.Frame.SubFrame[i].Frame.IsShowYLine=r.IsShowYLine),"bottom"==r.XMessageAlign&&(e.Frame.SubFrame[i].Frame.XMessageAlign=r.XMessageAlign),0==r.IsShowTitle&&(e.Frame.SubFrame[i].Frame.IsShowTitle=!1),r.UpdateTitleUICallback&&e.Frame.SubFrame[i].Frame.TitlePaint&&(e.Frame.SubFrame[i].Frame.TitlePaint.UpdateUICallback=r.UpdateTitleUICallback),!1!==r.IsShowLeftText&&!0!==r.IsShowLeftText||(e.Frame.SubFrame[i].Frame.IsShowYText[0]=r.IsShowLeftText),!1!==r.IsShowRightText&&!0!==r.IsShowRightText||(e.Frame.SubFrame[i].Frame.IsShowYText[1]=r.IsShowRightText),r.TopSpace>=0&&(e.Frame.SubFrame[i].Frame.ChartBorder.TopSpace=r.TopSpace),r.BottomSpace>=0&&(e.Frame.SubFrame[i].Frame.ChartBorder.BottomSpace=r.BottomSpace),r.Custom&&(e.Frame.SubFrame[i].Frame.YSplitOperator.Custom=r.Custom),d.JSCommonSplit_IFrameSplitOperator.IsNumber(r.SplitType)&&(e.Frame.SubFrame[i].Frame.YSplitOperator.SplitType=r.SplitType),d.JSCommonSplit_IFrameSplitOperator.IsNumber(r.FloatPrecision)&&(e.Frame.SubFrame[i].Frame.YSplitOperator.FloatPrecision=r.FloatPrecision),d.JSCommonSplit_IFrameSplitOperator.IsNumber(r.BorderLine)&&(e.Frame.SubFrame[i].Frame.BorderLine=r.BorderLine),d.JSCommonSplit_IFrameSplitOperator.IsNumber(r.YTextBaseline)&&(e.Frame.SubFrame[i].Frame.YTextBaseline=r.YTextBaseline))}for(var i in t.KLine&&(0==t.KLine.ShowKLine&&(e.ChartPaint[0].IsShow=!1),0==t.KLine.IsShowMaxMinPrice&&(e.ChartPaint[0].IsShowMaxMinPrice=!1)),t.KLineTitle&&(0==t.KLineTitle.IsShowName&&(e.TitlePaint[0].IsShowName=!1),0==t.KLineTitle.IsShowSettingInfo&&(e.TitlePaint[0].IsShowSettingInfo=!1),0==t.KLineTitle.IsShow&&(e.TitlePaint[0].IsShow=!1),t.KLineTitle.UpdateUICallback&&(e.TitlePaint[0].UpdateUICallback=t.KLineTitle.UpdateUICallback),t.KLineTitle.LineCount>1&&(e.TitlePaint[0].LineCount=t.KLineTitle.LineCount)),t.Overlay){r=t.Overlay[i];if(r.Symbol){e.OverlayChartPaint[0].Symbol=r.Symbol,r.Color&&(e.OverlayChartPaint[0].Color=r.Color),e.OverlayChartPaint[0].SetOption(r);break}}if(t.ExtendChart)for(var i in t.ExtendChart){r=t.ExtendChart[i];e.CreateExtendChart(r.Name,r)}var n=new u.JSCommonIndexScript.JSIndexScript;if(t.ColorIndex){r=t.ColorIndex;var s=n.Get(r.Index);s&&(e.ColorIndex=new S.JSCommonIndex_ScriptIndex(s.Name,s.Script,s.Args,s))}if(t.TradeIndex){r=t.TradeIndex;var o=n.Get(r.Index);o&&(e.TradeIndex=new S.JSCommonIndex_ScriptIndex(o.Name,o.Script,o.Args,o))}for(var i in t.Windows){r=t.Windows[i];if(r.Script)e.WindowIndex[i]=new S.JSCommonIndex_ScriptIndex(r.Name,r.Script,r.Args,r);else if(r.API){var h=r.API;e.WindowIndex[i]=new mt(h.Name,h.Script,h.Args,r)}else{var l=tt.Get(r.Index);if(l)e.WindowIndex[i]=l.Create(),e.CreateWindowIndex(i);else{var C=n.Get(r.Index);if(!C)continue;r.Lock&&(C.Lock=r.Lock),C.ID=r.Index;var D=C.Args;r.Args&&(D=r.Args),e.WindowIndex[i]=new S.JSCommonIndex_ScriptIndex(C.Name,C.Script,D,C),r.StringFormat>0&&(e.WindowIndex[i].StringFormat=r.StringFormat),r.FloatPrecision>=0&&(e.WindowIndex[i].FloatPrecision=r.FloatPrecision)}}null!=r.Modify&&(e.Frame.SubFrame[i].Frame.ModifyIndex=r.Modify),null!=r.Change&&(e.Frame.SubFrame[i].Frame.ChangeIndex=r.Change),1==r.IsDrawTitleBG&&(e.Frame.SubFrame[i].Frame.IsDrawTitleBG=r.IsDrawTitleBG),"function"==typeof r.UpdateUICallback&&(e.WindowIndex[i].UpdateUICallback=r.UpdateUICallback),isNaN(r.TitleHeight)||(e.Frame.SubFrame[i].Frame.ChartBorder.TitleHeight=r.TitleHeight),0==r.IsShowIndexName&&(e.Frame.SubFrame[i].Frame.IsShowIndexName=!1),r.IndexParamSpace>=0&&(e.Frame.SubFrame[i].Frame.IndexParamSpace=r.IndexParamSpace)}return e},this.CreateCustomKLineChartContainer=function(t){var e=new rt(this.CanvasElement);if(t.KLine&&(t.KLine.DragMode>=0&&(e.DragMode=t.KLine.DragMode),t.KLine.Right>=0&&(e.Right=t.KLine.Right),t.KLine.Period>=0&&(e.Period=t.KLine.Period),t.KLine.MaxReqeustDataCount>0&&(e.MaxReqeustDataCount=t.KLine.MaxReqeustDataCount),t.KLine.Info&&t.KLine.Info.length>0&&e.SetKLineInfo(t.KLine.Info,!1),0==t.KLine.KLineDoubleClick&&(e.MinuteDialog=this.MinuteDialog=null),t.KLine.PageSize>0&&(e.PageSize=t.KLine.PageSize),0==t.KLine.IsShowTooltip&&(e.IsShowTooltip=!1)),t.CustomStock&&(e.CustomStock=t.CustomStock),t.QueryDate&&(e.QueryDate=t.QueryDate),"function"==typeof t.UpdateUICallback&&(e.UpdateUICallback=t.UpdateUICallback),!t.Windows||t.Windows.length<=0)return null;if(e.Create(t.Windows.length),t.Border&&(isNaN(t.Border.Left)||(e.Frame.ChartBorder.Left=t.Border.Left),isNaN(t.Border.Right)||(e.Frame.ChartBorder.Right=t.Border.Right),isNaN(t.Border.Top)||(e.Frame.ChartBorder.Top=t.Border.Top),isNaN(t.Border.Bottom)||(e.Frame.ChartBorder.Bottom=t.Border.Bottom)),0==t.IsShowCorssCursorInfo&&(e.ChartCorssCursor.IsShowText=t.IsShowCorssCursorInfo),t.Frame)for(var a in t.Frame){var i=t.Frame[a];i.SplitCount&&(e.Frame.SubFrame[a].Frame.YSplitOperator.SplitCount=i.SplitCount),i.StringFormat&&(e.Frame.SubFrame[a].Frame.YSplitOperator.StringFormat=i.StringFormat),"bottom"==i.XMessageAlign&&(e.Frame.SubFrame[a].Frame.XMessageAlign=i.XMessageAlign)}t.KLineTitle&&(0==t.KLineTitle.IsShowName&&(e.TitlePaint[0].IsShowName=!1),0==t.KLineTitle.IsShowSettingInfo&&(e.TitlePaint[0].IsShowSettingInfo=!1));var r=new u.JSCommonIndexScript.JSIndexScript;for(var a in t.Windows){i=t.Windows[a];if(i.Script)e.WindowIndex[a]=new S.JSCommonIndex_ScriptIndex(i.Name,i.Script,i.Args,i);else{var n=tt.Get(i.Index);if(n)e.WindowIndex[a]=n.Create(),e.CreateWindowIndex(a);else{var s=r.Get(i.Index);if(!s)continue;i.Lock&&(s.Lock=i.Lock),e.WindowIndex[a]=new S.JSCommonIndex_ScriptIndex(s.Name,s.Script,s.Args,s)}}null!=i.Modify&&(e.Frame.SubFrame[a].Frame.ModifyIndex=i.Modify),null!=i.Change&&(e.Frame.SubFrame[a].Frame.ChangeIndex=i.Change),isNaN(i.TitleHeight)||(e.Frame.SubFrame[a].Frame.ChartBorder.TitleHeight=i.TitleHeight)}return e},this.CreateMinuteChartContainer=function(t){var e=null;e="分钟走势图横屏"===t.Type?new st(this.CanvasElement):new at(this.CanvasElement),t.NetworkFilter&&(e.NetworkFilter=t.NetworkFilter);var a=2;if(t.Windows&&t.Windows.length>0&&(a+=t.Windows.length),1==t.EnableScrollUpDown&&(e.EnableScrollUpDown=t.EnableScrollUpDown),t.Info&&t.Info.length>0&&e.SetMinuteInfo(t.Info,!1),t.SplashTitle&&(e.LoadDataSplashTitle=t.SplashTitle),d.JSCommonSplit_IFrameSplitOperator.IsNumber(t.DrawMoveWaitTime)&&(e.DrawMoveWaitTime=t.DrawMoveWaitTime),t.Language&&("CN"===t.Language?e.LanguageID=c.JSCommonResource_JSCHART_LANGUAGE_ID.LANGUAGE_CHINESE_ID:"EN"===t.Language&&(e.LanguageID=c.JSCommonResource_JSCHART_LANGUAGE_ID.LANGUAGE_ENGLISH_ID)),e.Create(a),1==t.CorssCursorTouchEnd&&(e.CorssCursorTouchEnd=t.CorssCursorTouchEnd),1==t.IsFullDraw&&(e.IsFullDraw=t.IsFullDraw),t.CorssCursorInfo&&(isNaN(t.CorssCursorInfo.Left)||(e.ChartCorssCursor.ShowTextMode.Left=t.CorssCursorInfo.Left),isNaN(t.CorssCursorInfo.Right)||(e.ChartCorssCursor.ShowTextMode.Right=t.CorssCursorInfo.Right),isNaN(t.CorssCursorInfo.Bottom)||(e.ChartCorssCursor.ShowTextMode.Bottom=t.CorssCursorInfo.Bottom),!1===t.CorssCursorInfo.IsShowCorss&&(e.ChartCorssCursor.IsShowCorss=t.CorssCursorInfo.IsShowCorss),d.JSCommonSplit_IFrameSplitOperator.IsBool(t.CorssCursorInfo.IsFixXLastTime)&&(e.ChartCorssCursor.IsFixXLastTime=t.CorssCursorInfo.IsFixXLastTime)),t.MinuteInfo&&e.CreateMinuteInfo(t.MinuteInfo),t.DayCount>1&&(e.DayCount=t.DayCount),t.Border&&(isNaN(t.Border.Left)||(e.Frame.ChartBorder.Left=t.Border.Left),isNaN(t.Border.Right)||(e.Frame.ChartBorder.Right=t.Border.Right),isNaN(t.Border.Top)||(e.Frame.ChartBorder.Top=t.Border.Top),isNaN(t.Border.Bottom)||(e.Frame.ChartBorder.Bottom=t.Border.Bottom)),t.Frame){for(var i in t.Frame){var r=t.Frame[i];e.Frame.SubFrame[i]&&(r.SplitCount&&(e.Frame.SubFrame[i].Frame.YSplitOperator.SplitCount=r.SplitCount),r.StringFormat&&(e.Frame.SubFrame[i].Frame.YSplitOperator.StringFormat=r.StringFormat),"bottom"==r.XMessageAlign&&(e.Frame.SubFrame[i].Frame.XMessageAlign=r.XMessageAlign),!1!==r.IsShowLeftText&&!0!==r.IsShowLeftText||(e.Frame.SubFrame[i].Frame.IsShowYText[0]=r.IsShowLeftText),!1!==r.IsShowRightText&&!0!==r.IsShowRightText||(e.Frame.SubFrame[i].Frame.IsShowYText[1]=r.IsShowRightText),r.Height>=0&&(e.Frame.SubFrame[i].Height=r.Height),r.Custom&&(e.Frame.SubFrame[i].Frame.YSplitOperator.Custom=r.Custom),d.JSCommonSplit_IFrameSplitOperator.IsNumber(r.BorderLine)&&(e.Frame.SubFrame[i].Frame.BorderLine=r.BorderLine),d.JSCommonSplit_IFrameSplitOperator.IsNumber(r.YTextBaseline)&&(e.Frame.SubFrame[i].Frame.YTextBaseline=r.YTextBaseline))}e.UpdateXShowText()}if(t.MinuteTitle&&(0==t.MinuteTitle.IsShowName&&(e.TitlePaint[0].IsShowName=!1),0==t.MinuteTitle.IsShow&&(e.TitlePaint[0].IsShow=!1),t.MinuteTitle.UpdateUICallback&&(e.TitlePaint[0].UpdateUICallback=t.MinuteTitle.UpdateUICallback),t.MinuteTitle.LineCount>1&&(e.TitlePaint[0].LineCount=t.MinuteTitle.LineCount)),"function"==typeof t.UpdateUICallback&&(e.UpdateUICallback=t.UpdateUICallback),t.ExtendChart)for(var i in t.ExtendChart){r=t.ExtendChart[i];e.CreateExtendChart(r.Name,r)}for(var i in t.Overlay){r=t.Overlay[i];if(r.Symbol){e.OverlayChartPaint[0].Symbol=r.Symbol,r.Color&&(e.OverlayChartPaint[0].Color=r.Color);break}}if(t.Overlay&&t.Overlay.length&&(e.OverlayChartPaint[0].Symbol=t.Overlay[0].Symbol),t.MinuteLine&&(0==t.MinuteLine.IsDrawAreaPrice&&(e.ChartPaint[0].IsDrawArea=!1),0==t.MinuteLine.IsShowAveragePrice))for(var i in e.ChartPaint[1].IsShow=!1,e.TitlePaint[0].IsShowAveragePrice=!1,e.ExtendChartPaint){r=e.ExtendChartPaint[i];"MinuteTooltipPaint"==r.ClassName&&(r.IsShowAveragePrice=!1)}var n=new u.JSCommonIndexScript.JSIndexScript;for(var i in t.Windows){r=t.Windows[i];if(r.Script)e.WindowIndex[2+parseInt(i)]=new S.JSCommonIndex_ScriptIndex(r.Name,r.Script,r.Args,r);else{var s=tt.Get(r.Index);if(s)e.WindowIndex[2+parseInt(i)]=s.Create(),e.CreateWindowIndex(2+parseInt(i));else{var o=n.Get(r.Index);if(!o)continue;var h=o.Args;r.Args&&(h=r.Args),r.Lock&&(o.Lock=r.Lock),e.WindowIndex[2+parseInt(i)]=new S.JSCommonIndex_ScriptIndex(o.Name,o.Script,h,o),r.StringFormat>0&&(e.WindowIndex[2+parseInt(i)].StringFormat=r.StringFormat),r.FloatPrecision>=0&&(e.WindowIndex[2+parseInt(i)].FloatPrecision=r.FloatPrecision)}}isNaN(r.TitleHeight)||(e.Frame.SubFrame[2+parseInt(i)].Frame.ChartBorder.TitleHeight=r.TitleHeight)}return e},this.CreateHistoryMinuteChartContainer=function(t){var e=new it(this.CanvasElement),a=2;if(t.Windows&&t.Windows.length>0&&(a+=t.Windows.length),e.Create(a),0==t.IsShowCorssCursorInfo&&(e.ChartCorssCursor.IsShowText=t.IsShowCorssCursorInfo),t.Border&&(isNaN(t.Border.Left)||(e.Frame.ChartBorder.Left=t.Border.Left),isNaN(t.Border.Right)||(e.Frame.ChartBorder.Right=t.Border.Right),isNaN(t.Border.Top)||(e.Frame.ChartBorder.Top=t.Border.Top),isNaN(t.Border.Bottom)||(e.Frame.ChartBorder.Bottom=t.Border.Bottom)),t.Frame)for(var i in t.Frame){var r=t.Frame[i];r.SplitCount&&(e.Frame.SubFrame[i].Frame.YSplitOperator.SplitCount=r.SplitCount),r.StringFormat&&(e.Frame.SubFrame[i].Frame.YSplitOperator.StringFormat=r.StringFormat),"bottom"==r.XMessageAlign&&(e.Frame.SubFrame[i].Frame.XMessageAlign=r.XMessageAlign)}var n=new u.JSCommonIndexScript.JSIndexScript;for(var i in t.Windows){r=t.Windows[i];if(r.Script)e.WindowIndex[2+parseInt(i)]=new S.JSCommonIndex_ScriptIndex(r.Name,r.Script,r.Args,r);else{var s=tt.Get(r.Index);if(s)e.WindowIndex[2+parseInt(i)]=s.Create(),e.CreateWindowIndex(2+parseInt(i));else{var o=n.Get(r.Index);if(!o)continue;r.Lock&&(o.Lock=r.Lock),e.WindowIndex[2+parseInt(i)]=new S.JSCommonIndex_ScriptIndex(o.Name,o.Script,o.Args,o)}}isNaN(r.TitleHeight)||(e.Frame.SubFrame[2+parseInt(i)].Frame.ChartBorder.TitleHeight=r.TitleHeight)}return e.TradeDate=20181009,t.HistoryMinute&&(t.HistoryMinute.TradeDate&&(e.TradeDate=t.HistoryMinute.TradeDate),null!=t.HistoryMinute.IsShowName&&(e.TitlePaint[0].IsShowName=t.HistoryMinute.IsShowName),null!=t.HistoryMinute.IsShowDate&&(e.TitlePaint[0].IsShowDate=t.HistoryMinute.IsShowDate)),e},this.CreateKLineTrainChartContainer=function(t){var e="K线训练横屏"==t.Type,a=new ot(this.CanvasElement,e);if(t.NetworkFilter&&(a.NetworkFilter=t.NetworkFilter),1==t.IsApiPeriod&&(a.IsApiPeriod=t.IsApiPeriod),t.KLine&&(t.KLine.Right>=0&&(a.Right=t.KLine.Right),t.KLine.Period>=0&&(a.Period=t.KLine.Period),t.KLine.MaxReqeustDataCount>0&&(a.MaxReqeustDataCount=t.KLine.MaxReqeustDataCount),t.KLine.Info&&t.KLine.Info.length>0&&a.SetKLineInfo(t.KLine.Info,!1),t.KLine.PageSize>0&&(a.PageSize=t.KLine.PageSize),0==t.KLine.IsShowTooltip&&(a.IsShowTooltip=!1),t.KLine.MaxRequestMinuteDayCount>0&&(a.MaxRequestMinuteDayCount=t.KLine.MaxRequestMinuteDayCount),t.KLine.DrawType&&(a.KLineDrawType=t.KLine.DrawType)),t.Train&&(t.Train.DataCount&&(a.TrainDataCount=t.Train.DataCount),t.Train.Callback&&(a.TrainCallback=t.Train.Callback),t.Train.StartDate&&(a.TrainStartDate=t.Train.StartDate)),!t.Windows||t.Windows.length<=0)return null;if(a.Create(t.Windows.length),t.Border&&(isNaN(t.Border.Left)||(a.Frame.ChartBorder.Left=t.Border.Left),isNaN(t.Border.Right)||(a.Frame.ChartBorder.Right=t.Border.Right),isNaN(t.Border.Top)||(a.Frame.ChartBorder.Top=t.Border.Top),isNaN(t.Border.Bottom)||(a.Frame.ChartBorder.Bottom=t.Border.Bottom)),t.ExtendChart)for(var i in t.ExtendChart){var r=t.ExtendChart[i];a.CreateExtendChart(r.Name,r)}if(0==t.IsShowCorssCursorInfo&&(a.ChartCorssCursor.IsShowText=t.IsShowCorssCursorInfo),1==t.CorssCursorTouchEnd&&(a.CorssCursorTouchEnd=t.CorssCursorTouchEnd),1==t.IsClickShowCorssCursor&&(a.IsClickShowCorssCursor=t.IsClickShowCorssCursor),1==t.IsFullDraw&&(a.IsFullDraw=t.IsFullDraw),t.CorssCursorInfo&&(isNaN(t.CorssCursorInfo.Left)||(a.ChartCorssCursor.ShowTextMode.Left=t.CorssCursorInfo.Left),isNaN(t.CorssCursorInfo.Right)||(a.ChartCorssCursor.ShowTextMode.Right=t.CorssCursorInfo.Right),isNaN(t.CorssCursorInfo.Bottom)||(a.ChartCorssCursor.ShowTextMode.Bottom=t.CorssCursorInfo.Bottom),!1===t.CorssCursorInfo.IsShowCorss&&(a.ChartCorssCursor.IsShowCorss=t.CorssCursorInfo.IsShowCorss),1==t.CorssCursorInfo.IsShowClose&&(a.ChartCorssCursor.IsShowClose=t.CorssCursorInfo.IsShowClose),t.CorssCursorInfo.HPenType>0&&(a.ChartCorssCursor.HPenType=t.CorssCursorInfo.HPenType),t.CorssCursorInfo.VPenType>0&&(a.ChartCorssCursor.VPenType=t.CorssCursorInfo.VPenType),d.JSCommonSplit_IFrameSplitOperator.IsBool(t.CorssCursorInfo.IsFixXLastTime)&&(a.ChartCorssCursor.IsFixXLastTime=t.CorssCursorInfo.IsFixXLastTime)),t.Frame)for(var i in t.Frame)if(a.Frame.SubFrame[i]){r=t.Frame[i];r.SplitCount&&(a.Frame.SubFrame[i].Frame.YSplitOperator.SplitCount=r.SplitCount),r.StringFormat&&(a.Frame.SubFrame[i].Frame.YSplitOperator.StringFormat=r.StringFormat),r.Height>0&&(a.Frame.SubFrame[i].Height=r.Height),!1!==r.IsShowLeftText&&!0!==r.IsShowLeftText||(a.Frame.SubFrame[i].Frame.IsShowYText[0]=r.IsShowLeftText),!1!==r.IsShowRightText&&!0!==r.IsShowRightText||(a.Frame.SubFrame[i].Frame.IsShowYText[1]=r.IsShowRightText)}t.KLine&&(0==t.KLine.ShowKLine&&(a.ChartPaint[0].IsShow=!1),0==t.KLine.IsShowMaxMinPrice&&(a.ChartPaint[0].IsShowMaxMinPrice=!1)),a.TitlePaint[0].IsShowName=!1,a.TitlePaint[0].IsShowSettingInfo=!1,a.TitlePaint[0].IsShowDateTime=!1;var n=new u.JSCommonIndexScript.JSIndexScript;for(var i in t.Windows){r=t.Windows[i];if(r.Script)a.WindowIndex[i]=new S.JSCommonIndex_ScriptIndex(r.Name,r.Script,r.Args,r);else{var s=tt.Get(r.Index);if(s)a.WindowIndex[i]=s.Create(),a.CreateWindowIndex(i);else{var o=n.Get(r.Index);if(!o)continue;r.Lock&&(o.Lock=r.Lock),a.WindowIndex[i]=new S.JSCommonIndex_ScriptIndex(o.Name,o.Script,o.Args,o)}}null!=r.Modify&&(a.Frame.SubFrame[i].Frame.ModifyIndex=r.Modify),null!=r.Change&&(a.Frame.SubFrame[i].Frame.ChangeIndex=r.Change),isNaN(r.TitleHeight)||(a.Frame.SubFrame[i].Frame.ChartBorder.TitleHeight=r.TitleHeight)}return a},this.CreateDepthChartContainer=function(t){var e=null;if(e=new ht(this.CanvasElement),t.NetworkFilter&&(e.NetworkFilter=t.NetworkFilter),1==t.EnableScrollUpDown&&(e.EnableScrollUpDown=t.EnableScrollUpDown),d.JSCommonSplit_IFrameSplitOperator.IsPlusNumber(t.MaxVolRate)&&(e.MaxVolRate=t.MaxVolRate),t.ZoomStepPixel>0&&(e.ZoomStepPixel=t.ZoomStepPixel),e.Create(t.Listener),t.Border&&(d.JSCommonSplit_IFrameSplitOperator.IsNumber(t.Border.Left)?e.Frame.ChartBorder.Left=t.Border.Left:t.Border.Left=e.Frame.ChartBorder.Left,d.JSCommonSplit_IFrameSplitOperator.IsNumber(t.Border.Right)?e.Frame.ChartBorder.Right=t.Border.Right:t.Border.Right=e.Frame.ChartBorder.Right,d.JSCommonSplit_IFrameSplitOperator.IsNumber(t.Border.Top)?e.Frame.ChartBorder.Top=t.Border.Top:t.Border.Top=e.Frame.ChartBorder.Top,d.JSCommonSplit_IFrameSplitOperator.IsNumber(t.Border.Bottom)?e.Frame.ChartBorder.Bottom=t.Border.Bottom:t.Border.Bottom=e.Frame.ChartBorder.Bottom),1==t.IsFullDraw&&(e.IsFullDraw=t.IsFullDraw),!0===t.CorssCursorTouchEnd&&(e.CorssCursorTouchEnd=t.CorssCursorTouchEnd),t.CorssCursorInfo){var a=t.CorssCursorInfo;d.JSCommonSplit_IFrameSplitOperator.IsNumber(a.HPenType)&&(e.ChartCorssCursor.HPenType=a.HPenType),d.JSCommonSplit_IFrameSplitOperator.IsNumber(a.VPenType)&&(e.ChartCorssCursor.VPenType=a.VPenType),d.JSCommonSplit_IFrameSplitOperator.IsBool(a.IsShowTooltip)&&(e.ChartCorssCursor.IsShowTooltip=a.IsShowTooltip)}if(t.Frame){a=t.Frame;a.SplitCount&&(e.Frame.YSplitOperator.SplitCount=a.SplitCount),d.JSCommonSplit_IFrameSplitOperator.IsNumber(a.SplitType)&&(e.Frame.YSplitOperator.SplitType=a.SplitType),d.JSCommonSplit_IFrameSplitOperator.IsNumber(a.Height)&&(e.Frame.Height=a.Height),d.JSCommonSplit_IFrameSplitOperator.IsNumber(a.LineType)&&(e.Frame.YSplitOperator.LineType=a.LineType),Array.isArray(a.IgnoreYValue)&&(e.Frame.YSplitOperator.IgnoreYValue=a.IgnoreYValue),!1!==a.IsShowLeftText&&!0!==a.IsShowLeftText||(e.Frame.IsShowYText[0]=a.IsShowLeftText,e.Frame.YSplitOperator.IsShowLeftText=a.IsShowLeftText),!1!==a.IsShowRightText&&!0!==a.IsShowRightText||(e.Frame.IsShowYText[1]=a.IsShowRightText,e.Frame.YSplitOperator.IsShowRightText=a.IsShowRightText),0==a.IsShowXLine&&(e.Frame.IsShowXLine=a.IsShowXLine),0==a.IsShowYLine&&(e.Frame.IsShowYLine=a.IsShowYLine)}return e},this.SetOption=function(t){n.JSConsole.Chart.Log("[JSChart::SetOption]",t);var e=null;switch(t.Type){case"历史K线图":case"历史K线图横屏":e=this.CreateKLineChartContainer(t);break;case"自定义指数历史K线图":e=this.CreateCustomKLineChartContainer(t);break;case"分钟走势图":case"分钟走势图横屏":e=this.CreateMinuteChartContainer(t);break;case"历史分钟走势图":e=this.CreateHistoryMinuteChartContainer(t);break;case"K线训练":case"K线训练横屏":e=this.CreateKLineTrainChartContainer(t);break;case"深度图":e=this.CreateDepthChartContainer(t);break;case"简单图形":return this.CreateSimpleChart(t);case"雷达图":case"饼图":return this.CreatePieChart(t);case"地图":return this.CreateMapChart(t);default:return!1}if(!e)return!1;for(var a in 1!=t.IsAutoUpdate&&1!=t.IsAutoUpate||(e.IsAutoUpdate=!0),t.AutoUpdateFrequency>0&&(e.AutoUpdateFrequency=t.AutoUpdateFrequency),t.EventCallback){var i=t.EventCallback[a];e.AddEventCallback(i)}if(!t.Symbol)return!1;this.JSChartContainer=e,e.Draw(),e.ChangeSymbol(t.Symbol),this.JSChartContainer.Draw()},this.ChangeSymbol=function(t){this.JSChartContainer&&this.JSChartContainer.ChangeSymbol(t)},this.ChangeIndex=function(t,e,a){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangeIndex&&this.JSChartContainer.ChangeIndex(t,e,a)},this.ChangeScriptIndex=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangeScriptIndex&&this.JSChartContainer.ChangeScriptIndex(t,e)},this.GetIndexInfo=function(){return this.JSChartContainer&&"function"==typeof this.JSChartContainer.GetIndexInfo?this.JSChartContainer.GetIndexInfo():[]},this.ChangePeriod=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangePeriod&&this.JSChartContainer.ChangePeriod(t,e)},this.ChangeInstructionIndex=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangeInstructionIndex&&this.JSChartContainer.ChangeInstructionIndex(t)},this.ChangeInstructionScriptIndex=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangeInstructionIndex&&this.JSChartContainer.ChangeInstructionScriptIndex(t)},this.AddIndexWindow=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.AddIndexWindow&&this.JSChartContainer.AddIndexWindow(t,e)},this.RemoveIndexWindow=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.RemoveIndexWindow&&this.JSChartContainer.RemoveIndexWindow(t)},this.CancelInstructionIndex=function(){this.JSChartContainer&&"function"==typeof this.JSChartContainer.CancelInstructionIndex&&this.JSChartContainer.CancelInstructionIndex()},this.ChangeIndexTemplate=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangeIndexTemplate&&(n.JSConsole.Chart.Log("[JSChart:ChangeIndexTemplate] ",t),this.JSChartContainer.ChangeIndexTemplate(t))},this.ChangeRight=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangeRight&&this.JSChartContainer.ChangeRight(t)},this.ChangeKLineDrawType=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangeKLineDrawType&&this.JSChartContainer.ChangeKLineDrawType(t)},this.ChangMainDataControl=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.SetMainDataConotrl&&this.JSChartContainer.SetMainDataConotrl(t)},this.OverlaySymbol=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.OverlaySymbol&&this.JSChartContainer.OverlaySymbol(t,e)},this.ForceLandscape=function(t){this.JSChartContainer&&(n.JSConsole.Chart.Log("[JSChart::ForceLandscape] bForceLandscape="+t),this.JSChartContainer.IsForceLandscape=t)},this.LockIndex=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.LockIndex&&(n.JSConsole.Chart.Log("[JSChart:LockIndex] lockData",t),this.JSChartContainer.LockIndex(t))},this.ChangeTradeDate=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangeTradeDate&&(n.JSConsole.Chart.Log("[JSChart:ChangeTradeDate] date",t),this.JSChartContainer.ChangeTradeDate(t))},this.ChangeDayCount=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangeDayCount&&(n.JSConsole.Chart.Log("[JSChart:ChangeDayCount] count",t),this.JSChartContainer.ChangeDayCount(t))},this.StopAutoUpdate=function(){this.JSChartContainer&&"function"==typeof this.JSChartContainer.StopAutoUpdate&&(n.JSConsole.Chart.Log("[JSChart::StopAutoUpdate] Stop."),this.JSChartContainer.StopAutoUpdate())},this.StopAutoUpdata=this.StopAutoUpdate,this.ChartDestory=function(){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChartDestory&&(n.JSConsole.Chart.Log("[JSChart::ChartDestory]"),this.JSChartContainer.ChartDestory())},this.CreateSimpleChart=function(t){var e=new lt(this.CanvasElement);t.MainDataControl&&(e.MainDataControl=t.MainDataControl),t.FrameType>0&&(e.FrameType=t.FrameType),isNaN(t.SplitCount)||(e.YSplitCount=t.SplitCount),e.Create(),t.Border&&(isNaN(t.Border.Left)||(e.Frame.ChartBorder.Left=t.Border.Left),isNaN(t.Border.Right)||(e.Frame.ChartBorder.Right=t.Border.Right),isNaN(t.Border.Top)||(e.Frame.ChartBorder.Top=t.Border.Top),isNaN(t.Border.Bottom)||(e.Frame.ChartBorder.Bottom=t.Border.Bottom),isNaN(t.Border.TitleHeight)||(e.Frame.ChartBorder.TitleHeight=t.Border.TitleHeight)),t.XFontType&&(e.Frame.XFontType=t.XFontType),t.Frame&&(t.Frame[0].MaxDistanceWidth&&(e.Frame.MaxDistanceWidth=t.Frame[0].MaxDistanceWidth),null!=t.Frame[0].IsShowBorder&&(e.Frame.IsShowBorder=t.Frame[0].IsShowBorder),t.Frame[0].StringFormat&&(e.Frame.YSplitOperator.StringFormat=t.Frame[0].StringFormat),t.Frame[0].FloatPrecision>=0&&(e.Frame.YSplitOperator.FloatPrecision=t.Frame[0].FloatPrecision),t.Frame[0].IgnoreYValue&&(e.Frame.YSplitOperator.IgnoreYValue=t.Frame[0].IgnoreYValue)),e.Draw(),e.RequestData(),this.JSChartContainer=e,this.JSChartContainer.Draw()},this.CreatePieChart=function(t){var e=new ut(this.CanvasElement);t.MainDataControl&&(e.MainDataControl=t.MainDataControl),t.Radius&&(e.Radius=t.Radius),e.Create(),t.Border&&(isNaN(t.Border.Left)||(e.Frame.ChartBorder.Left=t.Border.Left),isNaN(t.Border.Right)||(e.Frame.ChartBorder.Right=t.Border.Right),isNaN(t.Border.Top)||(e.Frame.ChartBorder.Top=t.Border.Top),isNaN(t.Border.Bottom)||(e.Frame.ChartBorder.Bottom=t.Border.Bottom)),t.Frame&&0==t.Frame[0].IsShowBorder&&(e.Frame.IsShowBorder=t.Frame[0].IsShowBorder),e.Draw(),e.RequestData(),this.JSChartContainer=e,this.JSChartContainer.Draw()},this.CreateMapChart=function(t){var e=new Ct(this.CanvasElement);t.MainDataControl&&(e.MainDataControl=t.MainDataControl),e.Create(),t.Border&&(isNaN(t.Border.Left)||(e.Frame.ChartBorder.Left=t.Border.Left),isNaN(t.Border.Right)||(e.Frame.ChartBorder.Right=t.Border.Right),isNaN(t.Border.Top)||(e.Frame.ChartBorder.Top=t.Border.Top),isNaN(t.Border.Bottom)||(e.Frame.ChartBorder.Bottom=t.Border.Bottom)),t.Frame&&0==t.Frame[0].IsShowBorder&&(e.Frame.IsShowBorder=t.Frame[0].IsShowBorder),e.Draw(),e.RequestData(),this.JSChartContainer=e,this.JSChartContainer.Draw()},this.OnTouchStart=function(t){this.JSChartContainer&&this.JSChartContainer.ontouchstart(t)},this.OnTouchMove=function(t){this.JSChartContainer&&this.JSChartContainer.ontouchmove(t)},this.OnTouchEnd=function(t){this.JSChartContainer&&this.JSChartContainer.ontouchend(t)},this.SaveToImage=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.SaveToImage&&this.JSChartContainer.SaveToImage(t)},this.EnableSplashScreen=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.EnableSplashScreen&&this.JSChartContainer.EnableSplashScreen(t)}}p.Init=function(t){n.JSConsole.Chart.Log("[JSChart.Init] uielement",t);var e=new p(t);return e.OnSize(),e},p.SetDomain=function(t,e){t&&(c.JSCommonResource_Global_JSChartResource.Domain=t,c.JSCommonResource_Global_JSChartResource.Index.StockHistoryDayApiUrl=t+"/API/StockHistoryDay",c.JSCommonResource_Global_JSChartResource.Index.MarketLongShortApiUrl=t+"/API/FactorTiming",c.JSCommonResource_Global_JSChartResource.Index.MarketAttentionApiUrl=t+"/API/MarketAttention",c.JSCommonResource_Global_JSChartResource.Index.MarketHeatApiUrl=t+"/API/MarketHeat"),e&&(c.JSCommonResource_Global_JSChartResource.CacheDomain=e),l.JSCommonComplier.JSComplier.SetDomain(t,e)},p.SetStyle=function(t){t&&c.JSCommonResource_Global_JSChartResource.SetStyle(t)},p.GetResource=function(){return c.JSCommonResource_Global_JSChartResource},p.GetKLineZoom=function(){return U},p.GetChinaFuturesTimeData=function(){return h.JSCommonCoordinateData_Global_FuturesTimeData},p.GetInternalTimeData=function(t){switch(t){case"NYMEXTimeData":return h.JSCommonCoordinateData_Global_NYMEXTimeData;case"COMEXTimeData":return h.JSCommonCoordinateData_Global_COMEXTimeData;case"NYBOTTimeData":return h.JSCommonCoordinateData_Global_NYBOTTimeData;case"CBOTTimeData":return h.JSCommonCoordinateData_Global_CBOTTimeData;case"LMETimeData":return h.JSCommonCoordinateData_Global_LMETimeData;case"FuturesTimeData":return h.JSCommonCoordinateData_Global_FuturesTimeData;default:return null}};var T={OP_SCROLL_LEFT:1,OP_SCROLL_RIGHT:2,OP_ZOOM_OUT:3,OP_ZOOM_IN:4,OP_GOTO_HOME:5};function F(t){this.ClassName="JSChartContainer";this.Frame,this.ChartPaint=new Array,this.ChartPaintEx=[],this.ChartInfo=new Array,this.ChartInfoPaint,this.ExtendChartPaint=new Array,this.TitlePaint=new Array,this.OverlayChartPaint=new Array,this.ChartDrawPicture=new Array,this.CurrentChartDrawPicture=null,this.SelectChartDrawPicture=null,this.ChartCorssCursor,this.IsClickShowCorssCursor=!1,this.ChartSplashPaint=null,this.LoadDataSplashTitle="数据加载中",this.Canvas=t.GetContext("2d"),this.UIElement=t,this.MouseDrag,this.DragMode=1,this.PhoneTouchInfo,this.EnableScrollUpDown=!1,this.TouchTimer=null,this.LastDrawStatus,this.LastDrawID=1,this.SnapshotType=0,this.CursorIndex=0,this.LastPoint=new g,this.IsForceLandscape=!1,this.CorssCursorTouchEnd=!1,this.EnableAnimation=!1,this.FrameSplitData=new Map,this.FrameSplitData.set("double",new d.JSCommonSplit_SplitData),this.FrameSplitData.set("price",new d.JSCommonSplit_PriceSplitData),this.UpdateUICallback,this.IsOnTouch=!1,this.IsFullDraw=!1,this.LanguageID=c.JSCommonResource_JSCHART_LANGUAGE_ID.LANGUAGE_CHINESE_ID,this.FormatDateString=d.JSCommonSplit_IFrameSplitOperator.FormatDateString,this.FormatValueString=d.JSCommonSplit_IFrameSplitOperator.FormatValueString,this.ToFixedPoint=E,this.ToFixedRect=L,this.FormatTimeString=d.JSCommonSplit_IFrameSplitOperator.FormatTimeString,this.mapEvent=new Map,this.NetworkFilter,this.IsDestroy=!1,this.LastMovePoint,this.DrawMoveTimer=null,this.DrawMoveWaitTime=60,this.ChartDestory=function(){this.IsDestroy=!0,this.StopAutoUpdate()},this.AddEventCallback=function(t){if(t&&t.event&&t.callback){var e={Callback:t.callback,Source:t};this.mapEvent.set(t.event,e)}},this.RemoveEventCallback=function(t){this.mapEvent.has(t)&&this.mapEvent.delete(t)},this.GetEvent=function(t){if(!this.mapEvent.has(t))return null;var e=this.mapEvent.get(t);return e},this.GetEventCallback=this.GetEvent,this.GetIndexEvent=function(){return this.GetEvent(s.JSCommon_JSCHART_EVENT_ID.RECV_INDEX_DATA)},this.GetBarrageEvent=function(){return this.GetEvent(s.JSCommon_JSCHART_EVENT_ID.BARRAGE_PLAY_END)},this.GetEnableSplashEvent=function(){return this.GetEvent(s.JSCommon_JSCHART_EVENT_ID.ON_ENABLE_SPLASH_DRAW)},this.IsPhoneDragging=function(t){var e=t.changedTouches.length,a=t.touches.length;return 1==e&&1==a},this.IsPhonePinching=function(t){var e=t.changedTouches.length,a=t.touches.length;return(1==e||2==e)&&2==a},this.IsSingleTouch=function(t){var e=t.touches.length;return 1==e},this.GetToucheData=function(t,e){for(var a=new Array,i=0;i<t.touches.length;++i){var r=t.touches[i];e?a.push({clientX:r.y,clientY:r.x,pageX:r.y,pageY:r.x}):a.push({clientX:r.x,clientY:r.y,pageX:r.x,pageY:r.y})}return a},this.ClearDrawMoveTimer=function(){null!=this.DrawMoveTimer&&(clearTimeout(this.DrawMoveTimer),this.DrawMoveTimer=null)},this.ClearTouchTimer=function(){null!=this.TouchTimer&&(clearTimeout(this.TouchTimer),this.TouchTimer=null)},this.ontouchstart=function(t){if(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){var e=this;if(e.IsOnTouch=!0,e.PhonePinch=null,this.IsPhoneDragging(t)){if(e.TryClickLock||this.TryClickIndexTitle){var a=this.GetToucheData(t,e.IsForceLandscape),i=a[0].clientX,r=a[0].clientY;if(e.TryClickLock&&e.TryClickLock(i,r))return;if(e.TryClickIndexTitle&&e.TryClickIndexTitle(i,r))return}null!=this.TouchTimer&&clearTimeout(this.TouchTimer),1==this.ChartCorssCursor.IsShow&&(this.TouchTimer=setTimeout((function(){if(n.Click.X==n.LastMove.X&&n.Click.Y==n.LastMove.Y){e.MouseDrag;e.MouseDrag=null;var a=n.Click.X,i=n.Click.Y;e.IsForceLandscape&&(i=e.UIElement.Height-n.Click.Y),e.OnMouseMove(a,i,t)}}),800));var n={Click:{},LastMove:{}};a=this.GetToucheData(t,e.IsForceLandscape);if(n.Click.X=a[0].clientX,n.Click.Y=a[0].clientY,n.LastMove.X=a[0].clientX,n.LastMove.Y=a[0].clientY,1==e.DragMode&&(e.MouseDrag=n),this.PhoneTouchInfo={Start:{X:a[0].clientX,Y:a[0].clientY},End:{X:a[0].clientX,Y:a[0].clientY}},e.IsClickShowCorssCursor){i=n.Click.X,r=n.Click.Y;e.OnMouseMove(i,r,t,!0)}this.TouchEvent({EventID:s.JSCommon_JSCHART_EVENT_ID.ON_PHONE_TOUCH,FunctionName:"OnTouchStart"},t)}else if(this.IsPhonePinching(t)){var o={Start:{},Last:{}};a=this.GetToucheData(t,e.IsForceLandscape);o.Start={X:a[0].pageX,Y:a[0].pageY,X2:a[1].pageX,Y2:a[1].pageY},o.Last={X:a[0].pageX,Y:a[0].pageY,X2:a[1].pageX,Y2:a[1].pageY},e.PhonePinch=o}}},this.ontouchmove=function(t){var e=this;if(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){var a=this,i=this.GetToucheData(t,a.IsForceLandscape);if(this.IsPhoneDragging(t)){var r=a.MouseDrag;if(null==r){var n=i[0].clientX,s=i[0].clientY;if(this.LastMovePoint={X:n,Y:s},this.DrawMoveTimer)return;this.DrawMoveTimer=setTimeout((function(){e.LastMovePoint&&(e.OnMouseMove(e.LastMovePoint.X,e.LastMovePoint.Y,t),e.DrawMoveTimer=null)}),this.DrawMoveWaitTime)}else{var o=Math.abs(r.LastMove.X-i[0].clientX);if(o=parseInt(o),1==a.DragMode){if(o<5)return;var h=!0;r.LastMove.X<i[0].clientX&&(h=!1),a.DataMove(o,h)?(a.UpdataDataoffset(),a.UpdatePointByCursorIndex(),a.UpdateFrameMaxMin(),a.ResetFrameXYSplit(),a.Draw()):a.DragDownloadData&&a.DragDownloadData(),r.LastMove.X=i[0].clientX,r.LastMove.Y=i[0].clientY}}this.PhoneTouchInfo&&(this.PhoneTouchInfo.End.X=i[0].clientX,this.PhoneTouchInfo.End.Y=i[0].clientY)}else if(this.IsPhonePinching(t)){var l=a.PhonePinch;if(!l)return;if(this.EnableZoomUpDown&&!1===this.EnableZoomUpDown.Touch)return;var u=Math.abs(i[0].pageY-i[1].pageY),C=Math.abs(l.Last.Y-l.Last.Y2),D=u-C,m=Math.abs(i[0].pageX-i[1].pageX),S=Math.abs(l.Last.X-l.Last.X2),c=m-S,f=this.ZoomStepPixel;if(Math.abs(D)<f&&Math.abs(c)<f)return;var d=D;if(Math.abs(D)<f&&(d=c),d>0){var I={};if(I.Index=parseInt(Math.abs(a.CursorIndex-.5).toFixed(0)),!a.Frame.ZoomUp(I))return;a.CursorIndex=I.Index,a.UpdatePointByCursorIndex(),a.UpdataDataoffset(),a.UpdateFrameMaxMin(),a.ResetFrameXYSplit(),a.Draw()}else{I={};if(I.Index=parseInt(Math.abs(a.CursorIndex-.5).toFixed(0)),!a.Frame.ZoomDown(I))return;a.CursorIndex=I.Index,a.UpdataDataoffset(),a.UpdatePointByCursorIndex(),a.UpdateFrameMaxMin(),a.ResetFrameXYSplit(),a.Draw()}l.Last={X:i[0].pageX,Y:i[0].pageY,X2:i[1].pageX,Y2:i[1].pageY}}}},this.ontouchend=function(t){this.ChartSplashPaint&&1==this.ChartSplashPaint.IsEnableSplash||(this.IsOnTouch=!1,this.LastMovePoint=null,n.JSConsole.Chart.Log("[JSChartContainer:ontouchend] IsOnTouch="+this.IsOnTouch+" LastDrawStatus="+this.LastDrawStatus),this.ClearDrawMoveTimer(),this.ClearTouchTimer(),this.TouchEvent({EventID:s.JSCommon_JSCHART_EVENT_ID.ON_PHONE_TOUCH,FunctionName:"OnTouchEnd"},t),this.Draw())},this.TouchEvent=function(t,e){var a=t.EventID,i=this.GetEvent(a);if(!i||!i.Callback)return!1;var r=this.PhoneTouchInfo;if(!r||!r.Start||!r.End)return!1;var n=r.End.X,o=r.End.Y,h=r.End.X,l=r.End.Y,u={X:n,Y:o,FrameID:-1,FunctionName:t.FunctionName,Drag:{Start:{X:r.Start.X,Y:r.Start.Y},End:{X:r.End.X,Y:r.End.Y}}},C=!1,D=new s.JSCommon_Rect(this.Frame.ChartBorder.GetLeft(),this.Frame.ChartBorder.GetTop(),this.Frame.ChartBorder.GetWidth(),this.Frame.ChartBorder.GetHeight());if(C=D.IsPointIn(h,l),C){var m={},S=this.Frame.GetYData(l,m);if(d.JSCommonSplit_IFrameSplitOperator.IsNumber(m.FrameID)&&m.FrameID>=0){var c=this.Frame.GetXData(h);u.FrameID=m.FrameID,u.Data={X:c,Y:S}}}return i.Callback(i,u,this),!0},this.FullDraw=function(t){var e=this,a=this;if(this.Canvas.clearRect(0,0,this.UIElement.Width,this.UIElement.Height),this.Frame.SetDrawOtherChart((function(){for(var t in e.ExtendChartPaint){var a=e.ExtendChartPaint[t];a.IsCallbackDraw&&a.Draw()}})),this.Frame.Draw(),this.Frame.DrawCustomVertical){var i=this.GetEvent(s.JSCommon_JSCHART_EVENT_ID.ON_CUSTOM_VERTICAL_DRAW);this.Frame.DrawCustomVertical(i)}if(this.ChartSplashPaint&&this.ChartSplashPaint.IsEnableSplash)return this.Frame.DrawInsideHorizontal(),this.ChartSplashPaint.Draw(),this.LastDrawStatus="FullDraw",void this.Canvas.draw();for(var r in this.ChartPaint){var n=this.ChartPaint[r];n.IsDrawFirst&&n.Draw()}for(var r in this.ChartPaint){n=this.ChartPaint[r];n.IsDrawFirst||n.Draw()}for(var r in this.ChartPaintEx){n=this.ChartPaintEx[r];n.Draw()}for(var r in this.OverlayChartPaint){n=this.OverlayChartPaint[r];n.Draw()}this.Frame.DrawInsideHorizontal&&this.Frame.DrawInsideHorizontal(),this.Frame.DrawCustomHorizontal&&this.Frame.DrawCustomHorizontal(),this.ChartInfoPaint&&this.ChartInfoPaint.Draw(),this.Frame.DrawLock();var o="DrawDynamicInfo"==t||this.IsOnTouch;o&&a.ChartCorssCursor&&(a.ChartCorssCursor.LastPoint=a.LastPoint,a.ChartCorssCursor.CursorIndex=a.CursorIndex,a.ChartCorssCursor.Draw());var h=this.GetEvent(s.JSCommon_JSCHART_EVENT_ID.ON_TITLE_DRAW),l=this.GetEvent(s.JSCommon_JSCHART_EVENT_ID.ON_INDEXTITLE_DRAW);for(var r in a.TitlePaint){n=a.TitlePaint[r];if(n.IsDynamic){if("DynamicChartTitlePainting"==n.ClassName?n.OnDrawEvent=l:n.OnDrawEvent=h,n.CursorIndex=a.CursorIndex,!o&&this.ChartPaint[0]&&this.ChartPaint[0].Data&&this.ChartPaint[0].Data.Data){var u=this.ChartPaint[0].Data,C=u.Data.length;C>0&&(n.CursorIndex=C-1-u.DataOffset)}n.FullDraw&&n.FullDraw()}}if(o)for(var r in this.ExtendChartPaint){n=this.ExtendChartPaint[r];n.IsCallbackDraw||(n.LatestPoint={X:this.LastPoint.X,Y:this.LastPoint.Y},n.IsDynamic&&n.DrawAfterTitle&&n.Draw())}this.LastDrawStatus="FullDraw",this.Canvas.draw(!1)},this.Draw=function(){var t=this;if(this.IsFullDraw)this.FullDraw("Draw");else if(1!=this.IsOnTouch||"MinuteChartContainer"!=this.ClassName&&"MinuteChartHScreenContainer"!=this.ClassName){var e=this;if(this.Canvas.clearRect(0,0,this.UIElement.Width,this.UIElement.Height),this.Frame.SetDrawOtherChart((function(){for(var e in t.ExtendChartPaint){var a=t.ExtendChartPaint[e];a.IsCallbackDraw&&a.Draw()}})),this.Frame.Draw(),this.Frame.DrawCustomVertical){var a=this.GetEvent(s.JSCommon_JSCHART_EVENT_ID.ON_CUSTOM_VERTICAL_DRAW);this.Frame.DrawCustomVertical(a)}if(this.ChartSplashPaint&&this.ChartSplashPaint.IsEnableSplash)return this.Frame.DrawInsideHorizontal(),this.ChartSplashPaint.Draw(),this.LastDrawStatus="Draw",void this.Canvas.draw();for(var i in this.ChartPaint){var r=this.ChartPaint[i];r.IsDrawFirst&&r.Draw()}for(var i in this.ChartPaint){r=this.ChartPaint[i];r.IsDrawFirst||r.Draw()}for(var i in this.ChartPaintEx){r=this.ChartPaintEx[i];r.Draw()}for(var i in this.OverlayChartPaint){r=this.OverlayChartPaint[i];r.Draw()}for(var i in this.ExtendChartPaint){r=this.ExtendChartPaint[i];r.IsCallbackDraw||(r.IsDynamic||r.IsAnimation||r.Draw())}this.Frame.DrawInsideHorizontal&&this.Frame.DrawInsideHorizontal(),this.Frame.DrawCustomHorizontal&&this.Frame.DrawCustomHorizontal(),this.ChartInfoPaint&&this.ChartInfoPaint.Draw(),this.Frame.DrawLock();var n=this.GetEvent(s.JSCommon_JSCHART_EVENT_ID.ON_TITLE_DRAW),o=this.GetEvent(s.JSCommon_JSCHART_EVENT_ID.ON_INDEXTITLE_DRAW);for(var i in this.TitlePaint){r=this.TitlePaint[i];r.IsDynamic&&("DynamicChartTitlePainting"==r.ClassName?r.OnDrawEvent=o:r.OnDrawEvent=n,"function"==typeof r.DrawTitle&&r.DrawTitle())}if(this.LastDrawStatus="Draw",this.IsOnTouch)this.Canvas.draw(!1);else{++this.LastDrawID;this.LastDrawID;this.Canvas.draw(!1,(function(){e.Frame.Snapshot(e.SnapshotType)}))}}},this.TempImage=null,this.DrawDynamicInfo=function(){if(this.IsFullDraw)this.FullDraw("DrawDynamicInfo");else{var t=this,e=this.Frame.ChartBorder.GetChartWidth(),a=this.Frame.ChartBorder.GetChartHeight();if(1==t.SnapshotType){if(null==this.Frame.ScreenImageData)return;wx.canvasPutImageData({canvasId:this.UIElement.ID,x:0,y:0,width:e,height:a,data:this.Frame.ScreenImageData,success:function(e){t.DrawDynamicChart(!0)}})}else{if(null==this.Frame.ScreenImagePath)return;t.Canvas&&t.Canvas.DomNode?(this.TempImage||(this.TempImage=t.Canvas.DomNode.createImage()),this.TempImage.src=this.Frame.ScreenImagePath,this.TempImage.onload=function(){t.Canvas.clearRect(0,0,e,a),t.Canvas.drawImage(t.TempImage,0,0,e,a),t.DrawDynamicChart(!1)}):(t.Canvas.drawImage(this.Frame.ScreenImagePath,0,0,e,a),t.DrawDynamicChart(!1))}}},this.DrawDynamicChart=function(t){var e=this;for(var a in e.ChartCorssCursor&&(e.ChartCorssCursor.LastPoint=e.LastPoint,e.ChartCorssCursor.CursorIndex=e.CursorIndex,e.ChartCorssCursor.Draw()),e.TitlePaint){var i=e.TitlePaint[a];i.IsDynamic&&(i.CursorIndex=e.CursorIndex,i.Draw())}for(var a in this.ExtendChartPaint){i=this.ExtendChartPaint[a];i.IsDynamic&&i.DrawAfterTitle&&i.Draw()}if(this.EnableAnimation)for(var a in this.ExtendChartPaint){i=this.ExtendChartPaint[a];!0===i.IsAnimation&&i.Draw()}this.LastDrawStatus="DrawDynamicInfo",n.JSConsole.Chart.Log("[JSChartContainer:DrawDynamicChart][ID="+this.UIElement.ID+"] draw ....."),e.Canvas.draw(t,(function(){n.JSConsole.Chart.Log("[JSChartContainer:DrawDynamicChart] finish.")}))},this.DrawAnimation=function(){var t=this;if(this.EnableAnimation){if(this.Frame.ScreenImagePath&&!this.IsOnTouch){for(var e in this.ExtendChartPaint){var a=this.ExtendChartPaint[e];!0===a.IsAnimation&&(a.IsMoveStep=!0)}this.DrawDynamicInfo()}this.UIElement.WebGLCanvas.requestAnimationFrame((function(){t.DrawAnimation()}))}},this.StartAnimation=function(t){var e=this;if(n.JSConsole.Chart.Log("[JSChartContainer::StartAnimation] ",this.UIElement.WebGLCanvas),this.UIElement.WebGLCanvas){var a=!1,i=null;for(var r in this.ExtendChartPaint){var s=this.ExtendChartPaint[r];if("BarragePaint"===s.ClassName){a=!0,i=s.BarrageList;break}}if(!a){var o=new m.JSCommonExtendChartPaint_BarragePaint;o.Canvas=this.Canvas,o.ChartBorder=this.Frame.ChartBorder,o.ChartFrame=this.Frame,o.HQChart=this,o.SetOption(t),this.ExtendChartPaint.push(o),i=o.BarrageList}this.EnableAnimation=!0;return this.UIElement.WebGLCanvas.requestAnimationFrame((function(){e.DrawAnimation()})),i}},this.StopAnimation=function(){this.EnableAnimation=!1,this.DrawDynamicInfo()},this.OnMouseMove=function(t,e,a,i){var r=this.LastPoint.Y;this.LastPoint.X=t,this.LastPoint.Y=e;var n=this.CursorIndex;if(this.CursorIndex=this.Frame.GetXData(t),"KLineChartContainer"==this.ClassName||"KLineChartHScreenContainer"==this.ClassName){if(n==this.CursorIndex&&Math.abs(r-e)<1)return}else if(parseInt(n-.5)==parseInt(this.CursorIndex-.5)&&Math.abs(r-e)<1)return;i?this.FullDraw():this.IsForceLandscape?this.Draw():this.DrawDynamicInfo()},this.OnDoubleClick=function(t,e,a){},this.UpdatePointByCursorIndex=function(){this.LastPoint.X=this.Frame.GetXFromIndex(this.CursorIndex);var t=Math.abs(this.CursorIndex-.5);t=parseInt(t.toFixed(0)),"KLineChartContainer"==this.ClassName&&(t=this.CursorIndex);var e=this.Frame.Data;if(!(e.DataOffset+t>=e.Data.length)){var a=e.Data[e.DataOffset+t].Close;this.LastPoint.Y=this.Frame.GetYFromData(a)}},this.ResetFrameXYSplit=function(){"function"==typeof this.Frame.ResetXYSplit&&this.Frame.ResetXYSplit()},this.UpdateFrameMaxMin=function(){var t=new Array,e=new Array;for(var a in this.ChartPaint){var i=this.ChartPaint[a];0!=i.IsShow&&e.push(i)}for(var a in this.OverlayChartPaint)e.push(this.OverlayChartPaint[a]);for(var a in e){var r=e[a],n=r.GetMaxMin();if(null!=n&&null!=n.Max&&null!=n.Min){var s=null;for(var o in t)if(t[o].Frame==r.ChartFrame){s=t[o];break}s?(s.Range.Max<n.Max&&(s.Range.Max=n.Max),s.Range.Min>n.Min&&(s.Range.Min=n.Min)):(s={},s.Frame=r.ChartFrame,s.Range=n,t.push(s))}}for(var a in t){i=t[a];i.Frame&&i.Range&&(null!=i.Range.Max&&null!=i.Range.Min&&(i.Frame.YSpecificMaxMin?(i.Frame.HorizontalMax=i.Frame.YSpecificMaxMin.Max,i.Frame.HorizontalMin=i.Frame.YSpecificMaxMin.Min):(i.Frame.HorizontalMax=i.Range.Max,i.Frame.HorizontalMin=i.Range.Min),i.Frame.XYSplit=!0))}},this.DataMoveLeft=function(){var t=null;return t=this.Frame.Data?this.Frame.SubFrame[0].Frame.Data:this.Frame.Data,!!t&&(!(t.DataOffset<=0)&&(--t.DataOffset,!0))},this.DataMoveRight=function(){var t=null;if(t=this.Frame.Data?this.Frame.SubFrame[0].Frame.Data:this.Frame.Data,!t)return!1;var e=0;return e=this.Frame.XPointCount?this.Frame.XPointCount:this.Frame.SubFrame[0].Frame.XPointCount,!!e&&(!(e+t.DataOffset>=t.Data.length)&&(++t.DataOffset,!0))},this.UpdataDataoffset=function(){var t=null;if(t=this.Frame.Data?this.Frame.Data:this.Frame.SubFrame[0].Frame.Data,t){for(var e in this.ChartPaint){var a=this.ChartPaint[e];a.Data&&(a.Data.DataOffset=t.DataOffset)}for(var e in this.OverlayChartPaint){a=this.OverlayChartPaint[e];a.Data&&(a.Data.DataOffset=t.DataOffset)}}},this.DataMove=function(t,e){if(t=parseInt(t/this.StepPixel),t<=0)return!1;var a=null;if(a=this.Frame.Data?this.Frame.SubFrame[0].Frame.Data:this.Frame.Data,!a)return!1;var i=0;if(i=this.Frame.XPointCount?this.Frame.XPointCount:this.Frame.SubFrame[0].Frame.XPointCount,!i)return!1;if(e){if(this.RightSpaceCount>0){if(i+a.DataOffset>=a.Data.length+this.RightSpaceCount-1)return!1;a.DataOffset+=t,a.DataOffset+i>=a.Data.length+this.RightSpaceCount&&(a.DataOffset=a.Data.length-(i-this.RightSpaceCount))}else{if(i+a.DataOffset>=a.Data.length)return!1;a.DataOffset+=t,a.DataOffset+i>=a.Data.length&&(a.DataOffset=a.Data.length-i)}return!0}return!(a.DataOffset<=0)&&(a.DataOffset-=t,a.DataOffset<0&&(a.DataOffset=0),!0)},this.GetSubFrameIndex=function(t,e){if(!this.Frame.SubFrame||this.Frame.SubFrame.length<=0)return-1;for(var a in this.Frame.SubFrame){var i=this.Frame.SubFrame[a].Frame,r=i.ChartBorder.GetLeft(),n=i.ChartBorder.GetTop(),s=i.ChartBorder.GetHeight(),o=i.ChartBorder.GetWidth();if(this.Canvas.rect(r,n,o,s),this.Canvas.isPointInPath(t,e))return parseInt(a)}return 0},this.GetDataIndexByPoint=function(t){var e=this.Frame;this.Frame.SubFrame&&this.Frame.SubFrame.length>0&&(e=this.Frame.SubFrame[0].Frame);var a=null;if(a=this.Frame.Data?this.Frame.Data:this.Frame.SubFrame[0].Frame.Data,a&&e){var i=parseInt(e.GetXData(t));return a.DataOffset+i}},this.SaveToImage=function(t){var e=this.UIElement.Width,a=this.UIElement.Height;n.JSConsole.Chart.Log("[JSChartContainer::SaveToImage]",this.UIElement),wx.canvasToTempFilePath({x:0,y:0,width:e,height:a,canvasId:this.UIElement.ID,success:function(i){var r={ImagePath:i.tempFilePath,Width:e,Height:a};"function"==typeof t&&t(r)}})},this.EnableSplashScreen=function(t){this.ChartSplashPaint&&t&&(d.JSCommonSplit_IFrameSplitOperator.IsString(t.Title)&&this.ChartSplashPaint.SetTitle(t.Title),this.ChartSplashPaint.EnableSplash(!0),!1!==t.Draw&&this.Draw())},this.AddIndexWindow=function(t,e){var a=this,i=new u.JSCommonIndexScript.JSIndexScript,r=i.Get(t);if(r){var n=this.Frame.SubFrame.length,s=this.CreateSubFrameItem(n);this.Frame.SubFrame[n]=s;var o=new I.JSCommonChartTitle_DynamicChartTitlePainting;if(o.Frame=this.Frame.SubFrame[n].Frame,o.Canvas=this.Canvas,o.LanguageID=this.LanguageID,o.GetEventCallback=function(t){return a.GetEventCallback(t)},this.TitlePaint[n+1]=o,e){if(e.Window){var h=e.Window;1==h.IsDrawTitleBG&&(s.Frame.IsDrawTitleBG=h.IsDrawTitleBG)}d.JSCommonSplit_IFrameSplitOperator.IsNumber(e.TitleHeight)&&(s.Frame.ChartBorder.TitleHeight=e.TitleHeight),d.JSCommonSplit_IFrameSplitOperator.IsBool(e.IsShowTitleArraw)&&(s.Frame.IsShowTitleArraw=e.IsShowTitleArraw),d.JSCommonSplit_IFrameSplitOperator.IsBool(e.IsShowIndexName)&&(s.Frame.IsShowIndexName=e.IsShowIndexName),d.JSCommonSplit_IFrameSplitOperator.IsBool(e.IsShowOverlayIndexName)&&(s.Frame.IsShowOverlayIndexName=e.IsShowOverlayIndexName),d.JSCommonSplit_IFrameSplitOperator.IsNumber(e.IndexParamSpace)&&(s.Frame.IndexParamSpace=e.IndexParamSpace),d.JSCommonSplit_IFrameSplitOperator.IsBool(e.IsShowXLine)&&(s.Frame.IsShowXLine=e.IsShowXLine),d.JSCommonSplit_IFrameSplitOperator.IsBool(e.IsShowYLine)&&(s.Frame.IsShowYLine=e.IsShowYLine),d.JSCommonSplit_IFrameSplitOperator.IsBool(e.IsShowIndexTitle)&&(s.Frame.IsShowIndexTitle=e.IsShowIndexTitle)}for(var l=0;l<this.Frame.SubFrame.length;++l){h=this.Frame.SubFrame[l].Frame;l==this.Frame.SubFrame.length-1?h.XSplitOperator.ShowText=!0:h.XSplitOperator.ShowText=!1}this.UpdataDataoffset(),this.Frame.SetSizeChage(!0),this.UpdateXShowText&&this.UpdateXShowText(),this.ResetFrameXYSplit(),this.UpdateFrameMaxMin(),this.Draw();var C={Name:r.Name,Script:r.Script,Args:r.Args,ID:t,KLineType:r.KLineType,YSpecificMaxMin:r.YSpecificMaxMin,YSplitScale:r.YSplitScale,FloatPrecision:r.FloatPrecision,Condition:r.Condition,StringFormat:r.StringFormat,OutName:r.OutName};if(e&&(e.FloatPrecision>=0&&(C.FloatPrecision=e.FloatPrecision),e.StringFormat>0&&(C.StringFormat=e.StringFormat),e.Args&&(C.Args=e.Args)),this.WindowIndex[n]=new S.JSCommonIndex_ScriptIndex(C.Name,C.Script,C.Args,C),"MinuteChartContainer"==this.ClassName||"MinuteChartHScreenContainer"==this.ClassName)var D=this.SourceData;else D=this.ChartPaint[0].Data;this.BindIndexData(n,D)}}}function A(t,e){var a=1;if(isNaN(t))return t;t<0&&(a=-1);var i=Math.pow(10,e),r=Math.round(Math.abs(t)*i)/i*a;if(/^(\d+(?:\.\d+)?)(e)([\-]?\d+)$/.test(r))var n=r.toFixed2(e);else n=r.toString();var s=n.indexOf(".");s<0&&e>0&&(s=n.length,n+=".");while(n.length<=s+e)n+="0";return n}function M(){function t(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}function E(t){return parseInt(t)+.5}function L(t){return.5+t<<0}function g(){this.X,this.Y}function N(){this.UIElement,this.Left=50,this.Right=80,this.Top=50,this.Bottom=50,this.TitleHeight=15,this.TopSpace=0,this.BottomSpace=0,this.LeftExtendWidth=0,this.RightExtendWidth=0,this.GetBorder=function(){var t={Left:this.Left,LeftEx:this.Left+this.LeftExtendWidth,Right:this.UIElement.width-this.Right,RightEx:this.UIElement.width-this.Right-this.RightExtendWidth,Top:this.Top,TopEx:this.Top+this.TitleHeight+this.TopSpace,TopTitle:this.Top+this.TitleHeight,Bottom:this.UIElement.height-this.Bottom,BottomEx:this.UIElement.height-this.Bottom-this.BottomSpace,ChartWidth:this.UIElement.width,ChartHeight:this.UIElement.height};return t},this.GetHScreenBorder=function(){var t={Left:this.Left,LeftEx:this.Left+this.BottomSpace,Right:this.UIElement.width-this.Right,RightEx:this.UIElement.width-this.Right-this.TitleHeight-this.TopSpace,RightTitle:this.UIElement.width-this.Right-this.TitleHeight,Top:this.Top,TopEx:this.Top+this.LeftExtendWidth,Bottom:this.UIElement.height-this.Bottom,BottomEx:this.UIElement.height-this.Bottom-this.RightExtendWidth,ChartWidth:this.UIElement.width,ChartHeight:this.UIElement.height};return t},this.GetChartWidth=function(){return this.UIElement.Width},this.GetChartHeight=function(){return this.UIElement.Height},this.GetLeft=function(){return this.Left},this.GetRight=function(){return this.UIElement.Width-this.Right},this.GetTop=function(){return this.Top},this.GetTopEx=function(){return this.Top+this.TitleHeight+this.TopSpace},this.GetTopTitle=function(){return this.Top+this.TitleHeight},this.GetBottom=function(){return this.UIElement.Height-this.Bottom},this.GetBottomEx=function(){return this.UIElement.Height-this.Bottom-this.BottomSpace},this.GetWidth=function(){return this.UIElement.Width-this.Left-this.Right},this.GetHeight=function(){return this.UIElement.Height-this.Top-this.Bottom},this.GetHeightEx=function(){return this.UIElement.Height-this.Top-this.Bottom-this.TitleHeight-this.TopSpace-this.BottomSpace},this.GetRightEx=function(){return this.UIElement.Width-this.Right-this.TitleHeight-this.TopSpace},this.GetWidthEx=function(){return this.UIElement.Width-this.Left-this.Right-this.TitleHeight-this.TopSpace-this.BottomSpace},this.GetLeftEx=function(){return this.Left+this.BottomSpace},this.GetRightTitle=function(){return this.UIElement.Width-this.Right-this.TitleHeight},this.GetTitleHeight=function(){return this.TitleHeight}}function x(){this.HorizontalInfo=new Array,this.VerticalInfo=new Array,this.ClassName="IChartFramePainting",this.Canvas,this.Identify,this.ChartBorder,this.PenBorder=c.JSCommonResource_Global_JSChartResource.FrameBorderPen,this.TitleBGColor=c.JSCommonResource_Global_JSChartResource.FrameTitleBGColor,this.IsShow=!0,this.SizeChange=!0,this.XYSplit=!0,this.HorizontalMax,this.HorizontalMin,this.XPointCount=10,this.YSplitOperator,this.XSplitOperator,this.Data,this.YSpecificMaxMin=null,this.YSplitScale=null,this.IsShowBorder=!0,this.IsShowIndexName=!0,this.IndexParamSpace=2,this.IsLocked=!1,this.LockPaint=null,this.BorderLine=null,this.Draw=function(){this.DrawFrame(),this.DrawBorder(),this.SizeChange=!1,this.XYSplit=!1},this.DrawFrame=function(){},this.DrawBorder=function(){if(this.IsShowBorder){var t=E(this.ChartBorder.GetLeft()),e=E(this.ChartBorder.GetTop()),a=E(this.ChartBorder.GetRight()),i=E(this.ChartBorder.GetBottom()),r=a-t,n=i-e;null==this.BorderLine?(this.Canvas.strokeStyle=this.PenBorder,this.Canvas.strokeRect(t,e,r,n)):d.JSCommonSplit_IFrameSplitOperator.IsNumber(this.BorderLine)&&(this.Canvas.strokeStyle=this.PenBorder,this.Canvas.beginPath(),(1&this.BorderLine)>0&&(this.Canvas.moveTo(t,e),this.Canvas.lineTo(a,e)),(2&this.BorderLine)>0&&(this.Canvas.moveTo(t,i),this.Canvas.lineTo(a,i)),(4&this.BorderLine)>0&&(this.Canvas.moveTo(t,e),this.Canvas.lineTo(t,i)),(8&this.BorderLine)>0&&(this.Canvas.moveTo(a,e),this.Canvas.lineTo(a,i)),this.Canvas.stroke())}},this.DrawTitleBG=function(){},this.DrawLock=function(){this.IsLocked&&(null==this.LockPaint&&(this.LockPaint=new D.JSCommonChartPaint_ChartLock),this.LockPaint.Canvas=this.Canvas,this.LockPaint.ChartBorder=this.ChartBorder,this.LockPaint.ChartFrame=this,this.LockPaint.Draw())},this.SetLock=function(t){t?(this.IsLocked=!0,this.LockPaint||(this.LockPaint=new D.JSCommonChartPaint_ChartLock),t.Callback&&(this.LockPaint.Callback=t.Callback),t.IndexName&&(this.LockPaint.IndexName=t.IndexName),t.ID&&(this.LockPaint.LockID=t.ID),t.BG&&(this.LockPaint.BGColor=t.BG),t.Text&&(this.LockPaint.Title=t.Text),t.TextColor&&(this.LockPaint.TextColor=t.TextColor),t.Font&&(this.LockPaint.Font=t.Font),t.Count&&(this.LockPaint.LockCount=t.Count)):this.IsLocked=!1}}function R(){this.newMethod=x,this.newMethod(),delete this.newMethod,this.ClassName="NoneFrame",this.Snapshot=function(){},this.DrawInsideHorizontal=function(){},this.SetSizeChage=function(t){this.SizeChange=t,this.Position={X:this.ChartBorder.UIElement.offsetLeft,Y:this.ChartBorder.UIElement.offsetTop,W:this.ChartBorder.UIElement.clientWidth,H:this.ChartBorder.UIElement.clientHeight}}}function O(){this.newMethod=x,this.newMethod(),delete this.newMethod,this.ClassName="AverageWidthFrame",this.DataWidth=50,this.DistanceWidth=10,this.MinXDistance=30,this.MinYDistance=10,this.XMessageAlign="top",this.IsShowTitle=!0,this.IsShowYText=[!0,!0],this.XBottomOffset=c.JSCommonResource_Global_JSChartResource.Frame.XBottomOffset,this.YTextTopOffset=c.JSCommonResource_Global_JSChartResource.Frame.YTopOffset,this.YTextPosition=[0,0],this.IsShowXLine=!0,this.IsShowYLine=!0,this.YTextBaseline=0,this.ShortYLineLength=5,this.ShortXLineLength=5,this.DrawOtherChart,this.DrawFrame=function(){this.XPointCount>0&&(this.DistanceWidth=this.ChartBorder.GetWidth()/(4*this.XPointCount),this.DataWidth=2*this.DistanceWidth),this.DrawHorizontal(),this.DrawVertical()},this.GetYFromData=function(t){if(t<=this.HorizontalMin)return this.ChartBorder.GetBottomEx();if(t>=this.HorizontalMax)return this.ChartBorder.GetTopEx();var e=this.ChartBorder.GetHeightEx()*(t-this.HorizontalMin)/(this.HorizontalMax-this.HorizontalMin);return this.ChartBorder.GetBottomEx()-e},this.DrawInsideHorizontal=function(){if(!0!==this.IsHScreen&&(!1!==this.IsShowYText[0]||!1!==this.IsShowYText[1])){var t=this.ChartBorder.GetLeft(),e=this.ChartBorder.GetRight(),a=this.ChartBorder.GetBottom(),i=this.ChartBorder.GetTopTitle(),r=this.ChartBorder.Right,n=this.ChartBorder.Left;this.ChartBorder.TitleHeight;if(!(n>=10)&&(n<10&&!0===this.IsShowYText[0]||r<10&&!0===this.IsShowYText[1]))for(var s=null,o=this.HorizontalInfo.length-1;o>=0;--o){var h=this.HorizontalInfo[o];if(h){var l=this.GetYFromData(h.Value);if(!(null!=l&&null!=s&&Math.abs(l-s)<this.MinYDistance)){if(null!=h.Message[0]&&n<10&&!0===this.IsShowYText[0]){null!=h.Font&&(this.Canvas.font=h.Font),this.Canvas.fillStyle=h.TextColor,this.Canvas.textAlign="left";var u=l;l>=a-2?this.Canvas.textBaseline="bottom":l<=i+2?(this.Canvas.textBaseline="top",u+=this.YTextTopOffset):1==this.YTextBaseline?this.Canvas.textBaseline="bottom":this.Canvas.textBaseline="middle";var C={X:t,Y:u,Text:{BaseLine:this.Canvas.textBaseline,Font:this.Canvas.font,Value:h.Message[0]}};this.IsOverlayMaxMin&&this.IsOverlayMaxMin(C)||this.Canvas.fillText(h.Message[0],t+1,u)}if(null!=h.Message[1]&&r<10&&!0===this.IsShowYText[1]){null!=h.Font&&(this.Canvas.font=h.Font),this.Canvas.fillStyle=h.TextColor,this.Canvas.textAlign="right";u=l;l>=a-2?this.Canvas.textBaseline="bottom":l<=i+2?(this.Canvas.textBaseline="top",u+=this.YTextTopOffset):1==this.YTextBaseline?this.Canvas.textBaseline="bottom":this.Canvas.textBaseline="middle";var D=this.Canvas.measureText(h.Message[1]).width;C={X:e-D,Y:u,Text:{BaseLine:this.Canvas.textBaseline,TextAlign:this.Canvas.textAlign,Font:this.Canvas.font,Value:h.Message[1]}};this.IsOverlayMaxMin&&this.IsOverlayMaxMin(C)||this.Canvas.fillText(h.Message[1],e-1,u)}s=l}}}}},this.DrawHorizontal=function(){var t=this.ChartBorder.GetLeft(),e=this.ChartBorder.GetRight(),a=this.ChartBorder.GetBottom(),i=this.ChartBorder.GetTopTitle(),r=this.ChartBorder.Right,n=this.ChartBorder.Left;this.ChartBorder.TitleHeight;this.Canvas.save();for(var s=null,o=this.HorizontalInfo.length-1;o>=0;--o){var h=this.HorizontalInfo[o],l=this.GetYFromData(h.Value);if(!(null!=l&&null!=s&&Math.abs(l-s)<this.MinYDistance)){var u=E(l);a!=l&&this.IsShowYLine&&(2==h.LineType?(this.Canvas.strokeStyle=h.LineColor,this.Canvas.setLineDash([5,5]),this.Canvas.beginPath(),this.Canvas.moveTo(t,u),this.Canvas.lineTo(e,u),this.Canvas.stroke(),this.Canvas.setLineDash([])):3==h.LineType||h.LineType>0&&(this.Canvas.strokeStyle=h.LineColor,c.JSCommonResource_Global_JSChartResource.FrameYLineDash?(this.Canvas.setLineDash(c.JSCommonResource_Global_JSChartResource.FrameYLineDash),this.Canvas.beginPath(),this.Canvas.moveTo(t,u),this.Canvas.lineTo(e,u),this.Canvas.stroke(),this.Canvas.setLineDash([])):(this.Canvas.beginPath(),this.Canvas.moveTo(t,u),this.Canvas.lineTo(e,u),this.Canvas.stroke())));var C=l;if(l>=a-2?this.Canvas.textBaseline="bottom":l<=i+2?(this.Canvas.textBaseline="top",C+=this.YTextTopOffset):this.Canvas.textBaseline="middle",this.Canvas.fillStyle=h.TextColor,this.Canvas.strokeStyle=h.TextColor,null!=h.Message[0]&&n>10&&!0===this.IsShowYText[0]&&(null!=h.Font&&(this.Canvas.font=h.Font),this.Canvas.textAlign="right",this.Canvas.fillText(h.Message[0],t-2,C)),null!=h.Message[1]&&r>10&&!0===this.IsShowYText[1]){null!=h.Font&&(this.Canvas.font=h.Font);var D=e;if(3==h.LineType){var m=this.ShortYLineLength;this.Canvas.beginPath(),this.Canvas.moveTo(D,u),this.Canvas.lineTo(D+m,u),this.Canvas.stroke(),D+=m}this.Canvas.textAlign="left",this.Canvas.fillText(h.Message[1],D+2,C)}s=l}}this.Canvas.restore()},this.GetXFromIndex=function(t){var e=this.XPointCount;if(1==e)return 0==t?this.ChartBorder.GetLeft():this.ChartBorder.GetRight();if(e<=0)return this.ChartBorder.GetLeft();if(t>=e)return this.ChartBorder.GetRight();var a=this.ChartBorder.GetLeft()+this.ChartBorder.GetWidth()*t/e;return a},this.DrawVertical=function(){var t=this.ChartBorder.GetTopTitle(),e=this.ChartBorder.GetBottom(),a=this.ChartBorder.GetRight();if(!(this.ChartBorder.Bottom<=5)){var i=e;"bottom"==this.XMessageAlign?i=this.ChartBorder.GetChartHeight():this.XMessageAlign="top";var r=null,n=null;for(var s in this.VerticalInfo){var o=this.GetXFromIndex(this.VerticalInfo[s].Value);if(o>a)break;if(!(null!=r&&Math.abs(o-r)<this.MinXDistance)){var h=this.VerticalInfo[s],l=E(o);if(this.IsShowXLine&&h.LineType>0&&(2==h.LineType?(this.Canvas.strokeStyle=h.LineColor,this.Canvas.setLineDash([5,5]),this.Canvas.beginPath(),this.Canvas.moveTo(l,t),this.Canvas.lineTo(l,e),this.Canvas.stroke(),this.Canvas.setLineDash([])):3==h.LineType||h.LineType>0&&(c.JSCommonResource_Global_JSChartResource.FrameXLineDash?(this.Canvas.strokeStyle=h.LineColor,this.Canvas.beginPath(),this.Canvas.setLineDash(c.JSCommonResource_Global_JSChartResource.FrameXLineDash),this.Canvas.moveTo(l,t),this.Canvas.lineTo(l,e),this.Canvas.stroke(),this.Canvas.setLineDash([])):(this.Canvas.strokeStyle=h.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(l,t),this.Canvas.lineTo(l,e),this.Canvas.stroke()))),null!=this.VerticalInfo[s].Message[0]&&this.ChartBorder.Bottom>5){var u=null,C=null;null!=this.VerticalInfo[s].Font&&(this.Canvas.font=this.VerticalInfo[s].Font),this.Canvas.fillStyle=h.TextColor,this.Canvas.strokeStyle=h.TextColor;var D=this.Canvas.measureText(this.VerticalInfo[s].Message[0]).width;if(o<D/2?(this.Canvas.textAlign="left",this.Canvas.textBaseline=this.XMessageAlign,u=o+D,C=o):o+D/2>=this.ChartBorder.GetChartWidth()?(this.Canvas.textAlign="right",this.Canvas.textBaseline=this.XMessageAlign,u=o+D,C=o):(this.Canvas.textAlign="center",this.Canvas.textBaseline=this.XMessageAlign,u=o+D/2,C=o-D/2),null!=n&&n>C)continue;i=e;if(3==h.LineType){var m=this.ShortXLineLength;this.Canvas.beginPath(),this.Canvas.moveTo(l,i),this.Canvas.lineTo(l,i+m),this.Canvas.stroke(),i+=m+2}this.Canvas.fillText(this.VerticalInfo[s].Message[0],o,i+this.XBottomOffset),n=u}r=o}}}},this.GetYData=function(t){return t<this.ChartBorder.GetTopEx()?this.HorizontalMax:t>this.ChartBorder.GetBottomEx()?this.HorizontalMin:(this.ChartBorder.GetBottomEx()-t)/this.ChartBorder.GetHeightEx()*(this.HorizontalMax-this.HorizontalMin)+this.HorizontalMin},this.GetXData=function(t){return t<=this.ChartBorder.GetLeft()?0:t>=this.ChartBorder.GetRight()?this.XPointCount:(t-this.ChartBorder.GetLeft())*(1*this.XPointCount/this.ChartBorder.GetWidth())},this.DrawCustomItem=function(t){if((t.Message[1]||t.Message[0])&&!(t.Value>this.HorizontalMax||t.Value<this.HorizontalMin)){var e=this.ChartBorder.GetLeft(),a=this.ChartBorder.GetRight(),i=this.ChartBorder.GetBottom(),r=this.ChartBorder.GetTopTitle(),n=this.ChartBorder.Right,s=this.ChartBorder.Left;this.ChartBorder.TitleHeight;this.IsHScreen&&(s=this.ChartBorder.Top,n=this.ChartBorder.Bottom,r=this.ChartBorder.GetTop(),i=this.ChartBorder.GetBottom());var o=18,h=this.GetYFromData(t.Value);if(t.Message[0])if(s<10){null!=t.Font&&(this.Canvas.font=t.Font),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle";var l=this.Canvas.measureText(t.Message[0]).width+2,u=t.LineColor,C=this.RGBToStruct(t.LineColor);if(C&&(u="rgba(".concat(C.R,", ").concat(C.G,", ").concat(C.B,", ").concat(c.JSCommonResource_Global_JSChartResource.FrameLatestPrice.BGAlpha,")")),this.Canvas.fillStyle=u,this.IsHScreen){var D=r,m=h-o/2-1;this.Canvas.fillRect(m,D,o,l),this.DrawHScreenText({X:h,Y:D},{Text:t.Message[0],Color:t.TextColor,XOffset:1,YOffset:2}),this.DrawLine(D+l,i,h,t.LineColor,t.LineType)}else{D=h-o/2-1,m=e+1;this.Canvas.fillRect(m,D,l,o),this.Canvas.fillStyle=t.TextColor,this.Canvas.fillText(t.Message[0],m+1,h),this.DrawLine(m+l,a,h,t.LineColor,t.LineType)}}else{null!=t.Font&&(this.Canvas.font=t.Font),this.Canvas.textAlign="right",this.Canvas.textBaseline="middle";l=this.Canvas.measureText(t.Message[0]).width+2;if(this.Canvas.fillStyle=t.LineColor,this.IsHScreen){D=r-l,m=h-o/2-1;this.Canvas.fillRect(m,D,o,l),this.DrawHScreenText({X:h,Y:D},{Text:t.Message[0],Color:t.TextColor,XOffset:1,YOffset:2}),this.DrawLine(D+l,i,h,t.LineColor,t.LineType)}else{D=h-o/2-1;this.Canvas.fillRect(e-l,D,l,o),this.Canvas.fillStyle=t.TextColor,this.Canvas.fillText(t.Message[0],e-1,h),this.DrawLine(e,a,h,t.LineColor,t.LineType)}}else if(t.Message[1])if(n<10){null!=t.Font&&(this.Canvas.font=t.Font),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle";l=this.Canvas.measureText(t.Message[1]).width+2,u=t.LineColor,C=this.RGBToStruct(t.LineColor);if(C&&(u="rgba(".concat(C.R,", ").concat(C.G,", ").concat(C.B,", ").concat(c.JSCommonResource_Global_JSChartResource.FrameLatestPrice.BGAlpha,")")),this.Canvas.fillStyle=u,this.IsHScreen){D=i-l,m=h-o/2-1;this.Canvas.fillRect(m,D,o,l),this.DrawHScreenText({X:h,Y:D},{Text:t.Message[1],Color:t.TextColor,XOffset:1,YOffset:2}),this.DrawLine(r,D,h,t.LineColor,t.LineType)}else{D=h-o/2-1,m=a-l;this.Canvas.fillRect(m,D,l,o),this.Canvas.fillStyle=t.TextColor,this.Canvas.fillText(t.Message[1],m+1,h),this.DrawLine(e,m,h,t.LineColor,t.LineType)}}else{null!=t.Font&&(this.Canvas.font=t.Font),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle";l=this.Canvas.measureText(t.Message[1]).width+2;if(this.Canvas.fillStyle=t.LineColor,this.IsHScreen){D=i,m=h-o/2-1;this.Canvas.fillRect(m,D,o,l),this.DrawHScreenText({X:h,Y:D},{Text:t.Message[1],Color:t.TextColor,XOffset:1,YOffset:2}),this.DrawLine(r,D,h,t.LineColor,t.LineType)}else{D=h-o/2-1;this.Canvas.fillRect(a,D,l,o),this.Canvas.fillStyle=t.TextColor,this.Canvas.fillText(t.Message[1],a+1,h),this.DrawLine(e,a,h,t.LineColor,t.LineType)}}}},this.DrawLine=function(t,e,a,i,r){-1!=r&&(0==r?(this.Canvas.strokeStyle=i,this.Canvas.beginPath(),this.IsHScreen?(this.Canvas.moveTo(E(a),t),this.Canvas.lineTo(E(a),e)):(this.Canvas.moveTo(t,E(a)),this.Canvas.lineTo(e,E(a))),this.Canvas.stroke()):this.DrawDotLine(t,e,a,i))},this.DrawDotLine=function(t,e,a,i){this.Canvas.save(),this.Canvas.strokeStyle=i,this.Canvas.setLineDash([5,5]),this.Canvas.beginPath(),this.IsHScreen?(this.Canvas.moveTo(E(a),t),this.Canvas.lineTo(E(a),e)):(this.Canvas.moveTo(t,E(a)),this.Canvas.lineTo(e,E(a))),this.Canvas.stroke(),this.Canvas.restore()},this.RGBToStruct=function(t){if(/^(rgb|RGB)/.test(t)){var e=t.replace(/(?:\(|\)|rgb|RGB)*/g,"").split(","),a={};return 3!=e.length?null:(a.R=Number(e[0]),a.G=Number(e[1]),a.B=Number(e[2]),a)}return null},this.DrawHScreenText=function(t,e){this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=e.Color,this.Canvas.save(),this.Canvas.translate(t.X,t.Y),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(e.Text,e.XOffset,e.YOffset),this.Canvas.restore()}}function B(){this.newMethod=O,this.newMethod(),delete this.newMethod,this.ClassName="MinuteFrame",this.MinXDistance=10,this.CustomHorizontalInfo=[],this.DrawFrame=function(){this.SplitXYCoordinate(),this.DrawTitleBG(),this.DrawHorizontal(),this.DrawVertical()},this.SplitXYCoordinate=function(){0!=this.XYSplit&&(null!=this.YSplitOperator&&this.YSplitOperator.Operator(),null!=this.XSplitOperator&&this.XSplitOperator.Operator())},this.GetXFromIndex=function(t){var e=this.XPointCount-1;if(1==e)return 0==t?this.ChartBorder.GetLeft():this.ChartBorder.GetRight();if(e<=0)return this.ChartBorder.GetLeft();if(t>=e)return this.ChartBorder.GetRight();var a=this.ChartBorder.GetLeft()+this.ChartBorder.GetWidth()*t/e;return a},this.GetXData=function(t){return t<=this.ChartBorder.GetLeft()?0:t>=this.ChartBorder.GetRight()?this.XPointCount:(t-this.ChartBorder.GetLeft())*(1*this.XPointCount/this.ChartBorder.GetWidth())},this.DrawCustomHorizontal=function(){for(var t in this.CustomHorizontalInfo){var e=this.CustomHorizontalInfo[t];switch(e.Type){case 0:case 1:this.DrawCustomItem(e);break}}}}function y(){this.newMethod=B,this.newMethod(),delete this.newMethod,this.ClassName="MinuteHScreenFrame",this.IsHScreen=!0,this.DrawTitleBG=function(){},this.DrawInsideHorizontal=function(){},this.GetYData=function(t){return t<this.ChartBorder.GetLeftEx()?this.HorizontalMin:t>this.ChartBorder.GetRightEx()?this.HorizontalMax:(t-this.ChartBorder.GetLeftEx())/this.ChartBorder.GetWidthEx()*(this.HorizontalMax-this.HorizontalMin)+this.HorizontalMin},this.GetXData=function(t){if(t<=this.ChartBorder.GetTop())return 0;if(t>=this.ChartBorder.GetBottom())return this.XPointCount;var e=this.XPointCount-1;return(t-this.ChartBorder.GetTop())*(1*e/this.ChartBorder.GetHeight())},this.GetXFromIndex=function(t){var e=this.XPointCount-1;if(1==e)return 0==t?this.ChartBorder.GetTop():this.ChartBorder.GetBottom();if(e<=0)return this.ChartBorder.GetTop();if(t>=e)return this.ChartBorder.GetBottom();var a=this.ChartBorder.GetTop()+this.ChartBorder.GetHeight()*t/e;return a},this.GetYFromData=function(t){if(t<=this.HorizontalMin)return this.ChartBorder.GetLeft();if(t>=this.HorizontalMax)return this.ChartBorder.GetRightEx();var e=this.ChartBorder.GetWidthEx()*(t-this.HorizontalMin)/(this.HorizontalMax-this.HorizontalMin);return this.ChartBorder.GetLeft()+e},this.DrawHorizontal=function(){for(var t=this.ChartBorder.GetTop(),e=this.ChartBorder.GetBottom(),a=this.ChartBorder.GetLeft(),i=this.ChartBorder.GetRight(),r=this.ChartBorder.Top,n=this.ChartBorder.Bottom,s=null,o=this.HorizontalInfo.length-1;o>=0;--o){var h=this.HorizontalInfo[o],l=this.GetYFromData(h.Value);if(!(null!=l&&Math.abs(l-s)<this.MinYDistance)){if(this.Canvas.strokeStyle=h.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(E(l),t),this.Canvas.lineTo(E(l),e),this.Canvas.stroke(),l>=i-2)this.Canvas.textBaseline="top",l=i;else if(l<=a+2){if(this.Canvas.textBaseline="bottom",l=a,null!=l&&Math.abs(l-s)<2*this.MinYDistance)continue}else this.Canvas.textBaseline="middle";if(null!=h.Message[0]&&r>10){null!=h.Font&&(this.Canvas.font=h.Font),this.Canvas.fillStyle=h.TextColor,this.Canvas.textAlign="right";var u=l,C=t;this.Canvas.save(),this.Canvas.translate(u,C),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(h.Message[0],-2,0),this.Canvas.restore()}if(null!=h.Message[1]&&n>10){null!=h.Font&&(this.Canvas.font=h.Font),this.Canvas.fillStyle=h.TextColor,this.Canvas.textAlign="left";u=l,C=e;this.Canvas.save(),this.Canvas.translate(u,C),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(h.Message[1],2,0),this.Canvas.restore()}s=l}}},this.DrawVertical=function(){var t=this.ChartBorder.GetLeft(),e=this.ChartBorder.GetRightEx(),a=this.ChartBorder.GetBottom(),i=null;for(var r in this.VerticalInfo){var n=this.GetXFromIndex(this.VerticalInfo[r].Value);if(n>a)break;if(!(null!=i&&Math.abs(n-i)<this.MinXDistance)){if(this.Canvas.strokeStyle=this.VerticalInfo[r].LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(t,E(n)),this.Canvas.lineTo(e,E(n)),this.Canvas.stroke(),null!=this.VerticalInfo[r].Message[0]){null!=this.VerticalInfo[r].Font&&(this.Canvas.font=this.VerticalInfo[r].Font),this.Canvas.fillStyle=this.VerticalInfo[r].TextColor;var s=this.Canvas.measureText(this.VerticalInfo[r].Message[0]).width;n<s/2?(this.Canvas.textAlign="left",this.Canvas.textBaseline="top"):n+s/2>=this.ChartBorder.GetChartHeight()?(this.Canvas.textAlign="right",this.Canvas.textBaseline="top"):(this.Canvas.textAlign="center",this.Canvas.textBaseline="top");var o=t,h=n;this.Canvas.save(),this.Canvas.translate(o,h),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(this.VerticalInfo[r].Message[0],0,0),this.Canvas.restore()}i=n}}}}function P(){this.newMethod=O,this.newMethod(),delete this.newMethod,this.ClassName="KLineFrame",this.ToolbarID=M(),this.ModifyIndex=!0,this.ChangeIndex=!0,this.CustomHorizontalInfo=[],this.LastCalculateStatus={Width:0,XPointCount:0},this.CustomVerticalInfo=[],this.DrawCustomVerticalEvent,this.RightSpaceCount=0,this.DrawFrame=function(){this.SplitXYCoordinate(),1==this.SizeChange&&this.CalculateDataWidth(),this.DrawOtherChart&&this.DrawOtherChart(),this.DrawTitleBG(),this.DrawHorizontal(),this.DrawVertical()},this.GetXFromIndex=function(t){t<0&&(t=0),t>this.xPointCount-1&&(t=this.xPointCount-1);for(var e=this.ChartBorder.GetLeft()+c.JSCommonResource_Global_JSChartResource.FrameLeftMargin+this.DistanceWidth/2+this.DataWidth/2,a=1;a<=t;++a)e+=this.DistanceWidth+this.DataWidth;return e},this.GetXData=function(t){if(t<=this.ChartBorder.GetLeft())return 0;if(t>=this.ChartBorder.GetRight())return this.XPointCount-1;var e=this.ChartBorder.GetLeft()+c.JSCommonResource_Global_JSChartResource.FrameLeftMargin,a=this.ChartBorder.GetRight()-c.JSCommonResource_Global_JSChartResource.FrameRightMargin,i=this.DistanceWidth,r=this.DataWidth,n=0,s=e+i/2+r+i;while(s<a&&n<1e4&&n+1<this.XPointCount){if(s>t)break;s+=r+i,++n}return n},this.DrawCustomHorizontal=function(){for(var t in this.CustomHorizontalInfo){var e=this.CustomHorizontalInfo[t];switch(e.Type){case 0:case 1:this.DrawCustomItem(e);break}}},this.DrawCustomVerticalItem=function(t){this.Canvas.save(),1==t.Data.Line.Type&&this.Canvas.setLineDash([5,5]),this.Canvas.strokeStyle=t.Data.Line.Color,this.Canvas.beginPath(),t.IsHScreen?(this.Canvas.moveTo(t.Top,E(t.X)),this.Canvas.lineTo(t.Bottom,E(t.X))):(this.Canvas.moveTo(E(t.X),t.Top),this.Canvas.lineTo(E(t.X),t.Bottom)),this.Canvas.stroke(),this.Canvas.restore()},this.DrawCustomVertical=function(){if(this.CustomVerticalInfo&&!(this.CustomVerticalInfo.length<=0)&&this.Data){var t=this.IsHScreen,e=this.ChartBorder.GetTopEx(),a=this.ChartBorder.GetBottomEx(),i=this.DataWidth,r=this.DistanceWidth,n=this.ChartBorder.GetLeft()+r/2+2;t&&(n=this.ChartBorder.GetTop()+r/2+2,e=this.ChartBorder.GetLeftEx(),a=this.ChartBorder.GetRightEx());for(var s=0,o=this.Data.DataOffset;o<this.Data.Data.length&&s<this.XPointCount;++o,++s,n+=i+r){var h=this.Data.Data[o];for(var l in this.CustomVerticalInfo){var u=this.CustomVerticalInfo[l];if(0==u.Type){if(d.JSCommonSplit_IFrameSplitOperator.IsNumber(u.Time)){if(h.Date!=u.Date||h.Time!=u.Time)continue}else if(h.Date!=u.Date)continue;var C=n,D=n+i,m=C+(D-C)/2,S={X:m,Top:e,Bottom:a,Data:u,IsHScreen:t};this.DrawCustomVerticalItem(S),this.DrawCustomVerticalEvent&&this.DrawCustomVerticalEvent.Callback(this.DrawCustomVerticalEvent,S,this);break}}}for(o=1;s<this.XPointCount;++o,++s,n+=i+r)for(var l in this.CustomVerticalInfo){u=this.CustomVerticalInfo[l];if(1==u.Type&&u.Space==o){C=n,D=n+i,m=C+(D-C)/2,S={X:m,Top:e,Bottom:a,Data:u,IsHScreen:t};this.DrawCustomVerticalItem(S),this.DrawCustomVerticalEvent&&this.DrawCustomVerticalEvent.Callback(this.DrawCustomVerticalEvent,S,this);break}}}},this.CalculateDataWidth=function(){if(!(this.XPointCount<2)){var t=this.GetFrameWidth()-c.JSCommonResource_Global_JSChartResource.FrameMargin;if(this.ZoomIndex>=0&&this.LastCalculateStatus.Width==t&&this.LastCalculateStatus.XPointCount==this.XPointCount){var e=this.DistanceWidth/2+c.JSCommonResource_Global_JSChartResource.FrameLeftMargin+(this.DataWidth+this.DistanceWidth)*(this.XPointCount-1);this.DataWidth,this.DistanceWidth,this.XPointCount;if(e<=t)return}this.LastCalculateStatus.Width=t,this.LastCalculateStatus.XPointCount=this.XPointCount;for(var a=0;a<U.length;++a){U[a][0],U[a][1];if((U[a][0]+U[a][1])*this.XPointCount<t)return this.ZoomIndex=a,this.DataWidth=U[a][0],this.DistanceWidth=U[a][1],this.TrimKLineDataWidth(t),void n.JSConsole.Chart.Log("[KLineFrame::CalculateDataWidth] ZoomIndex=".concat(this.ZoomIndex," DataWidth=").concat(this.DataWidth," DistanceWidth=").concat(this.DistanceWidth))}this.ZoomIndex=U.length-1,this.DataWidth=t/this.XPointCount,this.DistanceWidth=0}},this.OnSize=function(t){for(var e=this.GetFrameWidth()-c.JSCommonResource_Global_JSChartResource.FrameMargin,a=0,i=this.DistanceWidth/2+c.JSCommonResource_Global_JSChartResource.FrameLeftMargin+(this.DataWidth+this.DistanceWidth);i<e;i+=this.DataWidth+this.DistanceWidth,++a);return t.CurCount=this.XPointCount,t.CalcCount=a,t.DataWidth=this.DataWidth,t.DistanceWidth=this.DistanceWidth,t.Changed=!1,this.LastCalculateStatus.Width=e,t.CurCount==t.CalcCount||(this.XPointCount=a,this.LastCalculateStatus.XPointCount=this.XPointCount,this.Data&&(this.Data.DataOffset+=t.CurCount-t.CalcCount,this.Data.DataOffset<0&&(this.Data.DataOffset=0),t.Changed=!0)),t},this.SetDataWidth=function(t){var e=U.length-1;for(var a in U){var i=U[a];if(i[0]<=t){e=parseInt(a)-1;break}}this.ZoomIndex=e,this.DataWidth=U[this.ZoomIndex][0],this.DistanceWidth=U[this.ZoomIndex][1];for(var r=this.GetFrameWidth()-c.JSCommonResource_Global_JSChartResource.FrameMargin,n=0,s=this.DistanceWidth/2+c.JSCommonResource_Global_JSChartResource.FrameLeftMargin+(this.DataWidth+this.DistanceWidth);s<=r;s+=this.DataWidth+this.DistanceWidth,++n);this.XPointCount=n,this.LastCalculateStatus.XPointCount=this.XPointCount,this.LastCalculateStatus.Width=r;var o={XPointCount:this.XPointCount,DataWidth:this.DataWidth,DistanceWidth:this.DistanceWidth};return o},this.TrimKLineDataWidth=function(t){var e=U[this.ZoomIndex],a=U[this.ZoomIndex][0],i=U[this.ZoomIndex][1];if(1!=a||0!=i)if(e[0]<4)while(1){if((this.DistanceWidth+this.DataWidth)*this.XPointCount+this.DistanceWidth>t){this.DistanceWidth-=.01;break}this.DistanceWidth+=.01}else while(1){if((this.DistanceWidth+this.DataWidth)*this.XPointCount+this.DistanceWidth>t){this.DataWidth-=.01;break}this.DataWidth+=.01}else this.DataWidth=t/this.XPointCount},this.IsOverlayMaxMin=function(t){if(!this.ChartKLine)return!1;if(!this.ChartKLine.Max||!this.ChartKLine.Min)return!1;var e=this.Canvas.measureText(t.Text.Value).width+4,a=this.ChartKLine.Max,i=this.ChartKLine.Min,r=!1,n=!1,s=20;if(a.X>=t.X&&a.X<=t.X+e){var o=a.Y+s,h=a.Y-s;(o>=t.Y-s&&o<=t.Y+s||h>=t.Y-s&&h<=t.Y+s)&&(r=!0)}if(1==r)return!0;if(i.X>=t.X&&i.X<=t.X+e){o=i.Y+s,h=i.Y-s;(o>=t.Y-s&&o<=t.Y+s||h>=t.Y-s&&h<=t.Y+s)&&(n=!0)}return r||n},this.SplitXYCoordinate=function(){0!=this.XYSplit&&(null!=this.YSplitOperator&&this.YSplitOperator.Operator(),null!=this.XSplitOperator&&this.XSplitOperator.Operator())},this.CalculateCount=function(t){var e=this.GetFrameWidth()-c.JSCommonResource_Global_JSChartResource.FrameMargin;return parseInt(e/(U[t][0]+U[t][1]))},this.ZoomUp=function(t){if(this.ZoomIndex<=0)return!1;if(this.Data.DataOffset<0)return!1;var e=this.Data.Data.length,a=e+this.RightSpaceCount,i=0,r=this.Data.DataOffset+this.XPointCount-1,n=this.Data.DataOffset+t.Index;r>=e&&(i=r-(this.Data.Data.length-1),r=this.Data.Data.length-1,i>this.RightSpaceCount&&(i=this.RightSpaceCount));var s=this.CalculateCount(this.ZoomIndex-1);--this.ZoomIndex,this.XPointCount=s,s>=a?(s=a,this.XPointCount=s,this.Data.DataOffset=0):(this.XPointCount=s,this.Data.DataOffset=r-(this.XPointCount-i)+1),this.DataWidth=U[this.ZoomIndex][0],this.DistanceWidth=U[this.ZoomIndex][1];var o=this.GetFrameWidth()-c.JSCommonResource_Global_JSChartResource.FrameMargin;return this.TrimKLineDataWidth(o),this.LastCalculateStatus.XPointCount=this.XPointCount,t.Index=n-this.Data.DataOffset,!0},this.ZoomDown=function(t){if(this.ZoomIndex+1>=U.length)return!1;if(this.Data.DataOffset<0)return!1;var e=this.Data.Data.length,a=e+this.RightSpaceCount;if(this.XPointCount>=e)return!1;var i=0,r=this.Data.DataOffset+this.XPointCount-1;r>=this.Data.Data.length&&(i=r-(this.Data.Data.length-1),r=this.Data.Data.length-1,i>this.RightSpaceCount&&(i=this.RightSpaceCount));var n=this.CalculateCount(this.ZoomIndex+1),s=this.Data.DataOffset+t.Index;++this.ZoomIndex,n>=a?(n=a,this.XPointCount=n,this.Data.DataOffset=0):(this.XPointCount=n,this.Data.DataOffset=r-(this.XPointCount-i)+1),this.DataWidth=U[this.ZoomIndex][0],this.DistanceWidth=U[this.ZoomIndex][1];var o=this.GetFrameWidth()-c.JSCommonResource_Global_JSChartResource.FrameMargin;return this.TrimKLineDataWidth(o),this.LastCalculateStatus.XPointCount=this.XPointCount,t.Index=s-this.Data.DataOffset,!0},this.GetFrameWidth=function(){return this.IsHScreen?this.ChartBorder.GetHeight():this.ChartBorder.GetWidth()}}function w(){this.newMethod=P,this.newMethod(),delete this.newMethod,this.ClassName="KLineHScreenFrame",this.IsHScreen=!0,this.DrawInsideHorizontal=function(){if(!1!==this.IsShowYText[0]||!1!==this.IsShowYText[1]){var t=this.ChartBorder.GetLeft(),e=this.ChartBorder.GetRightEx(),a=this.ChartBorder.GetTop(),i=this.ChartBorder.GetBottom(),r=this.ChartBorder.Top,n=this.ChartBorder.Bottom,s=(this.ChartBorder.TitleHeight,1),o=(r<10*s||2==this.YTextPosition[0])&&!0===this.IsShowYText[0],h=(n<10*s||2==this.YTextPosition[1])&&!0===this.IsShowYText[1];if(o||h)for(var l=null,u=this.HorizontalInfo.length-1;u>=0;--u){var C=this.HorizontalInfo[u],D=this.GetYFromData(C.Value);if(!(null!=D&&null!=l&&Math.abs(D-l)<this.MinYDistance)){if(null!=C.Message[0]&&o){null!=C.Font&&(this.Canvas.font=C.Font),this.Canvas.fillStyle=C.TextColor,this.Canvas.textAlign="left",this.Canvas.textBaseline=D>=e-2?"top":D<=t+2?"bottom":"middle";this.Canvas.textBaseline,this.Canvas.textAlign,this.Canvas.font,C.Message[0];var m=D,S=a;this.Canvas.save(),this.Canvas.translate(m,S),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(C.Message[0],-2,0),this.Canvas.restore()}if(null!=C.Message[1]&&h){null!=C.Font&&(this.Canvas.font=C.Font),this.Canvas.fillStyle=C.TextColor,this.Canvas.textAlign="right",this.Canvas.textBaseline=D>=e-2?"top":D<=t+2?"bottom":"middle";var c=this.Canvas.measureText(C.Message[1]).width;this.Canvas.textBaseline,this.Canvas.textAlign,this.Canvas.font,C.Message[1],m=D,S=i;this.Canvas.save(),this.Canvas.translate(m,S),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(C.Message[1],2,0),this.Canvas.restore()}l=D}}}},this.DrawTitleBG=function(){},this.GetYFromData=function(t){if(t<=this.HorizontalMin)return this.ChartBorder.GetLeftEx();if(t>=this.HorizontalMax)return this.ChartBorder.GetRightEx();var e=this.ChartBorder.GetWidthEx()*(t-this.HorizontalMin)/(this.HorizontalMax-this.HorizontalMin);return this.ChartBorder.GetLeftEx()+e},this.DrawHorizontal=function(){for(var t=this.ChartBorder.GetTop(),e=this.ChartBorder.GetBottom(),a=this.ChartBorder.Top,i=this.ChartBorder.Bottom,r=this.ChartBorder.GetLeft(),n=null,s=this.HorizontalInfo.length-1;s>=0;--s){var o=this.HorizontalInfo[s],h=this.GetYFromData(o.Value);if(!(null!=h&&Math.abs(h-n)<15)){if(h!=r&&(2==o.LineType?(this.Canvas.strokeStyle=o.LineColor,this.Canvas.setLineDash([5,5]),this.Canvas.beginPath(),this.Canvas.moveTo(E(h),t),this.Canvas.lineTo(E(h),e),this.Canvas.stroke(),this.Canvas.setLineDash([])):o.LineType>0&&(this.Canvas.strokeStyle=o.LineColor,c.JSCommonResource_Global_JSChartResource.FrameYLineDash?(this.Canvas.setLineDash(c.JSCommonResource_Global_JSChartResource.FrameYLineDash),this.Canvas.beginPath(),this.Canvas.moveTo(E(h),t),this.Canvas.lineTo(E(h),e),this.Canvas.stroke(),this.Canvas.setLineDash([])):(this.Canvas.beginPath(),this.Canvas.moveTo(E(h),t),this.Canvas.lineTo(E(h),e),this.Canvas.stroke()))),null!=o.Message[0]&&a>10){null!=o.Font&&(this.Canvas.font=o.Font),this.Canvas.fillStyle=o.TextColor,this.Canvas.textAlign="right",this.Canvas.textBaseline="middle";var l=h,u=t;this.Canvas.save(),this.Canvas.translate(l,u),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(o.Message[0],-2,0),this.Canvas.restore()}if(null!=o.Message[1]&&i>10){null!=o.Font&&(this.Canvas.font=o.Font),this.Canvas.fillStyle=o.TextColor,this.Canvas.textAlign="left",this.Canvas.textBaseline="middle";l=h,u=e;this.Canvas.save(),this.Canvas.translate(l,u),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(o.Message[1],2,0),this.Canvas.restore()}n=h}}},this.GetXFromIndex=function(t){t<0&&(t=0),t>this.xPointCount-1&&(t=this.xPointCount-1);for(var e=this.ChartBorder.GetTop()+c.JSCommonResource_Global_JSChartResource.FrameLeftMargin+this.DistanceWidth/2+this.DataWidth/2,a=1;a<=t;++a)e+=this.DistanceWidth+this.DataWidth;return e},this.DrawVertical=function(){var t=this.ChartBorder.GetLeft(),e=this.ChartBorder.GetRightTitle(),a=this.ChartBorder.GetBottom(),i=null;for(var r in this.VerticalInfo){var n=this.GetXFromIndex(this.VerticalInfo[r].Value);if(n>=a)break;if(!(null!=i&&Math.abs(n-i)<80)){var s=this.VerticalInfo[r];if(2==s.LineType?(this.Canvas.setLineDash([5,5]),this.Canvas.beginPath(),this.Canvas.moveTo(t,E(n)),this.Canvas.lineTo(e,E(n)),this.Canvas.stroke(),this.Canvas.setLineDash([])):s.LineType>0&&(this.Canvas.strokeStyle=s.LineColor,c.JSCommonResource_Global_JSChartResource.FrameXLineDash?(this.Canvas.setLineDash(c.JSCommonResource_Global_JSChartResource.FrameXLineDash),this.Canvas.beginPath(),this.Canvas.moveTo(t,E(n)),this.Canvas.lineTo(e,E(n)),this.Canvas.stroke(),this.Canvas.setLineDash([])):(this.Canvas.beginPath(),this.Canvas.moveTo(t,E(n)),this.Canvas.lineTo(e,E(n)),this.Canvas.stroke())),null!=this.VerticalInfo[r].Message[0]){null!=this.VerticalInfo[r].Font&&(this.Canvas.font=this.VerticalInfo[r].Font),this.Canvas.fillStyle=this.VerticalInfo[r].TextColor;var o=this.Canvas.measureText(this.VerticalInfo[r].Message[0]).width;n<o/2?(this.Canvas.textAlign="left",this.Canvas.textBaseline="top"):(this.Canvas.textAlign="center",this.Canvas.textBaseline="top");var h=t,l=n;this.Canvas.save(),this.Canvas.translate(h,l),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(this.VerticalInfo[r].Message[0],0,this.XBottomOffset),this.Canvas.restore()}i=n}}},this.GetYData=function(t){return t<this.ChartBorder.GetLeftEx()?this.HorizontalMin:t>this.ChartBorder.GetRightEx()?this.HorizontalMax:(t-this.ChartBorder.GetLeftEx())/this.ChartBorder.GetWidthEx()*(this.HorizontalMax-this.HorizontalMin)+this.HorizontalMin},this.GetXData=function(t){if(t<=this.ChartBorder.GetTop())return 0;if(t>=this.ChartBorder.GetBottom())return this.XPointCount-1;var e=this.DistanceWidth,a=this.DataWidth,i=this.ChartBorder.GetTop()+c.JSCommonResource_Global_JSChartResource.FrameLeftMargin,r=this.ChartBorder.GetBottom()-c.JSCommonResource_Global_JSChartResource.FrameRightMargin,n=0,s=i+e/2+a+e;while(s<r&&n<1e4&&n+1<this.XPointCount){if(s>=t)break;s+=a+e,++n}return n}}function b(){this.Frame,this.Height}function G(){this.ClassName="HQTradeFrame",this.SubFrame=new Array,this.SizeChange=!0,this.ChartBorder,this.Canvas,this.ScreenImagePath,this.ScreenImageData=null,this.Data,this.Position,this.SizeChange=!0,this.SnapshotID=0,this.CurrentSnapshotID=0,this.SnapshotStatus=0,this.CalculateChartBorder=function(){if(!(this.SubFrame.length<=0)){var t=this.ChartBorder.GetTop(),e=this.ChartBorder.GetHeight(),a=0;for(var i in this.SubFrame){var r=this.SubFrame[i];a+=r.Height}for(var i in this.SubFrame){r=this.SubFrame[i];r.Frame.ChartBorder.Top=t,r.Frame.ChartBorder.Left=this.ChartBorder.Left,r.Frame.ChartBorder.Right=this.ChartBorder.Right;var n=e*(r.Height/a)+t;r.Frame.ChartBorder.Bottom=this.ChartBorder.GetChartHeight()-n,t=n}}},this.Draw=function(){for(var t in!0===this.SizeChange&&this.CalculateChartBorder(),this.SubFrame){var e=this.SubFrame[t];e.Height<=0||e.Frame.Draw()}this.SizeChange=!1},this.DrawLock=function(){for(var t in this.SubFrame){var e=this.SubFrame[t];e.Frame.DrawLock()}},this.DrawInsideHorizontal=function(){for(var t in this.SubFrame){var e=this.SubFrame[t];e.Frame.DrawInsideHorizontal()}},this.DrawCustomHorizontal=function(){for(var t in this.SubFrame){var e=this.SubFrame[t];e.Frame.DrawCustomHorizontal&&e.Frame.DrawCustomHorizontal()}},this.DrawCustomVertical=function(t){for(var e in this.SubFrame){var a=this.SubFrame[e];a.Frame.DrawCustomVerticalEvent=t,a.Frame.DrawCustomVertical&&a.Frame.DrawCustomVertical()}},this.SetSizeChage=function(t){for(var e in this.SizeChange=t,this.SubFrame){var a=this.SubFrame[e];a.Frame.SizeChange=t}this.Position={X:this.ChartBorder.UIElement.offsetLeft,Y:this.ChartBorder.UIElement.offsetTop,W:this.ChartBorder.UIElement.clientWidth,H:this.ChartBorder.UIElement.clientHeight}},this.SetDrawOtherChart=function(t){for(var e in this.SubFrame){var a=this.SubFrame[e];a.Frame.DrawOtherChart=t}},this.Snapshot=function(t){1==t?this.SnapshotImageData():this.SnapshotImagePath()},this.SnapshotImagePath=function(){var t=this,e=this.ChartBorder.GetChartWidth(),a=this.ChartBorder.GetChartHeight();++this.SnapshotID;var i=this.SnapshotID;this.SnapshotStatus=1,this.Canvas&&this.Canvas.DomNode?wx.canvasToTempFilePath({x:0,y:0,width:e,height:a,canvas:this.Canvas.DomNode,success:function(e){t.ScreenImagePath=e.tempFilePath,t.SnapshotStatus=0,t.CurrentSnapshotID=i,n.JSConsole.Chart.Log("[HQTradeFrame::SnapshotImagePath] SnapshotID(".concat(t.SnapshotID,", ").concat(t.CurrentSnapshotID,"), Path=").concat(e.tempFilePath))}}):wx.canvasToTempFilePath({x:0,y:0,width:e,height:a,canvasId:this.ChartBorder.UIElement.ID,success:function(e){t.ScreenImagePath=e.tempFilePath,t.SnapshotStatus=0,t.CurrentSnapshotID=i}})},this.SnapshotImageData=function(){var t=this,e=this.ChartBorder.GetChartWidth(),a=this.ChartBorder.GetChartHeight();n.JSConsole.Chart.Log("[HQTradeFrame::SnapshotImageData][ID=".concat(this.ChartBorder.UIElement.ID," invoke canvasGetImageData(").concat(e,", ").concat(a,") SnapshotStatus=").concat(this.SnapshotStatus)),++this.SnapshotID;var i=this.SnapshotID;this.SnapshotStatus=1,wx.canvasGetImageData({canvasId:this.ChartBorder.UIElement.ID,x:0,y:0,width:e,height:a,success:function(e){t.ScreenImageData=e.data,t.SnapshotStatus=0,t.CurrentSnapshotID=i,n.JSConsole.Chart.Log("[HQTradeFrame::SnapshotImageData] SnapshotID=".concat(t.SnapshotID,", CurrentSnapshotID=").concat(t.CurrentSnapshotID,", size=").concat(e.data.length))}})},this.GetXData=function(t){return this.SubFrame[0].Frame.GetXData(t)},this.GetYData=function(t,e){var a;for(var i in this.SubFrame){var r=this.SubFrame[i],n=r.Frame.ChartBorder.GetLeft(),o=r.Frame.ChartBorder.GetTopEx(),h=r.Frame.ChartBorder.GetWidth(),l=r.Frame.ChartBorder.GetHeightEx(),u=new s.JSCommon_Rect(n,o,h,l);if(u.IsPointIn(n,t)){a=r.Frame,e&&(e.FrameID=i);break}}if(null!=a){var C=a.GetYData(t);if(1==a.YSplitOperator.CoordinateType){var D=a.YSplitOperator.GetFirstOpenPrice();e.RightYValue=((C-D)/D*100).toFixed(2)+"%"}return C}},this.GetXFromIndex=function(t){return this.SubFrame[0].Frame.GetXFromIndex(t)},this.GetYFromData=function(t){return this.SubFrame[0].Frame.GetYFromData(t)},this.ZoomUp=function(t){var e=this.SubFrame[0].Frame.ZoomUp(t);return this.UpdateAllFrame(),e},this.ZoomDown=function(t){var e=this.SubFrame[0].Frame.ZoomDown(t);return this.UpdateAllFrame(),e},this.SetDataWidth=function(t){var e=this.SubFrame[0].Frame.SetDataWidth(t);return this.UpdateAllFrame(),e},this.OnSize=function(){var t={};return this.SubFrame[0].Frame.OnSize(t),this.UpdateAllFrame(),t},this.UpdateAllFrame=function(){for(var t=this.SubFrame[0].Frame,e=1;e<this.SubFrame.length;++e){var a=this.SubFrame[e];a.Frame.XPointCount=t.XPointCount,a.Frame.ZoomIndex=t.ZoomIndex,a.Frame.DataWidth=t.DataWidth,a.Frame.DistanceWidth=t.DistanceWidth,a.Frame.LastCalculateStatus.Width=t.LastCalculateStatus.Width,a.Frame.LastCalculateStatus.XPointCount=t.LastCalculateStatus.XPointCount}},this.ResetXYSplit=function(){for(var t in this.SubFrame)this.SubFrame[t].Frame.XYSplit=!0},this.GetCurrentPageSize=function(){if(this.SubFrame.length<=0)return null;var t=this.SubFrame[0];return t&&t.Frame?t.Frame.XPointCount:null}}function V(){this.newMethod=G,this.newMethod(),delete this.newMethod,this.ClassName="HQTradeHScreenFrame",this.IsHScreen=!0,this.CalculateChartBorder=function(){if(!(this.SubFrame.length<=0)){var t=this.ChartBorder.Right,e=this.ChartBorder.GetRight(),a=this.ChartBorder.GetWidth(),i=0;for(var r in this.SubFrame){var n=this.SubFrame[r];i+=n.Height}for(var r in this.SubFrame){n=this.SubFrame[r];n.Frame.ChartBorder.Top=this.ChartBorder.Top,n.Frame.ChartBorder.Bottom=this.ChartBorder.Bottom;var s=a*(n.Height/i);n.Frame.ChartBorder.Right=t,n.Frame.ChartBorder.Left=e-s,t+=s,e-=s}}},this.GetYData=function(t,e){var a;for(var i in this.SubFrame){var r=this.SubFrame[i],n=r.Frame.ChartBorder.GetLeftEx(),o=r.Frame.ChartBorder.GetTop(),h=r.Frame.ChartBorder.GetWidthEx(),l=r.Frame.ChartBorder.GetHeight(),u=new s.JSCommon_Rect(n,o,h,l);if(u.IsPointIn(t,o)){a=r.Frame,e&&(e.FrameID=i);break}}if(null!=a)return a.GetYData(t)}}function _(){this.newMethod=O,this.newMethod(),delete this.newMethod,this.ScreenImageData,this.Position,this.ClassName="DepthChartFrame",this.VerticalRange={Max:null,Min:null,Center:null,MaxDiffer:null,Differ:null,Step:.05},this.AskPrice,this.BidPrice,this.MinZoom=.05,this.SetPriceList=function(t,e){this.AskPrice=t,this.BidPrice=e},this.SetDrawOtherChart=function(t){},this.DrawFrame=function(){this.SplitXYCoordinate(),this.DrawHorizontal(),this.DrawVertical()},this.GetXFromIndex=function(t){var e=this.ChartBorder.GetLeft(),a=(this.ChartBorder.GetRight(),this.ChartBorder.GetWidth()),i=a*(t-this.VerticalRange.Min)/(this.VerticalRange.Max-this.VerticalRange.Min);return e+i},this.GetXData=function(t){var e=this.ChartBorder.GetLeft(),a=(this.ChartBorder.GetRight(),this.ChartBorder.GetWidth());return(t-e)/a*(this.VerticalRange.Max-this.VerticalRange.Min)+this.VerticalRange.Min},this.GetXFromPrice=function(t){var e=!1,a=this.GetPrice(this.BidPrice,t);if(null==a&&(a=this.GetPrice(this.AskPrice,t),e=!0),null==a&&this.BidPrice&&Array.isArray(this.BidPrice)&&this.BidPrice.length>0){var i=this.BidPrice[0];t<i&&(e=!1,a=i)}if(null==a&&this.AskPrice&&Array.isArray(this.AskPrice)&&this.AskPrice.length>0){var r=this.AskPrice[this.AskPrice.length-1];t>r&&(e=!0,a=r)}if(null==a)return null;var n=this.GetXFromIndex(a);return{X:n,Price:a,IsAsk:e}},this.GetPrice=function(t,e){if(!t||!Array.isArray(t)||t.length<=0)return null;if(e<t[0]||e>t[t.length-1])return null;var a=null;for(var i in t){var r=t[i];if(e==r)return r;if(e<r)return a;a=r}},this.SplitXYCoordinate=function(){0!=this.XYSplit&&(null!=this.YSplitOperator&&this.YSplitOperator.Operator(),null!=this.XSplitOperator&&this.XSplitOperator.Operator())},this.Snapshot=function(){this.ScreenImageData=this.Canvas.getImageData(0,0,this.ChartBorder.GetChartWidth(),this.ChartBorder.GetChartHeight())},this.SetSizeChage=function(t){this.SizeChange=t,this.Position={X:this.ChartBorder.UIElement.offsetLeft,Y:this.ChartBorder.UIElement.offsetTop,W:this.ChartBorder.UIElement.clientWidth,H:this.ChartBorder.UIElement.clientHeight}},this.ZoomUp=function(){var t=this.VerticalRange,e=t.Differ,a=t.MaxDiffer*this.MinZoom;if(e<a)return!1;var i=t.Differ*t.Step;return e-=i,t.Differ=e,t.Min=t.Center-t.Differ,t.Max=t.Center+t.Differ,!0},this.ZoomDown=function(){var t=this.VerticalRange,e=t.Differ;if(e==t.MaxDiffer)return!1;var a=t.Differ*t.Step;return e+=a,e>t.MaxDiffer&&(e=t.MaxDiffer),t.Differ=e,t.Min=t.Center-t.Differ,t.Max=t.Center+t.Differ,!0}}function H(){this.newMethod=O,this.newMethod(),delete this.newMethod,this.ScreenImageData,this.Position,this.IsShowBorder=!1,this.IsShowVertical=!1,this.XFontType=0,this.MaxDistanceWidth=4,this.BarCount=0,this.Draw=function(){this.DrawFrame(),this.IsShowBorder&&this.DrawBorder(),this.SizeChange=!1,this.XYSplit=!1},this.DrawFrame=function(){if(this.XPointCount>0){var t=this.ChartBorder.GetWidth()/(10*this.XPointCount);this.DistanceWidth=4*t,this.DataWidth=6*t,this.DistanceWidth>this.MaxDistanceWidth&&(this.DistanceWidth=this.MaxDistanceWidth,t=this.ChartBorder.GetWidth()/this.XPointCount,this.DataWidth=t-this.MaxDistanceWidth)}this.SplitXYCoordinate(),this.DrawHorizontal(),this.DrawVertical()},this.GetXFromIndex=function(t){t<0&&(t=0),t>this.xPointCount-1&&(t=this.xPointCount-1);for(var e=this.ChartBorder.GetLeft()+2+this.DistanceWidth/2+this.DataWidth/2,a=1;a<=t;++a)e+=this.DistanceWidth+this.DataWidth;return e},this.SplitXYCoordinate=function(){0!=this.XYSplit&&(null!=this.YSplitOperator&&this.YSplitOperator.Operator(),null!=this.XSplitOperator&&this.XSplitOperator.Operator())},this.DrawVertical=function(){var t=this.ChartBorder.GetTopEx(),e=this.ChartBorder.GetBottom(),a=this.ChartBorder.GetRight(),i=null;for(var r in this.VerticalInfo){var n=this.GetXFromIndex(this.VerticalInfo[r].Value);if(n>=a)break;if(1==this.XFontType){if(null!=i&&Math.abs(n-i)<20)continue}else if(null!=i&&Math.abs(n-i)<60)continue;if(this.IsShowVertical&&(this.Canvas.strokeStyle=this.VerticalInfo[r].LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(E(n),t),this.Canvas.lineTo(E(n),e),this.Canvas.stroke()),null!=this.VerticalInfo[r].Message[0]){null!=this.VerticalInfo[r].Font&&(this.Canvas.font=this.VerticalInfo[r].Font),this.Canvas.fillStyle=this.VerticalInfo[r].TextColor;var s=this.Canvas.measureText(this.VerticalInfo[r].Message[0]).width;n<s/2?(this.Canvas.textAlign="left",this.Canvas.textBaseline="top"):(this.Canvas.textAlign="center",this.Canvas.textBaseline="top"),1==this.XFontType?(this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.save(),this.Canvas.translate(n,e),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(this.VerticalInfo[r].Message[0],2,0),this.Canvas.restore()):this.Canvas.fillText(this.VerticalInfo[r].Message[0],n,e)}i=n}},this.Snapshot=function(){var t=this,e=this.ChartBorder.GetChartWidth(),a=this.ChartBorder.GetChartHeight();n.JSConsole.Chart.Log("[SimpleChartFrame::Snapshot][ID="+this.ChartBorder.UIElement.ID+"] invoke canvasToTempFilePath(width="+e+",height="+a+")"),wx.canvasToTempFilePath({x:0,y:0,width:e,height:a,canvasId:this.ChartBorder.UIElement.ID,success:function(e){t.ScreenImagePath=e.tempFilePath,n.JSConsole.Chart.Log(e.tempFilePath)}})},this.SetSizeChage=function(t){this.SizeChange=t,this.Position={X:this.ChartBorder.UIElement.offsetLeft,Y:this.ChartBorder.UIElement.offsetTop,W:this.ChartBorder.UIElement.clientWidth,H:this.ChartBorder.UIElement.clientHeight}}}function J(){this.newMethod=H,this.newMethod(),delete this.newMethod,this.DrawFrame=function(){if(this.XPointCount>0){var t=this.ChartBorder.GetHeightEx()/(10*this.XPointCount);this.DistanceWidth=4*t,this.DataWidth=6*t,this.DistanceWidth>this.MaxDistanceWidth&&(this.DistanceWidth=this.MaxDistanceWidth,t=this.ChartBorder.GetHeightEx()/this.XPointCount,this.DataWidth=t-this.MaxDistanceWidth)}this.SplitXYCoordinate(),this.DrawHorizontal(),this.DrawVertical()},this.GetXFromIndex=function(t){if(t<=this.HorizontalMin)return this.ChartBorder.GetLeft();if(t>=this.HorizontalMax)return this.ChartBorder.GetRight();var e=this.ChartBorder.GetWidth()*(t-this.HorizontalMin)/(this.HorizontalMax-this.HorizontalMin);return this.ChartBorder.GetLeft()+e},this.GetYFromData=function(t){t<0&&(t=0),t>this.xPointCount-1&&(t=this.xPointCount-1);for(var e=this.ChartBorder.GetBottom()-2-this.DistanceWidth/2-this.DataWidth/2,a=1;a<=t;++a)e-=this.DistanceWidth+this.DataWidth;return e},this.DrawHorizontal=function(){this.ChartBorder.GetTopEx(),this.ChartBorder.GetBottom(),this.ChartBorder.GetRight();var t=this.ChartBorder.GetLeft(),e=null;for(var a in this.VerticalInfo){var i=this.VerticalInfo[a],r=this.GetYFromData(i.Value);null!=r&&null!=e&&Math.abs(r-e)<15||(null!=i.Message[0]&&(null!=this.VerticalInfo[a].Font&&(this.Canvas.font=i.Font),this.Canvas.fillStyle=i.TextColor,this.Canvas.textAlign="right",this.Canvas.textBaseline="middle",this.Canvas.fillText(i.Message[0],t-2,r)),e=r)}},this.DrawVertical=function(){var t=this.ChartBorder.GetTopEx(),e=this.ChartBorder.GetBottom(),a=this.ChartBorder.GetRight(),i=(this.ChartBorder.GetLeft(),e);"bottom"==this.XMessageAlign?i=this.ChartBorder.GetChartHeight():this.XMessageAlign="top";var r=null,n=null;for(var s in this.HorizontalInfo){var o=this.HorizontalInfo[s],h=this.GetXFromIndex(o.Value);if(h>a)break;if(!(null!=r&&Math.abs(h-r)<this.MinXDistance)){if(this.IsShowXLine&&(this.Canvas.strokeStyle=o.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(E(h),t),this.Canvas.lineTo(E(h),e),this.Canvas.stroke()),null!=o.Message[0]){var l=null,u=null;null!=o.Font&&(this.Canvas.font=o.Font),this.Canvas.fillStyle=o.TextColor;var C=this.Canvas.measureText(o.Message[0]).width;if(h<C/2?(this.Canvas.textAlign="left",this.Canvas.textBaseline=this.XMessageAlign,l=h+C,u=h):(this.Canvas.textAlign="center",this.Canvas.textBaseline=this.XMessageAlign,l=h+C/2,u=h-C/2),null!=n&&n>u)continue;this.Canvas.fillText(o.Message[0],h,i),n=l}r=h}}}}function k(){this.ChartPaint,this.Data}Number.prototype.toFixed2=Number.prototype.toFixed,Number.prototype.toFixed=function(t){return A(this,t)};var U=[[48,10],[44,10],[40,9],[36,9],[32,8],[28,8],[24,7],[20,7],[18,6],[16,6],[14,5],[12,5],[8,4],[4,4],[3,3],[3,1],[2,1],[1,1],[1,0]];function W(){this.newMethod=D.JSCommonChartPaint_IChartPainting,this.newMethod(),delete this.newMethod,this.Color="rgb(255,193,37)",this.Draw=function(){if(this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.Data&&this.Data.Data){var t=!0===this.ChartFrame.IsHScreen,e=(this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight());t&&(e=this.ChartBorder.GetBottom());for(var a=this.ChartFrame.XPointCount,i=!0,r=0,n=this.Data.DataOffset,s=0;n<this.Data.Data.length&&s<a;++n,++s){var o=this.Data.Data[n];if(null!=o){var h=this.ChartFrame.GetXFromIndex(s);if(h>e)break;for(var l in o){var u=o[l].Value,C=this.ChartFrame.GetYFromData(u);i?(this.Canvas.strokeStyle=this.Color,this.Canvas.beginPath(),t?this.Canvas.moveTo(C,h):this.Canvas.moveTo(h,C),i=!1):t?this.Canvas.lineTo(C,h):this.Canvas.lineTo(h,C),++r}}}r>0&&this.Canvas.stroke()}},this.GetMaxMin=function(){var t=this.ChartFrame.XPointCount,e={Min:null,Max:null};if(!this.Data||!this.Data.Data)return e;for(var a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];if(null!=r)for(var n in r){var s=r[n].Value;null==e.Max&&(e.Max=s),null==e.Min&&(e.Min=s),e.Max<s&&(e.Max=s),e.Min>s&&(e.Min=s)}}return e}}function Y(){this.newMethod=D.JSCommonChartPaint_IChartPainting,this.newMethod(),delete this.newMethod,this.Color="rgb(255,193,37)",this.Draw=function(){if(this.Data&&this.Data.Data&&1==this.Data.Data.length){var t=this.ChartFrame.IsHScreen;this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight();t&&this.ChartBorder.GetTop();var e=this.ChartFrame.XPointCount,a=this.Data.Data[0],i=this.ChartFrame.GetYFromData(a),r=this.ChartFrame.GetXFromIndex(0),n=this.ChartFrame.GetXFromIndex(e-1),s=parseInt(i.toString())+.5;this.Canvas.beginPath(),t?(this.Canvas.moveTo(s,r),this.Canvas.lineTo(s,n)):(this.Canvas.moveTo(r,s),this.Canvas.lineTo(n,s)),this.Canvas.strokeStyle=this.Color,this.Canvas.stroke()}},this.GetMaxMin=function(){this.ChartFrame.XPointCount;var t={Min:null,Max:null};return this.Data&&this.Data.Data?(1!=this.Data.Data.length||(t.Min=this.Data.Data[0],t.Max=this.Data.Data[0]),t):t}}function X(){this.newMethod=D.JSCommonChartPaint_IChartPainting,this.newMethod(),delete this.newMethod,this.Color="rgb(65,105,225)",this.MainData,this.MainYClose,this.Name="ChartOverlayMinutePriceLine",this.Title,this.Symbol,this.YClose,this.Draw=function(){if(this.NotSupportMessage)this.DrawNotSupportmessage();else{var t=!0===this.ChartFrame.IsHScreen;this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight();!0===t&&this.ChartBorder.GetBottom();for(var e=this.ChartFrame.XPointCount,a=this.ChartFrame.MinuteCount,i=!0,r=0,n=this.Data.DataOffset,s=0;n<this.Data.Data.length&&s<e;++n,++s){var o=this.Data.Data[n].Close;if(null!=o){var h=o/this.YClose*this.MainYClose,l=this.ChartFrame.GetXFromIndex(s),u=this.ChartFrame.GetYFromData(h);i?(this.Canvas.strokeStyle=this.Color,this.Canvas.beginPath(),t?this.Canvas.moveTo(u,l):this.Canvas.moveTo(l,u),i=!1):t?this.Canvas.lineTo(u,l):this.Canvas.lineTo(l,u),++r,r>=a&&(i=!0,this.Canvas.stroke(),r=0)}}r>0&&this.Canvas.stroke()}},this.GetMaxMin=function(){var t=this.ChartFrame.XPointCount,e={};if(null==this.YClose)return e;e.Min=this.MainYClose,e.Max=this.MainYClose;for(var a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a].Close;if(null!=r){r=r/this.YClose*this.MainYClose;null==e.Max&&(e.Max=r),null==e.Min&&(e.Min=r),e.Max<r&&(e.Max=r),e.Min>r&&(e.Min=r)}}if(e.Max==this.MainYClose&&e.Min==this.MainYClose)return e.Max=this.MainYClose+.1*this.MainYClose,e.Min=this.MainYClose-.1*this.MainYClose,e;var n=Math.max(Math.abs(this.MainYClose-e.Max),Math.abs(this.MainYClose-e.Min));return e.Max=this.MainYClose+n,e.Min=this.MainYClose-n,e}}function K(){this.newMethod=Z,this.newMethod(),delete this.newMethod,this.BarID=0,this.Draw=function(){if(this.NotSupportMessage)this.DrawNotSupportmessage();else{var t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartBorder.GetTopEx(),i=this.ChartFrame.XPointCount,r=this.ChartBorder.GetBottom()-e/2-2,n=this.ChartFrame.GetXFromIndex(0);if(t>=4){var s=this.ChartFrame.BarCount,o=t,h=0;s>0&&(o=t/s,h=o*this.BarID),n=L(n);for(var l=this.Data.DataOffset,u=0;l<this.Data.Data.length&&u<i;++l,++u,r-=t+e){var C=this.Data.Data[l];if(null!=C&&0!=C){var D=r+h,m=r+h-t;if(D<a)break;var S=this.ChartFrame.GetXFromIndex(C);if(C>0){this.Canvas.fillStyle=this.UpBarColor;var c=L(Math.abs(S-n)),f=o;Math.abs(a-D)<t&&(o=Math.abs(a-D)),this.Canvas.fillRect(n,L(m),c,L(f+.5))}else{this.Canvas.fillStyle=this.DownBarColor;var d=L(Math.abs(S-n)),I=o;Math.abs(a-D)<o&&(I=Math.abs(a-D)),this.Canvas.fillRect(n,L(m),-d,L(I+.5))}}}}else for(l=this.Data.DataOffset,u=0;l<this.Data.Data.length&&u<i;++l,++u,r-=t+e){C=this.Data.Data[l];if(null!=C&&0!=C){D=r,m=r-t;if(m<a)break;S=this.ChartFrame.GetXFromIndex(C);var v=this.ChartFrame.GetYFromData(u);this.Canvas.strokeStyle=C>0?this.UpBarColor:this.DownBarColor,this.Canvas.beginPath(),this.Canvas.moveTo(E(S),v),this.Canvas.lineTo(E(n),v),this.Canvas.stroke()}}}}}function z(){this.newMethod=Z,this.newMethod(),delete this.newMethod,this.BarID=0,this.Draw=function(){if(this.NotSupportMessage)this.DrawNotSupportmessage();else{var t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartBorder.GetRight(),i=this.ChartFrame.XPointCount,r=this.ChartBorder.GetLeft()+e/2+2,n=this.ChartFrame.GetYFromData(0);if(t>=4){var s=this.ChartFrame.BarCount,o=t,h=0;s>0&&(o=t/s,h=o*this.BarID),n=L(n);for(var l=this.Data.DataOffset,u=0;l<this.Data.Data.length&&u<i;++l,++u,r+=t+e){var C=this.Data.Data[l];if(null!=C&&0!=C){var D=r+h,m=r+h+o;if(D>a)break;var S=this.ChartFrame.GetXFromIndex(u),c=this.ChartFrame.GetYFromData(C);if(C>0){this.Canvas.fillStyle=this.UpBarColor;var f=L(Math.abs(n-c)),d=o;a-D<o&&(d=a-D),c=n-c>0?n-f:n+f,this.Canvas.fillRect(L(D),c,L(d),f)}else{this.Canvas.fillStyle=this.DownBarColor;var I=L(Math.abs(n-c));a-D<o&&a-D,c=n-c>0?n-I:n+I,this.Canvas.fillRect(L(D),c,L(o),-I)}}}}else for(var v=this.Data.DataOffset,p=0;v<this.Data.Data.length&&p<i;++v,++p,r+=t+e){C=this.Data.Data[v];if(null!=C&&0!=C){D=r,m=r+t;if(m>a)break;S=this.ChartFrame.GetXFromIndex(p),c=this.ChartFrame.GetYFromData(C);this.Canvas.strokeStyle=C>0?this.UpBarColor:this.DownBarColor,this.Canvas.beginPath(),this.Canvas.moveTo(E(S),c),this.Canvas.lineTo(E(S),n),this.Canvas.stroke()}}}}}function Z(){this.newMethod=D.JSCommonChartPaint_IChartPainting,this.newMethod(),delete this.newMethod,this.UpBarColor=c.JSCommonResource_Global_JSChartResource.UpBarColor,this.DownBarColor=c.JSCommonResource_Global_JSChartResource.DownBarColor,this.Draw=function(){if(this.NotSupportMessage)this.DrawNotSupportmessage();else{var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetRight();t&&(i=this.ChartBorder.GetBottom());var r=this.ChartFrame.XPointCount,n=this.ChartBorder.GetLeft()+a/2+2;t&&(n=this.ChartBorder.GetTop()+a/2+2);var s=this.ChartFrame.GetYFromData(0);if(e>=4){s=L(s);for(var o=this.Data.DataOffset,h=0;o<this.Data.Data.length&&h<r;++o,++h,n+=e+a){var l=this.Data.Data[o];if(null!=l&&0!=l){var u=n,C=n+e;if(C>i)break;var D=this.ChartFrame.GetXFromIndex(h),m=this.ChartFrame.GetYFromData(l);if(l>0)if(this.Canvas.fillStyle=this.UpBarColor,t){var S=L(Math.abs(s-m));m=Math.min(s,m),this.Canvas.fillRect(m,L(u),S,L(e))}else{var c=L(Math.abs(s-m));m=s-m>0?s-c:s+c,this.Canvas.fillRect(L(u),m,L(e),c)}else{this.Canvas.fillStyle=this.DownBarColor;var f=L(Math.abs(s-m));m=s-m>0?s-f:s+f,this.Canvas.fillRect(L(u),m,L(e),-f)}}}}else for(o=this.Data.DataOffset,h=0;o<this.Data.Data.length&&h<r;++o,++h,n+=e+a){l=this.Data.Data[o];if(null!=l&&0!=l){u=n,C=n+e;if(C>i)break;D=this.ChartFrame.GetXFromIndex(h),m=this.ChartFrame.GetYFromData(l);this.Canvas.strokeStyle=l>0?this.UpBarColor:this.DownBarColor,this.Canvas.beginPath(),t?(this.Canvas.moveTo(m,E(D)),this.Canvas.lineTo(s,E(D))):(this.Canvas.moveTo(E(D),m),this.Canvas.lineTo(E(D),s)),this.Canvas.stroke()}}}},this.GetMaxMin=function(){for(var t=this.ChartFrame.XPointCount,e={Min:0,Max:null},a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];null==e.Max&&(e.Max=r),e.Max<r&&(e.Max=r),e.Min>r&&(e.Min=r)}return e}}function Q(){this.Data,this.Value,this.Text,this.Operator=function(){return!1}}function q(){this.newMethod=Q,this.newMethod(),delete this.newMethod,this.Symbol,this.FrameID,this.LanguageID=c.JSCommonResource_JSCHART_LANGUAGE_ID.LANGUAGE_CHINESE_ID,this.PercentageText,this.RValue,this.RText,this.Operator=function(){if(this.RText=null,d.JSCommonSplit_IFrameSplitOperator.IsString(this.RValue)&&(this.RText=this.RValue),!this.Value)return!1;var t=2;if(0==this.FrameID){t=h.JSCommonCoordinateData.GetfloatPrecision(this.Symbol);this.Text=this.Value.toFixed(t)}else this.Text=d.JSCommonSplit_IFrameSplitOperator.FormatValueString(this.Value,t,this.LanguageID);return!0}}function j(){this.newMethod=Q,this.newMethod(),delete this.newMethod,this.Operator=function(){if(!d.JSCommonSplit_IFrameSplitOperator.IsNumber(this.Value)||this.Value<0)return!1;if(!this.Data)return!1;var t=this.Value;if(t=parseInt(t.toFixed(0)),this.Data.DataOffset+t>=this.Data.Data.length)return!1;var e=this.Data.Data[this.Data.DataOffset+t],a=e.Date;if(this.Text=d.JSCommonSplit_IFrameSplitOperator.FormatDateString(a),s.JSCommon_ChartData.IsMinutePeriod(this.Data.Period,!0)){var i=d.JSCommonSplit_IFrameSplitOperator.FormatTimeString(e.Time);this.Text=this.Text+" "+i}else if(s.JSCommon_ChartData.IsSecondPeriod(this.Data.Period)){i=d.JSCommonSplit_IFrameSplitOperator.FormatTimeString(e.Time,"HH:MM:SS");this.Text=this.Text+" "+i}return!0}}function $(){this.newMethod=Q,this.newMethod(),delete this.newMethod,this.Frame,this.Symbol,this.Operator=function(){if(null==this.Value||isNaN(this.Value))return!1;var t=Math.abs(this.Value);t=parseInt(t.toFixed(0));var e=t;this.Frame&&this.Frame.MinuteCount&&(e=t%this.Frame.MinuteCount);var a=h.JSCommonCoordinateData.MinuteTimeStringData,i=a.GetTimeData(this.Symbol);if(!i)return!1;e<0?e=0:e>i.length&&(e=i.length-1),this.Frame&&t>=this.Frame.XPointCount&&(e=i.length-1);var r=i[e];return this.Text=d.JSCommonSplit_IFrameSplitOperator.FormatTimeString(r),!0}}function tt(){}function et(t){this.newMethod=F,this.newMethod(t),delete this.newMethod,this.ClassName="KLineChartContainer",this.WindowIndex=new Array,this.ColorIndex,this.TradeIndex,this.Symbol,this.Name,this.Period=0,this.IsApiPeriod=!1,this.Right=0,this.SourceData,this.MaxReqeustDataCount=3e3,this.MaxRequestMinuteDayCount=5,this.PageSize=200,this.KLineDrawType=0,this.LoadDataSplashTitle="下载历史数据",this.IsAutoUpdate=!1,this.AutoUpdateFrequency=3e4,this.AutoUpdateTimer,this.RightSpaceCount=1,this.SourceDataLimit=new Map,this.KLineSize=null,this.StepPixel=4,this.ZoomStepPixel=5,this.EnableZoomUpDown=null,this.DragDownload={Day:{Enable:!1,IsEnd:!1,Status:0},Minute:{Enable:!1,IsEnd:!1,status:0}},this.KLineApiUrl=c.JSCommonResource_Global_JSChartResource.Domain+"/API/KLine2",this.MinuteKLineApiUrl=c.JSCommonResource_Global_JSChartResource.Domain+"/API/KLine3",this.RealtimeApiUrl=c.JSCommonResource_Global_JSChartResource.Domain+"/API/Stock",this.KLineMatchUrl=c.JSCommonResource_Global_JSChartResource.Domain+"/API/KLineMatch",this.DragMinuteKLineApiUrl=c.JSCommonResource_Global_JSChartResource.Domain+"/API/KLine4",this.DragKLineApiUrl=c.JSCommonResource_Global_JSChartResource.Domain+"/API/KLine5",this.BeforeBindMainData=null,this.AfterBindMainData=null,this.ResetDragDownload=function(){this.DragDownload.Day.Status=0,this.DragDownload.Day.IsEnd=!1,this.DragDownload.Minute.Status=0,this.DragDownload.Minute.isEnd=!1},this.ChartOperator=function(t){var e=t.ID;if(e===T.OP_SCROLL_LEFT||e===T.OP_SCROLL_RIGHT){var a=e===T.OP_SCROLL_LEFT,i=1;t.Step>0&&(i=t.Step),this.DataMove(i*this.StepPixel,a)?(this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.ResetFrameXYSplit(),this.Draw()):e===T.OP_SCROLL_RIGHT&&this.DragDownloadData&&this.DragDownloadData()}else if(e===T.OP_ZOOM_IN||e===T.OP_ZOOM_OUT){var r={};if(r.Index=parseInt(Math.abs(this.CursorIndex-.5).toFixed(0)),e===T.OP_ZOOM_IN){if(!this.Frame.ZoomUp(r))return}else if(!this.Frame.ZoomDown(r))return;this.CursorIndex=r.Index,this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Draw()}else if(e===T.OP_GOTO_HOME){var s=null;if(s=this.Frame.Data?this.Frame.SubFrame[0].Frame.Data:this.Frame.Data,!s)return;var o=this.PageSize;for(var h in this.Frame.SubFrame){var l=this.Frame.SubFrame[h].Frame;l.XPointCount=o}var u=s.Data.length-o;s.DataOffset=u,this.CursorIndex=0,this.LastPoint.X=null,this.LastPoint.Y=null,n.JSConsole.Chart.Log("[KLineChartContainer::ChartOperator] OP_GOTO_HOME, dataOffset=".concat(s.DataOffset," CursorIndex=").concat(this.CursorIndex," PageSize=").concat(o)),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.UpdatePointByCursorIndex()}},this.Create=function(t){for(var e in this.UIElement.JSChartContainer=this,this.ChartCorssCursor=new D.JSCommonChartPaint_ChartCorssCursor,this.ChartCorssCursor.Canvas=this.Canvas,this.ChartCorssCursor.StringFormatX=new j,this.ChartCorssCursor.StringFormatY=new q,this.ChartCorssCursor.StringFormatY.LanguageID=this.LanguageID,this.ChartSplashPaint=new D.JSCommonChartPaint_ChartSplashPaint,this.ChartSplashPaint.Canvas=this.Canvas,this.ChartSplashPaint.SplashTitle=this.LoadDataSplashTitle,this.ChartSplashPaint.HQChart=this,this.Frame=new G,this.Frame.ChartBorder=new N,this.Frame.ChartBorder.UIElement=this.UIElement,this.Frame.ChartBorder.Top=30,this.Frame.ChartBorder.Left=5,this.Frame.ChartBorder.Bottom=20,this.Frame.Canvas=this.Canvas,this.ChartCorssCursor.Frame=this.Frame,this.ChartSplashPaint.Frame=this.Frame,this.CreateChildWindow(t),this.CreateMainKLine(),this.Frame.SubFrame){var a=new I.JSCommonChartTitle_DynamicChartTitlePainting;a.Frame=this.Frame.SubFrame[e].Frame,a.Canvas=this.Canvas,a.LanguageID=this.LanguageID,this.Frame.SubFrame[e].Frame.TitlePaint=a,this.TitlePaint.push(a)}},this.CreateChildWindow=function(t){for(var e=this,a=0;a<t;++a){var i=new N;i.UIElement=this.UIElement;var r=new P;r.Canvas=this.Canvas,r.ChartBorder=i,r.Identify=a,r.RightSpaceCount=this.RightSpaceCount,r.HorizontalMax=20,r.HorizontalMin=10,0==a?(r.YSplitOperator=new d.JSCommonSplit_FrameSplitKLinePriceY,r.YSplitOperator.FrameSplitData=this.FrameSplitData.get("price"),r.YSplitOperator.FrameSplitData2=this.FrameSplitData.get("double"),r.YSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)},i.BottomSpace=12,i.TopSpace=12):(r.YSplitOperator=new d.JSCommonSplit_FrameSplitY,r.YSplitOperator.FrameSplitData=this.FrameSplitData.get("double"),r.YSplitOperator.LanguageID=this.LanguageID,r.YSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)}),r.YSplitOperator.Frame=r,r.YSplitOperator.ChartBorder=i,r.XSplitOperator=new d.JSCommonSplit_FrameSplitKLineX,r.XSplitOperator.Frame=r,r.XSplitOperator.ChartBorder=i,a!=t-1&&(r.XSplitOperator.ShowText=!1);for(var n=r.HorizontalMin;n<=r.HorizontalMax;n+=1)r.HorizontalInfo[n]=new d.JSCommonSplit_CoordinateInfo,r.HorizontalInfo[n].Value=n,0==a&&n==r.HorizontalMin||(r.HorizontalInfo[n].Message[1]=n.toString(),r.HorizontalInfo[n].Font="14px 微软雅黑");var s=new b;s.Frame=r,s.Height=0==a?20:10,this.Frame.SubFrame[a]=s}},this.CreateSubFrameItem=function(t){var e=new N;e.UIElement=this.UIElement;var a=new P;a.Canvas=this.Canvas,a.ChartBorder=e,a.Identify=t,this.ModifyIndexDialog&&(a.ModifyIndexEvent=this.ModifyIndexDialog.DoModal),this.ChangeIndexDialog&&(a.ChangeIndexEvent=this.ChangeIndexDialog.DoModal),a.HorizontalMax=20,a.HorizontalMin=10,a.YSplitOperator=new d.JSCommonSplit_FrameSplitY,a.YSplitOperator.LanguageID=this.LanguageID,a.YSplitOperator.FrameSplitData=this.FrameSplitData.get("double"),a.YSplitOperator.Frame=a,a.YSplitOperator.ChartBorder=e,a.XSplitOperator=new d.JSCommonSplit_FrameSplitKLineX,a.XSplitOperator.Frame=a,a.XSplitOperator.ChartBorder=e,a.XSplitOperator.ShowText=!1;var i=this.Frame.SubFrame[0].Frame.XPointCount;a.XPointCount=i,a.Data=this.ChartPaint[0].Data;for(var r=a.HorizontalMin;r<=a.HorizontalMax;r+=1)a.HorizontalInfo[r]=new d.JSCommonSplit_CoordinateInfo,a.HorizontalInfo[r].Value=r,a.HorizontalInfo[r].Message[1]=r.toString(),a.HorizontalInfo[r].Font="14px 微软雅黑";var n=new b;return n.Frame=a,n.Height=10,n},this.CreateMainKLine=function(){var t=new D.JSCommonChartPaint_ChartKLine;t.Canvas=this.Canvas,t.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,t.ChartFrame=this.Frame.SubFrame[0].Frame,t.Name="Main-KLine",t.DrawType=this.KLineDrawType,this.ChartPaint[0]=t,this.TitlePaint[0]=new I.JSCommonChartTitle_DynamicKLineTitlePainting,this.TitlePaint[0].Frame=this.Frame.SubFrame[0].Frame,this.TitlePaint[0].Canvas=this.Canvas,this.TitlePaint[0].LanguageID=this.LanguageID;var e=new D.JSCommonChartPaint_ChartOverlayKLine;e.Canvas=this.Canvas,e.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,e.ChartFrame=this.Frame.SubFrame[0].Frame,e.Name="Overlay-KLine",e.DrawType=this.KLineDrawType,this.OverlayChartPaint[0]=e},this.BindMainData=function(t,e){if(this.ChartPaint[0].Data=t,this.ChartPaint[0].Symbol=this.Symbol,this.KLineSize)if(null==this.KLineSize.DataWidth)e=this.Frame.SubFrame[0].Frame.XPointCount-this.RightSpaceCount;else{var a=this.Frame.SetDataWidth(this.KLineSize.DataWidth);e=a.XPointCount-this.RightSpaceCount,this.KLineSize.DataWidth=null}for(var i in this.Frame.SubFrame){var r=this.Frame.SubFrame[i].Frame;r.XPointCount=e+this.RightSpaceCount,r.Data=this.ChartPaint[0].Data,r.XSplitOperator.Symbol=this.Symbol,r.XSplitOperator.Period=this.Period}this.TitlePaint[0].Data=this.ChartPaint[0].Data,this.TitlePaint[0].Symbol=this.Symbol,this.TitlePaint[0].Name=this.Name,this.TitlePaint[0].Period=this.Period,this.ChartCorssCursor.StringFormatX.Data=this.ChartPaint[0].Data,this.Frame.Data=this.ChartPaint[0].Data,this.OverlayChartPaint[0].MainData=this.ChartPaint[0].Data;var n=t.Data.length-e;n<0&&(n=0),this.ChartPaint[0].Data.DataOffset=n,this.ChartCorssCursor.StringFormatY.Symbol=this.Symbol,this.CursorIndex=e,this.CursorIndex+n>=t.Data.length&&(this.CursorIndex=t.Data.length-1-n),this.CursorIndex<0&&(this.CursorIndex=0)},this.UpdateMainData=function(t,e){var a=null;if(this.Frame.Data?this.Frame.SubFrame&&this.Frame.SubFrame[0]&&(a=this.Frame.SubFrame[0].Frame.Data):a=this.Frame.Data,a){var i=this.Frame.SubFrame[0].Frame.XPointCount,r=0;for(var s in e>0&&t.Data.length>e&&(r=t.Data.length-e,n.JSConsole.Chart.Log("[KLineChartContainer::UpdateMainData]  [count=".concat(e,"->").concat(t.Data.length,"], [newDataCount=").concat(r,"]"))),this.ChartPaint[0].Data=t,this.ChartPaint[0].Symbol=this.Symbol,t.Data.length>i&&(this.ChartPaint[0].Data.DataOffset=a.DataOffset+r),this.Frame.SubFrame){var o=this.Frame.SubFrame[s].Frame;o.Data=this.ChartPaint[0].Data,0==s&&(o.YSplitOperator.Symbol=this.Symbol,o.YSplitOperator.Data=this.ChartPaint[0].Data,o.YSplitOperator.Period=this.Period)}for(var s in this.TitlePaint[0].Data=this.ChartPaint[0].Data,this.TitlePaint[0].Symbol=this.Symbol,this.TitlePaint[0].Name=this.Name,this.ChartCorssCursor.StringFormatX.Data=this.ChartPaint[0].Data,this.Frame.Data=this.ChartPaint[0].Data,this.OverlayChartPaint){o=this.OverlayChartPaint[s];o.MainData=this.ChartPaint[0].Data}this.ChartCorssCursor.StringFormatY.Symbol=this.Symbol}},this.CreateWindowIndex=function(t){this.WindowIndex[t].Create(this,t)},this.BindIndexData=function(t,e){this.WindowIndex[t]&&("function"!=typeof this.WindowIndex[t].RequestData?"function"!=typeof this.WindowIndex[t].ExecuteScript?this.WindowIndex[t].BindData(this,t,e):this.WindowIndex[t].ExecuteScript(this,t,e):this.WindowIndex[t].RequestData(this,t,e))},this.BindInstructionIndexData=function(t){this.ColorIndex&&"function"==typeof this.ColorIndex.ExecuteScript&&this.ColorIndex.ExecuteScript(this,0,t),this.TradeIndex&&"function"==typeof this.TradeIndex.ExecuteScript&&this.TradeIndex.ExecuteScript(this,0,t)},this.GetChartPaint=function(t){var e=new Array;for(var a in this.ChartPaint)if(0!=a){var i=this.ChartPaint[a];i.ChartFrame==this.Frame.SubFrame[t].Frame&&e.push(i)}return e},this.AutoUpdateEvent=function(t){var e=t?s.JSCommon_JSCHART_EVENT_ID.RECV_START_AUTOUPDATE:s.JSCommon_JSCHART_EVENT_ID.RECV_STOP_AUTOUPDATE;if(this.mapEvent.has(e)){var a=this,i=this.mapEvent.get(e),r={Stock:{Symbol:this.Symbol,Name:this.Name,Right:this.Right,Period:this.Period}};t&&(r.Callback=function(t){s.JSCommon_ChartData.IsDayPeriod(a.Period,!0)?a.RecvRealtimeData(t):(s.JSCommon_ChartData.IsMinutePeriod(a.Period,!0)||s.JSCommon_ChartData.IsSecondPeriod(a.Period))&&a.RecvMinuteRealtimeData(t)}),i.Callback(i,r,this)}},this.RequestHistoryData=function(){var t=this;if(this.CancelAutoUpdate(),this.ChartSplashPaint.SetTitle(this.LoadDataSplashTitle),this.ChartSplashPaint.EnableSplash(!0),this.ResetDragDownload(),this.Draw(),this.NetworkFilter){var e={Name:"KLineChartContainer::RequestHistoryData",Explain:"日K数据",Request:{Url:t.KLineApiUrl,Type:"POST",Data:{symbol:t.Symbol,count:t.MaxReqeustDataCount,field:["name","symbol","yclose","open","price","high","low","vol"]}},Self:this,PreventDefault:!1};if(this.NetworkFilter(e,(function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvHistoryData(e),t.AutoUpdateEvent(!0),t.AutoUpdate()})),1==e.PreventDefault)return}wx.request({url:this.KLineApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol"],symbol:t.Symbol,start:-1,count:t.MaxReqeustDataCount},method:"POST",dataType:"json",success:function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvHistoryData(e),t.AutoUpdateEvent(!0),t.AutoUpdate()}})},this.RecvHistoryData=function(t){var e=t.data,a=et.JsonDataToHistoryData(e),i=new s.JSCommon_ChartData;i.Data=a,i.DataType=0,i.Symbol=e.symbol,this.SourceData=i,this.BeforeBindMainData&&this.BeforeBindMainData("RecvHistoryData");var r,n=new s.JSCommon_ChartData;if(n.Data=a,n.Right=this.Right,n.Period=this.Period,n.DataType=0,n.Right>0&&!this.IsApiPeriod){var o=n.GetRightDate(n.Right);n.Data=o}if(s.JSCommon_ChartData.IsDayPeriod(n.Period,!1)&&!this.IsApiPeriod){var h=n.GetPeriodData(n.Period);n.Data=h}this.Symbol=e.symbol,this.Name=e.name,this.BindMainData(n,this.PageSize),this.AfterBindMainData&&this.AfterBindMainData("RecvHistoryData"),this.Frame.SetSizeChage(!0),this.BindInstructionIndexData(n);for(var l=0;l<this.Frame.SubFrame.length;++l)0==l&&(r=this.Frame.SubFrame[l].Frame),this.BindIndexData(l,n);if(r&&r.YSplitOperator&&(r.YSplitOperator.Symbol=this.Symbol,r.YSplitOperator.Data=this.ChartPaint[0].Data),this.ReqeustKLineInfoData(),this.RequestOverlayHistoryData(),this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.mapEvent.has(s.JSCommon_JSCHART_EVENT_ID.RECV_HISTROY_DATA)){var u=this.mapEvent.get(s.JSCommon_JSCHART_EVENT_ID.RECV_HISTROY_DATA);e={HistoryData:n,Stock:{Symbol:this.Symbol,Name:this.Name}};u.Callback(u,e,this)}else"function"==typeof this.UpdateUICallback&&this.UpdateUICallback("RecvHistroyData",this),"function"==typeof this.UpdateUICallback&&this.UpdateUICallback("RecvHistoryData",this)},this.ReqeustHistoryMinuteData=function(){var t=this;if(this.CancelAutoUpdate(),this.ChartSplashPaint.SetTitle(this.LoadDataSplashTitle),this.ChartSplashPaint.EnableSplash(!0),this.ResetDragDownload(),this.Draw(),this.NetworkFilter){var e={Name:"KLineChartContainer::ReqeustHistoryMinuteData",Explain:"1分钟K线数据",Request:{Url:t.MinuteKLineApiUrl,Type:"POST",Data:{symbol:t.Symbol,count:t.MaxRequestMinuteDayCount,field:["name","symbol","yclose","open","price","high","low","vol"]}},Self:this,PreventDefault:!1};if(this.NetworkFilter(e,(function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvMinuteHistoryData(e),t.AutoUpdateEvent(!0),t.AutoUpdate()})),1==e.PreventDefault)return}wx.request({url:this.MinuteKLineApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol"],symbol:t.Symbol,start:-1,count:t.MaxRequestMinuteDayCount},method:"POST",dataType:"json",success:function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvMinuteHistoryData(e),t.AutoUpdateEvent(!0),t.AutoUpdate()}})},this.RecvMinuteHistoryData=function(t){var e=t.data,a=et.JsonDataToMinuteHistoryData(e),i=new s.JSCommon_ChartData;i.Data=a,i.DataType=1,i.Symbol=e.symbol,this.SourceData=i,this.BeforeBindMainData&&this.BeforeBindMainData("RecvMinuteHistoryData");var r,n=new s.JSCommon_ChartData;if(n.Data=a,n.Right=this.Right,n.Period=this.Period,n.DataType=1,n.Symbol=e.symbol,s.JSCommon_ChartData.IsMinutePeriod(n.Period,!1)&&!this.IsApiPeriod){var o=i.GetPeriodData(n.Period);n.Data=o}this.Symbol=e.symbol,this.Name=e.name,this.BindMainData(n,this.PageSize),this.AfterBindMainData&&this.AfterBindMainData("RecvMinuteHistoryData"),this.Frame.SetSizeChage(!0),this.BindInstructionIndexData(n);for(var h=0;h<this.Frame.SubFrame.length;++h)0==h&&(r=this.Frame.SubFrame[h].Frame),this.BindIndexData(h,n);if(r&&r.YSplitOperator&&(r.YSplitOperator.Symbol=this.Symbol,r.YSplitOperator.Data=this.ChartPaint[0].Data),this.OverlayChartPaint[0].Data=null,this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.mapEvent.has(s.JSCommon_JSCHART_EVENT_ID.RECV_HISTROY_DATA)){var l=this.mapEvent.get(s.JSCommon_JSCHART_EVENT_ID.RECV_HISTROY_DATA);e={HistoryData:n,Stock:{Symbol:this.Symbol,Name:this.Name}};l.Callback(l,e,this)}else"function"==typeof this.UpdateUICallback&&this.UpdateUICallback("RecvMinuteHistoryData",this)},this.RequestRealtimeData=function(){var t=this;if(this.NetworkFilter){var e={Name:"KLineChartContainer::RequestRealtimeData",Explain:"当天最新日线数据",Request:{Url:t.RealtimeApiUrl,Data:{symbol:[t.Symbol],field:["name","symbol","yclose","open","price","high","low","vol","amount","date","time"]},Type:"POST"},Self:this,PreventDefault:!1};if(this.NetworkFilter(e,(function(e){t.RecvRealtimeData(e),t.AutoUpdate()})),1==e.PreventDefault)return}wx.request({url:this.RealtimeApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol","amount","date","time"],symbol:[t.Symbol],start:-1},method:"POST",dataType:"json",async:!0,success:function(e){t.RecvRealtimeData(e),t.AutoUpdate()}})},this.RecvRealtimeData=function(t){if(1!=this.IsOnTouch){var e=t.data;if(e&&e.stock&&e.stock[0]&&this.Symbol==e.stock[0].symbol){var a=et.JsonDataToRealtimeData(e),i=this.SourceData.Data[this.SourceData.Data.length-1],r=this.GetHistoryDataCount();if(i.Date==a.Date)i.Close=a.Close,i.High=a.High,i.Low=a.Low,i.Vol=a.Vol,i.Amount=a.Amount;else{if(!(i.Date<a.Date))return;var o=new s.JSCommon_HistoryData;o.YClose=a.YClose,o.Open=a.Open,o.Close=a.Close,o.High=a.High,o.Low=a.Low,o.Vol=a.Vol,o.Amount=a.Amount,o.Date=a.Date,!d.JSCommonSplit_IFrameSplitOperator.IsNumber(o.YClose)&&this.SourceData.Data.length>0&&(o.YClose=this.SourceData.Data[this.SourceData.Data.length-1].YClose),this.SourceData.Data.push(o)}var h=new s.JSCommon_ChartData;if(h.Data=this.SourceData.Data,h.Period=this.Period,h.Right=this.Right,h.DataType=this.SourceData.DataType,h.Symbol=this.Symbol,h.Right>0&&s.JSCommon_ChartData.IsDayPeriod(h.Period,!0)&&!this.IsApiPeriod){var l=h.GetRightDate(h.Right);h.Data=l}if(!this.IsApiPeriod&&(s.JSCommon_ChartData.IsDayPeriod(h.Period,!1)||s.JSCommon_ChartData.IsMinutePeriod(h.Period,!1))){var u=h.GetPeriodData(h.Period);h.Data=u}this.UpdateMainData(h,r),this.Frame.SetSizeChage(!0),this.BindInstructionIndexData(h);for(var C=0;C<this.Frame.SubFrame.length;++C)this.BindIndexData(C,h);this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.SendKLineUpdateEvent(h)}else n.JSConsole.Chart.Log("[KLineChartContainer::RecvRealtimeData] recvdata error",t)}},this.GetHistoryDataCount=function(){var t=null;if(this.Frame.Data?this.Frame.SubFrame&&this.Frame.SubFrame[0]&&(t=this.Frame.SubFrame[0].Frame.Data):t=this.Frame.Data,!t)return-1;var e=t.Data.length;return e},this.RequestMinuteRealtimeData=function(){var t=this;if(this.NetworkFilter){var e={Name:"KLineChartContainer::RequestMinuteRealtimeData",Explain:"当天1分钟K线数据",Request:{Url:t.RealtimeApiUrl,Data:{symbol:[t.Symbol],field:["name","symbol","price","yclose","minutecount","minute","date","time"]},Type:"POST"},Self:this,PreventDefault:!1};if(this.NetworkFilter(e,(function(e){t.RecvMinuteRealtimeData(e),t.AutoUpdate()})),1==e.PreventDefault)return}wx.request({url:this.RealtimeApiUrl,data:{field:["name","symbol","price","yclose","minutecount","minute","date","time"],symbol:[t.Symbol],start:-1},method:"POST",dataType:"json",async:!0,success:function(e){t.RecvMinuteRealtimeData(e),t.AutoUpdate()}})},this.SetSourceDatatLimit=function(t){for(var e in this.SourceDataLimit=new Map,t){var a=t[e];this.SourceDataLimit.set(a.Period,a.MaxCount),n.JSConsole.Chart.Log("[KLineChartContainer::SetSourceDatatLimit] Period=".concat(a.Period,", MaxCount=").concat(a.MaxCount))}},this.ReduceSourceData=function(){if(this.SourceDataLimit&&this.SourceDataLimit.has(this.Period)){var t=this.SourceDataLimit.get(this.Period);if(!(t<50)){var e=null;if(this.Frame.Data?this.Frame.SubFrame&&this.Frame.SubFrame[0]&&(e=this.Frame.SubFrame[0].Frame.Data):e=this.Frame.Data,e){var a=e.DataOffset,i=0;while(this.SourceData.Data.length>t)this.SourceData.Data.shift(),--a,++i;i>0&&(a<0&&(a=0),e.DataOffset=a,n.JSConsole.Chart.Log("[KLineChartContainer::ReduceSourceData] remove data ".concat(i,", dataOffset=").concat(a)))}}}},this.RecvMinuteRealtimeData=function(t){var e=t.data;if(1!=this.IsOnTouch)if(2!=e.ver){if(e.stock&&e.stock[0]&&this.Symbol==e.stock[0].symbol){var a=et.JsonDataToMinuteRealtimeData(e);if(a){this.IsApiPeriod&&this.ReduceSourceData();var i=this.GetHistoryDataCount(),r=this.SourceData.Data.length;if(this.SourceData.MergeMinuteData(a)){n.JSConsole.Chart.Log("[KLineChartContainer::RecvMinuteRealtimeData] update kline by 1 minute data [".concat(r,"->").concat(this.SourceData.Data.length,"]"));var o=new s.JSCommon_ChartData;if(o.Data=this.SourceData.Data,o.Period=this.Period,o.Right=this.Right,o.DataType=this.SourceData.DataType,o.Symbol=this.Symbol,o.Right>0&&s.JSCommon_ChartData.IsDayPeriod(o.Period,!0)&&!this.IsApiPeriod){var h=o.GetRightDate(o.Right);o.Data=h}if(!this.IsApiPeriod&&(s.JSCommon_ChartData.IsDayPeriod(o.Period,!1)||s.JSCommon_ChartData.IsMinutePeriod(o.Period,!1))){var l=o.GetPeriodData(o.Period);o.Data=l}this.UpdateMainData(o,i),this.Frame.SetSizeChage(!0),this.BindInstructionIndexData(o);for(var u=0;u<this.Frame.SubFrame.length;++u)this.BindIndexData(u,o);this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.SendKLineUpdateEvent(o)}}}}else this.RecvMinuteRealtimeDataV2(e)},this.RecvMinuteRealtimeDataV2=function(t){if(1!=this.IsOnTouch){var e=et.JsonDataToMinuteHistoryData(t);if(e&&!(e.length<=0)){this.IsApiPeriod&&this.ReduceSourceData();var a=this.GetHistoryDataCount();if(this.SourceData.MergeMinuteData(e)){n.JSConsole.Chart.Log("[KLineChartContainer::RecvMinuteRealtimeDataV2] update kline by 1 minute data [".concat(a,"->").concat(this.SourceData.Data.length,"]"));var i=new s.JSCommon_ChartData;if(i.Data=this.SourceData.Data,i.Period=this.Period,i.Right=this.Right,i.DataType=this.SourceData.DataType,i.Symbol=this.Symbol,i.Right>0&&s.JSCommon_ChartData.IsDayPeriod(i.Period,!0)&&!this.IsApiPeriod){var r=i.GetRightDate(i.Right);i.Data=r}if((s.JSCommon_ChartData.IsDayPeriod(i.Period,!1)||s.JSCommon_ChartData.IsMinutePeriod(i.Period,!1))&&!this.IsApiPeriod){var o=i.GetPeriodData(i.Period);i.Data=o}this.UpdateMainData(i,a),this.Frame.SetSizeChage(!0),this.BindInstructionIndexData(i);for(var h=0;h<this.Frame.SubFrame.length;++h)this.BindIndexData(h,i);this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.SendKLineUpdateEvent(i)}}}},this.SendKLineUpdateEvent=function(t){var e=this.GetEvent(s.JSCommon_JSCHART_EVENT_ID.RECV_KLINE_UPDATE_DATA);if(e&&e.Callback){var a={HistoryData:t,Stock:{Symbol:this.Symbol,Name:this.Name}};return e.Callback(e,a,this),!0}return!1},this.ChangePeriod=function(t,e){var a=!1,i=null;if(e&&e.KLine&&(d.JSCommonSplit_IFrameSplitOperator.IsNumber(e.KLine.DrawType)&&(a=!0),d.JSCommonSplit_IFrameSplitOperator.IsNumber(e.KLine.Right)&&(i=e.KLine.Right)),this.Period!=t){a&&this.ChangeKLineDrawType(e.KLine.DrawType,!1);var r=!0;if(this.SourceData){r=!1;if(t>s.JSCommon_CUSTOM_DAY_PERIOD_START&&t<=s.JSCommon_CUSTOM_DAY_PERIOD_END)0!=this.SourceData.DataType&&(r=!0);else if(t>s.JSCommon_CUSTOM_MINUTE_PERIOD_START&&t<=s.JSCommon_CUSTOM_MINUTE_PERIOD_END||t>s.JSCommon_CUSTOM_SECOND_PERIOD_START&&t<=s.JSCommon_CUSTOM_SECOND_PERIOD_END)1!=this.SourceData.DataType&&(r=!0);else switch(t){case 0:case 1:case 2:case 3:case 21:0!=this.SourceData.DataType&&(r=!0);break;case 4:case 5:case 6:case 7:case 8:case 11:case 12:1!=this.SourceData.DataType&&(r=!0);break}}this.Period=t,null!=i&&(this.Right=i),0!=r||this.IsApiPeriod?s.JSCommon_ChartData.IsDayPeriod(this.Period,!0)?(this.CancelAutoUpdate(),this.AutoUpdateEvent(!1),this.RequestHistoryData()):(s.JSCommon_ChartData.IsMinutePeriod(this.Period,!0)||s.JSCommon_ChartData.IsSecondPeriod(this.Period))&&(this.CancelAutoUpdate(),this.AutoUpdateEvent(!1),this.ReqeustHistoryMinuteData()):this.Update()}else a&&this.ChangeKLineDrawType(e.KLine.DrawType)},this.ChangeRight=function(t){pt(this.Symbol)||t<0||t>2||this.Right!=t&&(this.Right=t,this.IsApiPeriod?s.JSCommon_ChartData.IsDayPeriod(this.Period,!0)?(this.CancelAutoUpdate(),this.AutoUpdateEvent(!1),this.RequestHistoryData()):(s.JSCommon_ChartData.IsMinutePeriod(this.Period,!0)||s.JSCommon_ChartData.IsSecondPeriod(this.Period))&&(this.CancelAutoUpdate(),this.AutoUpdateEvent(!1),this.ReqeustHistoryMinuteData()):this.Update())},this.DeleteIndexPaint=function(t){var e=new Array;for(var a in this.ChartPaint){var i=this.ChartPaint[a];0!=a&&i.ChartFrame==this.Frame.SubFrame[t].Frame||e.push(i)}this.Frame.SubFrame[t].Frame.YSpecificMaxMin=null,this.Frame.SubFrame[t].Frame.IsLocked=!1,this.Frame.SubFrame[t].Frame.YSplitScale=null,this.ChartPaint=e;var r=t+1;this.TitlePaint[r].Data=[],this.TitlePaint[r].Title=null},this.ShowKLine=function(t){this.ChartPaint.length<=0||!this.ChartPaint[0]||(this.ChartPaint[0].IsShow=t)},this.SetInstructionData=function(t,e){this.ChartPaint.length<=0||!this.ChartPaint[0]||(2==t?this.ChartPaint[0].ColorData=e.Data:1==t&&(this.ChartPaint[0].TradeData={Sell:e.Sell,Buy:e.Buy}))},this.ChangeInstructionIndex=function(t){var e=new u.JSCommonIndexScript.JSIndexScript,a=e.Get(t);a&&(1!=a.InstructionType&&2!=a.InstructionType||this.ChangeInstructionScriptIndex(a))},this.ChangeInstructionScriptIndex=function(t){if(1==t.InstructionType)this.TradeIndex=new S.JSCommonIndex_ScriptIndex(t.Name,t.Script,t.Args,t);else{if(2!=t.InstructionType)return;this.ColorIndex=new S.JSCommonIndex_ScriptIndex(t.Name,t.Script,t.Args,t)}var e=this.ChartPaint[0].Data;this.BindInstructionIndexData(e),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()},this.CancelInstructionIndex=function(){this.ChartPaint.length<=0||!this.ChartPaint[0]||(this.ColorIndex=null,this.TradeIndex=null,this.ChartPaint[0].ColorData=null,this.ChartPaint[0].TradeData=null,this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw())},this.ChangeScriptIndex=function(t,e){this.DeleteIndexPaint(t),this.WindowIndex[t]=new S.JSCommonIndex_ScriptIndex(e.Name,e.Script,e.Args,e);var a=this.ChartPaint[0].Data;this.BindIndexData(t,a),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()},this.ChangeAPIIndex=function(t,e){this.DeleteIndexPaint(t);var a=e.API;this.WindowIndex[t]=new mt(a.Name,a.Script,a.Args,e);var i=this.ChartPaint[0].Data;this.BindIndexData(t,i),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()},this.ChangeIndex=function(t,e,a){if(a&&a.API)return this.ChangeAPIIndex(t,a);var i=tt.Get(e);if(!i){var r=new u.JSCommonIndexScript.JSIndexScript,n=r.Get(e);if(!n)return;n.IsMainIndex?t=0:0==t&&(t=1);var s=n;return a&&(a.FloatPrecision>=0&&(s.FloatPrecision=a.FloatPrecision),a.StringFormat>0&&(s.StringFormat=a.StringFormat),a.Args&&(s.Args=a.Args)),this.ChangeScriptIndex(t,s)}i.IsMainIndex?t>0&&(t=0):0==t&&(t=1);var o=new Array;for(var h in this.ChartPaint){var l=this.ChartPaint[h];0!=h&&l.ChartFrame==this.Frame.SubFrame[t].Frame||o.push(l)}this.Frame.SubFrame[t].Frame.YSpecificMaxMin=null,this.Frame.SubFrame[t].Frame.YSplitScale=null,this.ChartPaint=o;var C=t+1;this.TitlePaint[C].Data=[],this.TitlePaint[C].Title=null,this.WindowIndex[t]=i.Create(),this.CreateWindowIndex(t);var D=this.ChartPaint[0].Data;this.BindIndexData(t,D),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()},this.ChangeKLineDrawType=function(t,e){if(this.KLineDrawType!=t){for(var a in this.KLineDrawType=t,this.ChartPaint){var i=this.ChartPaint[a];0==a?i.DrawType=this.KLineDrawType:"ChartVolStick"==i.ClassName&&(i.KLineDrawType=this.KLineDrawType)}this.OverlayChartPaint[0]&&(this.OverlayChartPaint[0].DrawType=this.KLineDrawType),0!=e&&(this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw())}},this.GetIndexInfo=function(){var t=[];for(var e in this.WindowIndex){var a=this.WindowIndex[e],i={Name:a.Name};a.ID&&(i.ID=a.ID),t.push(i)}return t},this.ChangeIndexTemplate=function(t){if(t.Windows){var e=t.Windows.length;if(!(e<=0)){var a=this.Frame.SubFrame.length,i=null,r=null;t.KLine&&(d.JSCommonSplit_IFrameSplitOperator.IsNumber(t.KLine.Period)&&t.KLine.Period!=this.Period&&(i=t.KLine.Period),d.JSCommonSplit_IFrameSplitOperator.IsNumber(t.KLine.Right)&&t.KLine.Right!=this.Right&&(r=t.KLine.Right));for(var n=null!=i||null!=r,s=0;s<a;++s){this.DeleteIndexPaint(s);var o=this.Frame.SubFrame[s];o.YSpecificMaxMin=null,o.IsLocked=!1,o.YSplitScale=null}if(a>e)this.Frame.SubFrame.splice(e,a-e),this.WindowIndex.splice(e,a-e);else for(s=a;s<e;++s){var h=this.CreateSubFrameItem(s);this.Frame.SubFrame[s]=h;var l=new I.JSCommonChartTitle_DynamicChartTitlePainting;l.Frame=this.Frame.SubFrame[s].Frame,l.Canvas=this.Canvas,l.LanguageID=this.LanguageID,this.TitlePaint[s+1]=l}var C=new u.JSCommonIndexScript.JSIndexScript,D=this.ChartPaint[0].Data;for(s=0;s<e;++s){var m=s,c=t.Windows[s],f=null;t.Frame&&t.Frame.length>s&&(f=t.Frame[s]);var v=m+1;if(this.TitlePaint[v].Data=[],this.TitlePaint[v].Title=null,c.Script)this.WindowIndex[s]=new S.JSCommonIndex_ScriptIndex(c.Name,c.Script,c.Args,c),n||this.BindIndexData(m,D);else{var p=c.Index,T=tt.Get(p);if(T)this.WindowIndex[s]=T.Create(),this.CreateWindowIndex(m),n||this.BindIndexData(m,D);else{var F=C.Get(p);if(F){var A=F.Args;t.Windows[s].Args&&(A=t.Windows[s].Args);var M={Name:F.Name,Script:F.Script,Args:A,ID:p,KLineType:F.KLineType,YSpecificMaxMin:F.YSpecificMaxMin,YSplitScale:F.YSplitScale,FloatPrecision:F.FloatPrecision,Condition:F.Condition,OutName:F.OutName};this.WindowIndex[s]=new S.JSCommonIndex_ScriptIndex(M.Name,M.Script,M.Args,M),n||this.BindIndexData(m,D)}}}c.IndexParamSpace>=0&&(this.Frame.SubFrame[s].Frame.IndexParamSpace=c.IndexParamSpace),1==c.IsDrawTitleBG&&(this.Frame.SubFrame[s].Frame.IsDrawTitleBG=c.IsDrawTitleBG),f&&(f.SplitCount&&(this.Frame.SubFrame[s].Frame.YSplitOperator.SplitCount=f.SplitCount),0==f.IsShowBorder&&(this.Frame.SubFrame[s].Frame.IsShowBorder=f.IsShowBorder),!1!==f.IsShowXLine&&!0!==f.IsShowXLine||(this.Frame.SubFrame[s].Frame.IsShowXLine=f.IsShowXLine),!1!==f.IsShowYLine&&!0!==f.IsShowYLine||(this.Frame.SubFrame[s].Frame.IsShowYLine=f.IsShowYLine),!1!==f.IsShowLeftText&&!0!==c.IsShowLeftText||(this.Frame.SubFrame[s].Frame.IsShowYText[0]=f.IsShowLeftText),!1!==f.IsShowRightText&&!0!==c.IsShowRightText||(this.Frame.SubFrame[s].Frame.IsShowYText[1]=f.IsShowRightText))}for(s=0;s<this.Frame.SubFrame.length;++s){c=this.Frame.SubFrame[s].Frame;s==this.Frame.SubFrame.length-1?c.XSplitOperator.ShowText=!0:c.XSplitOperator.ShowText=!1}n?(this.Frame.SetSizeChage(!0),null!=i?this.ChangePeriod(i,t):null!=r&&this.ChangeRight(r)):(this.UpdataDataoffset(),this.Frame.SetSizeChage(!0),this.ResetFrameXYSplit(),this.UpdateFrameMaxMin(),this.Draw())}}},this.RemoveIndexWindow=function(t){if(n.JSConsole.Chart.Log("[KLineChartContainer::RemoveIndexWindow] remove id",t),0!=t&&this.Frame.SubFrame&&!(t>=this.Frame.SubFrame.length)){var e=this.Frame.SubFrame[t].Frame;this.DeleteIndexPaint(t),this.Frame.SubFrame.splice(t,1),this.WindowIndex.splice(t,1),this.TitlePaint.splice(t+1,1);for(var a=0;a<this.Frame.SubFrame.length;++a){var i=this.Frame.SubFrame[a].Frame;a==this.Frame.SubFrame.length-1?i.XSplitOperator.ShowText=!0:i.XSplitOperator.ShowText=!1,i.Identify=a}if(this.ChartDrawPicture.length>0){var r=[];for(a=0;a<this.ChartDrawPicture.length;++a){i=this.ChartDrawPicture[a];i.Frame!=e&&r.push(i)}this.ChartDrawPicture=r}this.Frame.SetSizeChage(!0),this.UpdateFrameMaxMin(),this.ResetFrameXYSplit(),this.Draw()}},this.CreateExtendChart=function(t,e){var a;switch(t){case"KLineTooltip":return a=e.Create&&"function"==typeof e.Create?e.Create():new m.JSCommonExtendChartPaint_KLineTooltipPaint,a.Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.HQChart=this,e.LanguageID=this.LanguageID,a.SetOption(e),this.ExtendChartPaint.push(a),a;case"背景图":return a=new m.JSCommonExtendChartPaint_BackgroundPaint,a.Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.HQChart=this,a.SetOption(e),this.ExtendChartPaint.push(a),a;default:return null}},this.LockIndex=function(t){if(t&&t.IndexName)for(var e in this.WindowIndex){var a=this.WindowIndex[e];if(a||conintue,a.Name==t.IndexName){a.SetLock(t),this.Update();break}}},this.TryClickLock=function(t,e){for(var a in this.Frame.SubFrame){var i=this.Frame.SubFrame[a];if(i.Frame.IsLocked&&i.Frame.LockPaint){var r=new k;if(i.Frame.LockPaint.GetTooltipData(t,e,r))return r.HQChart=this,r.Data.Callback&&r.Data.Callback(r),!0}}return!1},this.TryClickIndexTitle=function(t,e){for(var a in this.TitlePaint){var i=this.TitlePaint[a];if(i.IsClickTitle&&i.IsClickTitle(t,e)){var r={Point:{X:t,Y:e},Title:i.Title,FrameID:i.Frame.Identify};n.JSConsole.Chart.Log("[KLineChartContainer::TryClickIndexTitle] click title ",r);var o=this.GetEvent(s.JSCommon_JSCHART_EVENT_ID.ON_CLICK_INDEXTITLE);return o&&o.Callback&&o.Callback(o,r,this),!0}}return!1},this.StopAutoUpdate=function(){this.IsAutoUpdate=!1,this.CancelAutoUpdate(),this.AutoUpdateEvent(!1)},this.Update=function(){if(this.SourceData){this.BeforeBindMainData&&this.BeforeBindMainData("Update");var t=new s.JSCommon_ChartData;if(t.Data=this.SourceData.Data,t.Period=this.Period,t.Right=this.Right,t.DataType=this.SourceData.DataType,t.Symbol=this.Symbol,t.Right>0&&s.JSCommon_ChartData.IsDayPeriod(t.Period,!0)){var e=t.GetRightDate(t.Right);t.Data=e}if(s.JSCommon_ChartData.IsDayPeriod(t.Period,!1)||s.JSCommon_ChartData.IsMinutePeriod(t.Period,!1)){var a=t.GetPeriodData(t.Period);t.Data=a}this.BindMainData(t,this.PageSize),this.AfterBindMainData&&this.AfterBindMainData("Update");for(var i=0;i<this.Frame.SubFrame.length;++i)this.BindIndexData(i,t);if(this.OverlayChartPaint[0].SourceData)if(s.JSCommon_ChartData.IsMinutePeriod(this.Period,!0))this.OverlayChartPaint[0].Data=null;else{t=new s.JSCommon_ChartData;if(t.Data=this.OverlayChartPaint[0].SourceData.Data,t.Period=this.Period,t.Right=this.Right,t.Right>0&&!pt(this.OverlayChartPaint[0].Symbol)){e=t.GetRightDate(t.Right);t.Data=e}var r=this.SourceData.GetOverlayData(t.Data);if(t.Data=r,s.JSCommon_ChartData.IsDayPeriod(t.Period,!1)){a=t.GetPeriodData(t.Period);t.Data=a}this.OverlayChartPaint[0].Data=t}this.ReqeustKLineInfoData(),this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw()}},this.ChangeSymbol=function(t){if(this.CancelAutoUpdate(),this.AutoUpdateEvent(!1),this.Symbol=t,pt(t)&&(this.Right=0),this.Frame&&this.Frame.SubFrame)for(var e=0;e<this.Frame.SubFrame.length;++e)this.DeleteIndexPaint(e);s.JSCommon_ChartData.IsDayPeriod(this.Period,!0)?this.RequestHistoryData():(s.JSCommon_ChartData.IsMinutePeriod(this.Period,!0)||s.JSCommon_ChartData.IsSecondPeriod(this.Period))&&this.ReqeustHistoryMinuteData()},this.ReqeustKLineInfoData=function(){if(this.ChartPaint.length>0){var t=this.ChartPaint[0];t.InfoData=new Map}for(var e in this.ChartInfo)this.ChartInfo[e].RequestData(this)},this.SetKLineInfo=function(t,e){for(var a in this.ChartInfo=[],t){var i=o.JSCommon_JSKLineInfoMap.Get(t[a]);if(i){var r=i.Create();r.MaxReqeustDataCount=this.MaxReqeustDataCount,this.ChartInfo.push(r)}}1==e&&this.ReqeustKLineInfoData()},this.SetPolicyInfo=function(t,e){if(t&&t.length){var a=o.JSCommon_JSKLineInfoMap.Get("策略选股");if(a){var i=a.Create();i.SetPolicyList(t),i.MaxReqeustDataCount=this.MaxReqeustDataCount,this.ChartInfo.push(i),1==e&&this.ReqeustKLineInfoData()}}},this.OverlaySymbol=function(t,e){var a=this.OverlayChartPaint[0];return!!a.MainData&&(a.Symbol=t,e&&a.Color&&(a.Color=e.Color),s.JSCommon_ChartData.IsDayPeriod(this.Period,!0)&&this.RequestOverlayHistoryData(),!0)},this.GetRequestDataCount=function(){var t={MaxRequestDataCount:this.MaxReqeustDataCount,MaxRequestMinuteDayCount:this.MaxRequestMinuteDayCount};if(!this.SourceData||!this.SourceData.Data||this.SourceData.Data.length<=0)return t;if(s.JSCommon_ChartData.IsDayPeriod(this.Period,!0)){var e=this.SourceData.Data.length;e>t.MaxRequestDataCount&&(t.MaxRequestDataCount=e)}else s.JSCommon_ChartData.IsMinutePeriod(this.Period,!0);return t},this.RequestOverlayHistoryData=function(){if(this.OverlayChartPaint.length){var t=this.OverlayChartPaint[0].Symbol;if(t){var e=this,a=this.GetRequestDataCount(),i=this.SourceData.Data[0].Date;if(this.NetworkFilter){var r={Name:"KLineChartContainer::RequestOverlayHistoryData",Explain:"叠加股票日K线数据",Request:{Url:e.KLineApiUrl,Data:{symbol:t,count:a.MaxRequestDataCount,first:{date:i},field:["name","symbol","yclose","open","price","high","vol","amount"]},Type:"POST"},Self:this,PreventDefault:!1};if(this.NetworkFilter(r,(function(t){e.RecvOverlayHistoryData(t)})),1==r.PreventDefault)return}wx.request({url:this.KLineApiUrl,data:{field:["name","symbol","yclose","open","price","high"],symbol:t,start:-1,count:this.MaxReqeustDataCount},method:"POST",dataType:"json",async:!0,success:function(t){e.RecvOverlayHistoryData(t)}})}}},this.RecvOverlayHistoryData=function(t){var e=t.data,a=et.JsonDataToHistoryData(e),i=new s.JSCommon_ChartData;i.Data=a;var r=new s.JSCommon_ChartData;if(r.Data=a,r.Period=this.Period,r.Right=this.Right,r.Right>0&&!pt(e.symbol)){var n=r.GetRightDate(r.Right);r.Data=n}var o=this.SourceData.GetOverlayData(r.Data);if(r.Data=o,s.JSCommon_ChartData.IsDayPeriod(r.Period,!1)){var h=r.GetPeriodData(r.Period);r.Data=h}this.OverlayChartPaint[0].Data=r,this.OverlayChartPaint[0].SourceData=i,this.OverlayChartPaint[0].Title=e.name,this.OverlayChartPaint[0].Symbol=e.symbol,this.Frame.SubFrame[0].Frame.YSplitOperator.CoordinateType=1,this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw()},this.ClearOverlaySymbol=function(){this.OverlayChartPaint[0].Symbol=null,this.OverlayChartPaint[0].Data=null,this.OverlayChartPaint[0].SourceData=null,this.OverlayChartPaint[0].TooltipRect=[],this.Frame.SubFrame[0].Frame.YSplitOperator.CoordinateType=0,this.UpdateFrameMaxMin(),this.Draw()},this.CreateChartDrawPicture=function(t){return!1},this.SetChartDrawPictureFirstPoint=function(t,e){var a=this.CurrentChartDrawPicture;if(!a)return!1;if(!this.Frame.SubFrame||this.Frame.SubFrame.length<=0)return!1;for(var i in this.Frame.SubFrame){var r=this.Frame.SubFrame[i].Frame,n=r.ChartBorder.GetLeft(),s=r.ChartBorder.GetTopEx(),o=r.ChartBorder.GetHeight(),h=r.ChartBorder.GetWidth();if(this.Canvas.rect(n,s,h,o),this.Canvas.isPointInPath(t,e)){a.Frame=r;break}}if(!a.Frame)return!1;a.Point[0]=new g,a.Point[0].X=t-this.UIElement.getBoundingClientRect().left,a.Point[0].Y=e-this.UIElement.getBoundingClientRect().top,a.Status=1},this.SetChartDrawPictureSecondPoint=function(t,e){var a=this.CurrentChartDrawPicture;if(!a)return!1;a.Point[1]=new g,a.Point[1].X=t-this.UIElement.getBoundingClientRect().left,a.Point[1].Y=e-this.UIElement.getBoundingClientRect().top,a.Status=2},this.MoveChartDrawPicture=function(t,e){var a=this.CurrentChartDrawPicture;return!!a&&(a.Move(t,e),!0)},this.FinishChartDrawPicturePoint=function(){var t=this.CurrentChartDrawPicture;return!!t&&(t.PointCount==t.Point.length&&(t.Status=10,t.PointToValue(),this.ChartDrawPicture.push(t),this.CurrentChartDrawPicture=null,!0))},this.FinishMoveChartDrawPicture=function(){var t=this.CurrentChartDrawPicture;return!!t&&(t.PointCount==t.Point.length&&(t.Status=10,t.PointToValue(),this.CurrentChartDrawPicture=null,!0))},this.ClearChartDrawPicture=function(t){if(t)for(var e in this.ChartDrawPicture)this.ChartDrawPicture[e]==t&&(this.ChartDrawPicture.splice(e,1),this.Draw());else this.ChartDrawPicture=[],this.Draw()},this.UpdataChartInfo=function(){var t=new Map;if(0==this.Period)for(var e in this.ChartInfo){var a=this.ChartInfo[e].Data;for(var i in a){var r=a[i];t.has(r.Date.toString())?t.get(r.Date.toString()).Data.push(r):t.set(r.Date.toString(),{Data:new Array(r)})}}else if(s.JSCommon_ChartData.IsDayPeriod(this.Period,!1)){t=new Map;var n=this.ChartPaint[0].Data;if(n&&n.Data&&n.Data.length>0){var o=n.Data[0],h=[];for(var e in this.ChartInfo){var l=this.ChartInfo[e];for(var i in l.Data){r=l.Data[i];r.Date>=o.Date&&h.push(r)}}h.sort((function(t,e){return t.Date-e.Date}));for(e=0;e<n.Data.length;){var u=n.Data[e];if(h.length<=0)break;l=h[0];u.Date<l.Date?++e:(t.has(u.Date.toString())?t.get(u.Date.toString()).Data.push(l):t.set(u.Date.toString(),{Data:new Array(l)}),h.shift())}}}var C=this.ChartPaint[0];C.InfoData=t;var D=this.TitlePaint[0];D&&(D.InfoData=t)},this.UpdateWindowIndex=function(t){var e=new s.JSCommon_ChartData;if(e.Data=this.SourceData.Data,e.Period=this.Period,e.Right=this.Right,this.IsApiPeriod);else{if(e.Right>0){var a=e.GetRightDate(e.Right);e.Data=a}if(s.JSCommon_ChartData.IsDayPeriod(e.Period,!1)||s.JSCommon_ChartData.IsMinutePeriod(e.Period,!1)){var i=e.GetPeriodData(e.Period);e.Data=i}}this.WindowIndex[t].BindData(this,t,e),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()},this.ChangeWindowIndexParam=function(t){this.WindowIndex[t].Index[0].Param+=1,this.WindowIndex[t].Index[1].Param+=1,this.UpdateWindowIndex(t)},this.OnDoubleClick=function(t,e,a){var i=new k;for(var r in this.ChartPaint){var n=this.ChartPaint[r];if(n.GetTooltipData(t,e,i))break}i.Data&&(a.data={Chart:this,Tooltip:i})},this.CancelAutoUpdate=function(){"number"==typeof this.AutoUpdateTimer&&(clearTimeout(this.AutoUpdateTimer),this.AutoUpdateTimer=void 0)},this.AutoUpdate=function(t){if(this.CancelAutoUpdate(),this.IsAutoUpdate&&this.Symbol&&!this.IsDestroy){var e=this,a=h.JSCommonCoordinateData_MARKET_SUFFIX_NAME.GetMarketStatus(this.Symbol);if(0!=a&&3!=a){var i=this.AutoUpdateFrequency;1==a?this.AutoUpdateTimer=setTimeout((function(){e.AutoUpdate()}),i):2==a&&(this.AutoUpdateTimer=setTimeout((function(){s.JSCommon_ChartData.IsDayPeriod(e.Period,!0)?e.RequestRealtimeData():(s.JSCommon_ChartData.IsMinutePeriod(e.Period,!0)||s.JSCommon_ChartData.IsSecondPeriod(e.Period))&&e.RequestMinuteRealtimeData()}),i))}}},this.GetMaxPageSize=function(){var t=this.Frame.ChartBorder.GetWidth(),e=U[U.length-1][0]+U[U.length-1][1],a=parseInt(t/e)-8;return n.JSConsole.Chart.Log("[KLineChartContainer::GetMaxPageSize] width=".concat(t," barWidth=").concat(e," pageSize=").concat(a)),a},this.DragDownloadData=function(){var t=null;if(t=this.Frame.Data?this.Frame.SubFrame[0].Frame.Data:this.Frame.Data,!t)return!1;if(!(t.DataOffset>0))if(s.JSCommon_ChartData.IsMinutePeriod(this.Period,!0)){if(n.JSConsole.Chart.Log("[KLineChartContainer.DragDownloadData] Minute:[Enable=".concat(this.DragDownload.Minute.Enable,", IsEnd=").concat(this.DragDownload.Minute.IsEnd,", Status=").concat(this.DragDownload.Minute.Status,"]")),!this.DragDownload.Minute.Enable)return;if(this.DragDownload.Minute.IsEnd)return;if(0!=this.DragDownload.Minute.Status)return;this.RequestDragMinuteData()}else if(s.JSCommon_ChartData.IsDayPeriod(this.Period,!0)){if(n.JSConsole.Chart.Log("[KLineChartContainer.DragDownloadData] Day:[Enable=".concat(this.DragDownload.Minute.Enable,", IsEnd=").concat(this.DragDownload.Minute.IsEnd,", Status=").concat(this.DragDownload.Minute.Status,"]")),!this.DragDownload.Day.Enable)return;if(this.DragDownload.Day.IsEnd)return;if(0!=this.DragDownload.Day.Status)return;this.RequestDragDayData()}},this.RequestDragMinuteData=function(){var t=this;this.AutoUpdateEvent(!1,"KLineChartContainer::RequestDragMinuteData"),this.CancelAutoUpdate();var e=this.DragDownload.Minute;e.Status=1;var a=this.SourceData.Data[0],i={field:["name","symbol","yclose","open","price","high","low","vol"],symbol:t.Symbol,enddate:a.Date,endtime:a.Time,count:t.MaxRequestMinuteDayCount,first:{date:a.Date,time:a.Time}};if(this.NetworkFilter){var r={Name:"KLineChartContainer::RequestDragMinuteData",Explain:"拖拽1分钟K线数据下载",Request:{Url:this.DragMinuteKLineApiUrl,Type:"POST",Data:i,Period:this.Period},DragDownload:e,Self:this,PreventDefault:!1};if(this.NetworkFilter(r,(function(a){t.RecvDragMinuteData(a),e.Status=0,t.AutoUpdateEvent(!0,"KLineChartContainer::RequestDragMinuteData"),t.AutoUpdate()})),1==r.PreventDefault)return}wx.request({url:this.DragMinuteKLineApiUrl,data:i,method:"POST",dataType:"json",async:!0,success:function(a){t.RecvDragMinuteData(a),e.Status=0,t.AutoUpdateEvent(!0,"KLineChartContainer::RequestDragMinuteData"),t.AutoUpdate()}})},this.RecvDragMinuteData=function(t){var e=t.data,a=et.JsonDataToMinuteHistoryData(e),i=this.GetHistoryDataCount();for(var r in a){var n=a[r];this.SourceData.Data.splice(r,0,n)}var o=new s.JSCommon_ChartData;if(o.Data=this.SourceData.Data,o.Period=this.Period,o.Right=this.Right,o.DataType=this.SourceData.DataType,o.Symbol=this.Symbol,!this.IsApiPeriod&&(s.JSCommon_ChartData.IsDayPeriod(o.Period,!1)||s.JSCommon_ChartData.IsMinutePeriod(o.Period,!1))){var h=o.GetPeriodData(o.Period);o.Data=h}this.UpdateMainData(o,i),this.BindInstructionIndexData(o);for(r=0;r<this.Frame.SubFrame.length;++r)this.BindIndexData(r,o);this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw()},this.RequestDragDayData=function(){var t=this;this.AutoUpdateEvent(!1,"KLineChartContainer::RequestDragDayData"),this.CancelAutoUpdate();var e=this.DragDownload.Day;e.Status=1;var a=this.SourceData.Data[0],i={field:["name","symbol","yclose","open","price","high","low","vol"],symbol:t.Symbol,enddate:a.Date,count:t.MaxReqeustDataCount,first:{date:a.Date}};if(this.NetworkFilter){var r={Name:"KLineChartContainer::RequestDragDayData",Explain:"拖拽日K数据下载",Request:{Url:this.DragKLineApiUrl,Type:"POST",Data:i,Period:this.Period,Right:this.Right},DragDownload:e,Self:this,PreventDefault:!1};if(this.NetworkFilter(r,(function(a){t.RecvDragDayData(a),e.Status=0,t.AutoUpdateEvent(!0,"KLineChartContainer::RequestDragDayData"),t.AutoUpdate()})),1==r.PreventDefault)return}wx.request({url:this.DragKLineApiUrl,data:i,method:"POST",dataType:"json",async:!0,success:function(a){t.RecvDragDayData(a),e.Status=0,t.AutoUpdateEvent(!0,"KLineChartContainer::RequestDragDayData"),t.AutoUpdate()}})},this.RecvDragDayData=function(t){var e=t.data,a=et.JsonDataToHistoryData(e);if(!a||a.length<=0)this.DragDownload.Day.IsEnd=!0;else{var i=this.GetHistoryDataCount();for(var r in a){var n=a[r];this.SourceData.Data.splice(r,0,n)}var o=new s.JSCommon_ChartData;if(o.Data=this.SourceData.Data,o.Period=this.Period,o.Right=this.Right,o.DataType=this.SourceData.DataType,o.Symbol=this.Symbol,!this.IsApiPeriod&&(s.JSCommon_ChartData.IsDayPeriod(o.Period,!1)||s.JSCommon_ChartData.IsMinutePeriod(o.Period,!1))){var h=o.GetPeriodData(o.Period);o.Data=h}this.UpdateMainData(o,i),this.BindInstructionIndexData(o);for(r=0;r<this.Frame.SubFrame.length;++r)this.BindIndexData(r,o);this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw()}},this.SetCustomVerical=function(t,e){if(this.Frame&&!(t>=this.Frame.SubFrame.length)){var a=this.Frame.SubFrame[t];a.Frame&&(a.Frame.CustomVerticalInfo=e)}},this.OnSize=function(){if(this.Frame&&this.Frame.OnSize){var t=this.Frame.OnSize();this.Frame.SetSizeChage(!0),t.Changed&&(this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin()),this.Draw()}}}function at(t){this.newMethod=F,this.newMethod(t),delete this.newMethod,this.ClassName="MinuteChartContainer",this.WindowIndex=new Array,this.Symbol,this.Name,this.SourceData,this.OverlaySourceData,this.IsAutoUpdate=!1,this.AutoUpdateFrequency=3e4,this.AutoUpdateTimer,this.TradeDate=0,this.LoadDataSplashTitle="下载分钟数据",this.UpdateUICallback,this.DayCount=1,this.DayData,this.MinuteApiUrl=c.JSCommonResource_Global_JSChartResource.Domain+"/API/Stock",this.HistoryMinuteApiUrl=c.JSCommonResource_Global_JSChartResource.Domain+"/API/StockMinuteData",this.ontouchstart=function(t){var e=this;if(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){this.IsOnTouch=!0;var a=this;if(0!=a.DragMode&&this.IsPhoneDragging(t)){if(a.TryClickLock){var i=this.GetToucheData(t,a.IsForceLandscape),r=i[0].clientX,n=i[0].clientY;if(a.TryClickLock(r,n))return}this.ClearTouchTimer();var s={Click:{},LastMove:{}};i=this.GetToucheData(t,a.IsForceLandscape);s.Click.X=i[0].clientX,s.Click.Y=i[0].clientY,s.LastMove.X=i[0].clientX,s.LastMove.Y=i[0].clientY;var o=function(){if(!0===e.ChartCorssCursor.IsShow){var i=s.Click.X,r=s.Click.Y;a.IsForceLandscape&&(r=a.UIElement.Height-s.Click.Y),a.OnMouseMove(i,r,t)}};1==this.EnableScrollUpDown&&(this.TouchTimer=setTimeout((function(){e.MouseDrag=null,o()}),800)),this.MouseDrag=s,0==this.EnableScrollUpDown&&o()}}},this.ontouchmove=function(t){var e=this;if(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){var a=this,i=a.MouseDrag,r=this.GetToucheData(t,a.IsForceLandscape);if(!0===this.ChartCorssCursor.IsShow&&this.IsPhoneDragging(t)&&null==i){var n=r[0].clientX,s=r[0].clientY;if(this.LastMovePoint={X:n,Y:s},this.DrawMoveTimer)return;this.DrawMoveTimer=setTimeout((function(){e.LastMovePoint&&(e.OnMouseMove(e.LastMovePoint.X,e.LastMovePoint.Y,t),e.DrawMoveTimer=null)}),this.DrawMoveWaitTime)}if(null!=i){this.ClearTouchTimer(),this.MouseDrag=null;n=r[0].clientX,s=r[0].clientY;this.OnMouseMove(n,s,t)}}},this.Create=function(t){for(var e in this.UIElement.JSChartContainer=this,this.ChartCorssCursor=new D.JSCommonChartPaint_ChartCorssCursor,this.ChartCorssCursor.Canvas=this.Canvas,this.ChartCorssCursor.StringFormatX=new $,this.ChartCorssCursor.StringFormatY=new q,this.ChartCorssCursor.StringFormatY.LanguageID=this.LanguageID,this.ChartSplashPaint=new D.JSCommonChartPaint_ChartSplashPaint,this.ChartSplashPaint.Canvas=this.Canvas,this.ChartSplashPaint.SplashTitle=this.LoadDataSplashTitle,this.ChartSplashPaint.HQChart=this,this.Frame=new G,this.Frame.ChartBorder=new N,this.Frame.ChartBorder.UIElement=this.UIElement,this.Frame.ChartBorder.Top=25,this.Frame.ChartBorder.Left=50,this.Frame.ChartBorder.Bottom=20,this.Frame.Canvas=this.Canvas,this.ChartCorssCursor.Frame=this.Frame,this.ChartSplashPaint.Frame=this.Frame,this.CreateChildWindow(t),this.CreateMainKLine(),this.Frame.SubFrame){var a=new I.JSCommonChartTitle_DynamicChartTitlePainting;a.Frame=this.Frame.SubFrame[e].Frame,a.Canvas=this.Canvas,a.LanguageID=this.LanguageID,this.TitlePaint.push(a)}this.ChartCorssCursor.StringFormatX.Frame=this.Frame.SubFrame[0].Frame},this.CreateChildWindow=function(t){for(var e=this,a=0;a<t;++a){var i=new N;i.UIElement=this.UIElement;var r=new B;r.Canvas=this.Canvas,r.ChartBorder=i,r.Identify=a,a<2&&(r.ChartBorder.TitleHeight=0),r.XPointCount=243;var n=[9,8,7,6,5,4,3,2,1];for(var s in r.HorizontalMax=n[0],r.HorizontalMin=n[n.length-1],0==a?(r.YSplitOperator=new d.JSCommonSplit_FrameSplitMinutePriceY,r.YSplitOperator.FrameSplitData=this.FrameSplitData.get("price"),r.YSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)}):(r.YSplitOperator=new d.JSCommonSplit_FrameSplitY,r.YSplitOperator.FrameSplitData=this.FrameSplitData.get("double"),r.YSplitOperator.LanguageID=this.LanguageID,r.YSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)}),r.YSplitOperator.Frame=r,r.YSplitOperator.ChartBorder=i,r.XSplitOperator=new d.JSCommonSplit_FrameSplitMinuteX,r.XSplitOperator.Frame=r,r.XSplitOperator.ChartBorder=i,a!=t-1&&(r.XSplitOperator.ShowText=!1),r.XSplitOperator.Operator(),n)r.HorizontalInfo[s]=new d.JSCommonSplit_CoordinateInfo,r.HorizontalInfo[s].Value=n[s],0==a&&s==r.HorizontalMin||(r.HorizontalInfo[s].Message[1]=n[s].toString(),r.HorizontalInfo[s].Font="14px 微软雅黑");var o=new b;o.Frame=r,o.Height=0==a?20:10,this.Frame.SubFrame[a]=o}},this.CreateSubFrameItem=function(t){var e=this,a=new N;a.UIElement=this.UIElement;var i=new B;i.Canvas=this.Canvas,i.ChartBorder=a,i.Identify=t,i.XPointCount=243,t>=2&&(this.ModifyIndexDialog&&(i.ModifyIndexEvent=this.ModifyIndexDialog.DoModal),this.ChangeIndexDialog&&(i.ChangeIndexEvent=this.ChangeIndexDialog.DoModal));var r=[9,8,7,6,5,4,3,2,1];i.HorizontalMax=r[0],i.HorizontalMin=r[r.length-1],i.YSplitOperator=new d.JSCommonSplit_FrameSplitY,i.YSplitOperator.LanguageID=this.LanguageID,i.YSplitOperator.FrameSplitData=this.FrameSplitData.get("double"),i.YSplitOperator.Frame=i,i.YSplitOperator.ChartBorder=a,i.XSplitOperator=new d.JSCommonSplit_FrameSplitMinuteX,i.XSplitOperator.Frame=i,i.XSplitOperator.ChartBorder=a,i.XSplitOperator.ShowText=!1,i.XSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)},i.YSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)};var n=this.Frame.SubFrame[0].Frame.XPointCount;for(var s in i.XPointCount=n,i.Data=this.ChartPaint[0].Data,r)i.HorizontalInfo[s]=new d.JSCommonSplit_CoordinateInfo,i.HorizontalInfo[s].Value=r[s],i.HorizontalInfo[s].Message[1]=r[s].toString(),i.HorizontalInfo[s].Font="14px 微软雅黑";var o=new b;return o.Frame=i,o.Height=10,o},this.UpdateXShowText=function(){for(var t=!0,e=this.Frame.SubFrame.length-1;e>=0;--e){var a=this.Frame.SubFrame[e].Frame,i=this.Frame.SubFrame[e];t?(a.XSplitOperator.ShowText=!0,i.Height>0&&(t=!1)):a.XSplitOperator.ShowText=!1}},this.DeleteIndexPaint=function(t){var e=new Array;for(var a in this.ChartPaint){var i=this.ChartPaint[a];0!=a&&i.ChartFrame==this.Frame.SubFrame[t].Frame||e.push(i)}this.Frame.SubFrame[t].Frame.YSpecificMaxMin=null,this.Frame.SubFrame[t].Frame.IsLocked=!1,this.ChartPaint=e;var r=t+1;this.TitlePaint[r].Data=[],this.TitlePaint[r].Title=null},this.CreateStockInfo=function(){this.ExtendChartPaint[0]=new StockInfoExtendChartPaint,this.ExtendChartPaint[0].Canvas=this.Canvas,this.ExtendChartPaint[0].ChartBorder=this.Frame.ChartBorder,this.ExtendChartPaint[0].ChartFrame=this.Frame,this.Frame.ChartBorder.Right=300},this.CreateMainKLine=function(){var t=new D.JSCommonChartPaint_ChartMinutePriceLine;t.Canvas=this.Canvas,t.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,t.ChartFrame=this.Frame.SubFrame[0].Frame,t.Name="Minute-Line",t.Color=c.JSCommonResource_Global_JSChartResource.Minute.PriceColor,t.AreaColor=c.JSCommonResource_Global_JSChartResource.Minute.AreaPriceColor,this.ChartPaint[0]=t;var e=new D.JSCommonChartPaint_ChartMinutePriceLine;e.Canvas=this.Canvas,e.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,e.ChartFrame=this.Frame.SubFrame[0].Frame,e.Name="Minute-Average-Line",e.Color=c.JSCommonResource_Global_JSChartResource.Minute.AvPriceColor,e.IsDrawArea=!1,this.ChartPaint[1]=e;var a=new D.JSCommonChartPaint_ChartMinuteVolumBar;a.Color=c.JSCommonResource_Global_JSChartResource.Minute.VolBarColor,a.Canvas=this.Canvas,a.ChartBorder=this.Frame.SubFrame[1].Frame.ChartBorder,a.ChartFrame=this.Frame.SubFrame[1].Frame,a.Name="Minute-Vol-Bar",this.ChartPaint[2]=a;var i=new D.JSCommonChartPaint_ChartSubLine;i.Color=c.JSCommonResource_Global_JSChartResource.Minute.PriceColor,i.Canvas=this.Canvas,i.ChartBorder=this.Frame.SubFrame[1].Frame.ChartBorder,i.ChartFrame=this.Frame.SubFrame[1].Frame,i.Name="Minute-Position-Line",this.ChartPaint[3]=i,this.TitlePaint[0]=new I.JSCommonChartTitle_DynamicMinuteTitlePainting,this.TitlePaint[0].Frame=this.Frame.SubFrame[0].Frame,this.TitlePaint[0].Canvas=this.Canvas,this.TitlePaint[0].LanguageID=this.LanguageID;var r=new X;r.Canvas=this.Canvas,r.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,r.ChartFrame=this.Frame.SubFrame[0].Frame,r.Name="Overlay-Minute",this.OverlayChartPaint[0]=r},this.ChangeScriptIndex=function(t,e){this.DeleteIndexPaint(t),this.WindowIndex[t]=new S.JSCommonIndex_ScriptIndex(e.Name,e.Script,e.Args,e);var a=this.SourceData;this.BindIndexData(t,a),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()},this.ChangeIndex=function(t,e,a){if(!(this.Frame.SubFrame.length<3)){var i=new u.JSCommonIndexScript.JSIndexScript,r=i.Get(e);if(r){t<2&&(t=2),t>=this.Frame.SubFrame.length&&(t=2);var n={Name:r.Name,Script:r.Script,Args:r.Args,ID:e,KLineType:r.KLineType,YSpecificMaxMin:r.YSpecificMaxMin,YSplitScale:r.YSplitScale,FloatPrecision:r.FloatPrecision,Condition:r.Condition,StringFormat:r.StringFormat};return a&&(a.FloatPrecision>=0&&(n.FloatPrecision=a.FloatPrecision),a.StringFormat>0&&(n.StringFormat=a.StringFormat),a.Args&&(n.Args=a.Args)),this.ChangeScriptIndex(t,n)}}},this.RemoveIndexWindow=function(t){if(n.JSConsole.Chart.Log("[MinuteChartContainer::RemoveIndexWindow] remove id",t),!(t<2)&&this.Frame.SubFrame&&!(t>=this.Frame.SubFrame.length)){this.Frame.SubFrame[t].Frame;this.DeleteIndexPaint(t),this.Frame.SubFrame.splice(t,1),this.WindowIndex.splice(t,1),this.TitlePaint.splice(t+1,1);for(var e=0;e<this.Frame.SubFrame.length;++e){var a=this.Frame.SubFrame[e].Frame;e==this.Frame.SubFrame.length-1?a.XSplitOperator.ShowText=!0:a.XSplitOperator.ShowText=!1,a.Identify=e}this.Frame.SetSizeChage(!0),this.UpdateFrameMaxMin(),this.ResetFrameXYSplit(),this.Draw()}},this.ChangeSymbol=function(t){this.Symbol=t,this.CancelAutoUpdate(),this.ChartSplashPaint.SetTitle(this.LoadDataSplashTitle),this.ChartSplashPaint.EnableSplash(!0),this.RequestData()},this.ChangeDayCount=function(t){t<0||t>10||(this.DayCount=t,this.CancelAutoUpdate(),this.RequestData())},this.OverlaySymbol=function(t,e){var a=this.OverlayChartPaint[0];return!!a.MainData&&(a.Symbol=t,e&&e.Color&&(a.Color=e.Color),this.DayCount<=1?this.RequestOverlayMinuteData():this.RequestOverlayHistoryMinuteData(),!0)},this.TryClickLock=function(t,e){for(var a in this.Frame.SubFrame){var i=this.Frame.SubFrame[a];if(i.Frame.IsLocked&&i.Frame.LockPaint){var r=new k;if(i.Frame.LockPaint.GetTooltipData(t,e,r))return r.HQChart=this,r.Data.Callback&&r.Data.Callback(r),!0}}return!1},this.RequestData=function(){this.DayCount<=1?this.RequestMinuteData():this.RequestHistoryMinuteData()},this.RecvMinuteDataEvent=function(){if(this.mapEvent.has(s.JSCommon_JSCHART_EVENT_ID.RECV_MINUTE_DATA)){var t=this.mapEvent.get(s.JSCommon_JSCHART_EVENT_ID.RECV_MINUTE_DATA),e={MinuteData:this.SourceData,Stock:{Symbol:this.Symbol,Name:this.Name}};t.Callback(t,e,this)}},this.RequestHistoryMinuteData=function(){var t=this;if(this.ChartSplashPaint.SetTitle(this.LoadDataSplashTitle),this.ChartSplashPaint.EnableSplash(!0),this.Draw(),this.NetworkFilter){var e={Name:"MinuteChartContainer::RequestHistoryMinuteData",Explain:"多日分时数据",Request:{Url:t.HistoryMinuteApiUrl,Data:{daycount:t.DayCount,symbol:t.Symbol},Type:"POST"},Self:this,PreventDefault:!1};if(this.NetworkFilter(e,(function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvHistoryMinuteData(e)})),1==e.PreventDefault)return}wx.request({url:t.HistoryMinuteApiUrl,data:{symbol:t.Symbol,daycount:t.DayCount},method:"post",dataType:"json",success:function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvHistoryMinuteData(e)}})},this.RecvHistoryMinuteData=function(t){var e=t.data;0==e.code?(this.DayData=at.JsonDataToMinuteDataArray(e),this.Symbol=e.symbol,this.Name=e.name,this.UpdateHistoryMinuteUI(),this.RecvMinuteDataEvent(),this.RequestOverlayHistoryMinuteData(),"function"==typeof this.UpdateUICallback&&this.UpdateUICallback("RecvHistoryMinuteData",this),this.AutoUpdate()):n.JSConsole.Chart.Log("[MinuteChartContainer::RecvHistoryMinuteData] failed.",e)},this.UpdateHistoryMinuteUI=function(){var t=this.HistoryMinuteDataToArray(this.DayData),e=new s.JSCommon_ChartData;if(e.Data=t,this.SourceData=e,this.TradeDate=this.DayData[0].Date,this.BindMainData(e,this.DayData[0].YClose),this.Frame.SubFrame.length>2){var a=new s.JSCommon_ChartData;a.Data=t;for(var i=2;i<this.Frame.SubFrame.length;++i)this.BindIndexData(i,a)}for(var r in this.Frame.SubFrame){var n=this.Frame.SubFrame[r];n.Frame.XSplitOperator.Symbol=this.Symbol,n.Frame.XSplitOperator.DayCount=this.DayData.length,n.Frame.XSplitOperator.DayData=this.DayData,n.Frame.XSplitOperator.Operator(),n.Frame.YSplitOperator.Symbol=this.Symbol}this.ChartCorssCursor.StringFormatY.Symbol=this.Symbol,this.ChartCorssCursor.StringFormatX.Symbol=this.Symbol,this.TitlePaint[0].IsShowDate=!0,this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw()},this.HistoryMinuteDataToArray=function(t){for(var e=[],a=t.length-1;a>=0;--a){var i=t[a];for(var r in i.Data)e.push(i.Data[r])}return e},this.UpdateLatestMinuteData=function(t,e){for(var a in this.DayData){var i=this.DayData[a];if(i.Date===e){i.Data=t;break}}},this.RequestMinuteData=function(){var t=this,e=["name","symbol","yclose","open","price","high","low","vol","amount","date","time","minute","minutecount"],a=this.Symbol.toUpperCase();if(h.JSCommonCoordinateData_MARKET_SUFFIX_NAME.IsChinaFutures(a)&&(e.push("clearing"),e.push("yclearing")),this.NetworkFilter){var i={Name:"MinuteChartContainer::RequestMinuteData",Explain:"最新分时数据",Request:{Url:t.MinuteApiUrl,Data:{field:e,symbol:[t.Symbol]},Type:"POST"},Self:this,PreventDefault:!1};if(this.NetworkFilter(i,(function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvMinuteData(e)})),1==i.PreventDefault)return}wx.request({url:this.MinuteApiUrl,data:{field:e,symbol:[this.Symbol],start:-1},method:"post",dataType:"json",success:function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvMinuteData(e)}})},this.RecvMinuteData=function(t){var e=at.JsonDataToMinuteData(t.data);if(this.DayCount>1)return this.UpdateLatestMinuteData(e,t.data.stock[0].date),this.UpdateHistoryMinuteUI(),this.RecvMinuteDataEvent(),this.RequestOverlayMinuteData(),"function"==typeof this.UpdateUICallback&&this.UpdateUICallback("RecvMinuteData",this),void this.AutoUpdate();var a=new s.JSCommon_ChartData;a.Data=e,this.TradeDate=t.data.stock[0].date,this.SourceData=a,this.Symbol=t.data.stock[0].symbol,this.Name=t.data.stock[0].name;var i=t.data.stock[0].yclose,r=this.Symbol.toUpperCase(),n=h.JSCommonCoordinateData_MARKET_SUFFIX_NAME.IsFutures(r);t.data.stock[0].yclearing&&n&&(i=t.data.stock[0].yclearing);var o={High:t.data.stock[0].high,Low:t.data.stock[0].low};for(var l in this.BindMainData(a,i,o),this.Frame.SubFrame){var u=this.Frame.SubFrame[l];u.Frame.XSplitOperator.Symbol=this.Symbol,u.Frame.XSplitOperator.DayCount=1,u.Frame.XSplitOperator.Operator(),u.Frame.YSplitOperator.Symbol=this.Symbol}if(this.Frame.SubFrame.length>2){var C=new s.JSCommon_ChartData;C.Data=e;for(var D=2;D<this.Frame.SubFrame.length;++D)this.BindIndexData(D,C)}this.ChartCorssCursor.StringFormatY.Symbol=this.Symbol,this.ChartCorssCursor.StringFormatX.Symbol=this.Symbol;var m=this.GetChartMinuteInfo();m&&(m.SourceData=this.SourceData),this.RecvMinuteDataEvent(),this.RequestMinuteInfoData(),this.RequestOverlayMinuteData(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),"function"==typeof this.UpdateUICallback&&this.UpdateUICallback("RecvMinuteData",this),this.AutoUpdate()},this.RequestOverlayMinuteData=function(){if(this.OverlayChartPaint.length){var t=this.OverlayChartPaint[0].Symbol;if(t){var e=this,a=this.TradeDate;if(this.NetworkFilter){var i={Name:"MinuteChartContainer::RequestOverlayMinuteData",Explain:"叠加股票最新分时数据",Request:{Url:e.HistoryMinuteApiUrl,Data:{days:[a],symbol:t},Type:"POST"},Self:this,PreventDefault:!1};if(this.NetworkFilter(i,(function(t){e.RecvOverlayMinuteData(t)})),1==i.PreventDefault)return}wx.request({url:e.HistoryMinuteApiUrl,data:{symbol:t,days:[a]},method:"post",dataType:"json",success:function(t){e.RecvOverlayMinuteData(t)}})}}},this.RecvOverlayMinuteData=function(t){var e,a=t.data,i=at.JsonDataToMinuteDataArray(a),r=null;if(this.DayCount>1){if(i.length<=0)return;var n=i[0];for(var o in this.OverlaySourceData){var h=this.OverlaySourceData[o];if(h.Date==n.Date){this.OverlaySourceData[o]=n;var l=this.HistoryMinuteDataToArray(this.OverlaySourceData);r=new s.JSCommon_ChartData;r.Data=l,e=n.YClose;break}}if(null==r)return}else r=i.length>0?i[0]:new s.JSCommon_ChartData,e=r.YClose;this.OverlayChartPaint[0].Data=r,this.OverlayChartPaint[0].Title=a.name,this.OverlayChartPaint[0].Symbol=a.symbol,this.OverlayChartPaint[0].YClose=e,this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),"function"==typeof this.UpdateUICallback&&this.UpdateUICallback("RecvOverlayMinuteData",this)},this.RequestOverlayHistoryMinuteData=function(){if(this.OverlayChartPaint.length){var t=this.OverlayChartPaint[0].Symbol;if(t){var e=this,a=[];for(var i in this.DayData){var r=this.DayData[i];a.push(r.Date)}if(!(a.length<=0)){if(this.NetworkFilter){var n={Name:"MinuteChartContainer::RequestOverlayHistoryMinuteData",Explain:"叠加股票多日分时数据",Request:{Url:e.HistoryMinuteApiUrl,Data:{days:a,symbol:t},Type:"POST"},Self:this,PreventDefault:!1};if(this.NetworkFilter(n,(function(t){e.RecvOverlayHistoryMinuteData(t)})),1==n.PreventDefault)return}wx.request({url:e.HistoryMinuteApiUrl,data:{symbol:t,days:a},method:"post",dataType:"json",async:!0,success:function(t){e.RecvOverlayHistoryMinuteData(t)}})}}}},this.RecvOverlayHistoryMinuteData=function(t){var e=t.data,a=at.JsonDataToMinuteDataArray(e),i=[];for(var r in this.DayData){var n=this.DayData[r],o=!1;for(var h in a)if(n.Date==a[h].Date){i.push(a[r]),o=!0;break}if(!o){var l=new s.JSCommon_ChartData;l.Date=n.Date}}this.OverlaySourceData=i;var u=this.HistoryMinuteDataToArray(i),C=new s.JSCommon_ChartData;C.Data=u;var D=i[0].YClose;this.OverlayChartPaint[0].Data=C,this.OverlayChartPaint[0].Title=e.name,this.OverlayChartPaint[0].Symbol=e.symbol,this.OverlayChartPaint[0].YClose=D,this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),"function"==typeof this.UpdateUICallback&&this.UpdateUICallback("RecvOverlayHistoryMinuteData",this)},this.CancelAutoUpdate=function(){"number"==typeof this.AutoUpdateTimer&&(clearTimeout(this.AutoUpdateTimer),this.AutoUpdateTimer=void 0)},this.AutoUpdate=function(){if(this.CancelAutoUpdate(),this.IsAutoUpdate&&this.Symbol&&!this.IsDestroy){var t=this,e=h.JSCommonCoordinateData_MARKET_SUFFIX_NAME.GetMarketStatus(this.Symbol);if(0!=e&&3!=e){var a=this.AutoUpdateFrequency;1==e?this.AutoUpdateTimer=setTimeout((function(){t.AutoUpdate()}),a):2==e&&(this.AutoUpdateTimer=setTimeout((function(){t.RequestMinuteData()}),a))}}},this.StopAutoUpdate=function(){this.CancelAutoUpdate(),this.IsAutoUpdate=!1},this.BindIndexData=function(t,e){this.WindowIndex[t]&&("function"!=typeof this.WindowIndex[t].RequestData?"function"!=typeof this.WindowIndex[t].ExecuteScript?this.WindowIndex[t].BindData(this,t,e):this.WindowIndex[t].ExecuteScript(this,t,e):this.WindowIndex[t].RequestData(this,t,e))},this.BindMainData=function(t,e,a){var i=new s.JSCommon_ChartData;i.Data=t.GetClose(),this.ChartPaint[0].Data=i,this.ChartPaint[0].YClose=e,this.ChartPaint[0].NotSupportMessage=null,this.Frame.SubFrame[0].Frame.YSplitOperator.YClose=e,this.Frame.SubFrame[0].Frame.YSplitOperator.Data=i,i=new s.JSCommon_ChartData,i.Data=t.GetMinuteAvPrice(),this.ChartPaint[1].Data=i,this.Frame.SubFrame[0].Frame.YSplitOperator.AverageData=i,this.Frame.SubFrame[0].Frame.YSplitOperator.OverlayChartPaint=this.OverlayChartPaint,a&&(this.Frame.SubFrame[0].Frame.YSplitOperator.High=a.High,this.Frame.SubFrame[0].Frame.YSplitOperator.Low=a.Low),this.ChartPaint[2].Data=t,this.ChartPaint[2].YClose=e;var r=this.Symbol.toUpperCase(),n=h.JSCommonCoordinateData_MARKET_SUFFIX_NAME.IsChinaFutures(r),o=h.JSCommonCoordinateData_MARKET_SUFFIX_NAME.IsSHO(r);this.ChartPaint[3].Data.Data=n||o?t.GetPosition():null,this.TitlePaint[0].Data=this.SourceData,this.TitlePaint[0].Symbol=this.Symbol,this.TitlePaint[0].Name=this.Name,this.TitlePaint[0].YClose=e,this.ChartCorssCursor&&this.ChartCorssCursor.StringFormatY&&(this.ChartCorssCursor.StringFormatY.YClose=e,this.ChartCorssCursor.StringFormatX.Data=this.ChartPaint[0].Data),this.ExtendChartPaint[0]&&(this.ExtendChartPaint[0].Symbol=this.Symbol,this.ExtendChartPaint[0].Name=this.Name),this.OverlayChartPaint[0].MainData=this.ChartPaint[0].Data,this.OverlayChartPaint[0].MainYClose=e},this.GetChartPaint=function(t){var e=new Array;for(var a in this.ChartPaint)if(!(a<3)){var i=this.ChartPaint[a];i.ChartFrame==this.Frame.SubFrame[t].Frame&&e.push(i)}return e},this.CreateWindowIndex=function(t){this.WindowIndex[t].Create(this,t)},this.CreateExtendChart=function(t,e){var a;switch(t){case"MinuteTooltip":return a=new m.JSCommonExtendChartPaint_MinuteTooltipPaint,a.Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.HQChart=this,e.LanguageID=this.LanguageID,a.SetOption(e),this.ExtendChartPaint.push(a),a;default:return null}},this.SetMinuteInfo=function(t,e){for(var a in this.ChartInfo=[],t){var i=o.JSCommon_JSMinuteInfoMap.Get(t[a]);if(i){var r=i.Create();this.ChartInfo.push(r)}}1==e&&this.RequestMinuteInfoData()},this.GetChartMinuteInfo=function(){return this.ChartInfoPaint},this.CreateMinuteInfo=function(t){var e=new D.JSCommonChartPaint_ChartMinuteInfo;return e.Canvas=this.Canvas,e.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,e.ChartFrame=this.Frame.SubFrame[0].Frame,e.ChartMinutePrice=this.ChartPaint[0],t&&e.SetOption&&e.SetOption(t),this.ChartInfoPaint=e,e},this.RequestMinuteInfoData=function(){if(!(this.ChartInfo.length<=0)){var t=this.GetChartMinuteInfo();for(var e in t||(t=this.CreateMinuteInfo(null)),t.SourceData=this.SourceData,this.ChartInfo)this.ChartInfo[e].RequestData(this)}},this.UpdataChartInfo=function(){var t=this.GetChartMinuteInfo();if(t){var e=new Map;for(var a in this.ChartInfo){var i=this.ChartInfo[a].Data;for(var r in i){var n=i[r],s="".concat(n.Date," ").concat(n.Time);e.has(s)?e.get(s).Data.push(n):e.set(s,{Data:new Array(n)})}}t.Data=e}}}function it(t){this.newMethod=at,this.newMethod(t),delete this.newMethod,this.HistoryMinuteApiUrl="https://opensourcecache.zealink.com/cache/minuteday/day/",this.CreateMainKLine=function(){var t=new D.JSCommonChartPaint_ChartMinutePriceLine;t.Canvas=this.Canvas,t.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,t.ChartFrame=this.Frame.SubFrame[0].Frame,t.Name="Minute-Line",t.Color=c.JSCommonResource_Global_JSChartResource.Minute.PriceColor,this.ChartPaint[0]=t;var e=new D.JSCommonChartPaint_ChartLine;e.Canvas=this.Canvas,e.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,e.ChartFrame=this.Frame.SubFrame[0].Frame,e.Name="Minute-Average-Line",e.Color=c.JSCommonResource_Global_JSChartResource.Minute.AvPriceColor,this.ChartPaint[1]=e;e=new D.JSCommonChartPaint_ChartMinuteVolumBar;e.Color=c.JSCommonResource_Global_JSChartResource.Minute.VolBarColor,e.Canvas=this.Canvas,e.ChartBorder=this.Frame.SubFrame[1].Frame.ChartBorder,e.ChartFrame=this.Frame.SubFrame[1].Frame,e.Name="Minute-Vol-Bar",this.ChartPaint[2]=e,this.TitlePaint[0]=new I.JSCommonChartTitle_DynamicMinuteTitlePainting,this.TitlePaint[0].Frame=this.Frame.SubFrame[0].Frame,this.TitlePaint[0].Canvas=this.Canvas,this.TitlePaint[0].IsShowDate=!0},this.ChangeTradeDate=function(t){t&&(this.TradeDate=t,this.RequestData())},this.RequestData=function(){var t=new Date,e=1e4*t.getFullYear()+100*(t.getMonth()+1)+t.getDate();e==this.TradeDate?this.RequestMinuteData():this.RequestHistoryMinuteData()},this.RequestHistoryMinuteData=function(){var t=this,e=this.HistoryMinuteApiUrl+this.TradeDate.toString()+"/"+this.Symbol+".json";wx.request({url:e,method:"get",dataType:"json",success:function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvHistoryMinuteData(e)},error:function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvHistoryMinuteError(e)}})},this.RecvHistoryMinuteError=function(t){if(404==t.status){var e=new s.JSCommon_ChartData;for(var a in this.SourceData=e,this.ChartPaint)this.ChartPaint[a].Data=e,0==a&&(this.ChartPaint[a].NotSupportMessage="没有权限访问!");this.TitlePaint[0].Data=this.SourceData,this.TitlePaint[0].Symbol=this.Symbol,this.TitlePaint[0].Name=null,this.Draw()}},this.RecvHistoryMinuteData=function(t){if(200!=t.statusCode){var e=new s.JSCommon_ChartData;for(var a in this.SourceData=e,this.ChartPaint)this.ChartPaint[a].Data=e,0==a&&(this.ChartPaint[a].NotSupportMessage="没有权限访问!");return this.TitlePaint[0].Data=this.SourceData,this.TitlePaint[0].Symbol=this.Symbol,this.TitlePaint[0].Name=null,void this.Draw()}var i=t.data,r=it.JsonDataToMinuteData(i);e=new s.JSCommon_ChartData;if(e.Data=r,this.TradeDate=i.date,this.SourceData=e,this.Symbol=i.symbol,this.Name=i.name,this.BindMainData(e,i.day.yclose),this.Frame.SubFrame.length>2){var n=new s.JSCommon_ChartData;n.Data=r;for(a=2;a<this.Frame.SubFrame.length;++a)this.BindIndexData(a,n)}this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw()}}function rt(t){this.newMethod=et,this.newMethod(t),delete this.newMethod,this.ClassName="CustomKLineChartContainer",this.ChangeRight=null,this.LoadDataSplashTitle="计算指数数据",this.CustomKLineApiUrl=c.JSCommonResource_Global_JSChartResource.Domain+"/API/IndexCalculate",this.CustomStock,this.QueryDate={Start:20180101,End:20180627},this.RequestHistoryData=function(){var t=this;this.ChartSplashPaint.SetTitle(this.LoadDataSplashTitle),this.ChartSplashPaint.EnableSplash(!0),this.Draw(),wx.request({url:this.CustomKLineApiUrl,data:{stock:t.CustomStock,Name:t.Symbol,date:{startdate:t.QueryDate.Start,enddate:t.QueryDate.End}},method:"POST",dataType:"json",async:!0,success:function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvHistoryData(e)}})},this.RecvHistoryData=function(t){var e=t.data,a=et.JsonDataToHistoryData(e),i=new s.JSCommon_ChartData;i.Data=a,i.DataType=0,i.Symbol=e.symbol;var r=new s.JSCommon_ChartData;if(r.Data=a,r.Right=0,r.Period=this.Period,r.DataType=0,r.Symbol=e.symbol,s.JSCommon_ChartData.IsDayPeriod(this.Period,!1)){var n=i.GetPeriodData(r.Period);r.Data=n}this.SourceData=i,this.Name=e.name,this.BindMainData(r,this.PageSize);for(var o=0;o<this.Frame.SubFrame.length;++o)this.BindIndexData(o,r);this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),"function"==typeof this.UpdateUICallback&&this.UpdateUICallback("RecvHistoryData",this)}}function nt(t){this.newMethod=et,this.newMethod(t),delete this.newMethod,this.ClassName="KLineChartHScreenContainer",this.OnMouseMove=function(t,e,a){this.LastPoint.X=t,this.LastPoint.Y=e,this.CursorIndex=this.Frame.GetXData(e),this.DrawDynamicInfo()},this.ontouchstart=function(t){if(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){var e=this;if(0!=e.DragMode)if(e.IsOnTouch=!0,e.PhonePinch=null,this.IsPhoneDragging(t)){if(e.TryClickLock||this.TryClickIndexTitle){var a=this.GetToucheData(t),i=a[0].clientX,r=a[0].clientY;if(e.TryClickLock&&e.TryClickLock(i,r))return;if(e.TryClickIndexTitle&&e.TryClickIndexTitle(i,r))return}null!=this.TouchTimer&&clearTimeout(this.TouchTimer),1==this.ChartCorssCursor.IsShow&&(this.TouchTimer=setTimeout((function(){if(n.Click.X==n.LastMove.X&&n.Click.Y==n.LastMove.Y){e.MouseDrag;e.MouseDrag=null;var a=n.Click.X,i=n.Click.Y;e.OnMouseMove(a,i,t)}}),800));var n={Click:{},LastMove:{}};a=this.GetToucheData(t);n.Click.X=a[0].clientX,n.Click.Y=a[0].clientY,n.LastMove.X=a[0].clientX,n.LastMove.Y=a[0].clientY,e.MouseDrag=n}else if(this.IsPhonePinching(t)){var s={Start:{},Last:{}};a=this.GetToucheData(t);s.Start={X:a[0].pageX,Y:a[0].pageY,X2:a[1].pageX,Y2:a[1].pageY},s.Last={X:a[0].pageX,Y:a[0].pageY,X2:a[1].pageX,Y2:a[1].pageY},e.PhonePinch=s}}},this.ontouchmove=function(t){if(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){var e=this,a=this.GetToucheData(t);if(this.IsPhoneDragging(t)){var i=e.MouseDrag;if(null==i){var r=a[0].clientX,n=a[0].clientY;e.OnMouseMove(r,n,t)}else{var s=Math.abs(i.LastMove.Y-a[0].clientY);if(s=parseInt(s),1==e.DragMode){if(s<5)return;var o=!0;i.LastMove.Y<a[0].clientY&&(o=!1),e.DataMove(s,o)&&(e.UpdataDataoffset(),e.UpdatePointByCursorIndex(),e.UpdateFrameMaxMin(),e.ResetFrameXYSplit(),e.Draw()),i.LastMove.X=a[0].clientX,i.LastMove.Y=a[0].clientY}}}else if(this.IsPhonePinching(t)){var h=e.PhonePinch;if(!h)return;if(this.EnableZoomUpDown&&!1===this.EnableZoomUpDown.Touch)return;var l=Math.abs(a[0].pageX-a[1].pageX),u=Math.abs(h.Last.X-h.Last.X2),C=l-u;if(Math.abs(C)<5)return;if(C>0){var D={};if(D.Index=parseInt(Math.abs(e.CursorIndex-.5).toFixed(0)),!e.Frame.ZoomUp(D))return;e.CursorIndex=D.Index,e.UpdatePointByCursorIndex(),e.UpdataDataoffset(),e.UpdateFrameMaxMin(),e.ResetFrameXYSplit(),e.Draw()}else{D={};if(D.Index=parseInt(Math.abs(e.CursorIndex-.5).toFixed(0)),!e.Frame.ZoomDown(D))return;e.CursorIndex=D.Index,e.UpdataDataoffset(),e.UpdatePointByCursorIndex(),e.UpdateFrameMaxMin(),e.ResetFrameXYSplit(),e.Draw()}h.Last={X:a[0].pageX,Y:a[0].pageY,X2:a[1].pageX,Y2:a[1].pageY}}}},t.onmousedown=function(e){if(this.JSChartContainer&&0!=this.JSChartContainer.DragMode){if(this.JSChartContainer.TryClickLock){var a=e.clientX-this.getBoundingClientRect().left,i=e.clientY-this.getBoundingClientRect().top;if(this.JSChartContainer.TryClickLock(a,i))return}var r={Click:{},LastMove:{}};r.Click.X=e.clientX,r.Click.Y=e.clientY,r.LastMove.X=e.clientX,r.LastMove.Y=e.clientY,this.JSChartContainer.MouseDrag=r,document.JSChartContainer=this.JSChartContainer,this.JSChartContainer.SelectChartDrawPicture=null,t.ondblclick=function(t){var e=t.clientX-this.getBoundingClientRect().left,a=t.clientY-this.getBoundingClientRect().top;this.JSChartContainer&&this.JSChartContainer.OnDoubleClick(e,a,t)},document.onmousemove=function(t){if(this.JSChartContainer&&(!this.JSChartContainer.ChartSplashPaint||1!=this.JSChartContainer.ChartSplashPaint.IsEnableSplash)){var e=this.JSChartContainer.MouseDrag;if(e){var a=Math.abs(e.LastMove.Y-t.clientY);if(1==this.JSChartContainer.DragMode){if(a<5)return;var i=!0;e.LastMove.Y<t.clientY&&(i=!1),this.JSChartContainer.DataMove(a,i)&&(this.JSChartContainer.UpdataDataoffset(),this.JSChartContainer.UpdatePointByCursorIndex(),this.JSChartContainer.UpdateFrameMaxMin(),this.JSChartContainer.ResetFrameXYSplit(),this.JSChartContainer.Draw()),e.LastMove.X=t.clientX,e.LastMove.Y=t.clientY}}}},document.onmouseup=function(t){document.onmousemove=null,document.onmouseup=null,this.JSChartContainer.MouseDrag=null,this.JSChartContainer.CurrentChartDrawPicture=null,this.JSChartContainer=null}}},this.Create=function(t){for(var e in this.UIElement.JSChartContainer=this,this.ChartCorssCursor=new D.JSCommonChartPaint_ChartCorssCursor,this.ChartCorssCursor.Canvas=this.Canvas,this.ChartCorssCursor.StringFormatX=new j,this.ChartCorssCursor.StringFormatY=new q,this.ChartSplashPaint=new D.JSCommonChartPaint_ChartSplashPaint,this.ChartSplashPaint.Canvas=this.Canvas,this.ChartSplashPaint.HQChart=this,this.Frame=new V,this.Frame.ChartBorder=new N,this.Frame.ChartBorder.UIElement=this.UIElement,this.Frame.ChartBorder.Top=30,this.Frame.ChartBorder.Left=5,this.Frame.ChartBorder.Bottom=20,this.Frame.Canvas=this.Canvas,this.ChartCorssCursor.Frame=this.Frame,this.ChartSplashPaint.Frame=this.Frame,this.CreateChildWindow(t),this.CreateMainKLine(),this.Frame.SubFrame){var a=new I.JSCommonChartTitle_DynamicChartTitlePainting;a.Frame=this.Frame.SubFrame[e].Frame,a.Canvas=this.Canvas,this.TitlePaint.push(a)}},this.CreateChildWindow=function(t){for(var e=0;e<t;++e){var a=new N;a.UIElement=this.UIElement;var i=new w;i.Canvas=this.Canvas,i.ChartBorder=a,i.Identify=e,i.RightSpaceCount=this.RightSpaceCount,this.ModifyIndexDialog&&(i.ModifyIndexEvent=this.ModifyIndexDialog.DoModal),this.ChangeIndexDialog&&(i.ChangeIndexEvent=this.ChangeIndexDialog.DoModal),i.HorizontalMax=20,i.HorizontalMin=10,0==e?(i.YSplitOperator=new d.JSCommonSplit_FrameSplitKLinePriceY,i.YSplitOperator.FrameSplitData=this.FrameSplitData.get("price"),a.TopSpace=12,a.BottomSpace=12):(i.YSplitOperator=new d.JSCommonSplit_FrameSplitY,i.YSplitOperator.FrameSplitData=this.FrameSplitData.get("double")),i.YSplitOperator.Frame=i,i.YSplitOperator.ChartBorder=a,i.XSplitOperator=new d.JSCommonSplit_FrameSplitKLineX,i.XSplitOperator.Frame=i,i.XSplitOperator.ChartBorder=a,e!=t-1&&(i.XSplitOperator.ShowText=!1);for(var r=i.HorizontalMin;r<=i.HorizontalMax;r+=1)i.HorizontalInfo[r]=new d.JSCommonSplit_CoordinateInfo,i.HorizontalInfo[r].Value=r,0==e&&r==i.HorizontalMin||(i.HorizontalInfo[r].Message[1]=r.toString(),i.HorizontalInfo[r].Font="14px 微软雅黑");var n=new b;n.Frame=i,n.Height=0==e?20:10,this.Frame.SubFrame[e]=n}}}function st(t){this.newMethod=at,this.newMethod(t),delete this.newMethod,this.ClassName="MinuteChartHScreenContainer",this.OnMouseMove=function(t,e,a){this.LastPoint.X=t,this.LastPoint.Y=e,this.CursorIndex=this.Frame.GetXData(e),this.DrawDynamicInfo()},this.Create=function(t){for(var e in this.UIElement.JSChartContainer=this,this.ChartCorssCursor=new D.JSCommonChartPaint_ChartCorssCursor,this.ChartCorssCursor.Canvas=this.Canvas,this.ChartCorssCursor.StringFormatX=new $,this.ChartCorssCursor.StringFormatY=new q,this.ChartSplashPaint=new D.JSCommonChartPaint_ChartSplashPaint,this.ChartSplashPaint.Canvas=this.Canvas,this.ChartSplashPaint.SplashTitle=this.LoadDataSplashTitle,this.Frame=new V,this.Frame.ChartBorder=new N,this.Frame.ChartBorder.UIElement=this.UIElement,this.Frame.ChartBorder.Top=25,this.Frame.ChartBorder.Left=50,this.Frame.ChartBorder.Bottom=20,this.Frame.Canvas=this.Canvas,this.ChartCorssCursor.Frame=this.Frame,this.ChartSplashPaint.Frame=this.Frame,this.CreateChildWindow(t),this.CreateMainKLine(),this.Frame.SubFrame){var a=new I.JSCommonChartTitle_DynamicChartTitlePainting;a.Frame=this.Frame.SubFrame[e].Frame,a.Canvas=this.Canvas,this.TitlePaint.push(a)}this.ChartCorssCursor.StringFormatX.Frame=this.Frame.SubFrame[0].Frame},this.CreateChildWindow=function(t){for(var e=0;e<t;++e){var a=new N;a.UIElement=this.UIElement;var i=new y;i.Canvas=this.Canvas,i.ChartBorder=a,e<2&&(i.ChartBorder.TitleHeight=0),i.XPointCount=243;var r=[9,8,7,6,5,4,3,2,1];for(var n in i.HorizontalMax=r[0],i.HorizontalMin=r[r.length-1],0==e?(i.YSplitOperator=new d.JSCommonSplit_FrameSplitMinutePriceY,i.YSplitOperator.FrameSplitData=this.FrameSplitData.get("price")):(i.YSplitOperator=new d.JSCommonSplit_FrameSplitY,i.YSplitOperator.FrameSplitData=this.FrameSplitData.get("double")),i.YSplitOperator.Frame=i,i.YSplitOperator.ChartBorder=a,i.XSplitOperator=new d.JSCommonSplit_FrameSplitMinuteX,i.XSplitOperator.Frame=i,i.XSplitOperator.ChartBorder=a,e!=t-1&&(i.XSplitOperator.ShowText=!1),i.XSplitOperator.Operator(),r)i.HorizontalInfo[n]=new d.JSCommonSplit_CoordinateInfo,i.HorizontalInfo[n].Value=r[n],0==e&&n==i.HorizontalMin||(i.HorizontalInfo[n].Message[1]=r[n].toString(),i.HorizontalInfo[n].Font="14px 微软雅黑");var s=new b;s.Frame=i,s.Height=0==e?20:10,this.Frame.SubFrame[e]=s}}}function ot(t,e){!0===e?(this.newMethod=nt,this.newMethod(t),delete this.newMethod):(this.newMethod=et,this.newMethod(t),delete this.newMethod),this.ClassName2="KLineTrainChartContainer",this.BuySellPaint,this.TrainDataCount=300,this.AutoRunTimer=null,this.BuySellData=[],this.TrainDataIndex,this.TrainCallback,this.DragMode=1,this.TrainStartEnd={},this.KLineSourceData,this.TrainInfo={Start:{},End:{}},this.CreateBuySellPaint=function(){var t=new D.JSCommonChartPaint_ChartBuySell;t.Canvas=this.Canvas,t.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,t.ChartFrame=this.Frame.SubFrame[0].Frame,t.Name="KLine-Train-BuySell",this.ChartPaintEx[0]=t},this.GetKDataIndexByDateTime=function(t,e){if(!e||!t)return-1;for(var a in t){var i=t[a];if(s.JSCommon_ChartData.IsMinutePeriod(this.Period,!0)){if(d.JSCommonSplit_IFrameSplitOperator.IsNumber(this.TrainStartDate.Time)){if(i.Date>=this.TrainStartDate.Date&&i.Time>=this.TrainStartDate.Time)return parseInt(a)}else if(i.Date>=this.TrainStartDate.Date)return parseInt(a)}else if((s.JSCommon_ChartData.IsDayPeriod(this.Period,!0)||s.JSCommon_ChartData.IsTickPeriod(this.Period))&&i.Date>=this.TrainStartDate.Date)return parseInt(a)}return-1},this.AfterBindMainData=function(t){this.ChartPaintEx[0]||this.CreateBuySellPaint();var e=this.ChartPaint[0].Data;this.ChartPaintEx[0].Data=e;var a=e.Data[e.Data.length-1];this.TrainInfo.LastShowData=a,this.TrainInfo.LastData=this.SourceData.Data[this.SourceData.Data.length-1],"Update"!=t&&this.UpdateTrainUICallback("开始")},this.BeforeBindMainData=function(t){if("Update"!=t){this.KLineSourceData=new s.JSCommon_ChartData,this.KLineSourceData.Data=this.SourceData.Data.slice(0);var e=this.SourceData.Data.length,a=e-this.TrainDataCount-20,i=this.GetKDataIndexByDateTime(this.SourceData.Data,this.TrainStartDate);i>=0&&(a=i+1,e-a<this.TrainDataCount&&(this.TrainDataCount=e-a));var r=a-1,n=this.SourceData.Data[r];this.TrainInfo.Start.Index=r,this.TrainInfo.Start.Date=n.Date,this.TrainInfo.Start.Time=n.Time,this.TrainInfo.End.Index=r,this.TrainInfo.End.Date=n.Date,this.TrainInfo.End.Time=n.Time,this.TrainInfo.LastData=n,this.SourceData.Data.length=a}},this.Run=function(t){if(!this.AutoRunTimer&&!(this.TrainDataCount<=0)){var e=this;this.AutoRunTimer=setInterval((function(){e.MoveNextKLineData(t)||clearInterval(e.AutoRunTimer)}),1e3)}},this.MoveNextKLineData=function(t){if(this.TrainDataCount<=0)return!1;var e=1,a=0;t&&t.Step>1&&(e=t.Step);for(var i=0;i<e;++i){var r=this.TrainInfo.End.Index+1;if(r>=this.KLineSourceData.Data.length)break;var n=this.KLineSourceData.Data[r];if(this.SourceData.Data.push(n),this.TrainInfo.End.Index=r,this.TrainInfo.End.Date=n.Date,this.TrainInfo.End.Time=n.Time,--this.TrainDataCount,++a,this.TrainDataCount<=0)break}if(0==a)return!1;var s=this.Frame.GetCurrentPageSize();return d.JSCommonSplit_IFrameSplitOperator.IsNumber(s)&&(this.PageSize=s-this.RightSpaceCount),this.Update(),this.TrainDataCount<=0?(this.FinishTrainData(),this.UpdateTrainUICallback("结束"),!1):(this.UpdateTrainUICallback("训练中"),!0)},this.UpdateTrainUICallback=function(t){if(this.mapEvent.has(s.JSCommon_JSCHART_EVENT_ID.RECV_TRAIN_MOVE_STEP)){var e=this.mapEvent.get(s.JSCommon_JSCHART_EVENT_ID.RECV_TRAIN_MOVE_STEP);if(e.Callback){var a={TrainDataCount:this.TrainDataCount,BuySellData:this.BuySellData,KLine:{Start:{Index:this.TrainInfo.Start.Index,Date:this.TrainInfo.Start.Date},End:{Index:this.TrainInfo.End.Index,Date:this.TrainInfo.End.Date}},LastData:this.TrainInfo.LastData,LastShowData:this.TrainInfo.LastShowData};d.JSCommonSplit_IFrameSplitOperator.IsNumber(this.TrainInfo.Start.Time)&&(a.KLine.Start.Time=this.TrainInfo.Start.Time),d.JSCommonSplit_IFrameSplitOperator.IsNumber(this.TrainInfo.End.Time)&&(a.KLine.End.Time=this.TrainInfo.End.Time),t&&(a.Description=t),this.TrainDataCount<=0&&(a.Symbol=this.Symbol,a.Name=this.Name),e.Callback(e,a,this)}}},this.FinishTrainData=function(){},this.Stop=function(){null!=this.AutoRunTimer&&clearInterval(this.AutoRunTimer),this.AutoRunTimer=null},this.BuyOrSell=function(t,e){var a=this.TrainInfo.LastShowData;if(!a)return!1;var i=this.ChartPaintEx[0];if(!i)return!1;var r=this.ChartPaint[0].Data;if(!r||r.Data.length<=0)return!1;var n=r.Data.length-1,s={Date:this.TrainInfo.End.Date,Time:this.TrainInfo.End.Time,Price:t.Price,Vol:t.Vol,Op:0,ID:t.ID};1==t.Op&&(s.Op=1);var o=n;s.Key=o,this.BuySellData.push(s),i.AddTradeItem(s),1==e&&this.Draw()},this.RestartTrain=function(t){n.JSConsole.Chart.Log("[KLineTrainChartContainer::RestartTrain] option ",t),this.TrainInfo={Start:{},End:{}},this.BuySellData=[],this.KLineSourceData=null;var e=this.ChartPaintEx[0];e&&(e.Data=null,e.ClearTradeData()),t.Symbol&&(this.Symbol=t.Symbol),d.JSCommonSplit_IFrameSplitOperator.IsNumber(t.Period)&&(this.Period=t.Period),d.JSCommonSplit_IFrameSplitOperator.IsNumber(t.Right)&&(this.Right=t.Right),t.Train&&(t.Train.DataCount>1&&(this.TrainDataCount=t.Train.DataCount),t.Train.DateTime&&(this.TrainStartDate=t.Train.DateTime));var a=this.Symbol;this.ChangeSymbol(a)}}function ht(t){this.newMethod=F,this.newMethod(t),delete this.newMethod,this.ClassName="DepthChartContainer",this.Symbol,this.MapAsk=new Map,this.MapBid=new Map,this.IsAutoUpdate=!1,this.AutoUpdateFrequency=3e4,this.AutoUpdateTimer,this.DefaultZoom=.8,this.MaxVolRate=1.1,this.Create=function(t){this.UIElement.JSChartContainer=this,this.ChartCorssCursor=new D.JSCommonChartPaint_DepthChartCorssCursor,this.ChartCorssCursor.Canvas=this.Canvas,this.ChartCorssCursor.HQChart=this,this.ChartSplashPaint=new D.JSCommonChartPaint_ChartSplashPaint,this.ChartSplashPaint.Canvas=this.Canvas,this.Frame=new _,this.Frame.ChartBorder=new N,this.Frame.ChartBorder.UIElement=this.UIElement,this.Frame.ChartBorder.Top=30,this.Frame.ChartBorder.Left=5,this.Frame.ChartBorder.Bottom=20,this.Frame.ChartBorder.TitleHeight=0,this.Frame.Canvas=this.Canvas;var e=new d.JSCommonSplit_FrameSplitY;e.FrameSplitData=this.FrameSplitData.get("double"),e.LanguageID=this.LanguageID,e.Frame=this.Frame,e.SplitCount=5,e.IgnoreYValue=[0],e.LineType=3,e.ChartBorder=this.Frame.ChartBorder,this.Frame.YSplitOperator=e;var a=new d.JSCommonSplit_FrameSplitXDepth;a.Frame=this.Frame,a.ChartBorder=this.Frame.ChartBorder,a.LanguageID=this.LanguageID,a.LineType=3,this.Frame.XSplitOperator=a,this.ChartCorssCursor&&(this.ChartCorssCursor.Frame=this.Frame),this.ChartSplashPaint.Frame=this.Frame;var i=new D.JSCommonChartPaint_ChartOrderbookDepth;i.Canvas=this.Canvas,i.ChartBorder=this.Frame.ChartBorder,i.ChartFrame=this.Frame,i.Name="深度图",this.ChartPaint.push(i)},this.ontouchstart=function(t){this.IsOnTouch=!0,this.TouchDrawCount=0,this.PhonePinch=null;this.IsSingleTouch(t);if(this.EnableScrollUpDown,this.IsPhoneDragging(t)){var e={Click:{},LastMove:{}},a=this.GetToucheData(t,this.IsForceLandscape);e.Click.X=a[0].clientX,e.Click.Y=a[0].clientY,e.LastMove.X=a[0].clientX,e.LastMove.Y=a[0].clientY,this.MouseDrag=e;var i=e.Click.X,r=e.Click.Y;this.OnMouseMove(i,r,t)}else if(this.IsPhonePinching(t)){var n={Start:{},Last:{}};a=this.GetToucheData(t,this.IsForceLandscape);n.Start={X:a[0].pageX,Y:a[0].pageY,X2:a[1].pageX,Y2:a[1].pageY},n.Last={X:a[0].pageX,Y:a[0].pageY,X2:a[1].pageX,Y2:a[1].pageY},this.PhonePinch=n}},this.ontouchmove=function(t){var e=this.GetToucheData(t,!1);if(this.IsPhoneDragging(t)){var a=this.MouseDrag;if(null==a){var i=e[0].clientX,r=e[0].clientY;this.OnMouseMove(i,r,t)}else{this.MouseDrag=null;i=e[0].clientX,r=e[0].clientY;this.OnMouseMove(i,r,t)}}else if(this.IsPhonePinching(t)){var n=this.PhonePinch;if(!n)return;if(this.EnableZoomUpDown&&!1===this.EnableZoomUpDown.Touch)return;var s=Math.abs(e[0].pageY-e[1].pageY),o=Math.abs(n.Last.Y-n.Last.Y2),h=s-o,l=Math.abs(e[0].pageX-e[1].pageX),u=Math.abs(n.Last.X-n.Last.X2),C=l-u,D=this.ZoomStepPixel;if(Math.abs(h)<D&&Math.abs(C)<D)return;var m=h;if(Math.abs(h)<D&&(m=C),m>0){if(!this.Frame.ZoomUp())return;this.UpdateFrameMaxMin(),this.Draw()}else{if(!this.Frame.ZoomDown())return;this.UpdateFrameMaxMin(),this.Draw()}n.Last={X:e[0].pageX,Y:e[0].pageY,X2:e[1].pageX,Y2:e[1].pageY}}},this.ontouchend=function(t){n.JSConsole.Chart.Log("[DepthChartContainer::OnTouchEnd]",t),this.IsOnTouch=!1,this.Draw(),this.TouchDrawCount=0},this.OnMouseMove=function(t,e,a,i){this.LastPoint.Y;this.LastPoint.X=t,this.LastPoint.Y=e,this.FullDraw()},this.ChangeSymbol=function(t){this.CancelAutoUpdate(),this.Symbol=t,this.MapBid=new Map,this.MapAsk=new Map,this.Frame.VerticalRange.Differ=null,this.ChartSplashPaint.SetTitle(this.LoadDataSplashTitle),this.ChartSplashPaint.EnableSplash(!0),this.Draw(),this.RequestDepthData()},this.RequestDepthData=function(){var t=this;if(this.NetworkFilter){var e={Name:"DepthChartContainer::RequestDepthData",Explain:"深度图数据",Request:{Data:{symbol:t.Symbol}},Self:this,PreventDefault:!1};if(this.NetworkFilter(e,(function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvDepthData(e),t.AutoUpdate()})),1==e.PreventDefault)return}},this.RecvDepthData=function(t){this.UpdateAskAndBid(t);var e=Array.from(this.MapAsk.values());e.sort((function(t,e){return t.Price-e.Price}));var a=0;for(var i in e){var r=e[i];a+=r.Vol,e[i]={Price:r.Price,Vol:a}}var n=Array.from(this.MapBid.values());n.sort((function(t,e){return e.Price-t.Price}));a=0;for(var i in n){r=n[i];a+=r.Vol,n[i]={Price:r.Price,Vol:a}}var s={Asks:e,Bids:n},o=this.ChartPaint[0];o.Data=s,this.Frame.XSplitOperator.Symbol=this.Symbol,this.ChartCorssCursor.Data=s,this.ChartCorssCursor.Symbol=this.Symbol,this.UpdateFramePriceList(),this.UpdateFrameMaxMin(),this.Draw()},this.UpdateAskAndBid=function(t){for(var e in"snapshot"==t.datatype&&(this.MapBid=new Map,this.MapAsk=new Map),t.asks){var a=t.asks[e],i=parseFloat(a[0]),r=parseFloat(a[1]);if(this.MapAsk.has(i)){var n=this.MapAsk.get(i);r<=0?this.MapAsk.delete(i):n.Vol=r}else r>0&&this.MapAsk.set(i,{Price:i,Vol:r})}for(var e in t.bids){a=t.bids[e],i=parseFloat(a[0]),r=parseFloat(a[1]);if(this.MapBid.has(i)){n=this.MapBid.get(i);r<=0?this.MapBid.delete(i):n.Vol=r}else r>0&&this.MapBid.set(i,{Price:i,Vol:r})}},this.UpdateFramePriceList=function(){var t=Array.from(this.MapAsk.keys()),e=Array.from(this.MapBid.keys());if(t.sort((function(t,e){return t-e})),e.sort((function(t,e){return t-e})),t.length>1&&e.length>1)var a=t[0],i=t[t.length-1],r=e[0],n=e[e.length-1],s=i-a,o=n-r,h=Math.max(s,o),l={Min:a,Max:a+h},u={Max:n,Min:n-h},C={Max:l.Max,Min:u.Min};this.Frame.SetPriceList(t,e);var D=this.Frame.VerticalRange;D.Max=C.Max,D.Center=C.Min+(C.Max-C.Min)/2,D.Min=C.Min,D.MaxDiffer=h,D.Ask=l,D.Bid=u,d.JSCommonSplit_IFrameSplitOperator.IsNumber(D.Differ)||(D.Differ=h*this.DefaultZoom),D.Min=D.Center-D.Differ,D.Max=D.Center+D.Differ},this.UpdateFrameMaxMin=function(){var t=this.ChartPaint[0].GetMaxMin();this.Frame.HorizontalMax=t.Max*this.MaxVolRate,this.Frame.HorizontalMin=0,this.Frame.XYSplit=!0},this.CancelAutoUpdate=function(){"number"==typeof this.AutoUpdateTimer&&(clearTimeout(this.AutoUpdateTimer),this.AutoUpdateTimer=void 0)},this.StopAutoUpdate=function(){this.CancelAutoUpdate(),this.IsAutoUpdate&&(this.IsAutoUpdate=!1)},this.AutoUpdate=function(){if(this.CancelAutoUpdate(),this.IsAutoUpdate&&this.Symbol&&!this.IsDestroy){var t=this,e=h.JSCommonCoordinateData_MARKET_SUFFIX_NAME.GetMarketStatus(this.Symbol);if(0!=e&&3!=e){var a=this.AutoUpdateFrequency;1==e?this.AutoUpdateTimer=setTimeout((function(){t.AutoUpdate()}),a):2==e&&(this.AutoUpdateTimer=setTimeout((function(){t.RequestDepthData()}),a))}}}}function lt(t){this.newMethod=F,this.newMethod(t),delete this.newMethod,this.WindowIndex=new Array,this.MainDataControl,this.SubDataControl=new Array,this.FrameType=0,this.YSplitCount=4,this.Create=function(){this.UIElement.JSChartContainer=this,this.ChartSplashPaint=new D.JSCommonChartPaint_ChartSplashPaint,this.ChartSplashPaint.Canvas=this.Canvas,1==this.FrameType?this.Frame=new J:this.Frame=new H,this.Frame.ChartBorder=new N,this.Frame.ChartBorder.UIElement=this.UIElement,this.Frame.ChartBorder.Top=30,this.Frame.ChartBorder.Left=5,this.Frame.ChartBorder.Bottom=20,this.Frame.Canvas=this.Canvas,this.ChartCorssCursor&&(this.ChartCorssCursor.Frame=this.Frame),this.ChartSplashPaint.Frame=this.Frame,this.CreateMainChart()},this.SetMainDataConotrl=function(t){if(t){this.MainDataControl=t,this.ChartPaint=[],this.Frame.BarCount=0;var e=this.Frame.YSplitOperator.StringFormat;this.CreateMainChart(),this.Frame.YSplitOperator.StringFormat=e,this.Draw(),this.RequestData()}},this.CreateMainChart=function(){if(this.MainDataControl){var t=0;for(var e in this.MainDataControl.DataType){var a=this.MainDataControl.DataType[e];if("BAR"==a.Type){var i=void 0;i=1==this.FrameType?new K:new z,i.BarID=t,i.Canvas=this.Canvas,i.ChartBorder=this.Frame.ChartBorder,i.ChartFrame=this.Frame,i.Name=a.Name,a.Color&&(i.UpBarColor=a.Color),a.Color2&&(i.DownBarColor=a.Color2),this.ChartPaint.push(i),++this.Frame.BarCount,++t}else if("LINE"==a.Type){var r=new D.JSCommonChartPaint_ChartLine;r.Canvas=this.Canvas,r.ChartBorder=this.Frame.ChartBorder,r.ChartFrame=this.Frame,r.Name=a.Name,a.Color&&(r.Color=a.Color),this.ChartPaint.push(r)}}var n=2,s=null;this.Frame.YSplitOperator&&(n=this.Frame.YSplitOperator.FloatPrecision,this.Frame.YSplitOperator.IgnoreYValue&&(s=this.Frame.YSplitOperator.IgnoreYValue)),this.Frame.YSplitOperator=new d.JSCommonSplit_FrameSplitY,this.Frame.YSplitOperator.FloatPrecision=n,this.Frame.YSplitOperator.IgnoreYValue=s,this.Frame.YSplitOperator.SplitCount=this.YSplitCount,this.Frame.YSplitOperator.FrameSplitData=this.FrameSplitData.get("double"),this.Frame.YSplitOperator.Frame=this.Frame,this.Frame.YSplitOperator.ChartBorder=this.Frame.ChartBorder,this.Frame.XSplitOperator=new d.JSCommonSplit_FrameSplitXData,this.Frame.XSplitOperator.Frame=this.Frame,this.Frame.XSplitOperator.ChartBorder=this.Frame.ChartBorder}},this.RequestData=function(){this.MainDataControl&&(this.MainDataControl.JSChartContainer=this,this.MainDataControl.RequestData())},this.UpdateMainData=function(t){var e=0;for(var a in t.Data){var i=new s.JSCommon_ChartData;i.Data=t.Data[a],this.ChartPaint[a].Data=i,e<i.Data.length&&(e=i.Data.length)}this.Frame.XPointCount=e,this.Frame.Data=this.ChartPaint[0].Data,this.Frame.XData=t.XData,this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw()}}function ut(t){this.Radius,this.newMethod=F,this.newMethod(t),delete this.newMethod,this.MainDataControl,this.OnMouseMove=function(t,e,a){},this.Create=function(){this.UIElement.JSChartContainer=this,this.ChartSplashPaint=new D.JSCommonChartPaint_ChartSplashPaint,this.ChartSplashPaint.Canvas=this.Canvas,this.Frame=new R,this.Frame.ChartBorder=new N,this.Frame.ChartBorder.UIElement=this.UIElement,this.Frame.ChartBorder.Top=30,this.Frame.ChartBorder.Left=5,this.Frame.ChartBorder.Bottom=20,this.Frame.Canvas=this.Canvas,this.ChartSplashPaint.Frame=this.Frame,this.CreateMainChart()},this.SetMainDataConotrl=function(t){t&&(this.MainDataControl=t,this.ChartPaint=[],this.CreateMainChart(),this.Draw(),this.RequestData())},this.CreateMainChart=function(){if(this.MainDataControl)for(var t in this.MainDataControl.DataType){var e=this.MainDataControl.DataType[t];if("PIE"==e.Type){var a=new D.JSCommonChartPaint_ChartPie;a.Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.Name=e.Name,this.ChartPaint.push(a)}else if("CIRCLE"==e.Type){a=new D.JSCommonChartPaint_ChartCircle;a.Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.Name=e.Name,this.ChartPaint.push(a)}else if("RADAR"==e.Type){a=new D.JSCommonChartPaint_ChartRadar;a.Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.Name=e.Name,e.StartAngle&&(a.StartAngle=e.StartAngle),e.TitleFont&&(a.TitleFont=e.TitleFont),this.ChartPaint.push(a)}}},this.RequestData=function(){this.MainDataControl&&(this.MainDataControl.JSChartContainer=this,this.MainDataControl.RequestData())},this.UpdateMainData=function(t){for(var e in t.Data){var a=new s.JSCommon_ChartData;a.Data=t.Data[e],this.ChartPaint[e].Data=a}this.Frame.SetSizeChage(!0),this.Draw()}}function Ct(t){this.newMethod=F,this.newMethod(t),delete this.newMethod,this.MainDataControl,this.OnMouseMove=function(t,e,a){},this.Create=function(){this.UIElement.JSChartContainer=this,this.ChartSplashPaint=new D.JSCommonChartPaint_ChartSplashPaint,this.ChartSplashPaint.Canvas=this.Canvas,this.Frame=new R,this.Frame.ChartBorder=new N,this.Frame.ChartBorder.UIElement=this.UIElement,this.Frame.ChartBorder.Top=30,this.Frame.ChartBorder.Left=5,this.Frame.ChartBorder.Bottom=20,this.Frame.Canvas=this.Canvas,this.ChartSplashPaint.Frame=this.Frame,this.CreateMainChart()},this.SetMainDataConotrl=function(t){t&&(this.MainDataControl=t,this.ChartPaint=[],this.CreateMainChart(),this.Draw(),this.RequestData())},this.CreateMainChart=function(){if(this.MainDataControl){var t=new D.JSCommonChartPaint_ChartChinaMap;t.Canvas=this.Canvas,t.ChartBorder=this.Frame.ChartBorder,t.ChartFrame=this.Frame,t.Name=this.MainDataControl.DataType[0].Name,this.Radius&&(t.Radius=this.Radius),this.ChartPaint.push(t)}},this.RequestData=function(){this.MainDataControl&&(this.MainDataControl.JSChartContainer=this,this.MainDataControl.RequestData())},this.UpdateMainData=function(t){this.ChartPaint[0].Data=t.Data[0],this.Frame.SetSizeChage(!0),this.Draw()}}tt.Get=function(t){var e=new Map([["市场多空",{IsMainIndex:!1,Create:function(){return new St}}],["市场择时",{IsMainIndex:!1,Create:function(){return new ct}}],["市场关注度",{IsMainIndex:!1,Create:function(){return new ft}}],["指数热度",{IsMainIndex:!1,Create:function(){return new dt}}],["自定义指数热度",{IsMainIndex:!1,Create:function(){return new It},Name:"自定义指数热度"}],["财务粉饰",{IsMainIndex:!1,Create:function(){return new vt}}]]);return e.get(t)},et.JsonDataToHistoryData=function(t){var e=t.data,a=new Array;if(!e)return a;var i=null;t.symbol&&(i=t.symbol.toUpperCase());h.JSCommonCoordinateData_MARKET_SUFFIX_NAME.IsChinaFutures(i);for(var r=0,n=1,o=2,l=3,u=4,C=5,D=6,m=7,S=8,c=0;c<e.length;++c){var f=new s.JSCommon_HistoryData,I=e[c];f.Date=I[r],f.Open=I[o],f.YClose=I[n],f.Close=I[C],f.High=I[l],f.Low=I[u],f.Vol=I[D],f.Amount=I[m],d.JSCommonSplit_IFrameSplitOperator.IsNumber(I[S])&&(f.Position=I[S]),d.JSCommonSplit_IFrameSplitOperator.IsNumber(f.Open)&&a.push(f)}return a},et.JsonDataToRealtimeData=function(t){var e=t.stock[0].symbol,a=e.toUpperCase(),i=(h.JSCommonCoordinateData_MARKET_SUFFIX_NAME.IsSHSZ(a),new s.JSCommon_HistoryData);return i.Date=t.stock[0].date,i.Open=t.stock[0].open,i.YClose=t.stock[0].yclose,i.High=t.stock[0].high,i.Low=t.stock[0].low,i.Vol=t.stock[0].vol,i.Amount=t.stock[0].amount,i.Close=t.stock[0].price,d.JSCommonSplit_IFrameSplitOperator.IsNumber(t.stock[0].position)&&(i.Position=t.stock[0].position),i},et.JsonDataToMinuteRealtimeData=function(t){var e=t.stock[0].symbol,a=e.toUpperCase(),i=(h.JSCommonCoordinateData_MARKET_SUFFIX_NAME.IsSHSZ(a),h.JSCommonCoordinateData_MARKET_SUFFIX_NAME.IsChinaFutures(a)),r=new Array,n=t.stock[0].yclose,o=t.stock[0].date;for(var l in i&&t.stock[0].yclearing&&(n=t.stock[0].yclearing),t.stock[0].minute){var u=t.stock[0].minute[l],C=new s.JSCommon_HistoryData;C.Close=u.price,C.Open=u.open,C.High=u.high,C.Low=u.low,C.Vol=u.vol,C.Amount=u.amount,u.date>0?C.Date=u.date:C.Date=o,C.Time=u.time,C.YClose=n,d.JSCommonSplit_IFrameSplitOperator.IsNumber(u.position)&&(C.Position=u.position),d.JSCommonSplit_IFrameSplitOperator.IsNumber(C.Close)||(C.Close=n,C.Open=C.High=C.Low=C.Close),d.JSCommonSplit_IFrameSplitOperator.IsNumber(C.Open)||(C.Open=null),d.JSCommonSplit_IFrameSplitOperator.IsNumber(C.Close)||(C.Close=null),d.JSCommonSplit_IFrameSplitOperator.IsNumber(C.High)||(C.High=null),d.JSCommonSplit_IFrameSplitOperator.IsNumber(C.Low)||(C.Low=null),d.JSCommonSplit_IFrameSplitOperator.IsNumber(u.price)&&(n=u.price),r[l]=C}return r},et.JsonDataToMinuteHistoryData=function(t){var e=null;t.symbol&&(e=t.symbol.toUpperCase());e&&h.JSCommonCoordinateData_MARKET_SUFFIX_NAME.IsSHSZ(e);e&&h.JSCommonCoordinateData_MARKET_SUFFIX_NAME.IsChinaFutures(e);for(var a=t.data,i=new Array,r=0,n=1,o=2,l=3,u=4,C=5,D=6,m=7,S=8,c=9,f=0;f<a.length;++f){var I=new s.JSCommon_HistoryData,v=a[f];I.Date=v[r],I.Open=v[o],I.YClose=v[n],I.Close=v[C],I.High=v[l],I.Low=v[u],I.Vol=v[D],I.Amount=v[m],I.Time=v[S],d.JSCommonSplit_IFrameSplitOperator.IsNumber(v[c])&&(I.Position=v[c]),i.push(I)}return i},at.JsonDataToMinuteData=function(t){var e=t.stock[0].symbol.toUpperCase(),a=h.JSCommonCoordinateData_MARKET_SUFFIX_NAME.IsSHSZ(e),i=h.JSCommonCoordinateData_MARKET_SUFFIX_NAME.IsChinaFutures(e)||h.JSCommonCoordinateData_MARKET_SUFFIX_NAME.IsNYMEX(e),r=h.JSCommonCoordinateData_MARKET_SUFFIX_NAME.IsSHO(e),o=t.stock[0].yclose,l=t.stock[0].yclose,u=t.stock[0].yclose;i&&t.stock[0].yclearing&&(u=o=l=t.stock[0].yclearing);var C=t.stock[0].date,D=new Array;for(var m in t.stock[0].minute){var S=t.stock[0].minute[m],c=new s.JSCommon_MinuteData;S.price&&(o=S.price),S.avprice&&(l=S.avprice),c.Close=S.price,c.Open=S.open,c.High=S.high,c.Low=S.low,c.Vol=a?S.vol/100:S.vol,c.Amount=S.amount,c.Increase=S.increase,c.Risefall=S.risefall,c.AvPrice=S.avprice,c.Close||(c.Close=o,c.Open=c.High=c.Low=c.Close),c.AvPrice||(c.AvPrice=l),S.date>0&&(C=S.date),c.DateTime=C.toString()+" "+S.time.toString(),c.Date=t.stock[0].date,c.Time=S.time,8<S.length&&S[8]>0&&(c.Date=S[8],c.DateTime=c.Date.toString()+" "+S[0].toString()),(i||r)&&(c.Position=S.position),0==m&&(c.IsFristData=!0,c.Close<=0&&(c.Close=t.stock[0].open,c.High=c.Low=t.stock[0].open,c.AvPrice=t.stock[0].open,n.JSConsole.Chart.Log("[MinuteChartContainer::JsonDataToMinuteData] first minute data is empty.",t.stock[0].symbol,S))),c.Open<=0&&(c.Open=null),c.Close<=0&&(c.Close=null),c.AvPrice<=0&&(c.AvPrice=null),c.High<=0&&(c.High=null),c.Low<=0&&(c.Low=null),u&&c.Close&&(c.Increase=(c.Close-u)/u*100),D[m]=c}return D},at.JsonDataToMinuteDataArray=function(t){var e=t.symbol.toUpperCase(),a=h.JSCommonCoordinateData_MARKET_SUFFIX_NAME.IsSHSZ(e),i=h.JSCommonCoordinateData_MARKET_SUFFIX_NAME.IsChinaFutures(e)||h.JSCommonCoordinateData_MARKET_SUFFIX_NAME.IsNYMEX(e),r=h.JSCommonCoordinateData_MARKET_SUFFIX_NAME.IsSHO(e),n=[];for(var o in t.data){var l=[],u=t.data[o],C=u.date,D=u.yclose,m=D,S=null;for(var c in u.minute){var f=u.minute[c];f[2]&&(m=f[2]);var d=new s.JSCommon_MinuteData;d.Close=f[2],d.Open=f[1],d.High=f[3],d.Low=f[4],d.Vol=a?f[5]/100:f[5],d.Amount=f[6],7<f.length&&f[7]>0&&(d.AvPrice=f[7],S=f[7]),d.Close||(d.Close=m,d.Open=d.High=d.Low=d.Close),!d.AvPrice&&S&&(d.AvPrice=S),d.Close&&D?d.Increase=(d.Close-D)/D*100:d.Increase=null,d.DateTime=C.toString()+" "+f[0].toString(),d.Date=C,d.Time=f[0],8<f.length&&f[8]>0&&(d.Date=f[8],d.DateTime=d.Date.toString()+" "+f[0].toString()),(i||r)&&9<f.length&&(d.Position=f[9]),0==c&&(d.IsFristData=!0),d.Open<=0&&(d.Open=null),d.Close<=0&&(d.Close=null),d.AvPrice<=0&&(d.AvPrice=null),d.High<=0&&(d.High=null),d.Low<=0&&(d.Low=null),d.AvPrice<=0&&(d.AvPrice=null),l[c]=d}var I=new s.JSCommon_ChartData;I.Data=l,I.YClose=D,I.Close=u.close,I.Date=C,n.push(I)}return n},it.JsonDataToMinuteData=function(t){var e=new Array;for(var a in t.minute.time){var i=new s.JSCommon_MinuteData;t.minute.price[a]<=0&&a>0?(i.Close=e[a-1].Close,i.Open=e[a-1].Close,i.High=i.Close,i.Low=i.Close,i.Vol=t.minute.vol[a]/100,i.Amount=t.minute.amount[a],i.DateTime=t.date.toString()+" "+t.minute.time[a].toString(),i.Date=t.date,i.Time=t.minute.time[a],i.AvPrice=e[a-1].AvPrice):(i.Close=t.minute.price[a],i.Open=t.minute.open[a],i.High=t.minute.high[a],i.Low=t.minute.low[a],i.Vol=t.minute.vol[a]/100,i.Amount=t.minute.amount[a],i.DateTime=t.date.toString()+" "+t.minute.time[a].toString(),i.Date=t.date,i.Time=t.minute.time[a],i.AvPrice=t.minute.avprice[a]),i.Open<=0&&(i.Open=null),i.Close<=0&&(i.Close=null),i.AvPrice<=0&&(i.AvPrice=null),i.High<=0&&(i.High=null),i.Low<=0&&(i.Low=null),e[a]=i}return e};var Dt={KLINE_ID:0,MINUTE_ID:2,HISTORY_MINUTE_ID:3,MULTIDAY_MINUTE_ID:4};function mt(t,e,a,i){this.newMethod=S.JSCommonIndex_ScriptIndex,this.newMethod(t,e,a,i),delete this.newMethod,this.ApiUrl,this.HQDataType,i.API&&(i.API.Url&&(this.ApiUrl=i.API.Url),i.API.Name&&(this.Name=this.ID=i.API.Name),i.API.ID&&(this.ID=i.API.ID)),this.ExecuteScript=function(t,e,a){n.JSConsole.Chart.Log("[APIScriptIndex::ExecuteScript] name, Arguments ",this.Name,this.Arguments);var i=Dt.KLINE_ID;"MinuteChartContainer"===t.ClassName||"MinuteChartHScreenContainer"===t.ClassName?i=t.DayCount>1?Dt.MULTIDAY_MINUTE_ID:Dt.MINUTE_ID:"HistoryMinuteChartContainer"===t.ClassName&&(i=Dt.HISTORY_MINUTE_ID);var r=[];if(this.Arguments)for(var s in this.Arguments){var o=this.Arguments[s];r.push({name:o.Name,value:o.Value})}var h=t.GetRequestDataCount(),l=this,u={indexname:this.ID,symbol:t.Symbol,script:this.Script,args:r,period:t.Period,right:t.Right,maxdatacount:h.MaxRequestDataCount,maxminutedaycount:h.MaxRequestMinuteDayCount,hqdatatype:i};if(i!=Dt.MULTIDAY_MINUTE_ID&&i!=Dt.MINUTE_ID||(u.daycount=t.DayCount),this.HQDataType=i,t.NetworkFilter){var C={Name:"APIScriptIndex::ExecuteScript",Explain:"指标计算",Request:{Url:l.ApiUrl,Type:"POST",Data:u},Self:this,HQChart:t,PreventDefault:!1};if(t.NetworkFilter(C,(function(i){l.RecvAPIData(i,t,e,a)})),1==C.PreventDefault)return}wx.request({url:l.ApiUrl,data:u,method:"POST",dataType:"json",async:!0,success:function(i){l.RecvAPIData(i,t,e,a)},error:function(t){l.RecvError(t)}})},this.RecvAPIData=function(t,e,a,i){var r=t.data;if(n.JSConsole.Chart.Log("[APIScriptIndex::RecvAPIData] recv data ",this.Name,r),0==r.code){if(r.outdata&&r.outdata.name&&(this.Name=r.outdata.name),r.outdata.args)for(var s in this.Arguments=[],r.outdata.args){var o=r.outdata.args[s];this.Arguments.push({Name:o.name,Value:o.value})}if(this.HQDataType==Dt.KLINE_ID?(this.OutVar=this.FittingData(r.outdata,e),n.JSConsole.Chart.Log("[APIScriptIndex::RecvAPIData] conver to OutVar ",this.OutVar)):this.OutVar=this.FittingMinuteData(r.outdata,e),this.BindData(e,a,i),0==this.IsLocked)e.Frame.SubFrame[a].Frame.SetLock(null);else{var h={IsLocked:!0,Callback:this.LockCallback,IndexName:this.Name,ID:this.LockID,BG:this.LockBG,Text:this.LockText,TextColor:this.LockTextColor,Font:this.LockFont,Count:this.LockCount,MinWidth:this.LockMinWidth};e.Frame.SubFrame[a].Frame.SetLock(h)}if(e.UpdataDataoffset(),e.UpdateFrameMaxMin(),e.Draw(),e.GetIndexEvent){var l=e.GetIndexEvent();if(l){r={OutVar:this.OutVar,WindowIndex:a,Name:this.Name,Arguments:this.Arguments,HistoryData:i,Stock:{Symbol:e.Symbol,Name:e.Name}};l.Callback(l,r,this)}}}},this.FittingData=function(t,e){var a=t.outvar,i=t.date,r=t.time,n=(e.ChartPaint[0].Data,[]);for(var s in a){var o=a[s],h={Name:o.name,Type:o.type};if(o.color&&(h.Color=o.color),o.data)h.Data=this.FittingArray(o.data,i,r,e),o.color&&(h.Color=o.color),o.linewidth>=1&&(h.LineWidth=o.linewidth),0==o.isshow&&(h.IsShow=!1),1==o.isexdata&&(h.IsExData=!0),n.push(h);else if(o.Draw){var l=o.Draw,u={};"DRAWICON"==l.DrawType?(u.Icon=l.Icon,u.Name=l.Name,u.DrawType=l.DrawType,u.DrawData=this.FittingArray(l.DrawData,i,r,e),h.Draw=u,n.push(h)):"DRAWTEXT"==l.DrawType?(u.Text=l.Text,u.Name=l.Name,u.DrawType=l.DrawType,u.DrawData=this.FittingArray(l.DrawData,i,r,e),h.Draw=u,n.push(h)):"STICKLINE"==l.DrawType?(u.Name=l.Name,u.Type=l.Type,u.Width=l.Width,u.DrawType=l.DrawType,u.DrawData=this.FittingArray(l.DrawData,i,r,e,1),h.Draw=u,n.push(h)):"MULTI_LINE"==l.DrawType||"MULTI_BAR"==l.DrawType?(u.Text=l.Text,u.Name=l.Name,u.DrawType=l.DrawType,u.DrawData=this.FittingMultiLine(l.DrawData,i,r,e),h.Draw=u,n.push(h)):"MULTI_TEXT"==l.DrawType?(u.Text=l.Text,u.Name=l.Name,u.DrawType=l.DrawType,u.DrawData=this.FittingMultiText(l.DrawData,i,r,e),this.GetKLineData(u.DrawData,e),h.Draw=u,n.push(h)):"MULTI_HTMLDOM"==l.DrawType?(u.Text=l.Text,u.Name=l.Name,u.DrawType=l.DrawType,u.Callback=l.Callback,u.DrawData=this.FittingMultiText(l.DrawData,i,r,e),this.GetKLineData(u.DrawData,e),h.Draw=u,n.push(h)):"KLINE_BG"==l.DrawType&&(u.Name=l.Name,u.DrawType=l.DrawType,u.DrawData={Color:l.Color,Angle:l.Angle},u.DrawData.Data=this.FittingKLineBG(l.DrawData,e),h.Draw=u,h.Name=l.DrawType,n.push(h))}}return n},this.GetKLineData=function(t,e){if(t&&Array.isArray(t)){var a=e.ChartPaint[0].Data;for(var i in t){var r=t[i];if(d.JSCommonSplit_IFrameSplitOperator.IsString(r.Value)&&(d.JSCommonSplit_IFrameSplitOperator.IsNumber(r.Index)&&!(r.Index<0||r.Index>=a.Data.length))){var n=r.Value.toUpperCase(),s=a.Data[r.Index];switch(n){case"HIGH":case"H":r.Value=s.High;break;case"L":case"LOW":r.Value=s.Low;break}}}}},this.FittingKLineBG=function(t,e){var a=e.ChartPaint[0].Data,i=[];if(s.JSCommon_ChartData.IsDayPeriod(e.Period,!0)){for(var r=!1,n=0,o=0;n<a.Data.length;){i[n]=0;var h=a.Data[n];if(o>=t.length)++n;else{var l=t[o];l.Date<h.Date?++o:(l.Date>h.Date||(r=!0,i[n]=1,++o),++n)}}if(r)return i}else if(s.JSCommon_ChartData.IsMinutePeriod(e.Period,!0)){for(r=!1,n=0,o=0;n<a.Data.length;){i[n]=0;h=a.Data[n];if(o>=t.length)++n;else{l=t[o];l.Date<h.Date||l.Date==h.Date&&l.Time<h.Time?++o:(l.Date>h.Date||l.Date==h.Date&&l.Time>h.Time||(r=!0,i[n]=1,++o),++n)}}if(r)return i}return null},this.FittingArray=function(t,e,a,i,r){var n,o=i.ChartPaint[0].Data,h=[];for(var l in t){var u=t[l],C=new s.JSCommon_SingleData;C.Date=e[l],a&&l<a.length&&(C.Time=a[l]),C.Value=u,h.push(C)}n=s.JSCommon_ChartData.IsDayPeriod(i.Period,!0)?o.GetFittingData(h):o.GetMinuteFittingData(h);var D,m=new s.JSCommon_ChartData;return m.Data=n,D=1==r?m.GetObject():m.GetValue(),D},this.FittingMultiLine=function(t,e,a,i){var r=i.ChartPaint[0].Data;if(s.JSCommon_ChartData.IsDayPeriod(i.Period,!0)){var n=[];for(var o in t){var h=t[o];for(var l in h.Point){var u=h.Point[l];n.push(u)}}return n.sort((function(t,e){return t.Date-e.Date})),r.GetDateIndex(n),t}if(s.JSCommon_ChartData.IsMinutePeriod(i.Period,!0)){n=[];for(var o in t){h=t[o];for(var l in h.Point){u=h.Point[l];n.push(u)}}return n.sort((function(t,e){return t.Date==e.Date?t.Time-e.Time:t.Date-e.Date})),r.GetDateTimeIndex(n),t}return null},this.FittingMultiText=function(t,e,a,i){var r=i.ChartPaint[0].Data;return s.JSCommon_ChartData.IsDayPeriod(i.Period,!0)?(t.sort((function(t,e){return t.Date-e.Date})),r.GetDateIndex(t),t):s.JSCommon_ChartData.IsMinutePeriod(i.Period,!0)?(t.sort((function(t,e){return t.Date==e.Date?t.Time-e.Time:t.Date-e.Date})),r.GetDateTimeIndex(t),t):null}}function St(){this.newMethod=S.JSCommonIndex_BaseIndex,this.newMethod("市场多空"),delete this.newMethod,this.Index=new Array(new S.JSCommonIndex_IndexInfo("多空指标",null),new S.JSCommonIndex_IndexInfo("多头区域",null),new S.JSCommonIndex_IndexInfo("空头区域",null)),this.Index[0].LineColor=c.JSCommonResource_Global_JSChartResource.Index.LineColor[0],this.Index[1].LineColor=c.JSCommonResource_Global_JSChartResource.UpBarColor,this.Index[2].LineColor=c.JSCommonResource_Global_JSChartResource.DownBarColor,this.LongShortData,this.Create=function(t,e){for(var a in this.Index){var i=null;i=0==a?new D.JSCommonChartPaint_ChartLine:new Y,i.Color=this.Index[a].LineColor,i.Canvas=t.Canvas,i.Name=this.Name+"-"+a.toString(),i.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,i.ChartFrame=t.Frame.SubFrame[e].Frame,t.ChartPaint.push(i)}},this.RequestData=function(t,e,a){var i=this,r={HQChart:t,WindowIndex:e,HistoryData:a};return this.LongShortData=[],r.HQChart.Period>0?(this.NotSupport(r.HQChart,r.WindowIndex,"不支持周期切换"),r.HQChart.Draw(),!1):(wx.request({url:c.JSCommonResource_Global_JSChartResource.Index.MarketLongShortApiUrl,data:{},method:"POST",dataType:"json",async:!0,success:function(t){i.RecvData(t,r)}}),!0)},this.RecvData=function(t,e){if(!(t.data.data.length<=0)){var a=new Array;for(var i in t.data.data){var r=t.data.data[i],n=new s.JSCommon_SingleData;n.Date=r[0],n.Value=r[1],a.push(n)}var o=e.HistoryData.GetFittingData(a),h=new s.JSCommon_ChartData;h.Data=o,h.Period=e.HQChart.Period,h.Right=e.HQChart.Right,this.LongShortData=h.GetValue(),this.BindData(e.HQChart,e.WindowIndex,e.HistoryData),e.HQChart.UpdataDataoffset(),e.HQChart.UpdateFrameMaxMin(),e.HQChart.Draw()}},this.BindData=function(t,e,a){var i=t.GetChartPaint(e);if(i.length!=this.Index.length)return!1;i[0].Data.Data=this.LongShortData,i[0].NotSupportMessage=null,i[1].Data.Data[0]=8,i[2].Data.Data[0]=1,t.Frame.SubFrame[e].Frame.YSpecificMaxMin={Max:9,Min:0,Count:3};var r=e+1;for(var n in i)t.TitlePaint[r].Data[n]=new I.JSCommonChartTitle_DynamicTitleData(i[n].Data,this.Index[n].Name,this.Index[n].LineColor),n>0&&(t.TitlePaint[r].Data[n].DataType="StraightLine");return t.TitlePaint[r].Title=this.FormatIndexTitle(),t.UpdateUICallback&&t.UpdateUICallback("MarketLongShortIndex",i,{WindowIndex:e,HistoryData:a}),!0}}function ct(){this.newMethod=S.JSCommonIndex_BaseIndex,this.newMethod("市场择时"),delete this.newMethod,this.Index=new Array(new S.JSCommonIndex_IndexInfo("因子择时",null)),this.TimingData,this.TitleColor=c.JSCommonResource_Global_JSChartResource.FrameSplitTextColor,this.Create=function(t,e){for(var a in this.Index){var i=new D.JSCommonChartPaint_ChartMACD;i.Canvas=t.Canvas,i.Name=this.Name+"-"+a.toString(),i.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,i.ChartFrame=t.Frame.SubFrame[e].Frame,t.ChartPaint.push(i)}},this.RequestData=function(t,e,a){var i=this,r={HQChart:t,WindowIndex:e,HistoryData:a};return this.LongShortData=[],r.HQChart.Period>0?(this.NotSupport(r.HQChart,r.WindowIndex,"不支持周期切换"),r.HQChart.Draw(),!1):(wx.request({url:c.JSCommonResource_Global_JSChartResource.Index.MarketLongShortApiUrl,data:{},method:"POST",dataType:"json",async:!0,success:function(t){i.RecvData(t,r)}}),!0)},this.RecvData=function(t,e){if(!(t.data.data.length<=0)){var a=new Array;for(var i in t.data.data){var r=t.data.data[i],n=new s.JSCommon_SingleData;n.Date=r[0],n.Value=r[2],a.push(n)}var o=e.HistoryData.GetFittingData(a),h=new s.JSCommon_ChartData;h.Data=o,h.Period=e.HQChart.Period,h.Right=e.HQChart.Right,this.TimingData=h.GetValue(),this.BindData(e.HQChart,e.WindowIndex,e.HistoryData),e.HQChart.UpdataDataoffset(),e.HQChart.UpdateFrameMaxMin(),e.HQChart.Draw()}},this.BindData=function(t,e,a){var i=t.GetChartPaint(e);if(i.length!=this.Index.length)return!1;i[0].Data.Data=this.TimingData,i[0].NotSupportMessage=null;var r=e+1;for(var n in i)t.TitlePaint[r].Data[n]=new I.JSCommonChartTitle_DynamicTitleData(i[n].Data,this.Index[n].Name,this.TitleColor),t.TitlePaint[r].Data[n].StringFormat=I.JSCommonChartTitle_STRING_FORMAT_TYPE.THOUSANDS,t.TitlePaint[r].Data[n].FloatPrecision=0;return t.TitlePaint[r].Title=this.FormatIndexTitle(),t.UpdateUICallback&&t.UpdateUICallback("MarketTimingIndex",i,{WindowIndex:e,HistoryData:a}),!0}}function ft(){this.newMethod=S.JSCommonIndex_BaseIndex,this.newMethod("市场关注度"),delete this.newMethod,this.Index=new Array(new S.JSCommonIndex_IndexInfo("市场关注度指数",null)),this.Data,this.TitleColor=c.JSCommonResource_Global_JSChartResource.FrameSplitTextColor,this.ApiUrl=c.JSCommonResource_Global_JSChartResource.Index.MarketAttentionApiUrl,this.Create=function(t,e){for(var a in this.Index){var i=new Z;i.Canvas=t.Canvas,i.Name=this.Name+"-"+a.toString(),i.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,i.ChartFrame=t.Frame.SubFrame[e].Frame,i.UpBarColor=i.DownBarColor="rgb(243,152,0)",t.ChartPaint.push(i)}},this.SetFrame=function(t,e,a){t.Frame.SubFrame[e].Frame.YSpecificMaxMin={Max:6,Min:0,Count:3}},this.RequestData=function(t,e,a){var i=this,r={HQChart:t,WindowIndex:e,HistoryData:a};return this.Data=[],r.HQChart.Period>0?(this.NotSupport(r.HQChart,r.WindowIndex,"不支持周期切换"),r.HQChart.Draw(),!1):(wx.request({url:this.ApiUrl,data:{symbol:r.HQChart.Symbol,startdate:20100101},method:"POST",dataType:"json",success:function(t){i.RecvData(t.data,r)}}),!0)},this.RecvData=function(t,e){if(!(t.date.length<0)){var a=new Array;for(var i in t.date){var r=new s.JSCommon_SingleData;r.Date=t.date[i],r.Value=t.value[i],a.push(r)}var n=e.HistoryData.GetFittingData(a),o=new s.JSCommon_ChartData;o.Data=n,o.Period=e.HQChart.Period,o.Right=e.HQChart.Right,this.Data=o.GetValue(),this.BindData(e.HQChart,e.WindowIndex,e.HistoryData),this.SetFrame(e.HQChart,e.WindowIndex,e.HistoryData),e.HQChart.UpdataDataoffset(),e.HQChart.UpdateFrameMaxMin(),e.HQChart.Draw()}},this.BindData=function(t,e,a){var i=t.GetChartPaint(e);if(i.length!=this.Index.length)return!1;i[0].Data.Data=this.Data,i[0].NotSupportMessage=null;var r=e+1;for(var n in i)t.TitlePaint[r].Data[n]=new I.JSCommonChartTitle_DynamicTitleData(i[n].Data,this.Index[n].Name,this.TitleColor),t.TitlePaint[r].Data[n].StringFormat=I.JSCommonChartTitle_STRING_FORMAT_TYPE.THOUSANDS,t.TitlePaint[r].Data[n].FloatPrecision=0;return t.TitlePaint[r].Title=this.FormatIndexTitle(),!0}}function dt(){this.newMethod=S.JSCommonIndex_BaseIndex,this.newMethod("指数/行业热度"),delete this.newMethod,this.Index=new Array(new S.JSCommonIndex_IndexInfo("热度指数",5),new S.JSCommonIndex_IndexInfo("MA",10),new S.JSCommonIndex_IndexInfo("MA",null)),this.Data,this.ApiUrl=c.JSCommonResource_Global_JSChartResource.Index.MarketHeatApiUrl,this.Index[0].LineColor=c.JSCommonResource_Global_JSChartResource.FrameSplitTextColor,this.Index[1].LineColor=c.JSCommonResource_Global_JSChartResource.Index.LineColor[0],this.Index[2].LineColor=c.JSCommonResource_Global_JSChartResource.Index.LineColor[1],this.Create=function(t,e){for(var a in this.Index){var i=null;0==a?i=new D.JSCommonChartPaint_ChartMACD:(i=new D.JSCommonChartPaint_ChartLine,i.Color=this.Index[a].LineColor),i.Canvas=t.Canvas,i.Name=this.Name+"-"+a.toString(),i.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,i.ChartFrame=t.Frame.SubFrame[e].Frame,t.ChartPaint.push(i)}},this.RequestData=function(t,e,a){var i=this,r={HQChart:t,WindowIndex:e,HistoryData:a};return this.Data=[],r.HQChart.Period>0?(this.NotSupport(r.HQChart,r.WindowIndex,"不支持周期切换"),r.HQChart.Draw(),!1):(wx.request({url:this.ApiUrl,data:{symbol:r.HQChart.Symbol,startdate:20100101},method:"POST",dataType:"json",success:function(t){i.RecvData(t.data,r)}}),!0)},this.RecvData=function(t,e){if(!(t.date.length<0)){var a=new Array;for(var i in t.date){var r=new s.JSCommon_SingleData;r.Date=t.date[i],r.Value=t.value[i],a.push(r)}var n=e.HistoryData.GetFittingData(a),o=new s.JSCommon_ChartData;o.Data=n,o.Period=e.HQChart.Period,o.Right=e.HQChart.Right,this.Data=o.GetValue(),this.BindData(e.HQChart,e.WindowIndex,e.HistoryData),e.HQChart.UpdataDataoffset(),e.HQChart.UpdateFrameMaxMin(),e.HQChart.Draw()}},this.BindData=function(t,e,a){var i=t.GetChartPaint(e);if(i.length!=this.Index.length)return!1;i[0].Data.Data=this.Data,i[0].NotSupportMessage=null;var r=C.JSCommon_HQIndexFormula.MA(this.Data,this.Index[0].Param);i[1].Data.Data=r;var n=C.JSCommon_HQIndexFormula.MA(this.Data,this.Index[1].Param);i[2].Data.Data=n;var s=e+1;for(var o in i){var h="";h=0==o?t.Name+this.Index[o].Name:"MA"+this.Index[o-1].Param,t.TitlePaint[s].Data[o]=new I.JSCommonChartTitle_DynamicTitleData(i[o].Data,h,this.Index[o].LineColor),t.TitlePaint[s].Data[o].StringFormat=I.JSCommonChartTitle_STRING_FORMAT_TYPE.DEFAULT,t.TitlePaint[s].Data[o].FloatPrecision=2}return t.TitlePaint[s].Title=this.FormatIndexTitle(),!0}}function It(){this.newMethod=S.JSCommonIndex_BaseIndex,this.newMethod("Market-Heat"),delete this.newMethod,this.Index=new Array(new S.JSCommonIndex_IndexInfo("区域",3),new S.JSCommonIndex_IndexInfo("热度指数",10),new S.JSCommonIndex_IndexInfo("MA",5),new S.JSCommonIndex_IndexInfo("MA",10)),this.Data,this.ApiUrl=c.JSCommonResource_Global_JSChartResource.Index.CustomIndexHeatApiUrl,this.Index[1].LineColor=c.JSCommonResource_Global_JSChartResource.Index.LineColor[1],this.Index[2].LineColor=c.JSCommonResource_Global_JSChartResource.Index.LineColor[2],this.Index[3].LineColor=c.JSCommonResource_Global_JSChartResource.Index.LineColor[3],this.Create=function(t,e){for(var a in this.Index){var i=null;0==a?i=new D.JSCommonChartPaint_ChartStraightArea:(i=new D.JSCommonChartPaint_ChartLine,i.Color=this.Index[a].LineColor),i.Canvas=t.Canvas,i.Name=this.Name+"-"+a.toString(),i.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,i.ChartFrame=t.Frame.SubFrame[e].Frame,t.ChartPaint.push(i)}},this.RequestData=function(t,e,a){var i=this,r={HQChart:t,WindowIndex:e,HistoryData:a};return this.Data=[],r.HQChart.Period>0?(this.NotSupport(r.HQChart,r.WindowIndex,"不支持周期切换"),r.HQChart.Draw(),!1):(wx.request({url:this.ApiUrl,data:{stock:r.HQChart.CustomStock,date:{startdate:r.HQChart.QueryDate.Start,enddate:r.HQChart.QueryDate.End},day:[this.Index[0].Param,this.Index[1].Param]},method:"POST",dataType:"json",success:function(t){i.RecvData(t,r)}}),!0)},this.RecvData=function(t,e){var a=t.data;if(!(null==a.data||a.data.length<0)){var i=new Array;for(var r in a.data){var n=a.data[r],o=new s.JSCommon_SingleData;o.Date=n[0],o.Value=n[1],i.push(o)}var h=e.HistoryData.GetFittingData(i),l=new s.JSCommon_ChartData;l.Data=h,l.Period=e.HQChart.Period,l.Right=e.HQChart.Right,this.Data=l.GetValue(),this.BindData(e.HQChart,e.WindowIndex,e.HistoryData),e.HQChart.UpdataDataoffset(),e.HQChart.UpdateFrameMaxMin(),e.HQChart.Draw()}},this.BindData=function(t,e,a){var i=t.GetChartPaint(e);if(i.length!=this.Index.length)return!1;i[0].NotSupportMessage=null,i[0].Data.Data=[{Value:0,Value2:.2,Color:"rgb(46,139,87)",Title:"较差区",TitleColor:"rgb(245,255 ,250)"},{Value:.19,Value2:.4,Color:"rgb(255,140,0)",Title:"变热区",TitleColor:"rgb(245,255 ,250)"},{Value:.39,Value2:.8,Color:"rgb(255,106,106)",Title:"较好区",TitleColor:"rgb(245,255 ,250)"},{Value:.79,Value2:1,Color:"rgb(255,69,0)",Title:"过热区",TitleColor:"rgb(245,255 ,250)"}],i[1].Data.Data=this.Data;var r=C.JSCommon_HQIndexFormula.MA(this.Data,this.Index[2].Param);i[2].Data.Data=r;var n=C.JSCommon_HQIndexFormula.MA(this.Data,this.Index[3].Param);i[3].Data.Data=n,t.Frame.SubFrame[e].Frame.YSpecificMaxMin={Max:1,Min:0,Count:3};for(var s=e+1,o=1;o<i.length;++o){var h=this.Index[o].Name;"MA"==h&&(h="MA"+this.Index[o].Param),t.TitlePaint[s].Data[o]=new I.JSCommonChartTitle_DynamicTitleData(i[o].Data,h,this.Index[o].LineColor),t.TitlePaint[s].Data[o].StringFormat=I.JSCommonChartTitle_STRING_FORMAT_TYPE.DEFAULT,t.TitlePaint[s].Data[o].FloatPrecision=2}return t.TitlePaint[s].Title="热度("+this.Index[0].Param+","+this.Index[1].Param+","+this.Index[2].Param+","+this.Index[3].Param+")",!0}}function vt(){this.newMethod=S.JSCommonIndex_BaseIndex,this.newMethod("财务风险"),delete this.newMethod,this.Index=new Array(new S.JSCommonIndex_IndexInfo("区域",null),new S.JSCommonIndex_IndexInfo("系数",null)),this.Data,this.ApiUrl=c.JSCommonResource_Global_JSChartResource.Index.StockHistoryDayApiUrl,this.Index[0].LineColor=c.JSCommonResource_Global_JSChartResource.Index.LineColor[0],this.Index[1].LineColor="rgb(105,105,105)",this.Create=function(t,e){for(var a in this.Index){var i=null;0==a?i=new D.JSCommonChartPaint_ChartStraightArea:1==a&&(i=new W),i&&(i.Color=this.Index[a].LineColor,i.Canvas=t.Canvas,i.Name=this.Name+"-"+a.toString(),i.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,i.ChartFrame=t.Frame.SubFrame[e].Frame,t.ChartPaint.push(i))}},this.RequestData=function(t,e,a){var i=this,r={HQChart:t,WindowIndex:e,HistoryData:a};if(this.Data=[],2!=r.HQChart.Period)return this.NotSupport(r.HQChart,r.WindowIndex,"只支持月线"),r.HQChart.Draw(),!1;var n=["finance.benford","announcement2.quarter","announcement1.quarter","announcement3.quarter","announcement4.quarter"],s=[{item:["date","int32","gte","20130101"]},{item:["announcement1.year","int32","gte",0,"announcement2.year","int32","gte",0,"announcement3.year","int32","gte",0,"announcement4.year","int32","gte",0,"or"]}];return wx.request({url:this.ApiUrl,data:{symbol:[r.HQChart.Symbol],field:n,condition:s},method:"POST",dataType:"json",success:function(t){i.RecvData(t,r)}}),!0},this.JsonDataToMapSingleData=function(t){var e=t.stock[0].stockday,a=new Map;for(var i in e){var n=e[i],o=new s.JSCommon_SingleData;if(o.Date=n.date,o.Value=new Array,null!=n.finance1&&null!=n.announcement1){var h=n.announcement1.year,l=n.announcement1.quarter,u=n.finance1.benford;o.Value.push({Year:h,Quarter:l,Value:u})}if(null!=n.finance2&&null!=n.announcement2){var C=n.announcement2.year,D=n.announcement2.quarter,m=n.finance2.benford;o.Value.push({Year:C,Quarter:D,Value:m})}if(null!=n.finance3&&null!=n.announcement3){var S=n.announcement3.year,c=n.announcement3.quarter,f=n.finance3.benford;o.Value.push({Year:S,Quarter:c,Value:f})}if(null!=n.finance4&&null!=n.announcement4){var d=n.announcement4.year,I=n.announcement4.quarter,v=n.finance4.benford;o.Value.push({Year:d,Quarter:I,Value:v})}a.set(o.Date,o)}var p,T=new Array,F=(0,r.default)(a);try{for(F.s();!(p=F.n()).done;){n=p.value;T.push(n[1])}}catch(A){F.e(A)}finally{F.f()}return T},this.RecvData=function(t,e){if(n.JSConsole.Chart.Log(t),!(null==t.data.stock||t.data.stock.length<=0)){var a=this.JsonDataToMapSingleData(t.data),i=e.HistoryData.GetFittingMonthData(a),r=new s.JSCommon_ChartData;r.Data=i,r.Period=e.HQChart.Period,r.Right=e.HQChart.Right,this.Data=r.GetValue(),this.BindData(e.HQChart,e.WindowIndex,e.HistoryData),e.HQChart.UpdataDataoffset(),e.HQChart.UpdateFrameMaxMin(),e.HQChart.Draw()}},this.BindData=function(t,e,a){var i=t.GetChartPaint(e);if(i.length!=this.Index.length)return!1;i[0].NotSupportMessage=null,i[0].Data.Data=[{Value:0,Value2:.2,Color:"rgb(219,255,193)",Title:"安全区",TitleColor:"rgb(66,192,99)"},{Value:.2,Value2:.4,Color:"rgb(255,228,170)",Title:"预警区",TitleColor:"rgb(255,124,3)"},{Value:.4,Value2:1,Color:"rgb(254,219,212)",Title:"警示区",TitleColor:"rgb(255,0,0)"}],i[1].Data.Data=this.Data,t.Frame.SubFrame[e].Frame.YSpecificMaxMin={Max:1,Min:0,Count:3},t.Frame.SubFrame[e].Frame.YSplitScale=[.2,.4];var r=e+1;return t.TitlePaint[r].Data[1]=new I.JSCommonChartTitle_DynamicTitleData(i[1].Data,this.Index[1].Name,this.Index[1].LineColor),t.TitlePaint[r].Data[1].DataType="MultiReport",t.TitlePaint[r].Title=this.FormatIndexTitle(),!0}}function pt(t){var e=t.toUpperCase();if(e.indexOf(".SH")>0){if(e=e.replace(".SH",""),"0"==e.charAt(0)&&parseInt(e)<=3e3)return!0}else if(e.indexOf(".SZ")>0){if(e=e.replace(".SZ",""),"3"==e.charAt(0)&&"9"==e.charAt(1))return!0}else if(e.indexOf(".CI")>0)return!0;return!1}t.exports={JSCommon:{JSCanvasElement:v,JSChart:p,Guid:M,IFrameSplitOperator:d.JSCommonSplit_IFrameSplitOperator,ChartData:s.JSCommon_ChartData,DataPlus:s.JSCommon_DataPlus,KLineTooltipPaint:m.JSCommonExtendChartPaint_KLineTooltipPaint,MARKET_SUFFIX_NAME:h.JSCommonCoordinateData_MARKET_SUFFIX_NAME,JSCommonCoordinateData:h.JSCommonCoordinateData,FrameSplitKLineX:d.JSCommonSplit_FrameSplitKLineX,FrameSplitKLinePriceY:d.JSCommonSplit_FrameSplitKLinePriceY,JSCHART_EVENT_ID:s.JSCommon_JSCHART_EVENT_ID}}},5946:function(t,e,a){"use strict";var i=a("4ea4");a("a4d3"),a("e01a"),a("99af"),a("c975"),a("fb6a"),a("4e82"),a("4ec9"),a("6b93"),a("d3b7"),a("acd8"),a("e25e"),a("ac1f"),a("25f0"),a("6062"),a("3ca3"),a("5319"),a("1276"),a("ddb0");var r,n=i(a("ade3")),s=i(a("b85c")),o=a("a0cd"),h=a("8f32"),l=a("90f8"),u={Domain:"https://opensource.zealink.com",CacheDomain:"https://opensourcecache.zealink.com",CustomFunction:{Data:new Map},CustomVariant:{Data:new Map},IsCustomFunction:function(t){return!!u.CustomFunction.Data.has(t)},IsCustomVariant:function(t){return!!u.CustomVariant.Data.has(t)}},C={BadGetterArity:"Getter must not have any formal parameters",BadSetterArity:"Setter must have exactly one formal parameter",BadSetterRestParameter:"Setter function argument must not be a rest parameter",ConstructorIsAsync:"Class constructor may not be an async method",ConstructorSpecialMethod:"Class constructor may not be an accessor",DeclarationMissingInitializer:"Missing initializer in %0 declaration",DefaultRestParameter:"Unexpected token =",DuplicateBinding:"Duplicate binding %0",DuplicateConstructor:"A class may only have one constructor",DuplicateProtoProperty:"Duplicate __proto__ fields are not allowed in object literals",ForInOfLoopInitializer:"%0 loop variable declaration may not have an initializer",GeneratorInLegacyContext:"Generator declarations are not allowed in legacy contexts",IllegalBreak:"Illegal break statement",IllegalContinue:"Illegal continue statement",IllegalExportDeclaration:"Unexpected token",IllegalImportDeclaration:"Unexpected token",IllegalLanguageModeDirective:"Illegal 'use strict' directive in function with non-simple parameter list",IllegalReturn:"Illegal return statement",InvalidEscapedReservedWord:"Keyword must not contain escaped characters",InvalidHexEscapeSequence:"Invalid hexadecimal escape sequence",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",InvalidLHSInForLoop:"Invalid left-hand side in for-loop",InvalidModuleSpecifier:"Unexpected token",InvalidRegExp:"Invalid regular expression",LetInLexicalBinding:"let is disallowed as a lexically bound name",MissingFromClause:"Unexpected token",MultipleDefaultsInSwitch:"More than one default clause in switch statement",NewlineAfterThrow:"Illegal newline after throw",NoAsAfterImportNamespace:"Unexpected token",NoCatchOrFinally:"Missing catch or finally after try",ParameterAfterRestParameter:"Rest parameter must be last formal parameter",Redeclaration:"%0 '%1' has already been declared",StaticPrototype:"Classes may not have static property named prototype",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictFunction:"In strict mode code, functions can only be declared at top level or inside a block",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictModeWith:"Strict mode code may not include a with statement",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictParamDupe:"Strict mode function may not have duplicate parameter names",StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictReservedWord:"Use of future reserved word in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",TemplateOctalLiteral:"Octal literals are not allowed in template strings.",UnexpectedEOS:"Unexpected end of input",UnexpectedIdentifier:"Unexpected identifier",UnexpectedNumber:"Unexpected number",UnexpectedReserved:"Unexpected reserved word",UnexpectedString:"Unexpected string",UnexpectedTemplate:"Unexpected quasi %0",UnexpectedToken:"Unexpected token %0",UnexpectedTokenIllegal:"Unexpected token ILLEGAL",UnknownLabel:"Undefined label '%0'",UnterminatedRegExp:"Invalid regular expression: missing /"},D={NonAsciiIdentifierStart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AD\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDEC0-\uDEF8]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]/,NonAsciiIdentifierPart:/[\xAA\xB5\xB7\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B4\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C81-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1369-\u1371\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFC-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AD\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C4\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDEC0-\uDEF8]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/},m={FromCodePoint:function(t){return t<65536?String.fromCharCode(t):String.fromCharCode(55296+(t-65536>>10))+String.fromCharCode(56320+(t-65536&1023))},IsWhiteSpace:function(t){return 32===t||9===t||11===t||12===t||160===t||t>=5760&&[5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(t)>=0},IsLineTerminator:function(t){return 10===t||13===t||8232===t||8233===t},IsIdentifierStart:function(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||92===t||12304===t||12305===t||t>=128&&D.NonAsciiIdentifierStart.test(m.FromCodePoint(t))},IsIdentifierPart:function(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||92===t||12304===t||12305===t||t>=128&&D.NonAsciiIdentifierPart.test(m.FromCodePoint(t))},IsDecimalDigit:function(t){return t>=48&&t<=57},IsHexDigit:function(t){return t>=48&&t<=57||t>=65&&t<=70||t>=97&&t<=102},isOctalDigit:function(t){return t>=48&&t<=55}},S={};function c(){this.Error=[],this.RecordError=function(t){this.Error.push(t)},this.ConstructError=function(t,e){var a=new Error(t);try{throw a}catch(i){Object.create&&Object.defineProperties&&(a=Object.create(i),a.Column=e)}return a},this.CreateError=function(t,e,a,i){var r="Line "+e+": "+i,n=this.ConstructError(r,a);return n.Index=t,n.LineNumber=e,n.Description=i,n},this.ThrowError=function(t,e,a,i){var r=this.CreateError(t,e,a,i);throw r}}function f(t,e){this.Source=t,this.ErrorHandler=e,this.Length=t.length,this.Index=0,this.LineNumber=t.length>0?1:0,this.LineStart=0,this.CurlyStack=[],this.SaveState=function(){return{Index:this.Index,LineNumber:this.LineNumber,LineStart:this.LineStart}},this.RestoreState=function(t){this.Index=t.Index,this.LineNumber=t.LineNumber,this.LineStart=t.LineStart},this.IsEOF=function(){return this.Index>=this.Length},this.IsKeyword=function(t){return!1},this.CodePointAt=function(t){var e=this.Source.charCodeAt(t);if(e>=55296&&e<=56319){var a=this.Source.charCodeAt(t+1);if(a>=56320&&a<=57343){var i=e;e=1024*(i-55296)+a-56320+65536}}return e},this.Lex=function(){if(this.IsEOF())return{Type:2,Value:"",LineNumber:this.LineNumber,LineStart:this.LineStart,Start:this.Index,End:this.Index};var t=this.Source.charCodeAt(this.Index);return m.IsIdentifierStart(t)?this.ScanIdentifier():40===t||41===t||59===t?this.ScanPunctuator():39===t||34===t?this.ScanStringLiteral():46==t?m.IsDecimalDigit(this.Source.charCodeAt(this.Index+1))?this.ScanNumericLiteral():this.ScanPunctuator():m.IsDecimalDigit(t)?this.ScanNumericLiteral():t>=55296&&t<57343&&m.IsIdentifierStart(this.CodePointAt(this.Index))?this.ScanIdentifier():this.ScanPunctuator()},this.ScanIdentifier=function(){var t,e=this.Index,a=92===this.Source.charCodeAt(e)?this.GetComplexIdentifier():this.GetIdentifier();if(t=a.length?3:this.IsKeyword(a)?4:null==a?5:"true"==a||"false"==a?1:3,3!=t&&e+a.length!=this.Index){this.Index;throw this.Index=e,C.InvalidEscapedReservedWord}return"AND"!=a&&"OR"!=a||(t=7),{Type:t,Value:a,LineNumber:this.LineNumber,LineStart:this.LineStart,Start:e,End:this.Index}},this.GetIdentifier=function(){var t=this.Index++;while(!this.IsEOF()){var e=this.Source.charCodeAt(this.Index);if(92==e)return this.Index=t,this.GetComplexIdentifier();if(e>=55296&&e<57343)return this.Index=t,this.GetComplexIdentifier();if(!m.IsIdentifierPart(e))break;++this.Index}return this.Source.slice(t,this.Index)},this.ScanPunctuator=function(){var t=this.Index,e=this.Source[this.Index];switch(e){case"(":++this.Index;break;case")":case";":case",":++this.Index;break;case".":++this.Index;break;default:e=this.Source.substr(this.Index,3),"AND"==e?this.Index+=3:(e=this.Source.substr(this.Index,2),"&&"===e||"||"===e||"=="===e||"!="===e||"<>"===e||"<="===e||">="===e||"=>"===e||":="==e||"OR"==e?this.Index+=2:(e=this.Source[this.Index],"<>=!+-*%&|^/:".indexOf(e)>=0&&++this.Index))}return this.Index==t&&this.ThrowUnecpectedToken(),{Type:7,Value:e,LineNumber:this.LineNumber,LineStart:this.LineStart,Start:t,End:this.Index}},this.ScanStringLiteral=function(){var t=this.Index,e=this.Source[this.Index];++this.Index;var a="";while(!this.IsEOF()){var i=this.Source[this.Index++];if(i==e){e="";break}if("\\"==i)throw"not complete";if(m.IsLineTerminator(i.charCodeAt(0)))break;a+=i}return""!=e&&(this.Index=t,this.ThrowUnecpectedToken()),{Type:8,Value:a,LineNumber:this.LineNumber,LineStart:this.LineStart,Start:t,End:this.Index}},this.ScanNumericLiteral=function(){var t=this.Index,e=this.Source[this.Index],a="";if("."!=e){if(a=this.Source[this.Index++],e=this.Source[this.Index],"0"==a&&("x"==e||"X"==e))return++this.Index,this.ScanHexLiteral(t);while(m.IsDecimalDigit(this.Source.charCodeAt(this.Index)))a+=this.Source[this.Index++];e=this.Source[this.Index]}if("."==e){a+=this.Source[this.Index++];while(m.IsDecimalDigit(this.Source.charCodeAt(this.Index)))a+=this.Source[this.Index++];e=this.Source[this.Index]}if("e"==e||"E"==e)if(a+=this.Source[this.Index++],e=this.Source[this.Index],"+"!=e&&"-"!=e||(a+=this.Source[this.Index]),m.IsDecimalDigit(this.Source.charCodeAt(this.Index)))while(m.IsDecimalDigit(this.Source.charCodeAt(this.Index)))a+=this.Source[this.Index++];else this.ThrowUnecpectedToken();return m.IsIdentifierStart(this.Source.charCodeAt(this.Index))&&this.ThrowUnecpectedToken(),{Type:6,Value:parseFloat(a),LineNumber:this.LineNumber,LineStart:this.LineStart,Start:t,End:this.Index}},this.ScanComments=function(){var t;this.Index;while(!this.IsEOF()){var e=this.Source.charCodeAt(this.Index);if(m.IsWhiteSpace(e))++this.Index;else if(m.IsLineTerminator(e))++this.Index,13==e&&10==this.Source.charCodeAt(this.Index)&&++this.Index,++this.LineNumber,this.LineStart=this.Index,!0;else if(47==e){if(e=this.Source.charCodeAt(this.Index+1),47!=e)break;this.Index+=2;this.SkipSingleLineComment(2);!0}else{if(123!=e)break;this.Index+=1;this.SkipMultiLineComment()}}return t},this.SkipMultiLineComment=function(){var t=[];while(!this.IsEOF()){var e=this.Source.charCodeAt(this.Index);if(m.IsLineTerminator(e))++this.LineNumber,++this.Index,this.LineStart=this.Index;else{if(125==e)return this.Index+=1,t;++this.Index}}return t},this.SkipSingleLineComment=function(t){var e=[];while(!this.IsEOF()){var a=this.Source.charCodeAt(this.Index);if(++this.Index,m.IsLineTerminator(a))return 13===a&&10===this.Source.charCodeAt(this.Index)&&++this.Index,++this.LineNumber,this.LineStart=this.Index,e}return e},this.ThrowUnecpectedToken=function(t){return t||(t=C.UnexpectedTokenIllegal),this.ErrorHandler.ThrowError(this.Index,this.LineNumber,this.Index-this.LineStart+1,t)}}function d(t){this.ErrorHandler=new c,this.Scanner=new f(t,this.ErrorHandler),this.Buffer=[],this.GetNextToken=function(){if(0==this.Buffer.length){this.Scanner.ScanComments();if(!this.Scanner.IsEOF()){var t=this.Scanner.Lex(),e={Type:S[t.Type],Value:this.Scanner.Source.slice(t.Start,t.End)};this.Buffer.push(e)}}return this.Buffer.shift()}}S[1]="Boolean",S[2]="<end>",S[3]="Identifier",S[4]="Keyword",S[5]="Null",S[6]="Numeric",S[7]="Punctuator",S[8]="String",S[9]="RegularExpression",S[10]="Template";var I={AssignmentExpression:"AssignmentExpression",AssignmentPattern:"AssignmentPattern",ArrayExpression:"ArrayExpression",ArrayPattern:"ArrayPattern",ArrowFunctionExpression:"ArrowFunctionExpression",AwaitExpression:"AwaitExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ClassBody:"ClassBody",ClassDeclaration:"ClassDeclaration",ClassExpression:"ClassExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DoWhileStatement:"DoWhileStatement",DebuggerStatement:"DebuggerStatement",EmptyStatement:"EmptyStatement",ExportAllDeclaration:"ExportAllDeclaration",ExportDefaultDeclaration:"ExportDefaultDeclaration",ExportNamedDeclaration:"ExportNamedDeclaration",ExportSpecifier:"ExportSpecifier",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForOfStatement:"ForOfStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",Identifier:"Identifier",IfStatement:"IfStatement",ImportDeclaration:"ImportDeclaration",ImportDefaultSpecifier:"ImportDefaultSpecifier",ImportNamespaceSpecifier:"ImportNamespaceSpecifier",ImportSpecifier:"ImportSpecifier",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",MetaProperty:"MetaProperty",MethodDefinition:"MethodDefinition",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",ObjectPattern:"ObjectPattern",Program:"Program",Property:"Property",RestElement:"RestElement",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SpreadElement:"SpreadElement",Super:"Super",SwitchCase:"SwitchCase",SwitchStatement:"SwitchStatement",TaggedTemplateExpression:"TaggedTemplateExpression",TemplateElement:"TemplateElement",TemplateLiteral:"TemplateLiteral",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement",YieldExpression:"YieldExpression"};function v(){this.IsNeedIndexData=!1,this.IsNeedLatestData=!1,this.IsNeedSymbolData=!1,this.IsNeedMarginData=new Set,this.IsNeedNewsAnalysisData=new Set,this.IsNeedBlockIncreaseData=new Set,this.IsNeedSymbolExData=new Set,this.FunctionData=[],this.IsAPIData=[],this.GetDataJobList=function(){var t=[];this.IsNeedSymbolData&&t.push({ID:L.JOB_DOWNLOAD_SYMBOL_DATA}),this.IsNeedIndexData&&t.push({ID:L.JOB_DOWNLOAD_INDEX_DATA}),this.IsNeedLatestData&&t.push({ID:L.JOB_DOWNLOAD_SYMBOL_LATEST_DATA});var e,a=(0,s.default)(this.IsNeedBlockIncreaseData);try{for(a.s();!(e=a.n()).done;){var i=e.value;t.push({ID:L.JOB_DOWNLOAD_INDEX_INCREASE_DATA,Symbol:i})}}catch(S){a.e(S)}finally{a.f()}var r,n=(0,s.default)(this.IsNeedMarginData);try{for(n.s();!(r=n.n()).done;){var o=r.value;t.push({ID:o})}}catch(S){n.e(S)}finally{n.f()}var h,l=(0,s.default)(this.IsNeedNewsAnalysisData);try{for(l.s();!(h=l.n()).done;){o=h.value;t.push({ID:o})}}catch(S){l.e(S)}finally{l.f()}for(var u in this.IsAPIData){var C=this.IsAPIData[u];t.push(C)}var D,m=(0,s.default)(this.IsNeedSymbolExData);try{for(m.s();!(D=m.n()).done;){o=D.value;t.push({ID:o})}}catch(S){m.e(S)}finally{m.f()}for(var u in this.FunctionData){C=this.FunctionData[u];t.push(C)}return t},this.VerifySymbolVariable=function(t,e){var a=new Set(["INDEXA","INDEXC","INDEXH","INDEXL","INDEXO","INDEXV","INDEXDEC","INDEXADV"]);if(a.has(t))this.IsNeedIndexData=!0;else{var i=new Set(["CLOSE","C","VOL","V","OPEN","O","HIGH","H","LOW","L","AMOUNT"]);if(i.has(t))this.IsNeedSymbolData=!0;else if("VOLR"!==t)if("HYBLOCK"!=t&&"DYBLOCK"!=t&&"GNBLOCK"!=t){var r=new Set(["CAPITAL","TOTALCAPITAL","EXCHANGE"]);if(r.has(t)){var n={ID:L.JOB_DOWNLOAD_VARIANT,VariantName:t};return e&&(n.Token={Index:e.Start,Line:e.LineNumber}),void this.FunctionData.push(n)}if(u.IsCustomVariant(t)){n={VariantName:t,ID:L.JOB_CUSTOM_VARIANT_DATA};return e&&(n.Token={Index:e.Start,Line:e.LineNumber}),void this.FunctionData.push(n)}}else this.IsNeedSymbolExData.has(L.JOB_DOWNLOAD_GROUP_DATA)||this.IsNeedSymbolExData.add(L.JOB_DOWNLOAD_GROUP_DATA);else this.IsNeedSymbolExData.has(L.JOB_DOWNLOAD_VOLR_DATA)||this.IsNeedSymbolExData.add(L.JOB_DOWNLOAD_VOLR_DATA)}},this.VerifySymbolFunction=function(t,e,a){if(u.IsCustomFunction(t.Name)){var i={FunctionName:t.Name,ID:L.JOB_CUSTOM_FUNCTION_DATA,Args:e};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.FunctionData.push(i)}if("DYNAINFO"!=t.Name){if("FINANCE"==t.Name){i={ID:L.JOB_DOWNLOAD_FINANCE,Args:e,FunctionName:t.Name};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.FunctionData.push(i)}if("FINVALUE"==t.Name){i={ID:L.JOB_DOWNLOAD_FINVALUE,Args:e,FunctionName:t.Name};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.FunctionData.push(i)}if("FINONE"==t.Name){i={ID:L.JOB_DOWNLOAD_FINONE,Args:e,FunctionName:t.Name};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.FunctionData.push(i)}if("GPJYVALUE"==t.Name){i={ID:L.JOB_DOWNLOAD_GPJYVALUE,Args:e,FunctionName:t.Name};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.FunctionData.push(i)}if("MARGIN"!==t.Name)if("NEWS"!==t.Name){if("COST"==t.Name||"WINNER"==t.Name){i={ID:L.JOB_DOWNLOAD_FINANCE,Args:[7],FunctionName:"FINANCE",FunctionName2:t.Name};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.FunctionData.push(i)}if("BETA"!==t.Name)if("UPCOUNT"!=t.Name&&"DOWNCOUNT"!=t.Name){if("LOADAPIDATA"==t.Name){i={Name:t.Name,ID:L.JOB_DOWNLOAD_CUSTOM_API_DATA,Args:e};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.IsAPIData.push(i)}}else{var r=e[0].Value;this.IsNeedBlockIncreaseData.has(r)||this.IsNeedBlockIncreaseData.add(r)}else this.IsNeedIndexData=!0}else{var n=L.GetNewsAnalysisID(e[0].Value);n&&!this.IsNeedNewsAnalysisData.has(n)&&this.IsNeedNewsAnalysisData.add(n)}else{var s=L.GetMarginJobID(e[0].Value);s&&!this.IsNeedMarginData.has(s)&&this.IsNeedMarginData.add(s)}}else this.IsNeedLatestData=!0},this.ExpressionStatement=function(t){return{Type:I.ExpressionStatement,Expression:t}},this.Script=function(t){return{Type:I.Program,Body:t,SourceType:"通达信脚本"}},this.SequenceExpression=function(t){return{Type:I.SequenceExpression,Expression:t}},this.BinaryExpression=function(t,e,a){var i="||"===t||"&&"===t||"AND"==t||"OR"==t,r=i?I.LogicalExpression:I.BinaryExpression;return{Type:r,Operator:t,Left:e,Right:a}},this.Literal=function(t,e){return{Type:I.Literal,Value:t,Raw:e}},this.Identifier=function(t,e){return this.VerifySymbolVariable(t,e),{Type:I.Identifier,Name:t}},this.AssignmentExpression=function(t,e,a){return{Type:I.AssignmentExpression,Operator:t,Left:e,Right:a}},this.UnaryExpression=function(t,e){return{Type:I.UnaryExpression,Operator:t,Argument:e,Prefix:!0}},this.EmptyStatement=function(){return{Type:I.EmptyStatement}},this.CallExpression=function(t,e,a){return this.VerifySymbolFunction(t,e,a),{Type:I.CallExpression,Callee:t,Arguments:e}},this.StaticMemberExpression=function(t,e){return{Type:I.MemberExpression,Computed:!1,Object:t,Property:e}}}function p(t){this.ErrorHandler=new c,this.Scanner=new f(t,this.ErrorHandler),this.Node=new v,this.LookAhead={Type:2,Value:"",LineNumber:this.Scanner.LineNumber,LineStart:0,Start:0,End:0},this.HasLineTerminator=!1,this.Context={IsModule:!1,await:!1,allowIn:!0,allowStrictDirective:!0,allowYield:!0,FirstCoverInitializedNameError:null,IsAssignmentTarget:!1,IsBindingElement:!1,InFunctionBody:!1,inIteration:!1,inSwitch:!1,labelSet:{},Strict:!1},this.PeratorPrecedence={")":0,";":0,",":0,"]":0,"||":1,OR:1,"&&":2,AND:2,"|":3,"^":4,"&":5,"=":6,"==":6,"!=":6,"<>":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":11,"/":11,"%":11},this.StartMarker={Index:0,Line:this.Scanner.LineNumber,Column:0},this.LastMarker={Index:0,Line:this.Scanner.LineNumber,Column:0},this.Initialize=function(){this.NextToken(),this.LastMarker={Index:this.Scanner.Index,Line:this.Scanner.LineNumber,Column:this.Scanner.Index-this.Scanner.LineStart}},this.CreateNode=function(){return{Index:this.StartMarker.Index,Line:this.StartMarker.Line,Column:this.StartMarker.Column}},this.StartNode=function(t,e){void 0==e&&(e=0);var a=t.Start-t.LineStart,i=t.LineNumber;return a<0&&(a+=e,i--),{Index:t.Start,Line:i,Column:a}},this.Match=function(t){return 7==this.LookAhead.Type&&this.LookAhead.Value==t},this.Expect=function(t){var e=this.NextToken();7==e.Type&&e.Value==t||this.ThrowUnexpectedToken(e)},this.MatchAssign=function(){if(7!=this.LookAhead.Type)return!1;var t=this.LookAhead.Value;return":"==t||":="==t},this.GetTokenRaw=function(t){return this.Scanner.Source.slice(t.Start,t.End)},this.NextToken=function(){var t=this.LookAhead;this.LastMarker.Index=this.Scanner.Index,this.LastMarker.Line=this.Scanner.LineNumber,this.LastMarker.Column=this.Scanner.Index-this.Scanner.LineStart,this.CollectComments(),this.Scanner.Index!==this.StartMarker.Index&&(this.StartMarker.Index=this.Scanner.Index,this.StartMarker.Line=this.Scanner.LineNumber,this.StartMarker.Column=this.Scanner.Index-this.Scanner.LineStart);var e=this.Scanner.Lex();return this.HasLineTerminator=t.LineNumber!=e.LineNumber,e&&this.Context.Strict&&e.Type,this.LookAhead=e,t},this.CollectComments=function(){this.Scanner.ScanComments()},this.ParseScript=function(){var t=this.CreateNode(),e=this.ParseDirectivePrologues();while(2!=this.LookAhead.Type)e.push(this.ParseStatementListItem());return this.Finalize(t,this.Node.Script(e))},this.ParseDirective=function(){this.LookAhead,this.CreateNode(),this.ParseExpression()},this.ParseDirectivePrologues=function(){var t=[];while(1){var e=this.LookAhead;if(8!=e.Type)break;var a=this.ParseDirective();t.push(a)}return t},this.ParseStatementListItem=function(){var t;return this.Context.IsAssignmentTarget=!0,this.Context.IsBindingElement=!0,4==this.LookAhead.Type||(t=this.ParseStatement()),t},this.ParseStatement=function(){var t;switch(this.LookAhead.Type){case 1:case 5:case 6:case 8:case 10:case 9:t=this.ParseExpressionStatement();break;case 7:var e=this.LookAhead.Value;t="("===e?this.ParseExpressionStatement():";"===e?this.ParseEmptyStatement():this.ParseExpressionStatement();break;case 3:t=this.ParseLabelledStatement();break;case 4:break;default:t="error"}return t},this.ParseEmptyStatement=function(){var t=this.CreateNode();return this.Expect(";"),this.Finalize(t,this.Node.EmptyStatement())},this.ParseLabelledStatement=function(){var t=this.CreateNode(),e=this.ParseExpression();this.ConsumeSemicolon();var a=new this.Node.ExpressionStatement(e);return this.Finalize(t,a)},this.ParseExpression=function(){var t=this.LookAhead,e=this.IsolateCoverGrammar(this.ParseAssignmentExpression);if(this.Match(",")){var a=[];a.push(e);while(2!=this.LookAhead.Type){if(!this.Match(","))break;this.NextToken(),a.push(this.IsolateCoverGrammar(this.ParseAssignmentExpression))}e=this.Finalize(this.StartNode(t),this.Node.SequenceExpression(a))}return e},this.ParseAssignmentExpression=function(){var t,e=this.LookAhead,a=e;if(t=this.ParseConditionalExpression(),this.MatchAssign()){if(!this.Context.IsAssignmentTarget){var i=t.Marker;this.ThrowUnexpectedError(i.Index,i.Line,i.Column,C.InvalidLHSInAssignment)}this.Match("=")||this.Match(":")?this.ReinterpretExpressionAsPattern(t):(this.Context.IsAssignmentTarget=!1,this.Context.IsBindingElement=!1),a=this.NextToken();var r=a.Value,n=this.IsolateCoverGrammar(this.ParseAssignmentExpression);t=this.Finalize(this.StartNode(e),this.Node.AssignmentExpression(r,t,n)),this.Context.FirstCoverInitializedNameError=null}return t},this.ParseConditionalExpression=function(){this.LookAhead;var t=this.InheritCoverGrammar(this.ParseBinaryExpression);return t},this.ParseBinaryExpression=function(){var t=this.LookAhead,e=this.InheritCoverGrammar(this.ParseExponentiationExpression),a=this.LookAhead,i=this.BinaryPrecedence(a);if(i>0){this.NextToken(),this.Context.IsAssignmentTarget=!1,this.Context.IsBindingElement=!1;var r=[t,this.LookAhead],n=e,s=this.IsolateCoverGrammar(this.ParseExponentiationExpression),o=[n,a.Value,s],h=[i];while(1){if(i=this.BinaryPrecedence(this.LookAhead),i<=0)break;while(o.length>2&&i<=h[h.length-1]){s=o.pop();var l=o.pop();h.pop(),n=o.pop(),r.pop();var u=this.StartNode(r[r.length-1]);o.push(this.Finalize(u,this.Node.BinaryExpression(l,n,s)))}o.push(this.NextToken().Value),h.push(i),r.push(this.LookAhead),o.push(this.IsolateCoverGrammar(this.ParseExponentiationExpression))}var C=o.length-1;e=o[C];var D=r.pop();while(C>1){var m=r.pop(),S=D&&D.LineStart,c=this.StartNode(m,S),f=o[C-1];e=this.Finalize(c,this.Node.BinaryExpression(f,o[C-2],e)),C-=2,D=m}}return e},this.ParseExponentiationExpression=function(){this.LookAhead;var t=this.InheritCoverGrammar(this.ParseUnaryExpression);return t},this.ParseUnaryExpression=function(){var t;if(this.Match("+")||this.Match("-")){var e=this.StartNode(this.LookAhead),a=this.NextToken();t=this.InheritCoverGrammar(this.ParseUnaryExpression),t=this.Finalize(e,this.Node.UnaryExpression(a.Value,t)),this.Context.IsAssignmentTarget=!1,this.Context.IsBindingElement=!1}else t=this.ParseUpdateExpression();return t},this.ParseUpdateExpression=function(){var t;this.LookAhead;return t=this.InheritCoverGrammar(this.ParseLeftHandSideExpressionAllowCall),t},this.ParseLeftHandSideExpressionAllowCall=function(){var t,e=this.LookAhead;t=this.InheritCoverGrammar(this.ParsePrimaryExpression);while(1)if(this.Match(".")){this.Context.IsBindingElement=!1,this.Context.IsAssignmentTarget=!0,this.Expect(".");var a=this.ParseIdentifierName();t=this.Finalize(this.StartNode(e),this.Node.StaticMemberExpression(t,a))}else{if(!this.Match("("))break;this.Context.IsBindingElement=!1,this.Context.IsAssignmentTarget=!1;var i=this.ParseArguments();t=this.Finalize(this.StartNode(e),this.Node.CallExpression(t,i,e))}return t},this.IsIdentifierName=function(t){return 3===t.Type||4===t.Type||1===t.Type||5===t.Type},this.ParseIdentifierName=function(){var t=this.CreateNode(),e=this.NextToken();return this.IsIdentifierName(e)||this.ThrowUnexpectedToken(e),this.Finalize(t,this.Node.Identifier(e.Value,e))},this.ParseArguments=function(){this.Expect("(");var t=[];if(!this.Match(")"))while(1){var e=this.IsolateCoverGrammar(this.ParseAssignmentExpression);if(t.push(e),this.Match(")"))break;if(this.ExpectCommaSeparator(),this.Match(")"))break}return this.Expect(")"),t},this.ExpectCommaSeparator=function(){this.Expect(",")},this.ParsePrimaryExpression=function(){var t,e,a,i=this.CreateNode();switch(this.LookAhead.Type){case 3:e=this.NextToken(),t=this.Finalize(i,this.Node.Identifier(e.Value,e));break;case 6:case 8:this.Context.IsAssignmentTarget=!1,this.Context.IsBindingElement=!1,e=this.NextToken(),a=this.GetTokenRaw(e),t=this.Finalize(i,this.Node.Literal(e.Value,a));break;case 7:switch(this.LookAhead.Value){case"(":this.Context.IsBindingElement=!1,t=this.InheritCoverGrammar(this.ParseGroupExpression);break;default:t=this.ThrowUnexpectedToken(this.NextToken())}break;default:t=this.ThrowUnexpectedToken(this.NextToken())}return t},this.ParseGroupExpression=function(){var t;if(this.Expect("("),this.Match(")"))this.NextToken();else{this.LookAhead;var e=!1;if(this.Context.IsBindingElement=!0,t=this.InheritCoverGrammar(this.ParseAssignmentExpression),this.Match(",")){var a=[];this.Context.IsAssignmentTarget=!1,a.push(t);while(2!=this.LookAhead.Type){if(!this.Match(","))break;this.NextToken(),this.Match(")")}}e||(this.Expect(")"),this.Context.IsBindingElement=!1)}return t},this.ParseExpressionStatement=function(){var t=this.CreateNode(),e=this.ParseExpression();return this.ConsumeSemicolon(),this.Finalize(t,this.Node.ExpressionStatement(e))},this.ConsumeSemicolon=function(){this.Match(";")?this.NextToken():this.HasLineTerminator||(this.LastMarker.Index=this.StartMarker.Index,this.LastMarker.Line=this.StartMarker.Line,this.LastMarker.Column=this.StartMarker.Column)},this.ReinterpretExpressionAsPattern=function(t){switch(t.Type){case I.Identifier:case I.MemberExpression:case I.AssignmentExpression:break;default:break}},this.Finalize=function(t,e){return e.Marker={Line:t.Line,Column:t.Column,Index:t.Index},e},this.BinaryPrecedence=function(t){var e,a=t.Value;return e=7===t.Type&&this.PeratorPrecedence[a]||0,e},this.IsolateCoverGrammar=function(t){var e=this.Context.IsBindingElement,a=this.Context.IsAssignmentTarget,i=this.Context.FirstCoverInitializedNameError;this.Context.IsBindingElement=!0,this.Context.IsAssignmentTarget=!0,this.Context.FirstCoverInitializedNameError=null;var r=t.call(this);return this.Context.FirstCoverInitializedNameError,this.Context.IsBindingElement=e,this.Context.IsAssignmentTarget=a,this.Context.FirstCoverInitializedNameError=i,r},this.InheritCoverGrammar=function(t){var e=this.Context.IsBindingElement,a=this.Context.IsAssignmentTarget,i=this.Context.FirstCoverInitializedNameError;this.Context.IsBindingElement=!0,this.Context.IsAssignmentTarget=!0,this.Context.FirstCoverInitializedNameError=null;var r=t.call(this);return this.Context.IsBindingElement=this.Context.IsBindingElement&&e,this.Context.IsAssignmentTarget=this.Context.IsAssignmentTarget&&a,this.Context.FirstCoverInitializedNameError=i||this.Context.FirstCoverInitializedNameError,r},this.ThrowUnexpectedToken=function(t,e){throw this.UnexpectedTokenError(t,e)},this.ThrowUnexpectedError=function(t,e,a,i){var r=i||"执行异常";return this.ErrorHandler.ThrowError(t,e,a,r)},this.UnexpectedTokenError=function(t,e){var a=e||C.UnexpectedToken,i="ILLEGAL";if(t&&(i=t.Value),a=a.replace("%0",i),t&&"number"==typeof t.LineNumber){var r=t.Start,n=t.LineNumber,s=this.LastMarker.Index-this.LastMarker.Column,o=t.Start-s+1;return this.ErrorHandler.CreateError(r,n,o,a)}var h=this.LastMarker.Index,l=this.LastMarker.Line,u=this.LastMarker.Column+1;return this.ErrorHandler.CreateError(h,l,u,a)}}function T(t,e){this.ErrorHandler=t,this.SymbolData=e,this.Add=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return t+e;var r,n,s=[];if(!a&&!i){for(var o=Math.max(t.length,e.length),h=0;h<o;++h)s[h]=null,h<t.length&&h<e.length&&(isNaN(t[h])||isNaN(e[h])||(s[h]=t[h]+e[h]));return s}for(var l in a?(r=t,n=e):(r=e,n=t),n)s[l]=null,isNaN(n[l])||isNaN(r)||(s[l]=r+n[l]);return s},this.Subtract=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return t-e;var r=[];if(!a&&!i){for(var n=Math.max(t.length,e.length),s=0;s<n;++s)r[s]=null,s<t.length&&s<e.length&&(isNaN(t[s])||isNaN(e[s])||(r[s]=t[s]-e[s]));return r}if(a)for(var o in e)r[o]=null,isNaN(t)||isNaN(e[o])||(r[o]=t-e[o]);else for(var h in t)r[h]=null,isNaN(t[h])||isNaN(e)||(r[h]=t[h]-e);return r},this.Multiply=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return t*e;var r,n,s=[];if(!a&&!i){for(var o=Math.max(t.length,e.length),h=0;h<o;++h)s[h]=null,h<t.length&&h<e.length&&(isNaN(t[h])||isNaN(e[h])||(s[h]=t[h]*e[h]));return s}for(var l in a?(r=t,n=e):(r=e,n=t),n)s[l]=null,isNaN(n[l])||isNaN(r)||(s[l]=r*n[l]);return s},this.Divide=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return 0==e?null:t/e;var r=[];if(!a&&!i){for(var n=Math.max(t.length,e.length),s=0;s<n;++s)r[s]=null,s<t.length&&s<e.length&&this.IsNumber(t[s])&&this.IsDivideNumber(e[s])&&(r[s]=t[s]/e[s]);return r}if(a)for(var o in e)r[o]=null,this.IsNumber(t)&&this.IsDivideNumber(e[o])&&(r[o]=t/e[o]);else for(var h in t)r[h]=null,this.IsNumber(t[h])&&this.IsDivideNumber(e)&&(r[h]=t[h]/e);return r},this.GT=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return t>e?1:0;var r=[];if(!a&&!i){for(var n=Math.max(t.length,e.length),s=0;s<n;++s)r[s]=null,s<t.length&&s<e.length&&(isNaN(t[s])||isNaN(e[s])||(r[s]=t[s]>e[s]?1:0));return r}if(a)for(var o in e)r[o]=null,isNaN(t)||isNaN(e[o])||(r[o]=t>e[o]?1:0);else for(var h in t)r[h]=null,isNaN(t[h])||isNaN(e)||(r[h]=t[h]>e?1:0);return r},this.GTE=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return t>=e?1:0;var r=[];if(!a&&!i){for(var n=Math.max(t.length,e.length),s=0;s<n;++s)r[s]=null,s<t.length&&s<e.length&&(isNaN(t[s])||isNaN(e[s])||(r[s]=t[s]>=e[s]?1:0));return r}if(a)for(var o in e)r[o]=null,isNaN(t)||isNaN(e[o])||(r[o]=t>=e[o]?1:0);else for(var h in t)r[h]=null,isNaN(t[h])||isNaN(e)||(r[h]=t[h]>=e?1:0);return r},this.LT=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return t<e?1:0;var r=[];if(!a&&!i){for(var n=Math.max(t.length,e.length),s=0;s<n;++s)r[s]=null,s<t.length&&s<e.length&&(isNaN(t[s])||isNaN(e[s])||(r[s]=t[s]<e[s]?1:0));return r}if(a)for(var o in e)r[o]=null,isNaN(t)||isNaN(e[o])||(r[o]=t<e[o]?1:0);else for(var h in t)r[h]=null,isNaN(t[h])||isNaN(e)||(r[h]=t[h]<e?1:0);return r},this.LTE=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return t>=e?1:0;var r=[];if(!a&&!i){for(var n=Math.max(t.length,e.length),s=0;s<n;++s)r[s]=null,s<t.length&&s<e.length&&(isNaN(t[s])||isNaN(e[s])||(r[s]=t[s]<=e[s]?1:0));return r}if(a)for(var o in e)r[o]=null,isNaN(t)||isNaN(e[o])||(r[o]=t<=e[o]?1:0);else for(var h in t)r[h]=null,isNaN(t[h])||isNaN(e)||(r[h]=t[h]<=e?1:0);return r},this.EQ=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return t==e?1:0;var r=[];if(!a&&!i){for(var n=Math.max(t.length,e.length),s=0;s<n;++s)r[s]=null,s<t.length&&s<e.length&&(isNaN(t[s])||isNaN(e[s])||(r[s]=t[s]==e[s]?1:0));return r}if(a)for(var o in e)r[o]=null,isNaN(t)||isNaN(e[o])||(r[o]=t==e[o]?1:0);else for(var h in t)r[h]=null,isNaN(t[h])||isNaN(e)||(r[h]=t[h]==e?1:0);return r},this.NEQ=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return t!=e?1:0;var r=[];if(!a&&!i){for(var n=Math.max(t.length,e.length),s=0;s<n;++s)r[s]=null,s<t.length&&s<e.length&&(isNaN(t[s])||isNaN(e[s])||(r[s]=t[s]!=e[s]?1:0));return r}if(a)for(var o in e)r[o]=null,isNaN(t)||isNaN(e[o])||(r[o]=t!=e[o]?1:0);else for(var h in t)r[h]=null,isNaN(t[h])||isNaN(e)||(r[h]=t[h]!=e?1:0);return r},this.And=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return t&&e?1:0;var r=[];if(!a&&!i){for(var n=Math.max(t.length,e.length),s=0;s<n;++s)r[s]=null,s<t.length&&s<e.length&&(isNaN(t[s])||isNaN(e[s])||(r[s]=t[s]&&e[s]?1:0));return r}if(a)for(var o in e)r[o]=null,isNaN(t)||isNaN(e[o])||(r[o]=t&&e[o]?1:0);else for(var h in t)r[h]=null,isNaN(t[h])||isNaN(e)||(r[h]=t[h]&&e?1:0);return r},this.Or=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return t||e?1:0;var r=[];if(!a&&!i){for(var n=Math.max(t.length,e.length),s=0;s<n;++s)r[s]=null,s<t.length&&s<e.length&&(isNaN(t[s])||isNaN(e[s])||(r[s]=t[s]||e[s]?1:0));return r}if(a)for(var o in e)r[o]=null,isNaN(t)||isNaN(e[o])||(r[o]=t||e[o]?1:0);else for(var h in t)r[h]=null,isNaN(t[h])||isNaN(e)||(r[h]=t[h]||e?1:0);return r},this.IF=function(t,e,a){var i=this.IsNumber(t),r=this.IsNumber(e),n=this.IsNumber(a),s=Array.isArray(e),o=Array.isArray(a);if(i)return t?e:a;var h=[];for(var l in t)t[l]?h[l]=r?e:s?e[l]:null:h[l]=n?a:o?a[l]:null;return h},this.IFN=function(t,e,a){return this.IF(t,a,e)},this.REF=function(t,e){var a=[];if("number"==typeof e){if(t.length<=0)return a;if(e>=t.length)return a;a=t.slice(0,t.length-e);for(var i=0;i<e;++i)a.unshift(null)}else for(var r=0;r<t.length;++r)if(a[r]=null,!(r>=e.length)){var n=e[r];a[r]=n>0&&n<=r?t[r-n]:r?a[r-1]:t[r]}return a},this.REFV=function(t,e){var a=[];if("number"==typeof e){if(t.length<=0)return a;if(e>=t.length)return a;a=t.slice(0,t.length-e);for(var i=0;i<e;++i)a.unshift(null)}else for(var r=0;r<t.length;++r)if(a[r]=null,!(r>=e.length)){var n=e[r];n>=0&&n<=r&&(a[r]=t[r-n])}return a},this.REFX=function(t,e){var a=[];if("number"==typeof e){if(t.length<=0)return a;if(e>=t.length)return a;a=t.slice(e,t.length);for(var i=t[t.length-1],r=0;r<e;++r)a.push(i)}else for(var n=t.length,s=0;s<t.length;++s)if(a[s]=null,!(s>=e.length)){var o=e[s];a[s]=o>=0&&o+s<n?t[s+o]:s?a[s-1]:t[s]}return a},this.REFXV=function(t,e){var a=[];if("number"==typeof e){if(t.length<=0)return a;if(e>=t.length)return a;a=t.slice(e,t.length);for(var i=0;i<e;++i)a.push(null)}else for(var r=t.length,n=0;n<t.length;++n)if(a[n]=null,!(n>=e.length)){var s=e[n];s>=0&&s+n<r&&(a[n]=t[n+s])}return a},this.MAX=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return Math.max(t,e);var r=[];if(!a&&!i){for(var n=Math.max(t.length,e.length),s=0;s<n;++s)r[s]=null,s<t.length&&s<e.length&&(isNaN(t[s])||isNaN(e[s])||(r[s]=Math.max(t[s],e[s])));return r}if(a)for(var o in e)r[o]=null,isNaN(t)||isNaN(e[o])||(r[o]=Math.max(t,e[o]));else for(var h in t)r[h]=null,isNaN(t[h])||isNaN(e)||(r[h]=Math.max(t[h],e));return r},this.MIN=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return Math.min(t,e);var r=[];if(!a&&!i){for(var n=Math.max(t.length,e.length),s=0;s<n;++s)r[s]=null,s<t.length&&s<e.length&&(isNaN(t[s])||isNaN(e[s])||(r[s]=Math.min(t[s],e[s])));return r}if(a)for(var o in e)r[o]=null,isNaN(t)||isNaN(e[o])||(r[o]=Math.min(t,e[o]));else for(var h in t)r[h]=null,isNaN(t[h])||isNaN(e)||(r[h]=Math.min(t[h],e));return r},this.ABS=function(t){var e=[];for(var a in t)e[a]=null,isNaN(t[a])||(e[a]=Math.abs(t[a]));return e},this.MA=function(t,e){if(e<=0)return[];var a=[];if(!t||!t.length)return a;for(var i=0;i<t.length;++i)if(a[i]=null,this.IsNumber(t[i]))break;t=t.slice(0);for(var r=0;i<t.length;++i,++r)if(r<e-1)a[i]=null;else{for(var n=t[i-(e-1)],s=0,o=e-1;o>=0;--o){var h=t[i-o];this.IsNumber(h)?n=h:(h=n,t[i-o]=h),s+=h}a[i]=s/e}return a},this.EMA=function(t,e){var a=[],i=0;if(i>=t.length)return a;for(;i<t.length;++i)if(null!=t[i]&&!isNaN(t[i]))break;var r=i,n=i+1;a[r]=t[r];for(var s=i+1;s<t.length;++s,++r,++n)a[n]=(2*t[n]+(e-1)*a[r])/(e+1);return a},this.XMA=function(t,e){for(var a=[],i=0;i<t.length;++i)if(this.IsNumber(t[i]))break;for(var r=parseInt((e-2)/2),n=0,s=0,o=0,h=0,l=i,u=0;l<t.length;++l){for(o=l-r-1,h=l+(e-r)-1,u=o;u<h;++u)u>=0&&u<t.length&&this.IsNumber(t[u])&&(n+=t[u],++s);a[l]=0!=s?n/s:null,n=0,s=0}return a},this.SMA=function(t,e,a){for(var i=[],r=0,n=null;r<t.length;++r)if(null!=t[r]&&!isNaN(t[r])){n=t[r],i[r]=n;break}for(++r;r<t.length;++r)i[r]=(a*t[r]+(e-a)*n)/e,n=i[r];return i},this.DMA=function(t,e){var a=[];if(t.length<0||t.length!=e.length)return a;for(var i=0;i<t.length;++i)if(null!=t[i]&&!isNaN(t[i])&&null!=e[i]&&!isNaN(e[i])){a[i]=t[i];break}for(i+=1;i<t.length;++i)null==t[i]||null==e[i]?a[i]=null:t[i]<1?a[i]=e[i]*t[i]+(1-e[i])*a[i-1]:a[i]=t[i];return a},this.WMA=function(t,e){var a=[];if(!t||!t.length)return a;e<1&&(e=1);var i=0;for(i=0;i<t.length&&!this.IsNumber(t[i]);++i)a[i]=null;t=t.slice(0);for(var r=0;i<t.length;++i,++r)if(r<e-1)a[i]=null;else{for(var n=t[i-(e-1)],s=0,o=0,h=e-1;h>=0;--h){var l=t[i-h];this.IsNumber(l)?n=l:(l=n,t[i-h]=l),o+=e-h,s+=l*(e-h)}a[i]=s/o}return a},this.MEMA=function(t,e){var a=[];if(!t||!t.length)return a;var i=0,r=0;for(r=0;r<t.length&&!this.IsNumber(t[r]);++r)a[r]=null;if(i=r,e<1||i+e>=t.length)return a;var n=0;for(t=t.slice(0);i<r+e;++i)a[i]=null,!this.IsNumber(t[i])&&i-1>=0&&(t[i]=t[i-1]),n+=t[i];for(a[i-1]=n/e;i<t.length;++i)this.IsNumber(a[i-1])&&this.IsNumber(t[i])?a[i]=(t[i]+a[i-1]*(e-1))/e:i-1>-1&&this.IsNumber(a[i-1])?a[i]=a[i-1]:a[i]=null;return a},this.EXPMA=function(t,e){var a=[];if(e>=t.length)return a;for(var i=e;i<t.length;++i)if(null!=t[i]){a[i]=t[i];break}for(i+=1;i<t.length;++i)null!=a[i-1]&&null!=t[i]?a[i]=(2*t[i]+(e-1)*a[i-1])/(e+1):null!=a[i-1]&&(a[i]=a[i-1]);return a},this.EXPMEMA=function(t,e){var a=[];if(e>=t.length)return a;for(var i=0;i<t.length;++i)if(t[i]&&!isNaN(t[i]))break;for(var r=0,n=0;i<t.length&&n<e;++n,++i)t[i]&&!isNaN(t[i])?r+=t[i]:r+=t[i-1];for(a[i-1]=r/e;i<t.length;++i)null!=a[i-1]&&null!=t[i]?a[i]=(2*t[i]+(e-1)*a[i-1])/(e+1):null!=a[i-1]&&(a[i]=a[i-1]);return a},this.SUMBARS=function(t,e){var a=[];if(!t||!t.length||!e||!e.length)return a;for(var i=0,r=0,n=0;i<t.length&&!this.IsNumber(t[i]);++i)a[i]=null;var s=0;for(r=t.length-1;r>=i;--r){for(n=r,s=0;n>=i&&s<e[r];--n)s+=t[n];a[r]=n<i?null:r-n}for(r=i+1;r<t.length;++r)null==a[r]&&(a[r]=a[r-1]);return a},this.REVERSE=function(t){for(var e=[],a=0;a<t.length&&!this.isNumber(t[a]);++a)e[a]=null;for(;a<t.length;++a)this.isNumber(t[a])?e[a]=0-t[a]:e[a]=null;return e},this.COUNT=function(t,e){if(Array.isArray(e)){for(var a=null,i=t.length,r=0;r<i;++r)if(this.IsNumber(t[r])){a=r;break}if(null==a)return[];var n=[],s=0;for(r=0;r<e.length;++r){var o=e[r];if(this.IsNumber(o)){o<1&&(o=r+1),s=0;for(var h=r,l=0;h>=0&&l<o;--h,++l)t[h]&&++s;n[r]=s}}return n}for(o=e,i=t.length,o=o<1?i:o,r=0,h=0;r<i;++r)if(this.IsNumber(t[r]))break;n=[];for(var u=0;r<i&&h<o;++r,++h)u=t[r]?u+1:u,n[r]=u;for(;r<i;++r)t[r-o]&&u&&u--,u=t[r]?u+1:u,n[r]=u;return n},this.HHV=function(t,e){var a=[];if(Array.isArray(e)){for(var i=null,r=0,n=0;r<t.length;++r)if(a[r]=null,!(r>=e.length)){i=null;var s=e[r];if(s>0&&s<=r)for(n=r-s;n<=r;++n)(null==i||i<t[n])&&(i=t[n]);else for(s=r,n=0;n<=r;++n)(null==i||i<t[n])&&(i=t[n]);a[r]=i}}else{if(e>t.length)return a;e<=0&&(e=t.length-1);var o=0;for(o=0;o<t.length;++o)if(this.IsNumber(t[o]))break;o<t.length&&(a[o]=t[o]);for(r=o+1,n=2;r<t.length&&n<e;++r,++n)t[r]>=t[o]&&(o=r),a[r]=t[o];for(;r<t.length;++r){if(r-o<e)o=t[r]<t[o]?o:r;else for(n=o=r-e+1;n<=r;++n)o=t[n]<t[o]?o:n;a[r]=t[o]}}return a},this.LLV=function(t,e){var a=[];if(Array.isArray(e)){for(var i=0;i<t.length;++i)if(a[i]=null,!(i>=e.length)){var r=null,n=e[i];if(n>0&&n<=i)for(var s=i-n;s<=i;++s)(null==r||r>t[s])&&(r=t[s]);else{n=i;for(s=0;s<=i;++s)(null==r||r>t[s])&&(r=t[s])}a[i]=r}}else{if(e>t.length)return a;e<=0&&(e=t.length-1);var o=0;for(o=0;o<t.length;++o)if(this.IsNumber(t[o]))break;o<t.length&&(a[o]=t[o]);for(i=o+1,s=2;i<t.length&&s<e;++i,++s)t[i]<=t[o]&&(o=i),a[i]=t[o];for(;i<t.length;++i){if(i-o<e)o=t[i]>t[o]?o:i;else for(s=o=i-e+1;s<=i;++s)o=t[s]>t[o]?o:s;a[i]=t[o]}}return a},this.STD=function(t,e){for(var a=[],i=0,r=[],n=e-1;n<t.length;++n){i=0;for(var s=0;s<e;++s)i+=t[n-s];r[n]=i/e}for(n=e-1;n<t.length;++n){i=0;for(s=0;s<e;++s)i+=Math.pow(t[n-s]-r[n],2);a[n]=Math.sqrt(i/e)}return a},this.AVEDEV=function(t,e){for(var a=[],i=0,r=[],n=e-1;n<t.length;++n){i=0;for(var s=0;s<e;++s)i+=t[n-s];r[n]=i/e}for(n=e-1;n<t.length;++n){i=0;for(s=0;s<e;++s)i+=Math.abs(t[n-s]-r[n]);a[n]=i/e}return a},this.CROSS=function(t,e){var a=[];if(Array.isArray(t)&&Array.isArray(e)){if(t.length!=e.length)return[];for(var i=0;i<t.length;++i)if(this.IsNumber(t[i])&&this.IsNumber(e[i]))break;for(++i;i<t.length;++i)a[i]=t[i]>e[i]&&t[i-1]<e[i-1]?1:0}else if(Array.isArray(t)&&"number"==typeof e){for(i=0;i<t.length;++i)if(this.IsNumber(t[i]))break;for(++i;i<t.length;++i)a[i]=t[i]>e&&t[i-1]<e?1:0}else if("number"==typeof t&&Array.isArray(e)){for(i=0;i<e.length;++i)if(this.IsNumber(e[i]))break;for(++i;i<e.length;++i)a[i]=e[i]<t&&e[i-1]>t?1:0}return a},this.MULAR=function(t,e){var a=[];if(t.length<e)return a;for(var i=e;i<t.length;++i)if(null!=t[i]&&!isNaN(t[i])){a[i]=t[i];break}for(++i;i<t.length;++i)a[i]=a[i-1]*t[i];return a},this.SUM=function(t,e){var a=[];if(0==e){a[0]=t[0];for(var i=1;i<t.length;++i)a[i]=a[i-1]+t[i]}else{i=e-1;for(var r=0;i<t.length;++i,++r)for(var n=0;n<e;++n)0==n?a[i]=t[n+r]:a[i]+=t[n+r]}return a},this.BARSCOUNT=function(t){var e=[],a=null;for(var i in t)e[i]=0,null==a&&(this.IsNumber(t[i])||contnue,a=0),e[i]=a,++a;return e},this.DEVSQ=function(t,e){var a=[];"number"!=typeof e&&(e=parseInt(e));var i=e,r=t.length,n=0,s=0,o=0,h=0,l=0;for(n=0;n<r&&!this.isNumber(t[n]);++n)a[n]=null;if(i<1||n+i>r)return a;for(h=0;n<r&&s<i;++n,++s)h+=t[n]/i;if(s==i){for(l=0,n--;o<i;o++)l+=(t[n-o]-h)*(t[n-o]-h);a[n]=l,n++}for(;n<r;++n){for(h+=(t[n]-t[n-i])/i,l=0,o=0;o<i;++o)l+=(t[n-o]-h)*(t[n-o]-h);a[n]=l}return a},this.NOT=function(t){var e="number"==typeof t;if(e)return t?0:1;var a=[];for(var i in t)a[i]=null,this.IsNumber(t[i])&&(a[i]=t[i]?0:1);return a},this.FORCAST=function(t,e){var a=[];"number"!=typeof e&&(e=parseInt(e));var i=e,r=t.length;if(i<1||i>=r)return a;var n,s,o,h,l,u=0,C=0,D=0,m=0;for(h=0;h<r&&!this.IsNumber(t[h]);++h)a[h]=null;for(o=h+i-1;o<r;++o){for(u=C=D=m=0,h=0,l=i;h<i&&h<=o;++h,--l)u+=l,C+=t[o-h];for(u/=i,C/=i,h=0,l=i;h<i&&h<=o;++h,--l)D+=(l-u)*(t[o-h]-C),m+=(l-u)*(l-u);s=D/m,n=C-u*s,a[o]=s*i+n}return a},this.SLOPE=function(t,e){var a=[];if("number"!=typeof e&&(e=parseInt(e)),e<1||!t.length)return a;if(e>=t.length)return a;for(var i,r,n,s,o=0,h=0;h<t.length;++h,++o)if(a[h]=null,this.IsNumber(t[h]))break;for(var l=o+e-1;l<t.length;++l){a[l]=null,i=r=n=s=0;for(var u=0;u<e&&u<=l;++u)i+=l-u,r+=t[l-u];for(i/=e,r/=e,u=0;u<e&&u<=l;++u)n+=(l-u-i)*(t[l-u]-r),s+=(l-u-i)*(l-u-i);s?a[l]=n/s:l&&(a[l]=a[l-1])}return a},this.STDP=function(t,e){var a=[];"number"!=typeof e&&(e=parseInt(e));var i=e,r=t.length;if(i<1||i>=r)return a;var n=0,s=0;for(n=0;n<r&&!this.isNumber(t[n]);++n)a[n]=null;for(var o,h=0,l=0;n<r&&s<i;++n,++s)h+=t[n]*t[n],l+=t[n];for(s==i&&(o=i*h-l*l,a[n-1]=Math.sqrt(o)/i);n<r;++n)h+=t[n]*t[n]-t[n-i]*t[n-i],l+=t[n]-t[n-i],o=i*h-l*l,a[n]=Math.sqrt(o)/i},this.VAR=function(t,e){var a=[];"number"!=typeof e&&(e=parseInt(e));var i,r,n,s,o=e,h=t.length;if(o<=1||o>=h)return a;for(i=0;i<h&&!this.IsNumber(t[i]);++i)a[i]=null;for(r=0,i=i+o-1;i<h;++i){for(n=s=0,r=0;r<o&&r<=i;++r)n+=t[i-r]*t[i-r],s+=t[i-r];a[i]=(o*n-s*s)/o*(o-1)}return a},this.VARP=function(t,e){var a=[];"number"!=typeof e&&(e=parseInt(e));var i=e,r=t.length;if(i<1||i>=r)return a;var n=0,s=0;for(n=0;n<r&&!this.IsNumber(t[n]);++n)a[n]=null;for(var o=0,h=0;n<r&&s<i;++n,++s)o+=t[n]*t[n],h+=t[n];for(s==i&&(a[n-1]=(i*o-h*h)/(i*i));n<r;++n)o+=t[n]*t[n]-t[n-i]*t[n-i],h+=t[n]-t[n-i],a[n]=(i*o-h*h)/(i*i);return a},this.RANGE=function(t,e,a){var i="number"==typeof t,r="number"==typeof e,n="number"==typeof a;if(i&&r&&n)return t>Math.min(e,a)&&t<Math.max(e,a)?1:0;for(var s,o,h=[],l=0;l<t.length;++l)if(h[l]=null,s=t[l],this.IsNumber(s)){if(r)o=e;else{if(l>=e.length)continue;o=e[l]}if(this.IsNumber(o)){if(n)rangeValue2=a;else{if(l>=a.length)continue;rangeValue2=a[l]}this.IsNumber(rangeValue2)&&(h[l]=s>Math.min(o,rangeValue2)&&s<Math.max(o,rangeValue2)?1:0)}}return h},this.EXIST=function(t,e){if(e=parseInt(e),"number"==typeof t)return 0;for(var a,i,r=[],n=0;n<t.length;++n)r[n]=null,i=t[n],this.IsNumber(i),r[n]=n-a<e?1:0;return r},this.TFILTER=function(t,e,a){a=parseInt(a);for(var i=[],r=Math.max(t.length,e.length),n=0;n<r;++n);return i},this.FILTER=function(t,e){for(var a=[],i=0,r=0;i<t.length;++i)if(t[i]){for(a[i]=1,r=0;r<e&&r+i+1<t.length;++r)a[r+i+1]=0;i+=e}else a[i]=0;return a},this.BARSLAST=function(t){var e=[];if(!t)return e;for(var a=null,i=0;i<t.length;++i)e[i]=null,t[i]>0?a=0:null!=a&&++a,null!=a&&(e[i]=a);return e},this.BARSSINCEN=function(t,e){var a=[];if(this.IsNumber(e)&&Array.isArray(t)){var i=e;i<1&&(i=t.length);var r=this.GetFirstVaildIndex(t);if(r>=t.length)return a;var n=0;for(n=r<=i-1?i-1:r,a[n]=n-r;n<t.length;++n)if(this.IsNumber(a[n-1])){if(a[n-1]+1<i)a[n]=a[n-1]+1;else for(var s=n-i+1;s<=n;++s)if(!(Math.abs(t[s])<1e-6)){a[n]=n-s;break}}else Math.abs(t[n])<1e-6||(a[n]=0)}return a},this.BARSSINCE=function(t){for(var e=[],a=null,i=0;i<t.length;++i)e[i]=null,null==a?t[i]&&(a=0):++a,a&&(e[i]=a);return e},this.Trigonometric=function(t,e){if(Array.isArray(t)){var a=[];for(var i in t){var r=t[i];this.IsNumber(r)?a[i]=e(r):a[i]=null}return a}return this.IsNumber(t)?e(t):null},this.ASIN=function(t){if(Array.isArray(t)){var e=[];for(var a in t){var i=t[a];if(e[a]=null,this.IsNumber(i))if(i>=-1&&i<=1)e[a]=Math.asin(i);else if(a-1>=0){var r=e[a-1];this.IsNumber(r)&&(e[a]=r)}}return e}return this.IsNumber(t)?Math.acos(t):null},this.ACOS=function(t){if(Array.isArray(t)){var e=[];for(var a in t){var i=t[a];if(e[a]=null,this.IsNumber(i))if(i>=-1&&i<=1)e[a]=Math.acos(i);else if(a-1>=0){var r=e[a-1];this.IsNumber(r)&&(e[a]=r)}}return e}return this.IsNumber(t)?Math.acos(t):null},this.LAST=function(t,e,a){var i=[];if(a<=0&&(a=t.length-1),a>e)return i;for(var r=0,n=0,s=0;n<t.length;++n){i[n]=0,r=0;var o=n-e,h=n-a;if(!(o<0||h<0)){for(s=o;s<t.length&&s<=h;++s,++r)if(!t[s])break;r==h-o+1&&(i[n]=1)}}return i},this.ZIG=function(t,e){var a=this.SymbolData.Data,i=[];if("number"==typeof t)switch(t){case 0:t=a.GetOpen();break;case 1:t=a.GetHigh();break;case 2:t=a.GetLow();break;case 3:t=a.GetClose();break;default:return i}return this.ZIG_Calculate(t,e)},this.ZIG_Calculate=function(t,e){var a=[],i=t.length,r=this.GetFirstVaildIndex(t),n=0,s=0,o=0,h=0,l=0;for(n=r+1,s=o=r;n<i-1&&o==r;++n)o=100*Math.abs(t[n]-t[r])>=e*t[r]?t[n]>t[r]?n:-n:r;for(;n<i-1;++n)if(t[n]>=t[n-1]&&t[n]>=t[n+1])if(o<0){if(100*(t[n]-t[-o])<e*t[-o])continue;for(l=(t[s]-t[h=-o])/(-o-s),a[h--]=t[-o];h>=s;h--)a[h]=t[-o]+(-o-h)*l;s=-o,o=n}else t[n]>t[o]&&(o=n);else if(t[n]<=t[n-1]&&t[n]<=t[n+1])if(o>0){if(100*(t[o]-t[n])<e*t[o])continue;for(l=(t[o]-t[h=s])/(o-s),a[h++]=t[s];h<=o;++h)a[h]=t[s]+(h-s)*l;s=o,o=-n}else t[n]<t[-o]&&(o=-n);if(Math.abs(o)>=i-2&&(o>0&&t[i-1]>=t[o]&&(o=i-1),o<0&&t[i-1]<=t[-o]&&(o=1-i)),o>0)for(l=(t[o]-t[h=s])/(o-s),a[h++]=t[s];h<=o;++h)a[h]=t[s]+(h-s)*l;else for(l=(t[s]-t[h=-o])/(-o-s),a[h--]=t[-o];h>=s;h--)a[h]=t[-o]+(-o-h)*l;if((o=Math.abs(o))<i-1)if(t[i-1]>=t[o])for(l=(t[i-1]-t[h=o])/(i-o),a[h++]=t[o];h<i;++h)a[h]=t[o]+(h-o)*l;else for(l=(t[o]-t[h=i-1])/(i-o),a[h--]=t[i-1];h>=o;h--)a[h]=t[i-1]+(i-h)*l;return a},this.GetFirstVaildIndex=function(t){for(var e=0;e<t.length;++e)if(this.IsNumber(t[e]))return e;return t.length},this.JSDraw=null,this.CalculateZIGLine=function(t,e,a,i,r){null==this.JSDraw&&(this.JSDraw=new F(this.ErrorHandler));var n=e.Up,s=t;if(n)for(var o=t.ID+1;o<a.ID;++o){var h=i[o];this.IsNumber(h)&&(s.Value<h&&(s={ID:o,Value:h}))}else for(o=t.ID+1;o<a.ID;++o){h=i[o];this.IsNumber(h)&&(s.Value>h&&(s={ID:o,Value:h}))}e.Value=s.Value,e.ID=s.ID;var l={Start:{ID:t.ID,Value:t.Value},End:{ID:e.ID,Value:e.Value}},u=this.JSDraw.CalculateDrawLine(l);for(var o in u){var C=u[o];r[C.ID]=C.Value}if(a.ID==i.length-1)for(var o in l={Start:{ID:e.ID,Value:e.Value},End:{ID:a.ID,Value:a.Value}},u=this.JSDraw.CalculateDrawLine(l),u){C=u[o];r[C.ID]=C.Value}else t.ID=e.ID,t.Value=e.Value,e.ID=a.ID,e.Value=a.Value,e.Up=t.Value<e.Value},this.TROUGHBARS=function(t,e,a){var i=this.ZIG(t,e),r=[],n=a;if(n<1)return r;for(var s=i.length,o=[],h=0;h<n;++h)o[h]=0;var l=0;h=this.GetFirstVaildIndex(i)+1;for(n--;h<s&&i[h]>i[h-1];++h);for(;h<s&&i[h]<i[h-1];++h);for(o[0]=--h;h<s-1;++h){if(i[h]<i[h+1]){if(l){if(n)for(var u=o.slice(0),C=0;C<n;++C)o[C+1]=u[C];o[l=0]=h}}else l=1;o[n]&&(r[h]=h-o[n])}return o[n]&&(r[h]=h-o[n]),r},this.TROUGH=function(t,e,a){var i=this.ZIG(t,e),r=[],n=a;if(n<1)return r;for(var s=i.length,o=[],h=0;h<n;++h)o[h]=0;h=1;var l=0;h=this.GetFirstVaildIndex(i)+1;for(n--;h<s&&i[h]>i[h-1];++h);for(;h<s&&i[h]<i[h-1];++h);for(o[0]=--h;h<s-1;++h){if(i[h]<i[h+1]){if(l){if(n)for(var u=o.slice(0),C=0;C<n;++C)o[C+1]=u[C];o[l=0]=h}}else l=1;o[n]&&(r[h]=i[o[n]])}return o[n]&&(r[h]=i[o[n]]),r},this.PEAKBARS=function(t,e,a){var i=this.ZIG(t,e),r=[],n=i.length,s=a;if(s<1)return r;for(var o=[],h=0;h<s;++h)o[h]=0;var l=0;h=this.GetFirstVaildIndex(i)+1;for(s--;h<n&&i[h]<i[h-1];++h);for(;h<n&&i[h]>i[h-1];++h);for(o[0]=--h;h<n-1;++h){if(i[h]>i[h+1]){if(l){if(s)for(var u=o.slice(0),C=0;C<s;++C)o[C+1]=u[C];o[l=0]=h}}else l=1;o[s]&&(r[h]=h-o[s])}return o[s]&&(r[h]=h-o[s]),r},this.PEAK=function(t,e,a){var i=this.ZIG(t,e),r=[],n=i.length,s=a;if(s<1)return r;for(var o=0,h=[],l=0;l<s;++l)h[l]=0;l=this.GetFirstVaildIndex(i)+1;for(s--;l<n&&i[l]<i[l-1];++l);for(;l<n&&i[l]>i[l-1];++l);for(h[0]=--l;l<n-1;++l){if(i[l]>i[l+1]){if(o){if(s)for(var u=h.slice(0),C=0;C<s;++C)h[C+1]=u[C];h[o=0]=l}}else o=1;h[s]&&(r[l]=i[h[s]])}return h[s]&&(r[l]=i[h[s]]),r},this.EVERY=function(t,e){var a=[];if(e<1)return a;for(var i=0;i<t.length;++i)if(a[i]=null,this.IsNumber(t[i]))break;for(var r=0;i<t.length;++i)t[i]?r+=1:r=0,r==e?(a[i]=1,--r):a[i]=0;return a},this.COST=function(t,e){var a=[],i=t/100;if(i<1e-6||i>1)return a;var r=this.SymbolData.Data.Data;if(!r||r.length<=0)return a;for(var n=this.SymbolData.GetStockCacheData({FunctionName:"FINANCE",Args:[7],ArgCount:1,Node:e}),s=r[0].High,o=r[0].Low,h=0;h<r.length;++h){var l=r[h];o=Math.min(o,l.Low),s=Math.max(s,l.High)}(o>2e3||o<0||s>2e3||o<0)&&this.ThrowUnexpectedNode(e,"COST() 历史K线最大最小值错误, 超出(0,1000)范围");var u=parseInt(100*s+1),C=parseInt(100*o-1),D=0,m=0,S=0;s=u/100,o=C/100;var c=u-C+1;if(c<1)return a;var f=[],d=[];for(h=0;h<c;++h)f[h]=0,d[h]=0;var I=0,v=0,p=0,T=0;for(h=0;h<r.length;++h)if(!(h>=n.length)){if(n[h]>1){var F=r[h];I=F.Vol/n[h];for(var A=0;A<c;A++)f[A]*=1-I;D=parseInt(Math.min(u,Math.max(C,100*F.Low)))-C,m=parseInt(Math.min(u,Math.max(C,100*F.High)))-C,S=parseInt(Math.min(u,Math.max(C,100*F.Close)))-C;for(A=0;A<c;++A)d[A]=0;var M=parseInt((D+m+2*S)/4);if(M==m||M==D)d[M]+=F.Vol;else{for(var E=F.Vol/(M-D),L=D;L<M;++L)d[L]+=E/(M-D)*(L-D);for(L;L<=m;++L)d[L]+=E/(M-m)*(L-m)}for(v=0,A=D;A<=m;A++)f[A]+=d[A];for(A=0;A<c;A++)v+=f[A];for(A=0,T=p=0;A<c;++A)if(p+=f[A],p>=v*i){T=(s-o)*A/c+o;break}}a[h]=T}return a},this.WINNER=function(t,e){var a=[],i=this.SymbolData.Data.Data;if(!i||i.length<=0)return a;for(var r=this.SymbolData.GetStockCacheData({FunctionName:"FINANCE",Args:[7],ArgCount:1,Node:e}),n=i[0].High,s=i[0].Low,o=0;o<i.length;++o){var h=i[o];s=Math.min(s,h.Low),n=Math.max(n,h.High)}(s>1e3||s<0||n>1e3||s<0)&&this.ThrowUnexpectedNode(e,"WINNER() 历史K线最大最小值错误, 超出(0,1000)范围");var l=parseInt(100*n+1),u=parseInt(100*s-1),C=0,D=0,m=0;n=l/100,s=u/100;var S=l-u+1;if(S<1)return a;var c=[],f=[];for(o=0;o<S;++o)c[o]=0,f[o]=0;var d=0,I=0,v=0;for(o=0;o<i.length;++o)if(!(o>=r.length)&&r[o]>1){var p=i[o];d=p.Vol/r[o];for(var T=0;T<S;T++)c[T]*=1-d;C=parseInt(Math.min(l,Math.max(u,100*p.Low)))-u,D=parseInt(Math.min(l,Math.max(u,100*p.High)))-u,m=parseInt(Math.min(l,Math.max(u,100*p.Close)))-u;for(T=0;T<S;++T)f[T]=0;var F=parseInt((C+D+2*m)/4);if(F==D||F==C)f[F]+=p.Vol;else{for(var A=p.Vol/(F-C),M=C;M<F;++M)f[M]+=A/(F-C)*(M-C);for(M;M<=D;++M)f[M]+=A/(F-D)*(M-D)}for(I=0,T=C;T<=D;T++)c[T]+=f[T];for(T=0;T<S;T++)I+=c[T];D=Array.isArray(t)?parseInt(Math.min(100*t[o]-u,S-1)):parseInt(Math.min(100*t-u,S-1));for(T=0,v=0;T<=D;T++)v+=c[T];I>0?a[o]=v/I:o-1>=0&&(a[o]=a[o-1])}return a},this.CalculateChip=function(t,e,a,i){for(var r={Min:null,Max:null,Data:[]},n=1,s=null,o=null,h=t;h>=0;--h){var l={},u=a[h];l.Vol=h==t?u.Vol*e[h]:u.Vol*n,l.Date=u.Date,l.High=u.High,l.Low=u.Low,(null==s||s<l.High)&&(s=l.High),(null==o||o<l.Low)&&(o=l.Low),r.Data[h]=l,n*=1-e[h]/100*i}return r.Max=s,r.Min=o,r},this.UPNDAY=function(t,e){var a=[];if(e<1)return a;if(null==t||e>t.length)return a;for(var i=0,r=0;r<t.length;++r)a[r]=0,r-1<0||(this.IsNumber(t[r])&&this.IsNumber(t[r-1])?(t[r]>t[r-1]?++i:i=0,i==e&&(a[r]=1,--i)):i=0);return a},this.DOWNNDAY=function(t,e){var a=[];if(e<1)return a;if(null==t||e>t.length)return a;for(var i=0,r=0;r<t.length;++r)a[r]=0,r-1<0||(this.IsNumber(t[r])&&this.IsNumber(t[r-1])?(t[r]<t[r-1]?++i:i=0,i==e&&(a[r]=1,--i)):i=0);return a},this.NDAY=function(t,e,a){var i=[];if(a<1)return i;if(!Array.isArray(t)&&!Array.isArray(e))return i;if(null==t||null==e)return i;if(Array.isArray(t)&&Array.isArray(e)){if(a>=t.length||a>=e.length)return i;for(var r=Math.max(t.length,e.length),n=0,s=0;s<r;++s)i[s]=0,s>=t.length||s>=e.length||(this.IsNumber(t[s])&&this.IsNumber(e[s])?(t[s]>e[s]?++n:n=0,n==a&&(i[s]=1,--n)):n=0)}else if(Array.isArray(t)&&!Array.isArray(e)){if(a>=t.length||!this.IsNumber(e))return;n=0;for(var o in t)i[o]=0,this.IsNumber(t[o])?(t[o]>e?++n:n=0,n==a&&(i[o]=1,--n)):n=0}else if(!Array.isArray(t)&&Array.isArray(e)){if(a>=e.length||!this.IsNumber(t))return;n=0;for(var h in e)i[h]=0,this.IsNumber(e[h])?(t>e[h]?++n:n=0,n==a&&(i[h]=1,--n)):n=0}return i},this.LONGCROSS=function(t,e,a){for(var i=[],r=Math.max(t.length,e.length),n=0;n<r;++n)i[n]=0,n-1<0||n>=t.length||n>=e.length||this.IsNumber(t[n])&&this.IsNumber(e[n])&&this.IsNumber(t[n-1])&&this.IsNumber(e[n-1])&&t[n]>e[n]&&t[n-1]<e[n-1]&&(i[n]=1);for(var s=0,o=0;s<r;++s)if(i[s])for(o=1;o<=a&&s-o>=0;++o)if(t[s-o]>=e[s-o]){i[s]=0;break}return i},this.EXISTR=function(t,e,a){var i=[];if(!Array.isArray(t))return i;if(e=parseInt(e),a=parseInt(a),e<=0&&(e=t.length),a<=0&&(a=1),a>e)return i;i=[];for(var r=0,n=0;r<t.length;++r)if(i[r]=null,!(r-e<0||r-a<0))for(i[r]=0,n=e;n>=a;--n){var s=t[r-n];if(this.IsNumber(s)&&s){i[r]=1;break}}return i},this.RELATE=function(t,e,a){var i=[];if(a<1&&(a=1),!Array.isArray(t)||!Array.isArray(e))return i;for(var r=this.CalculateAverage(t,a),n=this.CalculateAverage(e,a),s=Math.max(t.length,e.length),o=0,h=0;o<s;++o)if(i[o]=null,!(o>=t.length||o>=e.length||o>=r.length||o>=n.length)){var l=r[o],u=n[o],C=0,D=0,m=0;for(h=o-a+1;h<=o;++h)C+=(t[h]-l)*(e[h]-u),D+=Math.pow(t[h]-l,2),m+=Math.pow(e[h]-u,2);i[o]=C/a/(Math.sqrt(D/a)*Math.sqrt(m/a))}return i},this.CalculateAverage=function(t,e){var a=[];if(e<1)return a;for(var i=0,r=0;r<t.length;++r)if(this.IsNumber(t[r]))break;for(;r<t.length&&r<e;++r){a[r]=null;var n=t[r];this.IsNumber(n)&&(i+=n)}for(a[r-1]=i/e;r<t.length;++r){n=t[r];var s=t[r-e];this.IsNumber(n)||(n=0),this.IsNumber(s)||(s=0),i=i-s+n,a[r]=i/e}return a},this.COVAR=function(t,e,a){var i=[];if(a<1&&(a=1),!Array.isArray(t)||!Array.isArray(e))return i;for(var r=this.CalculateAverage(t,a),n=this.CalculateAverage(e,a),s=Math.max(t.length,e.length),o=(s=Math.max(t.length,e.length),0),h=0;o<s;++o)if(i[o]=null,!(o>=t.length||o>=e.length||o>=r.length||o>=n.length)){var l=r[o],u=n[o],C=0;for(h=o-a+1;h<=o;++h)C+=(t[h]-l)*(e[h]-u);i[o]=C/a}return i},this.HHVBARS=function(t,e){var a=[];if(!Array.isArray(t))return a;if(Array.isArray(e))for(var i=0;i<e.length;++i){a[i]=null;var r=e[i];if(this.IsNumber(r)){var n=i-r;n<0&&(n=0);for(var s=null,o=n;o<t.length;++o)if(this.IsNumber(t[o])){s=o;break}for(var h=0;o<t.length&&h<r;++h,++o)t[o]>=t[s]&&(s=o);null!=s&&(a[i]=i-s)}}else{e<1&&(e=t.length);for(s=null,i=0;i<t.length;++i)if(a[i]=null,this.IsNumber(t[i])){s=i;break}o=0;for(i=s+1;i<t.length&&o<e;++i,++o)t[i]>=t[s]&&(s=i),e==t.length&&(a[i]=i-s);for(;i<t.length;++i){if(i-s<e)t[i]>=t[s]&&(s=i);else for(s=i-e+1,o=s;o<=i;++o)t[o]>=t[s]&&(s=o);a[i]=i-s}}return a},this.LLVBARS=function(t,e){var a=[];if(!Array.isArray(t))return a;if(Array.isArray(e))for(var i=0;i<e.length;++i){a[i]=null;var r=e[i];if(this.IsNumber(r)){var n=i-r;n<0&&(n=0);for(var s=null,o=n;o<t.length;++o)if(this.IsNumber(t[o])){s=o;break}for(var h=0;o<t.length&&h<r;++h,++o)t[o]<=t[s]&&(s=o);null!=s&&(a[i]=i-s)}}else{e<1&&(e=t.length);for(s=null,i=0;i<t.length;++i)if(a[i]=null,this.IsNumber(t[i])){s=i;break}o=0;for(i=s+1;i<t.length&&o<e;++i,++o)t[i]<=t[s]&&(s=i),e==t.length&&(a[i]=i-s);for(;i<t.length;++i){if(i-s<e)t[i]<=t[s]&&(s=i);else for(s=i-e+1,o=s;o<=i;++o)t[o]<=t[s]&&(s=o);a[i]=i-s}}return a},this.BETA=function(t){var e=[],a=this.SymbolData.Data,i=this.SymbolData.IndexData;t<=0&&(t=1);for(var r=[],n=[],s=0;s<a.Data.length;++s){r[s]=0,n[s]=0;var o=a.Data[s],h=i.Data[s];o.Close>0&&o.YClose>0&&(r[s]=(o.Close-o.YClose)/o.YClose),h.Close>0&&h.YClose>0&&(n[s]=(h.Close-h.YClose)/h.YClose)}for(var l=this.CalculateAverage(r,t),u=this.CalculateAverage(n,t),C=0,D=0;C<a.Data.length;++C)if(e[C]=null,!(C>=r.length||C>=n.length||C>=l.length||C>=u.length)){var m=l[C],S=u[C],c=0,f=0;for(D=C-t+1;D<=C;++D){var d=n[D]-S,I=r[D]-m;c+=d*I,f+=d*d}this.IsDivideNumber(f)&&this.IsNumber(c)&&(e[C]=c/f)}return e},this.BETA2=function(t,e,a){var i=[];a<=0&&(a=1);for(var r=[null],n=[null],s=Math.max(t.length,e.length),o={X:t[0],Y:e[0]},h=1;h<s;++h){r[h]=0,n[h]=0;var l=t[h],u=e[h];o.X>0&&(r[h]=(l-o.X)/o.X),o.Y>0&&(n[h]=(u-o.Y)/o.Y),o={X:l,Y:u}}for(var C=this.CalculateAverage(r,a),D=this.CalculateAverage(n,a),m=(h=0,0);h<s;++h)if(i[h]=null,!(h>=r.length||h>=n.length||h>=C.length||h>=D.length)){var S=C[h],c=D[h],f=0,d=0;for(m=h-a+1;m<=h;++m){var I=r[m]-S,v=n[m]-c;f+=I*v,d+=I*I}this.IsDivideNumber(d)&&this.IsNumber(f)&&(i[h]=f/d)}return i},this.SAR=function(t,e,a){var i=[],r=this.SymbolData.Data;if(t>=r.Data.length)return i;for(var n=null,s=null,o=0;o<t;++o){var h=r.Data[o];null==n?n=h.High:n<h.High&&(n=h=n),(null==s||s>h.Low)&&(s=h.Low)}var l=0,u=1,C=l;i[t-1]=s;var D=s,m=r.Data[0].High,S=a/100;for(o=t;o<r.Data.length;++o){var c=m,f=(h=r.Data[o],r.Data[o-1]);C==l?h.Low<i[o-1]?(C=u,m=h.Low,S=e/100,D=Math.max(h.High,f.High),D=Math.max(D,c+S*(m-c))):(C=l,h.High>c&&(m=h.High,S=Math.min(S+e/100,a/100)),D=Math.min(h.Low,f.Low),D=Math.min(D,i[o-1]+S*(m-i[o-1]))):C==u&&(h.High>i[o-1]?(C=l,m=h.High,S=e/100,D=Math.min(h.Low,f.Low),D=Math.min(D,i[o-1]+S*(m-c))):(C=u,h.Low<c&&(m=h.Low,S=Math.min(S+e/100,a/100)),D=Math.max(h.High,f.High),D=Math.max(D,i[o-1]+S*(m-i[o-1])))),i[o]=D}return i},this.SARTURN=function(t,e,a){var i=[],r=this.SAR(t,e,a),n=this.SymbolData.Data,s=0;for(s=0;s<r.length;++s)if(this.IsNumber(r[s]))break;var o=0;s<n.Data.length&&(o=n.Data[s].Close>r[s]);for(var h=s+1;h<n.Data.length;++h){var l=n.Data[h];l.Close<r[h]&&o?i[h]=-1:i[h]=l.Close>r[h]&&!o?1:0,o=l.Close>r[h]}return i},this.BACKSET=function(t,e){var a=[];if(!t)return a;var i=t.length;if(!this.IsNumber(i)||i<=0)return a;if(Array.isArray(e)){for(var r=0;r<i;++r)a[r]=0;for(r=0;r<i;++r){var n=t[r],s=e[r];if(this.IsNumber(n)&&n&&this.IsNumber(s))for(var o=r,h=0;o>=0&&h<s;--o,++h)a[o]=1}}else{for(r=0;r<i;++r)a[r]=0;for(var l=0;l<i;++l)if(this.IsNumber(t[l]))break;if(l==i)return a;var u=Math.min(i-l,Math.max(e,1));for(r=i-1,o=0;r>=0;--r){n=t[r];if(this.IsNumber(n)&&n)for(o=r;o>r-u;--o)a[o]=1}if(t[r])for(o=r;o>=l;--o)a[o]=1}return a},this.STRCAT=function(t,e){var a=[];return this.IsString(t)&&this.IsString(e)&&(a=t+e),a},this.VARCAT=function(t,e){var a=[];if(Array.isArray(t)&&Array.isArray(e))for(var i=Math.max(t.length,e.length),r="",n=0;n<i;++n){if(a[n]=null,r="",n<t.length){var s=t[n];this.IsString(s)&&(r+=s)}if(n<e.length){s=e[n];this.IsString(s)&&(r+=s)}""!=r&&(a[n]=r)}else if(this.IsString(t)&&Array.isArray(e))for(n=0;n<e.length;++n){a[n]=null;s=e[n];this.IsString(s)&&(a[n]=t+s)}else if(Array.isArray(t)&&this.IsString(e))for(n=0;n<t.length;++n){a[n]=null;s=t[n];this.IsString(s)&&(a[n]=s+e)}else this.IsString(t)&&this.IsString(e)&&(a=t+e);return a},this.STRSPACE=function(t){var e=[];if(Array.isArray(t))for(var a=0;a<t.length;++a){e[a]=null;var i=t[a];TouchList.IsString(i)&&(e[a]=i+" ")}else this.IsString(t)&&(e=t+" ");return e},this.CON2STR=function(t,e){var a=[];if(Array.isArray(t))for(var i=t.length-1;i>=0;--i){var r=t[i];if(this.IsNumber(r))return a=r.toFixed(e),a}else this.IsNumber(t)&&(a=t.toFixed(e));return a},this.VAR2STR=function(t,e){var a=[];if(Array.isArray(t))for(var i=0;i<t.length;++i){a[i]=null;var r=t[i];this.IsNumber(r)&&(a[i]=r.toFixed(e))}else this.IsNumber(t)&&(a=t.toFixed(e));return a},this.ZTPRICE=function(t,e){if(!this.IsNumber(e))return null;if(Array.isArray(t)){var a=[];for(var i in t){var r=t[i];this.IsNumber(r)?a[i]=(1+e)*r:a[i]=null}return a}if(this.IsNumber(t)){a=(1+e)*t;return a}},this.DTPRICE=function(t,e){if(!this.IsNumber(e))return null;if(Array.isArray(t)){var a=[];for(var i in t){var r=t[i];this.IsNumber(r)?a[i]=(1-e)*r:a[i]=null}return a}if(this.IsNumber(t)){a=(1-e)*t;return a}},this.FRACPART=function(t){if(Array.isArray(t)){var e=[],a=0;for(var i in t){var r=t[i];this.IsNumber(r)?(a=parseInt(r),e[i]=r-a):e[i]=null}return e}if(this.IsNumber(t)){a=parseInt(t);e=t-a;return e}},this.BARSLASTCOUNT=function(t){var e=null;if(Array.isArray(t)){if(e=[],t.length>0)for(var a=0,i=t.length-1;i>=0;--i){a=0;for(var r=i;r>=0;--r){if(!t[r])break;++a}e[i]=a}}else e=t?1:0;return e},this.INTPART=function(t){var e=null;if(Array.isArray(t))for(var a in e=[],t){var i=t[a];this.IsNumber(i)?e[a]=parseInt(i):e[a]=null}else this.IsNumber(t)&&(e=parseInt(t));return e},this.CallFunction=function(t,e,a){switch(t){case"MAX":return this.MAX(e[0],e[1]);case"MIN":return this.MIN(e[0],e[1]);case"REF":return this.REF(e[0],e[1]);case"REFV":return this.REFV(e[0],e[1]);case"REFX":return this.REFX(e[0],e[1]);case"REFXV":return this.REFXV(e[0],e[1]);case"ABS":return this.ABS(e[0]);case"MA":return this.MA(e[0],e[1]);case"EMA":return this.EMA(e[0],e[1]);case"SMA":return this.SMA(e[0],e[1],e[2]);case"DMA":return this.DMA(e[0],e[1]);case"XMA":return this.XMA(e[0],e[1]);case"EXPMA":return this.EXPMA(e[0],e[1]);case"EXPMEMA":return this.EXPMEMA(e[0],e[1]);case"COUNT":return this.COUNT(e[0],e[1]);case"LLV":return this.LLV(e[0],e[1]);case"LLVBARS":return this.LLVBARS(e[0],e[1]);case"HHV":return this.HHV(e[0],e[1]);case"HHVBARS":return this.HHVBARS(e[0],e[1]);case"MULAR":return this.MULAR(e[0],e[1]);case"CROSS":return this.CROSS(e[0],e[1]);case"LONGCROSS":return this.LONGCROSS(e[0],e[1],e[2]);case"AVEDEV":return this.AVEDEV(e[0],e[1]);case"STD":return this.STD(e[0],e[1]);case"IF":case"IFF":return this.IF(e[0],e[1],e[2]);case"IFN":return this.IFN(e[0],e[1],e[2]);case"NOT":return this.NOT(e[0]);case"SUM":return this.SUM(e[0],e[1]);case"RANGE":return this.RANGE(e[0],e[1],e[2]);case"EXIST":return this.EXIST(e[0],e[1]);case"EXISTR":return this.EXISTR(e[0],e[1],e[2]);case"FILTER":return this.FILTER(e[0],e[1]);case"TFILTER":return this.TFILTER(e[0],e[1],e[2]);case"SLOPE":return this.SLOPE(e[0],e[1]);case"BARSLAST":return this.BARSLAST(e[0]);case"BARSCOUNT":return this.BARSCOUNT(e[0]);case"BARSSINCEN":return this.BARSSINCEN(e[0],e[1]);case"BARSSINCE":return this.BARSSINCE(e[0]);case"LAST":return this.LAST(e[0],e[1],e[2]);case"EVERY":return this.EVERY(e[0],e[1]);case"ZIG":return this.ZIG(e[0],e[1]);case"TROUGHBARS":return this.TROUGHBARS(e[0],e[1],e[2]);case"TROUGH":return this.TROUGH(e[0],e[1],e[2]);case"PEAKBARS":return this.PEAKBARS(e[0],e[1],e[2]);case"PEAK":return this.PEAK(e[0],e[1],e[2]);case"COST":return this.COST(e[0],a);case"WINNER":return this.WINNER(e[0],a);case"UPNDAY":return this.UPNDAY(e[0],e[1]);case"DOWNNDAY":return this.DOWNNDAY(e[0],e[1]);case"NDAY":return this.NDAY(e[0],e[1],e[2]);case"DEVSQ":return this.DEVSQ(e[0],e[1]);case"FORCAST":return this.FORCAST(e[0],e[1]);case"STDP":return this.STDP(e[0],e[1]);case"VAR":return this.VAR(e[0],e[1]);case"VARP":return this.VARP(e[0],e[1]);case"RELATE":return this.RELATE(e[0],e[1],e[2]);case"COVAR":return this.COVAR(e[0],e[1],e[2]);case"BETA":return this.BETA(e[0]);case"BETA2":return this.BETA2(e[0],e[1],e[2]);case"WMA":return this.WMA(e[0],e[1]);case"MEMA":return this.MEMA(e[0],e[1]);case"SUMBARS":return this.SUMBARS(e[0],e[1]);case"REVERSE":return this.REVERSE(e[0]);case"SAR":return this.SAR(e[0],e[1],e[2]);case"SARTURN":return this.SARTURN(e[0],e[1],e[2]);case"BACKSET":return this.BACKSET(e[0],e[1]);case"STRCAT":return this.STRCAT(e[0],e[1]);case"VARCAT":return this.VARCAT(e[0],e[1]);case"VAR2STR":return this.VAR2STR(e[0],e[1]);case"CON2STR":return this.CON2STR(e[0],e[1]);case"STRSPACE":return this.STRSPACE(e[0]);case"DTPRICE":return this.DTPRICE(e[0],e[1]);case"ZTPRICE":return this.ZTPRICE(e[0],e[1]);case"FRACPART":return this.FRACPART(e[0]);case"BARSLASTCOUNT":return this.BARSLASTCOUNT(e[0]);case"INTPART":return this.INTPART(e[0]);case"ATAN":return this.Trigonometric(e[0],Math.atan);case"ACOS":return this.ACOS(e[0]);case"ASIN":return this.ASIN(e[0]);case"COS":return this.Trigonometric(e[0],Math.cos);case"SIN":return this.Trigonometric(e[0],Math.sin);case"TAN":return this.Trigonometric(e[0],Math.tan);case"LN":return this.Trigonometric(e[0],Math.log);case"LOG":return this.Trigonometric(e[0],Math.log10);case"EXP":return this.Trigonometric(e[0],Math.exp);case"SQRT":return this.Trigonometric(e[0],Math.sqrt);default:this.ThrowUnexpectedNode(a,"函数"+t+"不存在")}},this.CallCustomFunction=function(t,e,a,i){var r=u.CustomFunction.Data.get(t),n=a.GetStockCacheData({CustomName:t,Node:i});if(!r.Invoke)return{Out:n};o.JSConsole.Complier.Log("[JSAlgorithm::CallCustomFunction] call custom function functionInfo=",r);var s=this,h={Name:t,Args:e,Symbol:a.Symbol,Period:a.Period,Right:a.Right,KData:a.Data,DownloadData:n,ThrowError:function(t){s.ThrowUnexpectedNode(i,t)}};return r.Invoke(h)},this.ThrowUnexpectedNode=function(t,e){var a=t.Marker,i=e||"执行异常";return this.ErrorHandler.ThrowError(a.Index,a.Line,a.Column,i)}}function F(t,e){this.ErrorHandler=t,this.SymbolData=e,this.DRAWTEXT=function(t,e,a){var i=[],r={DrawData:i,DrawType:"DRAWTEXT",Text:a};if(Array.isArray(t)){var n=this.IsNumber(e);for(var s in t)i[s]=null,!isNaN(t[s])&&t[s]&&(n?i[s]=e:this.IsNumber(e[s])&&(i[s]=e[s]))}else if(this.IsNumber(t)&&t)for(n=this.IsNumber(e),s=0;s<this.SymbolData.Data.Data.length;++s)n?i[s]=e:this.IsNumber(e[s])&&(i[s]=e[s]);return r},this.DRAWTEXT_FIX=function(t,e,a,i,r){var n={Position:null,DrawType:"DRAWTEXT_FIX",Text:r};if(t.length<=0)return n;for(var s in t)if(!isNaN(t[s])&&t[s])return n.Position={X:e,Y:a,Type:i},n;return n},this.SUPERDRAWTEXT=function(t,e,a,i,r){var n=[],s={DrawData:n,DrawType:"SUPERDRAWTEXT",Text:a,YOffset:r,Direction:i,TextAlign:"center"};if(t.length<=0)return s;var o="number"==typeof e;for(var h in t)n[h]=null,!isNaN(t[h])&&t[h]&&(o?n[h]=e:this.IsNumber(e[h])&&(n[h]=e[h]));return s},this.STICKLINE=function(t,e,a,i,r){var n=[],s={DrawData:n,DrawType:"STICKLINE",Width:i,Type:r},o="number"==typeof e,h="number"==typeof a;if(Array.isArray(t)){if(t.length<=0)return s;for(var l in t)if(n[l]=null,!isNaN(t[l])&&t[l])if(o&&h)n[l]={Value:e,Value2:a};else if(o&&!h){if(isNaN(a[l]))continue;n[l]={Value:e,Value2:a[l]}}else if(!o&&h){if(isNaN(e[l]))continue;n[l]={Value:e[l],Value2:a}}else{if(isNaN(e[l])||isNaN(a[l]))continue;n[l]={Value:e[l],Value2:a[l]}}}else{if(!t)return s;for(l=0;l<this.SymbolData.Data.Data.length;++l)if(n[l]=null,o&&h)n[l]={Value:e,Value2:a};else if(o&&!h){if(!this.IsNumber(a[l]))continue;n[l]={Value:e,Value2:a[l]}}else if(!o&&h){if(!this.IsNumber(e[l]))continue;n[l]={Value:e[l],Value2:a}}else{if(!this.IsNumber(e[l])||!this.IsNumber(a[l]))continue;n[l]={Value:e[l],Value2:a[l]}}}return s},this.DRAWLINE=function(t,e,a,i,r){var n=[],s={DrawData:n,DrawType:"DRAWLINE",Expand:r};if(t.length<=0)return s;for(var o=Math.max(t.length,a.length),h=!1,l=!1,u={Start:{},End:{},List:new Array},C=0;C<o;++C)if(n[C]=null,C<t.length&&C<a.length){if(0==h&&0==l){if(null==t[C]||!t[C])continue;h=!0,u.Start={ID:C,Value:e[C]}}else if(1==h&&0==l){var D=null!=a[C]&&a[C];if(!D)continue;D&&(l=!0,u.End={ID:C,Value:i[C]})}if(1==h&&1==l){var m=this.CalculateDrawLine(u);for(var S in m){var c=m[S];n[c.ID]=c.Value}h=l=!1,u={Start:{},End:{}}}}if(1==r){for(var f=null,d=n.length-1;d>=0;--d)if(this.IsNumber(n[d])){f=d;break}if(null!=f&&f-1>=0){var I=f-1;for(d=f+1;d<n.length;++d){var v=n[I],p=n[f],T=(v-p)*(d-I)/(f-I);n[d]=v-T}}}return s},this.DRAWBAND=function(t,e,a,i){for(var r=[],n={DrawData:r,DrawType:"DRAWBAND",Color:[e.toLowerCase(),i.toLowerCase()]},s=Math.max(t.length,a.length),o=0;o<s;++o){var h={Value:null,Value2:null};o<t.length&&(h.Value=t[o]),o<a.length&&(h.Value2=a[o]),r.push(h)}return n},this.DRAWKLINE=function(t,e,a,i){for(var r=[],n={DrawData:r,DrawType:"DRAWKLINE"},s=Math.max(t.length,e.length,a.length,i.length),o=0;o<s;++o){var h={Open:null,High:null,Low:null,Close:null};o<t.length&&o<e.length&&o<a.length&&o<i.length&&(h.Open=e[o],h.High=t[o],h.Low=a[o],h.Close=i[o]),r[o]=h}return n},this.DRAWKLINE_IF=function(t,e,a,i,r){for(var n=[],s={DrawData:n,DrawType:"DRAWKLINE_IF"},o=Math.max(t.length,e.length,a.length,i.length,r.length),h=0;h<o;++h){var l={Open:null,High:null,Low:null,Close:null};h<e.length&&h<a.length&&h<i.length&&h<r.length&&h<t.length&&t[h]&&(l.Open=a[h],l.High=e[h],l.Low=i[h],l.Close=r[h]),n[h]=l}return s},this.POLYLINE=function(t,e){var a=[],i={DrawData:a,DrawType:"POLYLINE"},r="number"==typeof e,n=!1,s=!1;if(r)for(var o in t)if(a[o]=null,0==n){if(!t[o])continue;a[o]=e,n=!0}else a[o]=e;else{var h={Start:{},End:{},List:new Array};for(var l in t)if(a[l]=null,0==n&&0==s){if(null==t[l]||!t[l])continue;if(l>=e.length||!this.IsNumber(e[l]))continue;n=!0,h.Start={ID:parseInt(l),Value:e[l]}}else if(1==n&&0==s){if(null==t[l]||!t[l])continue;if(l>=e.length||!this.IsNumber(e[l]))continue;h.End={ID:parseInt(l),Value:e[l]};var u=this.CalculateDrawLine(h);for(var C in u){var D=u[C];a[D.ID]=D.Value}var m={ID:h.End.ID,Value:h.End.Value};h={Start:m,End:{}}}}return i},this.DRAWNUMBER=function(t,e,a){var i,r={Value:new Array,Text:new Array},n={DrawData:r,DrawType:"DRAWNUMBER"},s=Array.isArray(e),o="number"==typeof a;for(var h in o&&(i=this.IsInteger(a)?a.toString():a.toFixed(2)),t)if(r.Value[h]=null,t[h])if(s){if(h>=e.length||!this.IsNumber(e[h]))continue;if(o)r.Value[h]=e[h],r.Text[h]=i;else{if(h>=a.length||!a[h])continue;r.Value[h]=e[h],"number"==typeof a[h]?r.Text[h]=a[h].toFixed(2):r.Text[h]=a[h].toString()}}else if(this.IsNumber(e))if(o)r.Value[h]=e,r.Text[h]=i;else{if(h>=a.length||!a[h])continue;r.Value[h]=e,this.IsNumber(a[h])?r.Text[h]=a[h].toFixed(2):r.Text[h]=a[h].toString()}return n},this.DRAWICON=function(t,e,a){var i=new Map([[1,{Symbol:"↑",Color:"rgb(238,44,44)"}],[2,{Symbol:"↓",Color:"rgb(0,139,69)"}],[3,{Symbol:"😧"}],[4,{Symbol:"😨"}],[5,{Symbol:"😁"}],[6,{Symbol:"😱"}],[7,{Symbol:"◼",Color:"rgb(238,44,44)"}],[8,{Symbol:"◆",Color:"rgb(0,139,69)"}],[9,{Symbol:"💰"}],[10,{Symbol:"📪"}],[11,{Symbol:"👆"}],[12,{Symbol:"👇"}],[13,{Symbol:"B",Color:"rgb(178,34,34)"}],[14,{Symbol:"S",Color:"rgb(0,139,69)"}],[36,{Symbol:"Χ",Color:"rgb(238,44,44)"}],[37,{Symbol:"X",Color:"rgb(0,139,69)"}],[38,{Symbol:"▲",Color:"rgb(238,44,44)"}],[39,{Symbol:"▼",Color:"rgb(0,139,69)"}]]),r=i.get(a);r||(r={Symbol:"●",Color:"rgb(0,139,69)"});var n=[],s={DrawData:n,DrawType:"DRAWICON",Icon:r};if(t.length<=0)return s;var o="number"==typeof e;if("number"==typeof t){if(!t)return s;for(var h=0;h<this.SymbolData.Data.Data.length;++h)o?n[h]=e:h<e.length&&this.IsNumber(e[h])?n[h]=e[h]:n[h]=null;return s}for(var h in t)n[h]=null,t[h]&&(o?n[h]=e:this.IsNumber(e[h])&&(n[h]=e[h]));return s},this.DRAWRECTREL=function(t,e,a,i,r){var n={Rect:{Left:Math.min(t,a),Top:Math.min(e,i),Right:Math.max(t,a),Bottom:Math.max(e,i)},Color:r};0==r&&(n.Color=null);var s={DrawData:n,DrawType:"DRAWRECTREL"};return s},this.DRAWGBK=function(t,e,a,i){var r={Color:[],Angle:i};e&&r.Color.push(e),a&&r.Color.push(a);var n={DrawData:null,DrawType:"DRAWGBK"};if(Array.isArray(t))for(var s in t){var o=t[s];if(o){n.DrawData=r;break}}else t&&(n.DrawData=r);return n},this.DRAWGBK2=function(t,e,a,i){var r={Color:[],Angle:i};e&&r.Color.push(e),a&&r.Color.push(a);var n={DrawData:null,DrawType:"DRAWGBK2"};if(Array.isArray(t)){for(var s in r.Data=[],t){var o=t[s];r.Data[s]=o?1:0}n.DrawData=r}else t&&(n.DrawData=r,n.DrawType="DRAWGBK");return n},this.RGB=function(t,e,a){var i="rgb(".concat(t,",").concat(e,",").concat(a,")");return i},this.RGBA=function(t,e,a,i){var r="rgba(".concat(t,",").concat(e,",").concat(a,",").concat(i,")");return r}}T.prototype.IsNumber=function(t){return null!=t&&!isNaN(t)},T.prototype.IsInteger=function(t){return"number"===typeof t&&t%1===0},T.prototype.IsDivideNumber=function(t){return null!=t&&(!isNaN(t)&&0!=t)},T.prototype.IsString=function(t){return!(!t||"string"!=typeof t)},F.prototype.CalculateDrawLine=function(t){t.List=[];for(var e=t.Start.ID;e<=t.End.ID;++e)t.List.push(e);var a=Math.abs(t.Start.Value-t.End.Value),i=t.List.length-1,r=[];if(r.push({ID:t.Start.ID,Value:t.Start.Value}),t.Start.Value>t.End.Value)for(var n=1;n<t.List.length-1;++n){var s=a*(t.List.length-1-n)/i+t.End.Value;r.push({ID:t.List[n],Value:s})}else for(var o=1;o<t.List.length-1;++o){s=a*o/i+t.Start.Value;r.push({ID:t.List[o],Value:s})}return r.push({ID:t.End.ID,Value:t.End.Value}),r},F.prototype.IsNumber=function(t){return null!=t&&!isNaN(t)},F.prototype.IsInteger=function(t){return"number"===typeof t&&t%1===0},F.prototype.IsDrawFunction=function(t){var e=new Set(["STICKLINE","DRAWTEXT","SUPERDRAWTEXT","DRAWTEXT_FIX","DRAWLINE","DRAWBAND","DRAWKLINE","DRAWKLINE_IF","PLOYLINE","POLYLINE","DRAWNUMBER","DRAWICON","DRAWRECTREL","DRAWGBK","DRAWGBK2"]);return!!e.has(t)};var A={YCLOSE:3,OPEN:4,HIGH:5,LOW:6,CLOSE:7,VOL:8,AMOUNT:10,AMPLITUDE:13,INCREASE:14,EXCHANGERATE:37};function M(t,e,a){this.AST=t,this.Execute=a,this.Symbol="600000.sh",this.Name,this.Data=null,this.SourceData=null,this.MarketValue=null,this.Period=0,this.Right=0,this.DataType=0,this.KLineApiUrl=u.Domain+"/API/KLine2",this.MinuteKLineApiUrl=u.Domain+"/API/KLine3",this.RealtimeApiUrl=u.Domain+"/API/stock",this.StockHistoryDayApiUrl=u.Domain+"/API/StockHistoryDay",this.StockHistoryDay3ApiUrl=u.Domain+"/API/StockHistoryDay3",this.StockNewsAnalysisApiUrl=u.CacheDomain+"/cache/newsanalyze",this.MaxReqeustDataCount=1e3,this.MaxRequestMinuteDayCount=5,this.LatestData,this.IndexData,this.MarginData=new Map,this.NewsAnalysisData=new Map,this.ExtendData=new Map,this.StockData=new Map,this.NetworkFilter,e&&(e.HQDataType&&(this.DataType=e.HQDataType),e.Data&&(this.Data=e.Data,2!=this.DataType&&(this.Period=e.Data.Period,this.Right=e.Data.Right)),e.SourceData&&(this.SourceData=e.SourceData),e.Symbol&&(this.Symbol=e.Symbol),e.Symbol&&(this.Symbol=e.Symbol),e.MaxReqeustDataCount>0&&(this.MaxReqeustDataCount=e.MaxReqeustDataCount),e.MaxRequestMinuteDayCount>0&&(this.MaxRequestMinuteDayCount=e.MaxRequestMinuteDayCount),e.KLineApiUrl&&(this.KLineApiUrl=e.KLineApiUrl),e.NetworkFilter&&(this.NetworkFilter=e.NetworkFilter)),this.GetLatestData=function(){if(this.LatestData)return this.Execute.RunNextJob();var t=this;wx.request({url:t.RealtimeApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol","amount","date","time","increase","exchangerate","amplitude"],symbol:[this.Symbol]},method:"POST",dataType:"json",success:function(e){t.RecvLatestData(e),t.Execute.RunNextJob()},error:function(e){t.RecvError(e)}})},this.RecvLatestData=function(t){var e=t.data;if(e.stock&&1==e.stock.length){var a=e.stock[0];this.LatestData={Symbol:a.symbol,Name:a.name,Date:a.date,Time:a.time,YClose:a.yclose,Price:a.price,Open:a.open,High:a.high,Low:a.low,Vol:a.vol,Amount:a.amount,Increase:a.increase,Exchangerate:a.exchangerate,Amplitude:a.amplitude},o.JSConsole.Complier.Log("[JSSymbolData::RecvLatestData]",this.LatestData)}},this.GetLatestCacheData=function(t){if(!this.LatestData)return null;switch(t){case A.YCLOSE:return this.LatestData.YClose;case A.OPEN:return this.LatestData.Open;case A.HIGH:return this.LatestData.High;case A.LOW:return this.LatestData.Low;case A.VOL:return this.LatestData.Vol;case A.AMOUNT:return this.LatestData.Amount;case A.INCREASE:return this.LatestData.Increase;case A.EXCHANGERATE:return this.LatestData.Exchangerate;case A.AMPLITUDE:return this.LatestData.Amplitude;case A.CLOSE:return this.LatestData.Price;default:return null}},this.GetVolRateData=function(t,e){var a=t.ID.toString()+"-VolRate-"+this.Symbol;if(this.ExtendData.has(a))return this.Execute.RunNextJob();var i=this;wx.request({url:i.RealtimeApiUrl,data:{field:["name","symbol","avgvol5","date"],symbol:[this.Symbol]},method:"POST",dataType:"json",async:!0,success:function(t){i.RecvVolRateData(t,a),i.Execute.RunNextJob()},error:function(t){i.RecvError(t)}})},this.RecvVolRateData=function(t,e){var a=t.data;if(a.stock&&1==a.stock.length){var i=a.stock[0].avgvol5,r=a.stock[0].date,n={AvgVol5:i,Date:r};this.ExtendData.set(e,n),o.JSConsole.Complier.Log("[JSSymbolData::RecvVolRateData]",n)}},this.GetVolRateCacheData=function(t){var e=L.JOB_DOWNLOAD_VOLR_DATA.toString()+"-VolRate-"+this.Symbol;e&&this.ExtendData.has(e)||this.Execute.ThrowUnexpectedNode(t,"不支持VOLR");for(var a=[],i=this.ExtendData.get(e),r=i.AvgVol5/241,n=0,s=0,o=0;s<this.Data.Data.length;++s){a[s]=null;var h=this.Data.Data[s],l=h.DateTime;if(l){var u=l.split(" ");if(2==u.length){var C=parseInt(u[0]);C==i.Date&&(n+=h.Vol,r>0&&(a[s]=n/(o+1)/r*100),++o)}}}return a},this.GetGroupData=function(t){var e=t.ID.toString()+"-Group-"+this.Symbol;if(this.ExtendData.has(e))return this.Execute.RunNextJob();var a=this;if(this.NetworkFilter){var i={Name:"JSSymbolData::GetGroupData",Explain:"HYBLOCK|DYBLOCK",Request:{Url:a.RealtimeApiUrl,Type:"POST",Data:{symbol:[this.Symbol],field:["name","symbol","industry","concept","region"]}},Self:this,PreventDefault:!1};if(this.NetworkFilter(i,(function(t){a.RecvGroupData(t,e),a.Execute.RunNextJob()})),1==i.PreventDefault)return}wx.request({url:a.RealtimeApiUrl,data:{field:["name","symbol","industry","concept","region"],symbol:[this.Symbol]},method:"POST",dataType:"json",async:!0,success:function(t){a.RecvGroupData(t,e),a.Execute.RunNextJob()},error:function(t){a.RecvError(t)}})},this.RecvGroupData=function(t,e){var a=t.data;if(a.stock&&1==a.stock.length){var i=a.stock[0],r=i.industry,n=i.concept,s=i.region,o={Industry:[],Concept:[],Region:[]};if(r)for(var h in r){var l=r[h];o.Industry.push({Name:l.name,Symbol:l.symbol});break}if(n)for(var h in n){l=n[h];o.Concept.push({Name:l.name,Symbol:l.symbol})}if(s)for(var h in s){l=s[h];o.Region.push({Name:l.name,Symbol:l.symbol})}this.ExtendData.set(e,o)}},this.GetIndexData=function(){if(this.IndexData)return this.Execute.RunNextJob();var t=this;h.JSCommonData.ChartData.IsDayPeriod(this.Period,!0)?wx.request({url:t.KLineApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol","up","down","stop","unchanged"],symbol:"000001.sh",start:-1,count:t.MaxReqeustDataCount+500},method:"POST",dataType:"json",success:function(e){t.RecvIndexHistroyData(e),t.Execute.RunNextJob()},error:function(e){t.RecvError(e)}}):h.JSCommonData.ChartData.IsMinutePeriod(this.Period,!0)&&wx.request({url:t.MinuteKLineApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol"],symbol:"000001.sh",start:-1,count:t.MaxRequestMinuteDayCount+5},method:"POST",dataType:"json",success:function(e){t.RecvIndexMinuteHistroyData(e),t.Execute.RunNextJob()},error:function(e){t.RecvError(e)}})},this.RecvIndexHistroyData=function(t){var e=t.data;o.JSConsole.Complier.Log("[JSSymbolData::RecvIndexHistroyData] recv data",e);var a=this.JsonDataToHistoryData(e);this.IndexData=new h.JSCommonData.ChartData,this.IndexData.DataType=0,this.IndexData.Data=a;var i=this.SourceData.GetOverlayData(this.IndexData.Data);if(this.IndexData.Data=i,h.JSCommonData.ChartData.IsDayPeriod(this.Period,!1)){var r=this.IndexData.GetPeriodData(this.Period);this.IndexData.Data=r}},this.RecvIndexMinuteHistroyData=function(t){var e=t.data;o.JSConsole.Complier.Log("[JSSymbolData::RecvIndexMinuteHistroyData] recv data",e);var a=this.JsonDataToMinuteHistoryData(e);if(this.IndexData=new h.JSCommonData.ChartData,this.IndexData.DataType=1,this.IndexData.Data=a,h.JSCommonData.ChartData.IsMinutePeriod(this.Period,!1)){var i=this.IndexData.GetPeriodData(this.Period);this.IndexData.Data=i}},this.GetIndexCacheData=function(t){if(!this.IndexData)return new Array;switch(t){case"INDEXA":return this.IndexData.GetAmount();case"INDEXC":return this.IndexData.GetClose();case"INDEXH":return this.IndexData.GetHigh();case"INDEXL":return this.IndexData.GetLow();case"INDEXO":return this.IndexData.GetOpen();case"INDEXV":return this.IndexData.GetVol();case"INDEXADV":return this.IndexData.GetUp();case"INDEXDEC":return this.IndexData.GetDown()}},this.GetIndexIncreaseData=function(t){var e=t.ID.toString()+"-UpCount-"+t.Symbol,a=t.ID.toString()+"-DownCount-"+t.Symbol;if(this.ExtendData.has(e)&&this.ExtendData.has(a))return this.Execute.RunNextJob();var i=t.Symbol;i=i.replace(".CI",".ci");var r=this,n=u.CacheDomain+"/cache/analyze/increaseanalyze/"+i+".json";o.JSConsole.Complier.Log("[JSSymbolData::GetIndexIncreaseData] Get url=",n),wx.request({url:n,method:"GET",dataType:"json",success:function(t){r.RecvMinuteIncreaseData(t,{UpKey:e,DownKey:a}),r.Execute.RunNextJob()},error:function(t){r.RecvError(t)}})},this.RecvMinuteIncreaseData=function(t,e){o.JSConsole.Complier.Log("[JSSymbolData::RecvMinuteIncreaseData] recv data",t);var a=t.data;if(a.minute){var i=a.minute;if(i.time&&i.up&&i.down){for(var r=[],n=[],s=0;s<i.time.length;++s)r[s]=i.up[s],n[s]=i.down[s];this.ExtendData.set(e.UpKey,r),this.ExtendData.set(e.DownKey,n)}}},this.GetIndexIncreaseCacheData=function(t,e,a){var i;return"UPCOUNT"==t?i=L.JOB_DOWNLOAD_INDEX_INCREASE_DATA.toString()+"-UpCount-"+e:"DOWNCOUNT"==t&&(i=L.JOB_DOWNLOAD_INDEX_INCREASE_DATA.toString()+"-DownCount-"+e),i&&this.ExtendData.has(i)||this.Execute.ThrowUnexpectedNode(a,"不支持函数"+t+"("+e+")"),this.ExtendData.get(i)},this.GetSymbolData=function(){if(this.Data)return this.Execute.RunNextJob();var t=this;2!==this.DataType?h.JSCommonData.ChartData.IsDayPeriod(this.Period,!0)?wx.request({url:t.KLineApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol"],symbol:t.Symbol,start:-1,count:t.MaxReqeustDataCount},method:"POST",dataType:"json",async:!0,success:function(e){t.RecvHistroyData(e),t.Execute.RunNextJob()},error:function(e){t.RecvError(e)}}):h.JSCommonData.ChartData.IsMinutePeriod(this.Period,!0)&&wx.request({url:this.MinuteKLineApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol"],symbol:t.Symbol,start:-1,count:t.MaxRequestMinuteDayCount},method:"POST",dataType:"json",async:!0,success:function(e){t.RecvMinuteHistroyData(e),t.Execute.RunNextJob()},error:function(e){t.RecvError(e)}}):wx.request({url:t.RealtimeApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol","amount","date","minute","time","minutecount"],symbol:[t.Symbol],start:-1},method:"POST",dataType:"json",async:!0,success:function(e){t.RecvMinuteData(e),t.Execute.RunNextJob()}})},this.RecvHistroyData=function(t){var e=t.data;o.JSConsole.Complier.Log("[JSSymbolData::RecvHistroyData] recv data",e);var a=this.JsonDataToHistoryData(e);if(this.Data=new h.JSCommonData.ChartData,this.Data.DataType=0,this.Data.Data=a,this.SourceData=new h.JSCommonData.ChartData,this.SourceData.Data=a,this.Right>0){var i=this.Data.GetRightDate(this.Right);this.Data.Data=i}if(h.JSCommonData.ChartData.IsDayPeriod(this.Period,!1)){var r=this.Data.GetPeriodData(this.Period);this.Data.Data=r}this.Name=e.name},this.RecvMinuteHistroyData=function(t){var e=t.data;o.JSConsole.Complier.Log("[JSSymbolData::RecvMinuteHistroyData] recv data",e);var a=this.JsonDataToMinuteHistoryData(e);if(this.Data=new h.JSCommonData.ChartData,this.Data.DataType=1,this.Data.Data=a,this.SourceData=new h.JSCommonData.ChartData,this.SourceData.Data=a,h.JSCommonData.ChartData.IsMinutePeriod(this.Period,!1)){var i=this.Data.GetPeriodData(this.Period);this.Data.Data=i}this.Name=e.name},this.RecvMinuteData=function(t){var e=t.data;o.JSConsole.Complier.Log("[JSSymbolData::RecvMinuteData] recv data",e);var a=this.JsonDataToMinuteData(e);this.Data=new h.JSCommonData.ChartData,this.Data.DataType=2,this.Data.Data=a,this.Name=e.stock[0].name},this.GetSymbolCacheData=function(t){if(!this.Data)return new Array;switch(t){case"CLOSE":case"C":return this.Data.GetClose();case"VOL":case"V":return this.Data.GetVol();case"OPEN":case"O":return this.Data.GetOpen();case"HIGH":case"H":return this.Data.GetHigh();case"LOW":case"L":return this.Data.GetLow();case"AMOUNT":case"AMO":return this.Data.GetAmount();case"VOLINSTK":return this.Data.GetPosition()}},this.GetCurrBarsCount=function(){if(!this.Data||!this.Data.Data||!this.Data.Data.length)return new Array;for(var t=this.Data.Data.length,e=[],a=t-1;a>=0;--a)e.push(a);return e},this.GetIsLastBar=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e=this.Data.Data.length,a=0;a<e;++a)a==e-1?t.push(1):t.push(0);return t},this.GetMarginCacheData=function(t,e){var a=L.GetMarginJobID(t);return a||this.Execute.ThrowUnexpectedNode(e,"不支持MARGIN("+t+")"),this.MarginData.has(a)?this.MarginData.get(a):[]},this.GetMarginData=function(t){if(this.MarginData.has(t))return this.Execute.RunNextJob();o.JSConsole.Complier.Log("[JSSymbolData::GetMarginData] jobID=",t);var e=this,a=["name","date","symbol"];switch(t){case L.JOB_DOWNLOAD_MARGIN_BALANCE:a.push("margin.balance");break;case L.JOB_DOWNLOAD_MARGIN_RATE:a.push("margin.rate");break;case L.JOB_DOWNLOAD_MARGIN_BUY_BALANCE:case L.JOB_DOWNLOAD_MARGIN_BUY_AMOUNT:case L.JOB_DOWNLOAD_MARGIN_BUY_REPAY:case L.JOB_DOWNLOAD_MARGIN_BUY_NET:a.push("margin.buy");break;case L.JOB_DOWNLOAD_MARGIN_SELL_BALANCE:case L.JOB_DOWNLOAD_MARGIN_SELL_VOLUME:case L.JOB_DOWNLOAD_MARGIN_SELL_REPAY:case L.JOB_DOWNLOAD_MARGIN_SELL_NET:a.push("margin.sell");break}wx.request({url:this.StockHistoryDayApiUrl,data:{field:a,symbol:[this.Symbol],orderfield:"date"},method:"POST",dataType:"json",async:!0,success:function(a){e.RecvMarginData(a,t),e.Execute.RunNextJob()}})},this.RecvMarginData=function(t,e){var a=t.data;if(a.stock&&1==a.stock.length){var i=a.stock[0],r=new Array,n=[],s=[],o=[];for(var l in i.stockday){var u=i.stockday[l],C=u.margin;if(C){var D=new h.JSCommonData.SingleData;switch(D.Date=u.date,e){case L.JOB_DOWNLOAD_MARGIN_BALANCE:if(!this.IsNumber(C.balance))continue;D.Value=C.balance,r.push(D);break;case L.JOB_DOWNLOAD_MARGIN_RATE:if(!this.IsNumber(C.rate))continue;D.Value=C.rate,r.push(D);break;case L.JOB_DOWNLOAD_MARGIN_BUY_BALANCE:case L.JOB_DOWNLOAD_MARGIN_BUY_AMOUNT:case L.JOB_DOWNLOAD_MARGIN_BUY_REPAY:case L.JOB_DOWNLOAD_MARGIN_BUY_NET:var m=C.buy;if(!m)continue;if(!this.IsNumber(m.balance)||!this.IsNumber(m.amount)||!this.IsNumber(m.repay)||!this.IsNumber(m.net))continue;D.Value=m.balance;var S=new h.JSCommonData.SingleData;S.Date=u.date,S.Value=m.amount;var c=new h.JSCommonData.SingleData;c.Date=u.date,c.Value=m.repay;var f=new h.JSCommonData.SingleData;f.Date=u.date,f.Value=m.net,r.push(D),n.push(S),s.push(c),o.push(f);break;case L.JOB_DOWNLOAD_MARGIN_SELL_BALANCE:case L.JOB_DOWNLOAD_MARGIN_SELL_VOLUME:case L.JOB_DOWNLOAD_MARGIN_SELL_REPAY:case L.JOB_DOWNLOAD_MARGIN_SELL_NET:var d=C.sell;if(!d)continue;if(!this.IsNumber(d.balance)||!this.IsNumber(d.volume)||!this.IsNumber(d.repay)||!this.IsNumber(d.net))continue;D.Value=m.balance;S=new h.JSCommonData.SingleData;S.Date=u.date,S.Value=m.volume;c=new h.JSCommonData.SingleData;c.Date=u.date,c.Value=m.repay;f=new h.JSCommonData.SingleData;f.Date=u.date,f.Value=m.net,r.push(D),n.push(S),s.push(c),o.push(f);break;default:continue}}}var I=[];for(var v in e===L.JOB_DOWNLOAD_MARGIN_BALANCE||e===L.JOB_DOWNLOAD_MARGIN_RATE?I.push({JobID:e,Data:r}):e===L.JOB_DOWNLOAD_MARGIN_BUY_BALANCE||e===L.JOB_DOWNLOAD_MARGIN_BUY_AMOUNT||e===L.JOB_DOWNLOAD_MARGIN_BUY_REPAY||e===L.JOB_DOWNLOAD_MARGIN_BUY_NET?(I.push({JobID:L.JOB_DOWNLOAD_MARGIN_BUY_BALANCE,Data:r}),I.push({JobID:L.JOB_DOWNLOAD_MARGIN_BUY_AMOUNT,Data:n}),I.push({JobID:L.JOB_DOWNLOAD_MARGIN_BUY_REPAY,Data:s}),I.push({JobID:L.JOB_DOWNLOAD_MARGIN_BUY_NET,Data:o})):e!==L.JOB_DOWNLOAD_MARGIN_SELL_BALANCE&&e!==L.JOB_DOWNLOAD_MARGIN_SELL_VOLUME&&e!==L.JOB_DOWNLOAD_MARGIN_SELL_REPAY&&e!==L.JOB_DOWNLOAD_MARGIN_SELL_NET||(I.push({JobID:L.JOB_DOWNLOAD_MARGIN_SELL_BALANCE,Data:r}),I.push({JobID:L.JOB_DOWNLOAD_MARGIN_SELL_VOLUME,Data:n}),I.push({JobID:L.JOB_DOWNLOAD_MARGIN_SELL_REPAY,Data:s}),I.push({JobID:L.JOB_DOWNLOAD_MARGIN_SELL_NET,Data:o})),I){var p=this.Data.GetFittingData(I[v].Data),T=new h.JSCommonData.ChartData;if(T.Data=p,T.Period=this.Period,T.Period>0){var F=T.GetPeriodSingleData(T.Period);T.Data=F}var A=T.GetValue();this.MarginData.set(I[v].JobID,A)}}},this.GetNewsAnalysisCacheData=function(t,e){var a=L.GetNewsAnalysisID(t);return a||this.Execute.ThrowUnexpectedNode(e,"不支持NEWS("+t+")"),this.NewsAnalysisData.has(a)?this.NewsAnalysisData.get(a):[]},this.GetNewsAnalysisData=function(t){if(this.NewsAnalysisData.has(t))return this.Execute.RunNextJob();var e=this,a=new Map([[L.JOB_DOWNLOAD_NEWS_ANALYSIS_NEGATIVE,"negative"],[L.JOB_DOWNLOAD_NEWS_ANALYSIS_RESEARCH,"research"],[L.JOB_DOWNLOAD_NEWS_ANALYSIS_INTERACT,"interact"],[L.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE,"holderchange"],[L.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE2,"holderchange"],[L.JOB_DOWNLOAD_NEWS_ANALYSIS_TRUSTHOLDER,"trustholder"],[L.JOB_DOWNLOAD_NEWS_ANALYSIS_BLOCKTRADING,"Blocktrading"],[L.JOB_DOWNLOAD_NEWS_ANALYSIS_COMPANYNEWS,"companynews"],[L.JOB_DOWNLOAD_NEWS_ANALYSIS_TOPMANAGERS,"topmanagers"],[L.JOB_DOWNLOAD_NEWS_ANALYSIS_PLEDGE,"Pledge"]]);if(a.has(t)){var i=a.get(t),r=this.StockNewsAnalysisApiUrl+"/"+i+"/"+this.Symbol+".json";wx.request({url:r,method:"GET",dataType:"json",async:!0,success:function(a){200==a.statusCode?e.RecvNewsAnalysisData(a,t):e.RecvNewsAnalysisDataError(a,t),e.Execute.RunNextJob()},fail:function(t,a){e.Execute.RunNextJob()}})}else this.Execute.RunNextJob()},this.RecvNewsAnalysisDataError=function(t,e){o.JSConsole.Complier.Log("[JSSymbolData::RecvNewsAnalysisDataError] request error.",t.statusCode);for(var a=[],i=0;i<this.Data.Data.length;++i){var r=new h.JSCommonData.SingleData;r.Date=this.Data.Data[i].Date,r.Value=0,a.push(r)}var n=new h.JSCommonData.ChartData;n.Data=a,this.NewsAnalysisData.set(e,n.GetValue())},this.RecvNewsAnalysisData=function(t,e){var a=t.data;if(a.data&&a.date&&!(a.data.length<=0||a.data.length!=a.date.length))if(o.JSConsole.Complier.Log("[JSSymbolData::RecvNewsAnalysisData] jobID",e,a.update),e==L.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE||e==L.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE2){for(var i=[],r=[],n=0;n<a.data.length;++n){var s=new h.JSCommonData.SingleData;s.Date=a.date[n],s.Value=a.data[n],this.IsNumber(s.Value)&&i.push(s),n<a.data2.length&&(s=new h.JSCommonData.SingleData,s.Date=a.date[n],s.Value=a.data2[n],this.IsNumber(s.Value)&&r.push(s))}var l=this.Data.GetFittingData2(i,0),u=new h.JSCommonData.ChartData;u.Data=l,this.NewsAnalysisData.set(L.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE,u.GetValue()),l=this.Data.GetFittingData2(r,0),u=new h.JSCommonData.ChartData,u.Data=l,this.NewsAnalysisData.set(L.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE2,u.GetValue())}else{for(i=[],n=0;n<a.data.length;++n){s=new h.JSCommonData.SingleData;s.Date=a.date[n],s.Value=a.data[n],i.push(s)}var C=this.Data.GetFittingData2(i,0);u=new h.JSCommonData.ChartData;u.Data=C,this.NewsAnalysisData.set(e,u.GetValue())}},this.GetStockDataKey=function(t,e){var a=t.FunctionName;if(e.length>0){a+="(";for(var i=0;i<e.length;++i)i>0&&(a+=","),a+=e[i].toString();a+=")"}return a},this.GetFinOne=function(t){var e=this.JobArgumentsToArray(t,3),a=this.GetStockDataKey(t,e);if(this.StockData.has(a))return this.Execute.RunNextJob();var i=this;if(this.NetworkFilter){var r=this.Data.GetDateRange(),n={Name:"JSSymbolData::GetFinOne",Explain:"财务数据FINONE(ID,Y,MMDD)",JobID:t.ID,Request:{Url:i.StockHistoryDayApiUrl,Type:"POST",Data:{Args:e,symbol:this.Symbol,daterange:r}},Self:this,PreventDefault:!1};if(this.NetworkFilter(n,(function(e){i.RecvStockValue(e,t,a,1),i.Execute.RunNextJob()})),1==n.PreventDefault)return}var s=new O({Job:t,Symbol:this.Symbol,Url:this.StockHistoryDayApiUrl,Args:e,DataKey:a,Callback:function(t,e,a){i.RecvStockValue(t,e,a,1),i.Execute.RunNextJob()},ErrorCallback:function(t){i.AddStockValueError(a,t)}});s.Download()},this.GetFinValue=function(t){var e=this.JobArgumentsToArray(t,1),a=e[0],i=this.GetStockDataKey(t,e);if(this.StockData.has(i))return this.Execute.RunNextJob();var r=this;if(this.NetworkFilter){var n=this.Data.GetDateRange(),s={Name:"JSSymbolData::GetFinValue",Explain:"财务数据FINVALUE(ID)",JobID:t.ID,Request:{Url:r.StockHistoryDayApiUrl,Type:"POST",Data:{id:a,symbol:this.Symbol,daterange:n}},Self:this,PreventDefault:!1};if(this.NetworkFilter(s,(function(e){r.RecvStockValue(e,t,i,0),r.Execute.RunNextJob()})),1==s.PreventDefault)return}var o=new R({Job:t,Symbol:this.Symbol,Url:this.StockHistoryDayApiUrl,Args:e,DataKey:i,Callback:function(t,e,a){r.RecvStockValue(t,e,a,0),r.Execute.RunNextJob()},ErrorCallback:function(t){r.AddStockValueError(i,t)}});o.Download()},this.GetFinance=function(t){var e=this.JobArgumentsToArray(t,1),a=e[0],i=this.GetStockDataKey(t,e);if(this.StockData.has(i))return this.Execute.RunNextJob();var r=this;if(this.NetworkFilter){var n=this.Data.GetDateRange(),s={Name:"JSSymbolData::GetFinance",Explain:"财务数据FINANCE(ID)",JobID:t.ID,Request:{Url:r.RealtimeApiUrl,Type:"POST",Data:{id:a,symbol:this.Symbol,daterange:n}},Self:this,PreventDefault:!1};if(this.NetworkFilter(s,(function(e){r.RecvStockValue(e,t,i,0),r.Execute.RunNextJob()})),1==s.PreventDefault)return}var o=new x({Job:t,Symbol:this.Symbol,Url:this.StockHistoryDayApiUrl,RealtimeUrl:this.RealtimeApiUrl,Args:e,DataKey:i,Callback:function(t,e,a){r.RecvStockValue(t,e,a,0),r.Execute.RunNextJob()},ErrorCallback:function(t){r.AddStockValueError(i,t)}});o.Download()},this.GetVariantData=function(t){var e=t.VariantName;if(this.StockData.has(e))return this.Execute.RunNextJob();var a=this;if(this.NetworkFilter){var i=this.Data.GetDateRange(),r={Name:"JSSymbolData::GetVariantData",Explain:"变量数据下载",JobID:t.ID,Request:{Url:"www.121287.com",Type:"POST",Data:{VariantName:t.VariantName,symbol:this.Symbol,daterange:i}},Self:this,PreventDefault:!1};if(this.NetworkFilter(r,(function(i){a.RecvStockValue(i,t,e,0),a.Execute.RunNextJob()})),1==r.PreventDefault)return}var n,s=function(t,e,i){a.RecvStockValue(t,e,i,0),a.Execute.RunNextJob()},o=function(t){a.AddStockValueError(e,t)};"CAPITAL"!=t.VariantName&&"TOTALCAPITAL"!=t.VariantName&&"EXCHANGE"!=t.VariantName||(n=new x({Job:t,Symbol:this.Symbol,Url:this.StockHistoryDayApiUrl,RealtimeUrl:this.RealtimeApiUrl,Args:[t.VariantName],DataKey:e,Callback:s,ErrorCallback:o})),n.Download()},this.GetGPJYValue=function(t){var e=this.JobArgumentsToArray(t,3),a=this.GetStockDataKey(t,e);if(this.StockData.has(a))return this.Execute.RunNextJob();var i=this,r=1==e[2]?0:2;if(this.NetworkFilter){var n=this.Data.GetDateRange(),s={Name:"JSSymbolData::GetGPJYValue",Explain:"股票交易类数据GPJYVALUE(ID,N,TYPE)",JobID:t.ID,Request:{Url:i.StockHistoryDayApiUrl,Type:"POST",Data:{Args:e,symbol:this.Symbol,daterange:n}},Self:this,PreventDefault:!1};if(this.NetworkFilter(s,(function(e){i.RecvStockValue(e,t,a,r),i.Execute.RunNextJob()})),1==s.PreventDefault)return}var o=new B({Job:t,Symbol:this.Symbol,Url:this.StockHistoryDayApiUrl,Args:e,DataKey:a,Callback:function(t,e,a){i.RecvStockValue(t,e,a,r),i.Execute.RunNextJob()},ErrorCallback:function(t){i.AddStockValueError(a,t)}});o.Download()},this.GetCustomVariantData=function(t){var e=t.VariantName;if(this.StockData.has(e))return this.Execute.RunNextJob();var a=u.CustomVariant.Data.get(e),i=this;if(this.NetworkFilter){var r=this.Data.GetDateRange(),n={Name:"JSSymbolData::GetCustomVariantData",Explain:"自定义变量数据下载",JobID:t.ID,Request:{Url:"www.121287.com",Type:"POST",Data:{VariantName:t.VariantName,symbol:this.Symbol,daterange:r}},Self:this,VariantInfo:a,PreventDefault:!1};this.NetworkFilter(n,(function(a){a.Error?i.AddStockValueError(e,a.Error):i.RecvStockValue(a.Data,t,e,a.DataType),i.Execute.RunNextJob()}))}else this.AddStockValueError(e,"自定义变量".concat(e,"下载失败")),this.Execute.RunNextJob()},this.GetCustomFunctionData=function(t){var e=t.FunctionName,a=u.CustomFunction.Data.get(e);if(!a.IsDownload)return this.Execute.RunNextJob();if(this.StockData.has(e))return this.Execute.RunNextJob();var i=this;if(this.NetworkFilter){var r=this.Data.GetDateRange(),n={Name:"JSSymbolData::GetCustomFunctionData",Explain:"自定义函数数据下载",JobID:t.ID,Request:{Url:"www.121287.com",Type:"POST",Data:{FunctionName:t.FunctionName,symbol:this.Symbol,daterange:r,JobItem:t}},Self:this,FunctionInfo:a,PreventDefault:!1};this.NetworkFilter(n,(function(a){a.Error?i.AddStockValueError(e,a.Error):i.RecvStockValue(a.Data,t,e,a.DataType),i.Execute.RunNextJob()}))}else this.AddStockValueError(e,"自定义函数".concat(e,"下载失败")),this.Execute.RunNextJob()},this.RecvStockValue=function(t,e,a,i){if(t)if(0==i)if(Array.isArray(t)){var r=this.Data;if(h.JSCommonData.ChartData.IsDayPeriod(this.Period,!0))u=r.GetFittingFinanceData(t);else{if(!h.JSCommonData.ChartData.IsMinutePeriod(this.Period,!0))return;u=r.GetMinuteFittingFinanceData(t)}var n=new h.JSCommonData.ChartData;n.Data=u;var s=n.GetValue();if("EXCHANGE"==a)for(var o in s){var l=r.Data[o];s[o]>0&&(s[o]=l.Vol/s[o]*100)}this.StockData.set(a,{Data:s})}else this.StockData.set(a,{Data:t.Value});else if(1==i)this.StockData.set(a,{Data:t.Value});else if(2==i){var u;r=this.Data;if(h.JSCommonData.ChartData.IsDayPeriod(this.Period,!0))u=r.GetFittingTradeData(t,0,!1);else{if(!h.JSCommonData.ChartData.IsMinutePeriod(this.Period,!0))return;u=r.GetMinuteFittingTradeData(t,0,!1)}n=new h.JSCommonData.ChartData;n.Data=u;s=n.GetValue();this.StockData.set(a,{Data:s})}},this.AddStockValueError=function(t,e){this.StockData.set(t,{Error:e})},this.GetStockCacheData=function(t){var e;if(t.FunctionName)e=this.GetStockDataKey({FunctionName:t.FunctionName},t.Args);else if(t.VariantName)e=t.VariantName;else{if(!t.CustomName)return null;e=t.CustomName}if(!this.StockData.has(e))return null;var a=this.StockData.get(e);return a.Error&&this.Execute.ThrowUnexpectedNode(t.Node,a.Error),a.Data},this.JobArgumentsToArray=function(t,e){var a=t.Args;if(a.length!=e){var i=t.Token;this.Execute.ErrorHandler.ThrowError(i.Index,i.Line,0,"".concat(t.FunctionName,"() Error: argument count error."))}for(var r=[],n=0;n<a.length;++n){var s=a[n];if(this.IsNumber(s))r.push(s);else if(s.Type==I.Literal)r.push(s.Value);else if(s.Type==I.Identifier){var o=!1;for(var h in this.Arguments){var l=this.Arguments[h];if(l.Name==s.Name){r.push(l.Value),o=!0;break}}if(!o){i=t.Token;this.Execute.ErrorHandler.ThrowError(i.Index,i.Line,0,"".concat(t.FunctionName,"() Error: can't read ").concat(s.Name))}}}return r},this.DownloadCustomAPIData=function(t){if(!this.NetworkFilter)return this.Execute.RunNextJob();var e=[];for(var a in t.Args){var i=t.Args[a];if(i.Type==I.Literal)e.push(i.Value);else{if(i.Type!=I.Identifier)return this.Execute.RunNextJob();var r=!1;for(var n in this.Arguments){var s=this.Arguments[n];if(s.Name==i.Name){e.push(s.Value),r=!0;break}}if(!r){var o=t.Token;this.Execute.ErrorHandler.ThrowError(o.Index,o.Line,0,"LoadAPIData() Error: can't read ".concat(i.Name))}}}var h=this,l={Name:"JSSymbolData::DownloadCustomAPIData",Explain:"下载自定义api数据",Period:this.Period,Right:this.Right,Symbol:this.Symbol,KData:this.Data,Cache:this.CustomAPIData,Args:e,Self:this,PreventDefault:!1};this.NetworkFilter(l,(function(t){h.RecvCustomAPIData(t,e),h.Execute.RunNextJob()})),1!=l.PreventDefault&&this.Execute.RunNextJob()},this.RecvCustomAPIData=function(t,e){if(t&&t.data){var a=t.data,i=this.GenerateCustomAPIKey(e);if(h.JSCommonData.ChartData.IsMinutePeriod(this.Period,!0)){if(!a.date||!a.time)return;var r=a.date;a.time;for(var n in a)if("date"!=n&&"time"!=n)var s=a[n]}else if(h.JSCommonData.ChartData.IsDayPeriod(this.Period,!0)){if(!a.date)return;r=a.date;var o={__Type__:"Object"};for(var n in a)if("date"!=n){s=a[n];if(Array.isArray(s)){var l=this.FittingCustomAPIArray(s,r);o[n]=l}else this.IsNumber(s)&&(o[n]=s)}this.CustomAPIData.set(i,o)}}},this.FittingCustomAPIArray=function(t,e,a){var i,r=this.Data,n=[];for(var s in t){var o=t[s],l=new h.JSCommonData.SingleData;l.Date=e[s],a&&s<a.length&&(l.Time=a[s]),l.Value=o,n.push(l)}if(h.JSCommonData.ChartData.IsDayPeriod(this.Period,!0))i=r.GetFittingData(n);else{if(!h.JSCommonData.ChartData.IsMinutePeriod(this.Period,!0))return null;i=r.GetMinuteFittingData(n)}var u=new h.JSCommonData.ChartData;u.Data=i;var C=u.GetValue();return C},this.JsonDataToHistoryData=function(t){for(var e=t.data,a=new Array,i=0,r=1,n=2,s=3,o=4,l=5,u=6,C=7,D=8,m=9,S=10,c=11,f=0;f<e.length;++f){var d=new h.JSCommonData.HistoryData;d.Date=e[f][i],d.Open=e[f][n],d.YClose=e[f][r],d.Close=e[f][l],d.High=e[f][s],d.Low=e[f][o],d.Vol=e[f][u],d.Amount=e[f][C],isNaN(d.Open)||d.Open<=0||(e[f].length>D&&(d.Up=e[f][D]),e[f].length>m&&(d.Down=e[f][m]),e[f].length>S&&(d.Stop=e[f][S]),e[f].length>c&&(d.Unchanged=e[f][c]),a.push(d))}return a},this.JsonDataToMinuteHistoryData=function(t){for(var e=t.data,a=new Array,i=0,r=1,n=2,s=3,o=4,l=5,u=6,C=7,D=8,m=0;m<e.length;++m){var S=new h.JSCommonData.HistoryData;S.Date=e[m][i],S.Open=e[m][n],S.YClose=e[m][r],S.Close=e[m][l],S.High=e[m][s],S.Low=e[m][o],S.Vol=e[m][u],S.Amount=e[m][C],S.Time=e[m][D],a.push(S)}for(var c=0;c<a.length;++c){var f=a[c];if(null==f&&coninue,isNaN(f.Open)||f.Open<=0||isNaN(f.High)||f.High<=0||isNaN(f.Low)||f.Low<=0||isNaN(f.Close)||f.Close<=0||isNaN(f.YClose)||f.YClose<=0)if(0==c)f.YClose>0&&(f.Open=f.YClose,f.High=f.YClose,f.Low=f.YClose,f.Close=f.YClose);else for(var d=c-1;d>=0;--d){var I=a[d];if(null==I&&coninue,I.Open>0&&I.High>0&&I.Low>0&&I.Close>0){f.YClose<=0&&(f.YClose=I.Close),f.Open=I.Open,f.High=I.High,f.Low=I.Low,f.Close=I.Close;break}}}return a},this.JsonDataToMinuteData=function(t){var e=new Array;for(var a in t.stock[0].minute){var i=t.stock[0].minute[a],r=new h.JSCommonData.MinuteData;r.Close=i.price,r.Open=i.open,r.High=i.high,r.Low=i.low,r.Vol=i.vol,r.Amount=i.amount,r.DateTime=0==a?t.stock[0].date.toString()+" 0925":t.stock[0].date.toString()+" "+i.time.toString(),r.Date=t.stock[0].date,r.Time=i.time,r.Increate=i.increate,r.Risefall=i.risefall,r.AvPrice=i.avprice,e[a]=r}return e},this.CODELIKE=function(t){return 0==this.Symbol.indexOf(t)?1:0},this.NAMELIKE=function(t){return this.Name&&0==this.Name.indexOf(t)?1:0},this.SETCODE=function(){return this.Symbol.indexOf(".sh")?1:(this.Symbol.indexOf(".sz"),0)},this.GetSymbol=function(){return this.Symbol},this.GetName=function(){return this.Name},this.GetIndustry=function(){var t=L.JOB_DOWNLOAD_GROUP_DATA.toString()+"-Group-"+this.Symbol;if(!this.ExtendData.has(t))return"";var e=this.ExtendData.get(t);if(!e.Industry||e.Industry.length<=0)return"";var a="";for(var i in e.Industry){var r=e.Industry[i];a.length>0&&(a+=" "),a+=r.Name}return a},this.GetRegion=function(){var t=L.JOB_DOWNLOAD_GROUP_DATA.toString()+"-Group-"+this.Symbol;if(!this.ExtendData.has(t))return"";var e=this.ExtendData.get(t);if(!e.Region||e.Region.length<=0)return"";var a="";for(var i in e.Region){var r=e.Region[i];a.length>0&&(a+=" "),a+=r.Name}return a},this.GetConcept=function(){var t=L.JOB_DOWNLOAD_GROUP_DATA.toString()+"-Group-"+this.Symbol;if(!this.ExtendData.has(t))return"";var e=this.ExtendData.get(t);if(!e.Concept||e.Concept.length<=0)return"";var a="";for(var i in e.Concept){var r=e.Concept[i];a.length>0&&(a+=" "),a+=r.Name}return a},this.TIME=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e in this.Data.Data){var a=this.Data.Data[e];this.IsNumber(a.Time)?t[e]=a.Time:t[e]=0}return t},this.DATE=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e in this.Data.Data){var a=this.Data.Data[e];t[e]=a.Date-19e6}return t},this.YEAR=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e in this.Data.Data){var a=this.Data.Data[e];this.IsNumber(a.Date)?t[e]=parseInt(a.Date/1e4):t[e]=null}return t},this.MONTH=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e in this.Data.Data){var a=this.Data.Data[e];this.IsNumber(a.Date)?t[e]=parseInt(a.Date%1e4/100):t[e]=null}return t},this.WEEK=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;var e=new Date;for(var a in this.Data.Data){var i=this.Data.Data[a];if(t[a]=null,this.IsNumber(i.Date)){var r=parseInt(i.Date/1e4),n=parseInt(i.Date%1e4/100),s=i.Date%100;e.setFullYear(r),e.setMonth(n-1),e.setDate(s),t[a]=e.getDay()}}return t},this.REFDATE=function(t,e){var a=null;if(Array.isArray(e)?e.length>0&&(a=e[e.length-1]):this.IsNumber(e)&&(a=e),null==a)return null;a<5e6&&(a+=19e6);var i=null;for(var r in this.Data.Data)if(this.Data.Data[r].Date==a){i=parseInt(r);break}return null==i||i>=t.length?null:t[i]},this.PERIOD=function(){var t=[5,6,7,11,0,1,2,3,4,5,9];return this.Period>=0&&this.Period<=t.length-1?t[this.Period]:this.Period},this.GetDrawNull=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e in this.Data.Data)t[e]=null;return t}}M.prototype.IsNumber=function(t){return null!=t&&!isNaN(t)},M.prototype.IsDivideNumber=function(t){return null!=t&&(!isNaN(t)&&0!=t)},M.prototype.JsonDataToFinance=function(t){for(var e,a=1;a<=4;++a){switch(a){case 1:var i=t.finance1,r=t.announcement1;break;case 2:i=t.finance2,r=t.announcement2;break;case 3:i=t.finance3,r=t.announcement3;break;case 4:i=t.finance4,r=t.announcement4;break;default:break}i&&r&&this.IsNumber(r.year)&&this.IsNumber(r.quarter)&&(e?e.Announcement.year<r.year&&(e={Date:item.date,Finance:i,Announcement:r}):e={Date:t.date,Finance:i,Announcement:r})}return e};var E=!1,L=(r={JOB_DOWNLOAD_SYMBOL_DATA:1,JOB_DOWNLOAD_INDEX_DATA:2,JOB_DOWNLOAD_SYMBOL_LATEST_DATA:3,JOB_DOWNLOAD_INDEX_INCREASE_DATA:4,JOB_DOWNLOAD_VOLR_DATA:5,JOB_DOWNLOAD_GROUP_DATA:6,JOB_DOWNLOAD_FINVALUE:301,JOB_DOWNLOAD_FINONE:302,JOB_DOWNLOAD_FINANCE:303,JOB_DOWNLOAD_GPJYVALUE:304,JOB_DOWNLOAD_VARIANT:305,JOB_CUSTOM_FUNCTION_DATA:6e3,JOB_CUSTOM_VARIANT_DATA:6001,JOB_DOWNLOAD_MARGIN_BALANCE:1e3,JOB_DOWNLOAD_MARGIN_RATE:1001,JOB_DOWNLOAD_MARGIN_BUY_BALANCE:1010,JOB_DOWNLOAD_MARGIN_BUY_AMOUNT:1011,JOB_DOWNLOAD_MARGIN_BUY_REPAY:1012,JOB_DOWNLOAD_MARGIN_BUY_NET:1013,JOB_DOWNLOAD_MARGIN_SELL_BALANCE:1020,JOB_DOWNLOAD_MARGIN_SELL_VOLUME:1021,JOB_DOWNLOAD_MARGIN_SELL_REPAY:1022,JOB_DOWNLOAD_MARGIN_SELL_NET:1023,JOB_DOWNLOAD_NEWS_ANALYSIS_NEGATIVE:2e3,JOB_DOWNLOAD_NEWS_ANALYSIS_RESEARCH:2001,JOB_DOWNLOAD_NEWS_ANALYSIS_INTERACT:2002,JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE:2003,JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE2:2004,JOB_DOWNLOAD_NEWS_ANALYSIS_TRUSTHOLDER:2005,JOB_DOWNLOAD_NEWS_ANALYSIS_BLOCKTRADING:2006,JOB_DOWNLOAD_NEWS_ANALYSIS_COMPANYNEWS:2007,JOB_DOWNLOAD_NEWS_ANALYSIS_TOPMANAGERS:2008,JOB_DOWNLOAD_NEWS_ANALYSIS_PLEDGE:2009},(0,n.default)(r,"JOB_CUSTOM_FUNCTION_DATA",6e3),(0,n.default)(r,"JOB_CUSTOM_VARIANT_DATA",6001),(0,n.default)(r,"JOB_DOWNLOAD_CUSTOM_API_DATA",3e4),(0,n.default)(r,"JOB_RUN_SCRIPT",1e4),(0,n.default)(r,"GetMarginJobID",(function(t){var e=new Map([[1,L.JOB_DOWNLOAD_MARGIN_BALANCE],[2,L.JOB_DOWNLOAD_MARGIN_RATE],[3,L.JOB_DOWNLOAD_MARGIN_BUY_BALANCE],[4,L.JOB_DOWNLOAD_MARGIN_BUY_AMOUNT],[5,L.JOB_DOWNLOAD_MARGIN_BUY_REPAY],[6,L.JOB_DOWNLOAD_MARGIN_BUY_NET],[7,L.JOB_DOWNLOAD_MARGIN_SELL_BALANCE],[8,L.JOB_DOWNLOAD_MARGIN_SELL_VOLUME],[9,L.JOB_DOWNLOAD_MARGIN_SELL_REPAY],[10,L.JOB_DOWNLOAD_MARGIN_SELL_NET]]);return e.has(t)?e.get(t):null})),(0,n.default)(r,"GetNewsAnalysisID",(function(t){var e=new Map([[1,L.JOB_DOWNLOAD_NEWS_ANALYSIS_NEGATIVE],[2,L.JOB_DOWNLOAD_NEWS_ANALYSIS_RESEARCH],[3,L.JOB_DOWNLOAD_NEWS_ANALYSIS_INTERACT],[4,L.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE],[5,L.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE2],[6,L.JOB_DOWNLOAD_NEWS_ANALYSIS_TRUSTHOLDER],[7,L.JOB_DOWNLOAD_NEWS_ANALYSIS_BLOCKTRADING],[8,L.JOB_DOWNLOAD_NEWS_ANALYSIS_COMPANYNEWS],[9,L.JOB_DOWNLOAD_NEWS_ANALYSIS_TOPMANAGERS],[10,L.JOB_DOWNLOAD_NEWS_ANALYSIS_PLEDGE]]);return e.has(t)?e.get(t):null})),r);function g(t,e){this.AST=t,this.ErrorHandler=new c,this.VarTable=new Map,this.OutVarTable=new Array,this.Arguments=[],this.ConstVarTable=new Map([["CLOSE",null],["VOL",null],["OPEN",null],["HIGH",null],["LOW",null],["AMOUNT",null],["AMO",null],["VOLINSTK",null],["C",null],["V",null],["O",null],["H",null],["L",null],["VOLR",null],["DATE",null],["YEAR",null],["MONTH",null],["PERIOD",null],["WEEK",null],["TIME",null],["INDEXA",null],["INDEXC",null],["INDEXH",null],["INDEXL",null],["INDEXO",null],["INDEXV",null],["INDEXADV",null],["INDEXDEC",null],["CURRBARSCOUNT",null],["ISLASTBAR",null],["TOTALCAPITAL",null],["CAPITAL",null],["EXCHANGE",null],["SETCODE",null],["CODE",null],["STKNAME",null],["HYBLOCK",null],["DYBLOCK",null],["GNBLOCK",null],["DRAWNULL",null]]),this.SymbolData=new M(this.AST,e,this),this.Algorithm=new T(this.ErrorHandler,this.SymbolData),this.Draw=new F(this.ErrorHandler,this.SymbolData),this.JobList=[],this.UpdateUICallback=null,this.CallbackParam=null,e&&(e.Callback&&(this.UpdateUICallback=e.Callback),e.CallbackParam&&(this.CallbackParam=e.CallbackParam),e.Arguments&&(this.Arguments=e.Arguments)),this.Execute=function(){this.RunNextJob()},this.RunNextJob=function(){if(!(this.JobList.length<=0)){var t=this.JobList.shift();switch(t.ID){case L.JOB_DOWNLOAD_SYMBOL_DATA:return this.SymbolData.GetSymbolData();case L.JOB_DOWNLOAD_INDEX_DATA:return this.SymbolData.GetIndexData();case L.JOB_DOWNLOAD_INDEX_INCREASE_DATA:return this.SymbolData.GetIndexIncreaseData(t);case L.JOB_DOWNLOAD_SYMBOL_LATEST_DATA:return this.SymbolData.GetLatestData();case L.JOB_DOWNLOAD_VOLR_DATA:return this.SymbolData.GetVolRateData(t);case L.JOB_DOWNLOAD_GROUP_DATA:return this.SymbolData.GetGroupData(t);case L.JOB_DOWNLOAD_FINONE:return this.SymbolData.GetFinOne(t);case L.JOB_DOWNLOAD_FINVALUE:return this.SymbolData.GetFinValue(t);case L.JOB_DOWNLOAD_FINANCE:return this.SymbolData.GetFinance(t);case L.JOB_DOWNLOAD_GPJYVALUE:return this.SymbolData.GetGPJYValue(t);case L.JOB_DOWNLOAD_VARIANT:return this.SymbolData.GetVariantData(t);case L.JOB_CUSTOM_VARIANT_DATA:return this.SymbolData.GetCustomVariantData(t);case L.JOB_CUSTOM_FUNCTION_DATA:return this.SymbolData.GetCustomFunctionData(t);case L.JOB_DOWNLOAD_MARGIN_BALANCE:case L.JOB_DOWNLOAD_MARGIN_RATE:case L.JOB_DOWNLOAD_MARGIN_BUY_BALANCE:case L.JOB_DOWNLOAD_MARGIN_BUY_AMOUNT:case L.JOB_DOWNLOAD_MARGIN_BUY_REPAY:case L.JOB_DOWNLOAD_MARGIN_BUY_NET:case L.JOB_DOWNLOAD_MARGIN_SELL_BALANCE:case L.JOB_DOWNLOAD_MARGIN_SELL_VOLUME:case L.JOB_DOWNLOAD_MARGIN_SELL_REPAY:case L.JOB_DOWNLOAD_MARGIN_SELL_NET:return this.SymbolData.GetMarginData(t.ID);case L.JOB_DOWNLOAD_NEWS_ANALYSIS_NEGATIVE:case L.JOB_DOWNLOAD_NEWS_ANALYSIS_RESEARCH:case L.JOB_DOWNLOAD_NEWS_ANALYSIS_INTERACT:case L.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE:case L.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE2:case L.JOB_DOWNLOAD_NEWS_ANALYSIS_TRUSTHOLDER:case L.JOB_DOWNLOAD_NEWS_ANALYSIS_BLOCKTRADING:case L.JOB_DOWNLOAD_NEWS_ANALYSIS_COMPANYNEWS:case L.JOB_DOWNLOAD_NEWS_ANALYSIS_TOPMANAGERS:case L.JOB_DOWNLOAD_NEWS_ANALYSIS_PLEDGE:return this.SymbolData.GetNewsAnalysisData(t.ID);case L.JOB_DOWNLOAD_CUSTOM_API_DATA:return this.SymbolData.DownloadCustomAPIData(t);case L.JOB_RUN_SCRIPT:return this.Run()}}},this.ReadSymbolData=function(t,e){switch(t){case"CLOSE":case"C":case"VOL":case"V":case"OPEN":case"O":case"HIGH":case"H":case"LOW":case"L":case"AMOUNT":case"VOLINSTK":return this.SymbolData.GetSymbolCacheData(t);case"VOLR":return this.SymbolData.GetVolRateCacheData(e);case"INDEXA":case"INDEXC":case"INDEXH":case"INDEXO":case"INDEXV":case"INDEXL":case"INDEXADV":case"INDEXDEC":return this.SymbolData.GetIndexCacheData(t);case"CURRBARSCOUNT":return this.SymbolData.GetCurrBarsCount();case"ISLASTBAR":return this.SymbolData.GetIsLastBar();case"TOTALCAPITAL":case"CAPITAL":case"EXCHANGE":return this.SymbolData.GetStockCacheData({VariantName:t,Node:e});case"SETCODE":return this.SymbolData.SETCODE();case"CODE":return this.SymbolData.GetSymbol();case"STKNAME":return this.SymbolData.GetName();case"HYBLOCK":return this.SymbolData.GetIndustry();case"DYBLOCK":return this.SymbolData.GetRegion();case"GNBLOCK":return this.SymbolData.GetConcept();case"TIME":return this.SymbolData.TIME();case"DATE":return this.SymbolData.DATE();case"YEAR":return this.SymbolData.YEAR();case"MONTH":return this.SymbolData.MONTH();case"WEEK":return this.SymbolData.WEEK();case"PERIOD":return this.SymbolData.PERIOD();case"DRAWNULL":return this.SymbolData.GetDrawNull()}},this.ReadCustomVariant=function(t,e){return this.SymbolData.GetStockCacheData({VariantName:t,Node:e})},this.ReadVariable=function(t,e){if(this.ConstVarTable.has(t)){var a=this.ConstVarTable.get(t);return null==a&&(a=this.ReadSymbolData(t,e),this.ConstVarTable.set(t,a)),a}return u.IsCustomVariant(t)?this.ReadCustomVariant(t,e):this.VarTable.has(t)?this.VarTable.get(t):(this.ThrowUnexpectedNode(e,"变量"+t+"不存在"),null)},this.ReadMemberVariable=function(t){var e,a=t.Object,i=t.Property;if(e=a.Type==I.BinaryExpression||a.Type==I.LogicalExpression?this.VisitBinaryExpression(a):a.Type==I.CallExpression?this.VisitCallExpression(a):this.GetNodeValue(a),!e)return null;var r=e[i.Name];return r||null},this.SingleDataToArrayData=function(t){for(var e=this.SymbolData.Data.Data.length,a=[],i=0;i<e;++i)a[i]=t;return a},this.RunAST=function(){for(var t in this.Arguments){var e=this.Arguments[t];this.VarTable.set(e.Name,e.Value)}for(var a in this.AST||this.ThrowError(),this.AST.Body||this.ThrowError(),this.AST.Body){var i=this.AST.Body[a];if(this.VisitNode(i),i.Type==I.ExpressionStatement&&i.Expression)if(i.Expression.Type==I.AssignmentExpression&&":"==i.Expression.Operator&&i.Expression.Left){var r=i.Expression,n=r.Left.Name,s=this.VarTable.get(n);Array.isArray(s)||(s="string"==typeof s?this.SingleDataToArrayData(parseFloat(s)):this.SingleDataToArrayData(s)),this.OutVarTable.push({Name:n,Data:s,Type:0})}else if(i.Expression.Type==I.CallExpression){var o=i.Expression;if(this.Draw.IsDrawFunction(o.Callee.Name)){var h=o.Draw;h.Name=o.Callee.Name,this.OutVarTable.push({Name:h.Name,Draw:h,Type:1})}else{var u=o.Out;S="__temp_c_".concat(o.Callee.Name,"_").concat(a,"__");var C=0;Array.isArray(u)||(u=this.SingleDataToArrayData(u)),this.OutVarTable.push({Name:S,Data:u,Type:C,NoneName:!0})}}else if(i.Expression.Type==I.Identifier){var D=i.Expression.Name,m=this.ReadVariable(D,i.Expression);C=0;Array.isArray(m)||(m="string"==typeof m?this.SingleDataToArrayData(parseFloat(m)):this.SingleDataToArrayData(m)),D="__temp_i_"+a+"__",this.OutVarTable.push({Name:D,Data:m,Type:C,NoneName:!0})}else if(i.Expression.Type==I.BinaryExpression){var S="__temp_b_"+a+"__",c=i.Expression.Out;C=0;Array.isArray(c)||(c=this.SingleDataToArrayData(c)),this.OutVarTable.push({Name:S,Data:c,Type:C,NoneName:!0})}else if(i.Expression.Type==I.LogicalExpression){S="__temp_l_"+a+"__";var f=i.Expression.Out;C=0;Array.isArray(f)||(f=this.SingleDataToArrayData(f)),this.OutVarTable.push({Name:S,Data:f,Type:C,NoneName:!0})}else if(i.Expression.Type==I.SequenceExpression){var d=void 0,v=void 0,p=void 0,T=void 0,F=!1,A=!1,M=!1,E=!1,L=!1,g=!1,N=!0,x=!1,R=!1,O=!1,B=!1,y=!0,P=!1;for(var w in i.Expression.Expression){var b=i.Expression.Expression[w];if(b.Type==I.AssignmentExpression&&":"==b.Operator&&b.Left){d=b.Left.Name;var G=this.VarTable.get(d);Array.isArray(G)||(G=this.SingleDataToArrayData(G),this.VarTable.set(d,G))}else if(b.Type==I.Identifier){var V=b.Name;if("COLORSTICK"===V)F=!0;else if("POINTDOT"===V)A=!0;else if("CIRCLEDOT"===V)M=!0;else if("DOTLINE"==V)R=!0;else if("LINESTICK"===V)E=!0;else if("STICK"===V)L=!0;else if("VOLSTICK"===V)g=!0;else if("DRAWABOVE"===V)P=!0;else if(0==V.indexOf("COLOR"))p=V;else if(0==V.indexOf("LINETHICK"))T=V;else if(0==V.indexOf("NODRAW"))N=!1;else if(0==V.indexOf("EXDATA"))x=!0;else if(0==V.indexOf("LINEOVERLAY"))O=!0;else if(0==V.indexOf("NOTEXT")||0==V.indexOf("NOTITLE"))y=!1;else{d=b.Name;var _=this.ReadVariable(d,b);Array.isArray(_)||(_=this.SingleDataToArrayData(_)),d="__temp_si_"+a+"__",B=!0,this.VarTable.set(d,_)}}else if(b.Type==I.Literal){var H=this.SingleDataToArrayData(b.Value);d=b.Value.toString(),this.VarTable.set(d,H)}else if(b.Type==I.CallExpression)if(this.Draw.IsDrawFunction(b.Callee.Name))v=b.Draw,v.Name=b.Callee.Name;else{var J=b.Out;d="__temp_sc_".concat(b.Callee.Name,"_").concat(a,"__"),B=!0,this.VarTable.set(d,J)}else if(b.Type==I.BinaryExpression){d="__temp_sb_"+a+"__";var k=b.Out;B=!0,this.VarTable.set(d,k)}}if(A&&d){var U=this.VarTable.get(d),W={Name:d,Data:U,Radius:l.JSCommonResource_Global_JSChartResource.POINTDOT.Radius,Type:3};p&&(W.Color=p),T&&(W.LineWidth=T),this.OutVarTable.push(W)}else if(M&&d){var Y=this.VarTable.get(d),X={Name:d,Data:Y,Radius:l.JSCommonResource_Global_JSChartResource.CIRCLEDOT.Radius,Type:3};p&&(X.Color=p),T&&(X.LineWidth=T),this.OutVarTable.push(X)}else if(E&&d){var K=this.VarTable.get(d),z={Name:d,Data:K,Type:4};p&&(z.Color=p),T&&(z.LineWidth=T),this.OutVarTable.push(z)}else if(L&&d){var Z=this.VarTable.get(d),Q={Name:d,Data:Z,Type:5};p&&(Q.Color=p),T&&(Q.LineWidth=T),this.OutVarTable.push(Q)}else if(g&&d){var q=this.VarTable.get(d),j={Name:d,Data:q,Type:6};p&&(j.Color=p),this.OutVarTable.push(j)}else if(F&&d){var $=this.VarTable.get(d),tt={Name:d,Data:$,Color:p,Type:2};T&&(tt.LineWidth=T),p&&(tt.Color=p),this.OutVarTable.push(tt)}else if(d&&p){var et=this.VarTable.get(d),at={Name:d,Data:et,Color:p,Type:0};T&&(at.LineWidth=T),0==N&&(at.IsShow=!1),1==x&&(at.IsExData=!0),1==R&&(at.IsDotLine=!0),1==O&&(at.IsOverlayLine=!0),1==B&&(at.NoneName=!0),0==y&&(at.IsShowTitle=!1),this.OutVarTable.push(at)}else if(v){var it={Name:v.Name,Draw:v,Type:1};p&&(it.Color=p),T&&(it.LineWidth=T),P&&(it.IsDrawAbove=!0),this.OutVarTable.push(it)}else if(d){var rt=this.VarTable.get(d),nt={Name:d,Data:rt,Type:0};p&&(nt.Color=p),T&&(nt.LineWidth=T),0==N&&(nt.IsShow=!1),1==x&&(nt.IsExData=!0),1==R&&(nt.IsDotLine=!0),1==O&&(nt.IsOverlayLine=!0),0==y&&(nt.IsShowTitle=!1),this.OutVarTable.push(nt)}}}return this.OutVarTable},this.Run=function(){var t=this.RunAST();this.UpdateUICallback&&this.UpdateUICallback(t,this.CallbackParam)},this.VisitNode=function(t){switch(t.Type){case I.SequenceExpression:this.VisitSequenceExpression(t);break;case I.ExpressionStatement:this.VisitNode(t.Expression);break;case I.AssignmentExpression:this.VisitAssignmentExpression(t);break;case I.BinaryExpression:case I.LogicalExpression:this.VisitBinaryExpression(t);break;case I.CallExpression:this.VisitCallExpression(t);break}},this.VisitSequenceExpression=function(t){for(var e in t.Expression){var a=t.Expression[e];this.VisitNode(a)}},this.VisitCallExpression=function(t){var e=t.Callee.Name,a=[];for(var i in t.Arguments){var r=t.Arguments[i],n=void 0;n=r.Type==I.BinaryExpression||r.Type==I.LogicalExpression?this.VisitBinaryExpression(r):r.Type==I.CallExpression?this.VisitCallExpression(r):this.GetNodeValue(r),a.push(n)}if(u.IsCustomFunction(e)){var s=this.Algorithm.CallCustomFunction(e,a,this.SymbolData,t);return t.Out=[],t.Draw=null,s&&(s.Out&&(t.Out=s.Out),s.Draw&&(t.Draw=s.Draw)),t.Out}switch(e){case"DYNAINFO":t.Out=this.SymbolData.GetLatestCacheData(a[0]);break;case"STICKLINE":t.Draw=this.Draw.STICKLINE(a[0],a[1],a[2],a[3],a[4]),t.Out=[];break;case"DRAWTEXT":t.Draw=this.Draw.DRAWTEXT(a[0],a[1],a[2]),t.Out=[];break;case"SUPERDRAWTEXT":t.Draw=this.Draw.SUPERDRAWTEXT(a[0],a[1],a[2],a[3],a[4]),t.Out=[];break;case"DRAWTEXT_FIX":t.Draw=this.Draw.DRAWTEXT_FIX(a[0],a[1],a[2],a[3],a[4]),t.Out=[];break;case"DRAWICON":t.Draw=this.Draw.DRAWICON(a[0],a[1],a[2]),t.Out=[];break;case"DRAWLINE":t.Draw=this.Draw.DRAWLINE(a[0],a[1],a[2],a[3],a[4]),t.Out=t.Draw.DrawData;break;case"DRAWBAND":t.Draw=this.Draw.DRAWBAND(a[0],a[1],a[2],a[3]),t.Out=[];break;case"DRAWKLINE":t.Draw=this.Draw.DRAWKLINE(a[0],a[1],a[2],a[3]),t.Out=[];break;case"DRAWKLINE_IF":t.Draw=this.Draw.DRAWKLINE_IF(a[0],a[1],a[2],a[3],a[4]),t.Out=[];break;case"PLOYLINE":case"POLYLINE":t.Draw=this.Draw.POLYLINE(a[0],a[1]),t.Out=t.Draw.DrawData;break;case"DRAWNUMBER":t.Draw=this.Draw.DRAWNUMBER(a[0],a[1],a[2]),t.Out=t.Draw.DrawData.Value;break;case"RGB":t.Out=this.Draw.RGB(a[0],a[1],a[2]);break;case"RGBA":t.Out=this.Draw.RGBA(a[0],a[1],a[2],a[3]);break;case"DRAWRECTREL":t.Draw=this.Draw.DRAWRECTREL(a[0],a[1],a[2],a[3],a[4]),t.Out=[];break;case"DRAWGBK":t.Draw=this.Draw.DRAWGBK(a[0],a[1],a[2],a[3]),t.Out=[];break;case"DRAWGBK2":t.Draw=this.Draw.DRAWGBK2(a[0],a[1],a[2],a[3]),t.Out=[];break;case"CODELIKE":t.Out=this.SymbolData.CODELIKE(a[0]);break;case"NAMELIKE":t.Out=this.SymbolData.NAMELIKE(a[1]);break;case"REFDATE":t.Out=this.SymbolData.REFDATE(a[0],a[1]);break;case"FINANCE":t.Out=this.SymbolData.GetStockCacheData({FunctionName:e,Args:a,ArgCount:1,Node:t});break;case"FINVALUE":t.Out=this.SymbolData.GetStockCacheData({FunctionName:e,Args:a,ArgCount:1,Node:t});break;case"FINONE":t.Out=this.SymbolData.GetStockCacheData({FunctionName:e,Args:a,ArgCount:3,Node:t});break;case"GPJYVALUE":t.Out=this.SymbolData.GetStockCacheData({FunctionName:e,Args:a,ArgCount:3,Node:t});break;case"MARGIN":t.Out=this.SymbolData.GetMarginCacheData(a[0],t);break;case"NEWS":t.Out=this.SymbolData.GetNewsAnalysisCacheData(a[0],t);break;case"UPCOUNT":case"DOWNCOUNT":t.Out=this.SymbolData.GetIndexIncreaseCacheData(e,a[0],t);break;case"LOADAPIDATA":t.Out=this.SymbolData.GetCustomApiData(a);break;default:t.Out=this.Algorithm.CallFunction(e,a,t);break}return t.Out},this.VisitAssignmentExpression=function(t){var e=t.Left;e.Type!=I.Identifier&&this.ThrowUnexpectedNode(t);var a=e.Name,i=t.Right,r=null;i.Type==I.BinaryExpression||i.Type==I.LogicalExpression?r=this.VisitBinaryExpression(i):i.Type==I.CallExpression?r=this.VisitCallExpression(i):i.Type==I.Literal?r=i.Value:i.Type==I.Identifier?r=this.ReadVariable(i.Name,i):i.Type==I.MemberExpression&&(r=this.ReadMemberVariable(i)),E&&o.JSConsole.Complier.Log("[JSExecute::VisitAssignmentExpression]",a," = ",r),this.VarTable.set(a,r)},this.VisitBinaryExpression=function(t){var e=[];e.push(t);var a=null;while(0!=e.length)if(a=e[e.length-1],a.Left&&t!=a.Left&&t!=a.Right)e.push(a.Left);else if(a.Right&&t!=a.Right)e.push(a.Right);else{var i=e.pop();if(i.Type==I.BinaryExpression){var r=this.GetNodeValue(i.Left),n=this.GetNodeValue(i.Right);switch(E&&o.JSConsole.Complier.Log("[JSExecute::VisitBinaryExpression] BinaryExpression",i,r,n),i.Out=null,i.Operator){case"-":i.Out=this.Algorithm.Subtract(r,n);break;case"*":i.Out=this.Algorithm.Multiply(r,n);break;case"/":i.Out=this.Algorithm.Divide(r,n);break;case"+":i.Out=this.Algorithm.Add(r,n);break;case">":i.Out=this.Algorithm.GT(r,n);break;case">=":i.Out=this.Algorithm.GTE(r,n);break;case"<":i.Out=this.Algorithm.LT(r,n);break;case"<=":i.Out=this.Algorithm.LTE(r,n);break;case"==":case"=":i.Out=this.Algorithm.EQ(r,n);break;case"!=":case"<>":i.Out=this.Algorithm.NEQ(r,n);break}E&&o.JSConsole.Complier.Log("[JSExecute::VisitBinaryExpression] BinaryExpression",i)}else if(i.Type==I.LogicalExpression){var s=this.GetNodeValue(i.Left),h=this.GetNodeValue(i.Right);switch(E&&o.JSConsole.Complier.Log("[JSExecute::VisitBinaryExpression] LogicalExpression",i,s,h),i.Out=null,i.Operator){case"&&":case"AND":i.Out=this.Algorithm.And(s,h);break;case"||":case"OR":i.Out=this.Algorithm.Or(s,h);break}E&&o.JSConsole.Complier.Log("[JSExecute::VisitBinaryExpression] LogicalExpression",i)}t=a}return t.Out},this.GetNodeValue=function(t){switch(t.Type){case I.Literal:return t.Value;case I.UnaryExpression:if("-"==t.Operator){var e=this.GetNodeValue(t.Argument);return this.Algorithm.Subtract(0,e)}return t.Argument.Value;case I.Identifier:var a=this.ReadVariable(t.Name,t);return a;case I.BinaryExpression:case I.LogicalExpression:return t.Out;case I.CallExpression:return this.VisitCallExpression(t);default:this.ThrowUnexpectedNode(t)}},this.ThrowUnexpectedNode=function(t,e){var a=t.Marker,i=e||"执行异常";return this.ErrorHandler.ThrowError(a.Index,a.Line,a.Column,i)},this.ThrowError=function(){}}function N(){}function x(t){this.Url=t.Url,this.RealtimeUrl=t.RealtimeUrl,this.Job=t.Job,this.Symbol=t.Symbol,this.Args=t.Args,this.DataKey=t.DataKey,this.RecvCallback=t.Callback,this.ErrorCallback=t.ErrorCallback,this.Download=function(){var t=this.Args[0];switch(t){case 1:case 7:case"EXCHANGE":this.DownloadHistoryData(t);break;case 9:case 18:case 30:case 32:case 33:case 34:case 38:case 40:case 41:case 42:case 43:case"CAPITAL":case"TOTALCAPITAL":case 100:this.DownloadRealtimeData(t);break;default:this.DownloadRealtimeData(t);break}},this.DownloadRealtimeData=function(t){var e=this,a=this.GetFieldList();if(!a)return this.Job.FunctionName2?message="".concat(this.Job.FunctionName2," can't support."):this.Job.FunctionName?message="".concat(this.Job.FunctionName,"(").concat(this.Args[0],") can't support."):message="".concat(this.Args[0]," can't support."),this.ErrorCallback(message),void e.RecvCallback(null,e.Job,e.DataKey);wx.request({url:this.RealtimeUrl,data:{field:a,symbol:[this.Symbol],condition:[],start:0,end:10},method:"POST",dataType:"json",async:!0,success:function(t){var a=e.RealtimeDataToHQChartData(t.data);e.RecvCallback(a,e.Job,e.DataKey)}})},this.DownloadHistoryData=function(t){var e=this,a=this.GetFieldList();if(!a)return message="".concat(this.Job.FunctionName,"(").concat(this.Args[0],") can't support."),this.ErrorCallback(message),void e.RecvCallback(null,e.Job,e.DataKey);wx.request({url:this.Url,data:{field:a,symbol:[this.Symbol],condition:[],start:0,end:200},method:"POST",dataType:"json",async:!0,success:function(t){var a=e.ToHQChartData(t.data);a&&a.sort((function(t,e){return t.Date-e.Date})),e.RecvCallback(a,e.Job,e.DataKey)}})},this.GetFieldList=function(){var t=this.Args[0];switch(t){case 1:return["capital.total","capital.date"];case 7:return["capital.a","capital.date"];case"EXCHANGE":return["capital.a","capital.date"];case 9:return["finance.peruprofit","symbol","date"];case 18:return["finance.percreserve","symbol","date"];case 30:return["finance.nprofit","symbol","date"];case 32:return["finance.peruprofit","symbol","date"];case 33:return["finance.persearning","symbol","date"];case 34:return["finance.pernetasset","symbol","date"];case 38:return["finance.persearning","symbol","date"];case 40:return["capital.a","capital.date","symbol","date","price"];case 41:return["capital.total","capital.date","symbol","date","price"];case"CAPITAL":return["capital.a","capital.date","symbol","date"];case"TOTALCAPITAL":return["capital.total","capital.date","symbol","date"];case 42:return["company.releasedate","symbol","date"];case 43:return["dividendyield","symbol","date"];case 100:return["shareholder","symbol","date"];default:return null}},this.RealtimeDataToHQChartData=function(t,e){if(!t.stock||1!=t.stock.length)return null;var a=t.stock[0],i=(e=this.Args[0],a.date);switch(e){case 9:return a.finance?{Date:i,Value:a.finance.peruprofit}:null;case 18:return a.finance?{Date:i,Value:a.finance.percreserve}:null;case 30:return a.finance?{Date:i,Value:a.finance.nprofit}:null;case 32:return a.finance?{Date:i,Value:a.finance.peruprofit}:null;case 33:return a.finance?{Date:i,Value:a.finance.persearning}:null;case 34:return a.finance?{Date:i,Value:a.finance.pernetasset}:null;case 38:return a.finance?{Date:i,Value:a.finance.persearning}:null;case 40:return a.capital?{Date:i,Value:a.capital.a*a.price}:null;case 41:return a.capital?{Date:i,Value:a.capital.total*a.price}:null;case 42:if(!a.company)return null;var r=a.company.releasedate,n=parseInt(r/1e4),s=parseInt(r%1e4/100),o=r%100,h=new Date(n,s-1,o),l=new Date,u=parseInt((l.getTime()-h.getTime())/864e5);return{Date:i,Value:u+1};case 43:return a.dividendyield?{Date:i,Value:a.dividendyield.quarter4}:null;case 100:return a.shareholder?{Date:i,Value:a.shareholder.count}:null;case"CAPITAL":return a.capital?{Date:i,Value:a.capital.a/100}:null;case"TOTALCAPITAL":return a.capital?{Date:i,Value:a.capital.total/100}:null}},this.ToHQChartData=function(t){if(!t.stock||1!=t.stock.length)return null;var e=[],a=new Set,i=t.stock[0],r=this.Args[0];for(var n in i.stockday){var s=i.stockday[n],o=this.ToHQChartItemData(s,r);o&&!a.has(o.Date)&&(e.push(o),a.add(o.Date))}return e},this.ToHQChartItemData=function(t,e){if(!t)return null;var a=t.date;switch(e){case 1:return t.capital?{Date:a,Value:t.capital.total}:null;case 7:case"EXCHANGE":return t.capital?{Date:a,Value:t.capital.a}:null;default:return null}}}function R(t){this.Url=t.Url,this.Job=t.Job,this.Symbol=t.Symbol,this.Args=t.Args,this.DataKey=t.DataKey,this.RecvCallback=t.Callback,this.ErrorCallback=t.ErrorCallback,this.Download=function(){var t=this,e=this.GetFieldList();if(!e)return message="".concat(this.Job.FunctionName,"(").concat(this.Args[0],") can't support."),this.ErrorCallback(message),void t.RecvCallback(null,t.Job,t.DataKey);wx.request({url:this.Url,data:{field:e,symbol:[this.Symbol],condition:[{item:["finance","doc","exists","true"]}],start:0,end:200},method:"POST",dataType:"json",async:!0,success:function(e){var a=t.ToHQChartData(e.data);a&&a.sort((function(t,e){return t.Date-e.Date})),t.RecvCallback(a,t.Job,t.DataKey)}})},this.ToHQChartData=function(t){if(!t.stock||1!=t.stock.length)return null;var e=[],a=new Set,i=t.stock[0];for(var r in i.stockday){var n=i.stockday[r];if(n.announcement1){var s=this.ToHQChartItemData(n.announcement1,n.finance1,n);s&&!a.has(s.Date)&&(e.push(s),a.add(s.Date))}if(n.announcement2){s=this.ToHQChartItemData(n.announcement2,n.finance2,n);s&&!a.has(s.Date)&&(e.push(s),a.add(s.Date))}if(n.announcement3){s=this.ToHQChartItemData(n.announcement3,n.finance3,n);s&&!a.has(s.Date)&&(e.push(s),a.add(s.Date))}if(n.announcement4){s=this.ToHQChartItemData(n.announcement4,n.finance4,n);s&&!a.has(s.Date)&&(e.push(s),a.add(s.Date))}}return e},this.ToHQChartItemData=function(t,e,a){var i=this.Args[0],r=1e4*t.year,n=t.quarter;switch(n){case 1:r+=331;break;case 2:r+=630;break;case 3:r+=930;break;case 4:r+=1231;break;default:return null}var s={Date:r,Value:0};switch(i){case 0:s.Value=r%1e6;break;case 1:s.Value=e.persearning;break;case 3:s.Value=e.peruprofit;break;case 4:s.Value=e.pernetasset;break;case 5:s.Value=e.percreserve;break;case 6:s.Value=e.woewa;break;case 7:s.Value=e.perccfo;break;case 8:s.Value=e.monetaryfunds;break;case 11:s.Value=e.areceivable;break}return s},this.GetFieldList=function(){var t=this.Args[0];switch(t){case 0:return["finance.date"];case 1:return["finance.persearning"];case 3:return["finance.peruprofit"];case 4:return["finance.pernetasset"];case 5:return["finance.percreserve"];case 6:return["finance.woewa"];case 7:return["finance.perccfo"];case 8:return["finance.monetaryfunds"];case 11:return["finance.areceivable"];default:return null}}}function O(t){this.newMethod=R,this.newMethod(t),delete this.newMethod,this.Download=function(){var t=this,e=this.GetFieldList();if(!e)return message="".concat(this.Job.FunctionName,"(").concat(this.Args[0],", ").concat(this.Args[1],", ").concat(this.Args[2],") can't support."),this.ErrorCallback(message),void t.RecvCallback(null,t.Job,t.DataKey);var a=[{item:["finance","doc","exists","true"]}],i=this.Args[1],r=this.Args[2],n=0,s=3,o=null;0==i&&0==r||(0==i&&r<300?(n=r,s=200):0==r&&i<1e3?o=i:i>1909&&(331==r?(a=[{item:["announcement1.year","int32","eq",i]},{item:["finance1","doc","exists","true"]}],e.push("announcement1.year"),e.push("announcement1.quarter")):630==r?(a=[{item:["announcement2.year","int32","eq",i]},{item:["finance2","doc","exists","true"]}],e.push("announcement2.year"),e.push("announcement2.quarter")):930==r?(a=[{item:["announcement3.year","int32","eq",i]},{item:["finance3","doc","exists","true"]}],e.push("announcement4.year"),e.push("announcement4.quarter")):(a=[{item:["announcement4.year","int32","eq",i]},{item:["finance4","doc","exists","true"]}],e.push("announcement4.year"),e.push("announcement4.quarter")))),wx.request({url:this.Url,data:{field:e,symbol:[this.Symbol],condition:a,start:0,end:s},method:"POST",dataType:"json",async:!0,success:function(e){var a=t.ToHQChartData(e.data),i=null;a&&a.length>0&&(a.sort((function(t,e){return e.Date-t.Date})),i=null==o?a[n]:t.GetPreYearData(a,o)),t.RecvCallback(i,t.Job,t.DataKey)}})},this.GetPreYearData=function(t,e){if(331!=e&&630!=e&&930!=e&&1231!=e){for(var a=t[0].Date%1e3,i=(r=1,0);r<t.length;++r){n=t[r];if(n.Date%1e4==a&&(++i,i==e))return n}return null}for(var r in t){var n=t[r];if(n.Date%1e4==e)return n}}}function B(t){this.Url=t.Url,this.RealtimeUrl=t.RealtimeUrl,this.Job=t.Job,this.Symbol=t.Symbol,this.Args=t.Args,this.DataKey=t.DataKey,this.RecvCallback=t.Callback,this.ErrorCallback=t.ErrorCallback,this.Download=function(){var t=this,e=this.GetFieldList();if(!e)return message="".concat(this.Job.FunctionName,"(").concat(this.Args[0],", ").concat(this.Args[1],", ").concat(this.Args[2],") can't support."),this.ErrorCallback(message),void t.RecvCallback(null,t.Job,t.DataKey,!0);wx.request({url:this.Url,data:{field:e,symbol:[this.Symbol],orderfield:"date",order:-1,start:0,end:5},method:"POST",dataType:"json",async:!0,success:function(e){var a=t.ToHQChartData(e.data);a&&a.length>0&&a.sort((function(t,e){return t.Date-e.Date})),t.RecvCallback(a,t.Job,t.DataKey)}})},this.GetFieldList=function(){var t=this.Args[0];switch(t){case 1:return["shareholder","date","symbol"];case 2:return["tradedetail.buy","tradedetail.sell","date","symbol"];case 3:return["margin","date","symbol"];case 4:return["blocktrading.amount","blocktrading.price","date","symbol"];default:return null}},this.ToHQChartData=function(t){if(!t.stock||1!=t.stock.length)return null;var e=[],a=new Set,i=t.stock[0],r=this.Args[0],n=this.Args[1];for(var s in i.stockday){var o=i.stockday[s],h=this.ToHQChartItemData(o,r,n);h&&!a.has(h.Date)&&(e.push(h),a.add(h.Date))}return e},this.ToHQChartItemData=function(t,e,a){if(!t)return null;var i=t.date;switch(e){case 1:return t.shareholder?{Date:i,Value:t.shareholder.count}:null;case 2:return!t.tradedetail&&t.tradedetail[0]?null:0==a?{Date:i,Value:t.tradedetail[0].buy}:{Date:i,Value:t.tradedetail[0].sell};case 3:if(!t.margin)return null;if(0==a){if(t.margin.buy)return{Date:i,Value:t.margin.buy.balance}}else if(t.margin.sell)return{Date:i,Value:t.margin.sell.balance};return null;case 4:return t.blocktrading?0==a?{Date:i,Value:t.blocktrading.price}:{Date:i,Value:t.blocktrading.amount}:null;default:return null}}}N.Tokenize=function(t){var e=new d(t),a=[];try{while(1){var i=e.GetNextToken();if(!i)break;a.push(i)}}catch(r){}return a},N.Parse=function(t){var e=new p(t);e.Initialize();var a=e.ParseScript(),i=a;return i},N.Execute=function(t,e,a){var i=function(){try{var i=new p(t);i.Initialize();var r=i.ParseScript(),n=r,s=new g(n,e);s.JobList=i.Node.GetDataJobList(),s.JobList.push({ID:L.JOB_RUN_SCRIPT});s.Execute()}catch(h){o.JSConsole.Complier.Log(h),a&&a(h)}};i()},N.SetDomain=function(t,e){t&&(u.Domain=t),e&&(u.CacheDomain=e)},N.AddFunction=function(t){if(t&&t.Name){var e=t.Name.toUpperCase();u.CustomFunction.Data.set(e,t)}},N.AddVariant=function(t){if(t&&t.Name){var e=t.Name.toUpperCase();u.CustomVariant.Data.set(e,t)}},t.exports={JSCommonComplier:{JSComplier:N}}},"621d":function(t,e,a){"use strict";a("4de4"),a("fb6a"),a("d3b7"),a("acd8"),a("e25e"),a("ac1f"),a("25f0"),a("6062"),a("3ca3"),a("5319"),a("841c"),a("1276"),a("ddb0");var i=a("90f8"),r=a("8f32"),n=a("8cb2");n.JSCommonCoordinateData.MARKET_SUFFIX_NAME;function s(){this.Value,this.Message=new Array,this.TextColor=i.JSCommonResource_Global_JSChartResource.FrameSplitTextColor,this.Font=i.JSCommonResource_Global_JSChartResource.FrameSplitTextFont,this.LineColor=i.JSCommonResource_Global_JSChartResource.FrameSplitPen,this.LineType=1}function o(){this.ChartBorder,this.Frame,this.FrameSplitData,this.SplitCount=5,this.StringFormat=0,this.IsShowLeftText=!0,this.IsShowRightText=!0,this.LanguageID=i.JSCommonResource_JSCHART_LANGUAGE_ID.LANGUAGE_CHINESE_ID,this.GetEventCallback,this.IntegerCoordinateSplit=function(t){var e=this.FrameSplitData.Find(t.Interval);if(!e)return!1;if(t.Interval==e.Interval)return!0;var a=t.Max,i=t.Min,r=t.Max/e.FixInterval,n=t.Min/e.FixInterval;o.IsFloat(r)&&(a=parseInt((r+.5).toFixed(0))*e.FixInterval),o.IsFloat(n)&&(i=parseInt((n-.5).toFixed(0))*e.FixInterval),0==t.Min&&(i=0),i<0&&t.Min>0&&(i=0);for(var s=0,h=i;h-a<1e-8;h+=e.FixInterval)++s;return t.Interval=e.FixInterval,t.Max=a,t.Min=i,t.Count=s,!0},this.Filter=function(t,e){if(this.SplitCount<=0||t.length<=0||t.length<=this.SplitCount)return t;var a=parseInt(t.length/this.SplitCount);a<=1&&(a=2);for(var i=[],r=0;r<t.length;r+=a)r+a>=t.length&&r!=t.length-1?i.push(t[t.length-1]):i.push(t[r]);if(2==this.SplitCount&&i.length>2)for(r=1;r<i.length-1;++r){var n=i[r];n.Message[0]=null,n.Message[1]=null}if(e){var o=!1;for(r=0;r<i;++r){n=i[r];if(Math.abs(n.Value)<1e-8){o=!0;break}}if(0==o){var h=new s;h.Value=0,h.Message[0]=null,h.Message[1]=null,i.push(h)}}return i},this.RemoveZero=function(t){var e=[!0,!0];for(var a in t){var i=t[a],r=i.Message[0];this.IsDecimalZeroEnd(r)||(e[0]=!1);r=i.Message[1];this.IsDecimalZeroEnd(r)||(e[1]=!1)}if(0!=e[0]||0!=e[1])for(var a in t){i=t[a];if(e[0]){r=i.Message[0];null!=r&&("number"==typeof r&&(r=r.toString()),i.Message[0]=r.replace(/[.][0]+/g,""))}if(e[1]){r=i.Message[1];null!=r&&("number"==typeof r&&(r=r.toString()),i.Message[1]=r.replace(/[.][0]+/g,""))}}},this.IsDecimalZeroEnd=function(t){if(null==t)return!0;if("0"==t)return!0;"number"==typeof t&&(t=t.toString());var e=t.search(/[.]/);if(e<0)return!1;for(var a=e+1;a<t.length;++a){var i=t.charAt(a);if(i>="1"&&i<="9")return!1}return!0}}function h(){this.newMethod=o,this.newMethod(),delete this.newMethod,this.CoordinateType=0,this.Symbol,this.Data,this.FrameSplitData2,this.FloatPrecision=null,this.Custom=[],this.SplitType=0,this.Operator=function(){var t={};t.Max=this.Frame.HorizontalMax,t.Min=this.Frame.HorizontalMin,t.Count=this.SplitCount,t.Max==t.Min&&(t.Max+=.01*t.Max,t.Min-=.01*t.Min),t.Interval=(t.Max-t.Min)/(t.Count-1);var e=n.JSCommonCoordinateData.GetfloatPrecision(this.Symbol);n.JSCommonCoordinateData.MARKET_SUFFIX_NAME.IsSHSZIndex(this.Symbol)&&(e=0),null!=this.FloatPrecision&&(e=this.FloatPrecision);var a=!0;if(h.SplitCustom)h.SplitCustom(this,t,e),a=!1;else switch(this.CoordinateType){case 1:this.SplitPercentage(t,e);break;default:1==this.SplitType?this.SplitFixed(t,e):this.SplitDefault(t,e),this.CustomCoordinate(e);break}if(a&&(this.Frame.HorizontalInfo=this.Filter(this.Frame.HorizontalInfo,!1)),this.Frame.HorizontalMax=t.Max,this.Frame.HorizontalMin=t.Min,this.GetEventCallback){var i=this.GetEventCallback(r.JSCommon_JSCHART_EVENT_ID.ON_SPLIT_YCOORDINATE);if(i&&i.Callback){var s={ID:this.Frame.Identify,Frame:this.Frame};i.Callback(i,s,this)}}},this.SplitDefault=function(t,e){this.IntegerCoordinateSplit(t),this.Frame.HorizontalInfo=[];for(var a=0,i=t.Min;a<t.Count;++a,i+=t.Interval)this.Frame.HorizontalInfo[a]=new s,this.Frame.HorizontalInfo[a].Value=i,this.IsShowLeftText&&(this.Frame.HorizontalInfo[a].Message[0]=i.toFixed(e)),this.IsShowRightText&&(this.Frame.HorizontalInfo[a].Message[1]=i.toFixed(e))},this.SplitPercentage=function(t,e){var a=this.GetFirstOpenPrice();t.Max=(t.Max-a)/a,t.Min=(t.Min-a)/a,t.Interval=(t.Max-t.Min)/(t.Count-1),this.IntegerCoordinateSplit2(t),this.Frame.HorizontalInfo=[];for(var i=0,r=t.Min;i<t.Count;++i,r+=t.Interval){var n=(r+1)*a;this.Frame.HorizontalInfo[i]=new s,this.Frame.HorizontalInfo[i].Value=n,this.IsShowLeftText&&(this.Frame.HorizontalInfo[i].Message[0]=n.toFixed(e)),this.IsShowRightText&&(this.Frame.HorizontalInfo[i].Message[1]=(100*r).toFixed(2)+"%")}t.Min=(1+t.Min)*a,t.Max=(1+t.Max)*a},this.SplitFixed=function(t,e){this.Frame.HorizontalInfo=[];for(var a=0,i=t.Min;a<t.Count;++a,i+=t.Interval)this.Frame.HorizontalInfo[a]=new s,this.Frame.HorizontalInfo[a].Value=i,this.IsShowLeftText&&(this.Frame.HorizontalInfo[a].Message[0]=i.toFixed(e)),this.IsShowRightText&&(this.Frame.HorizontalInfo[a].Message[1]=i.toFixed(e))},this.CustomCoordinate=function(t){for(var e in this.Frame.CustomHorizontalInfo=[],this.Custom){var a=this.Custom[e];if(0==a.Type){var i=t;o.IsNumber(a.FloatPrecision)&&a.FloatPrecision>=0&&(i=a.FloatPrecision);var r=this.GetLatestPrice(i,a);r&&this.Frame.CustomHorizontalInfo.push(r)}else 1==a.Type&&this.CustomFixedCoordinate(a)}},this.GetLatestPrice=function(t,e){if(!this.Data||!this.Data.Data)return null;if(this.Data.Data.length<=0)return null;var a=this.Data.Data[this.Data.Data.length-1],r=new s;return r.Type=0,r.Value=a.Close,r.TextColor=i.JSCommonResource_Global_JSChartResource.FrameLatestPrice.TextColor,r.LineType=2,a.Close=parseFloat(a.Close),"left"==e.Position?r.Message[0]=a.Close.toFixed(t):r.Message[1]=a.Close.toFixed(t),a.Close>a.Open?r.LineColor=i.JSCommonResource_Global_JSChartResource.FrameLatestPrice.UpBarColor:a.Close<a.Open?r.LineColor=i.JSCommonResource_Global_JSChartResource.FrameLatestPrice.DownBarColor:r.LineColor=i.JSCommonResource_Global_JSChartResource.FrameLatestPrice.UnchagneBarColor,o.IsNumber(e.LineType)&&(r.LineType=e.LineType),0==e.IsShowLine&&(r.LineType=-1),r},this.GetFirstOpenPrice=function(){if(!this.Data)return null;for(var t=this.Frame.XPointCount,e=this.Data.DataOffset,a=0;e<this.Data.Data.length&&a<t;++e,++a){var i=this.Data.Data[e];if(null!=i.Open&&null!=i.High&&null!=i.Low&&null!=i.Close)return i.Open}return null},this.CustomFixedCoordinate=function(t){var e=n.JSCommonCoordinateData.GetfloatPrecision(this.Symbol);for(var a in t.Data){var i,r=t.Data[a],h=new s;h.Type=1,h.TextColor=r.TextColor,h.LineColor=r.Color,h.LineType=2,o.IsNumber(t.LineType)&&(h.LineType=t.LineType),0==t.IsShowLine&&(h.LineType=-1),h.Value=r.Value,i=r.Text?r.Text:h.Value.toFixed(e),"left"==t.Position?h.Message[0]=i:h.Message[1]=i,this.Frame.CustomHorizontalInfo.push(h)}},this.IntegerCoordinateSplit2=function(t){var e=this.FrameSplitData2.Find(t.Interval);if(!e)return!1;if(t.Interval==e.FixInterval)return!0;var a=t.Max,i=t.Min,r=t.Max/e.FixInterval,n=t.Min/e.FixInterval;o.IsFloat(r)&&(a=parseInt((r+.5).toFixed(0))*e.FixInterval),o.IsFloat(n)&&(i=parseInt((n-.5).toFixed(0))*e.FixInterval),0==t.Min&&(i=0),i<0&&t.Min>0&&(i=0);for(var s=0,h=i;h-a<1e-8;h+=e.FixInterval)++s;return t.Interval=e.FixInterval,t.Max=a,t.Min=i,t.Count=s,!0}}function l(){this.newMethod=o,this.newMethod(),delete this.newMethod,this.SplitType=0,this.FloatPrecision=2,this.FLOATPRECISION_RANGE=[1,.1,.01,.001,1e-4],this.IgnoreYValue=null,this.LineType=null,this.IsShowYZero=!0,this.IntegerSplitData=null,this.Operator=function(){var t={};if(t.Max=this.Frame.HorizontalMax,t.Min=this.Frame.HorizontalMin,this.Frame.YSpecificMaxMin?(t.Count=this.Frame.YSpecificMaxMin.Count,t.Interval=(t.Max-t.Min)/(t.Count-1)):1==this.SplitType?(t.Count=this.SplitCount,t.Interval=(t.Max-t.Min)/(t.Count-1)):(t.Count=2*this.SplitCount,0==this.FloatPrecision?(t.Interval=(t.Max-t.Min)/(t.Count-1),this.IntegerCoordinateSplit2(t)):(t.Interval=(t.Max-t.Min)/(t.Count-1),this.IntegerCoordinateSplit(t))),this.Frame.HorizontalInfo=[],this.Frame.YSplitScale)for(var e in this.Frame.YSplitScale){var a=this.Frame.YSplitScale[e],i=new s;i.Value=a,o.IsNumber(this.LineType)&&(i.LineType=this.LineType);var n=Math.abs(a),h=this.FloatPrecision;n<1e-10?i.Message[1]=0:n<this.FLOATPRECISION_RANGE[this.FLOATPRECISION_RANGE.length-1]?i.Message[1]=a.toExponential(2).toString():(h<this.FLOATPRECISION_RANGE.length&&n<this.FLOATPRECISION_RANGE[h]&&++h,h<this.FLOATPRECISION_RANGE.length&&n<this.FLOATPRECISION_RANGE[h]&&++h,h<this.FLOATPRECISION_RANGE.length&&n<this.FLOATPRECISION_RANGE[h]&&++h,i.Message[1]=o.FormatValueString(a,h,this.LanguageID)),i.Message[0]=i.Message[1],-2==this.StringFormat?i.Message[1]=null:-3==this.StringFormat?i.Message[0]=null:-1==this.StringFormat&&(i.Message[0]=i.Message[1]=null),this.Frame.HorizontalInfo.push(i)}else for(e=0,a=t.Min;e<t.Count;++e,a+=t.Interval){i=new s;if(this.Frame.HorizontalInfo[e]=i,i.Value=a,o.IsNumber(this.LineType)&&(i.LineType=this.LineType),1==this.StringFormat){h=this.FloatPrecision;!isNaN(a)&&Math.abs(a)>1e3&&(h=0),this.Frame.HorizontalInfo[e].Message[1]=o.FormatValueString(a,h,this.LanguageID)}else if(-1==this.StringFormat);else{n=Math.abs(a),h=this.FloatPrecision;n<1e-10?this.Frame.HorizontalInfo[e].Message[1]=0:n<this.FLOATPRECISION_RANGE[this.FLOATPRECISION_RANGE.length-1]?this.Frame.HorizontalInfo[e].Message[1]=a.toExponential(2).toString():(h<this.FLOATPRECISION_RANGE.length&&n<this.FLOATPRECISION_RANGE[h]&&++h,h<this.FLOATPRECISION_RANGE.length&&n<this.FLOATPRECISION_RANGE[h]&&++h,h<this.FLOATPRECISION_RANGE.length&&n<this.FLOATPRECISION_RANGE[h]&&++h,this.Frame.HorizontalInfo[e].Message[1]=o.FormatValueString(a,h,this.LanguageID))}this.Frame.HorizontalInfo[e].Message[0]=this.Frame.HorizontalInfo[e].Message[1],-2==this.StringFormat?this.Frame.HorizontalInfo[e].Message[1]=null:-3==this.StringFormat&&(this.Frame.HorizontalInfo[e].Message[0]=null)}if(this.FilterIgnoreYValue(),this.Frame.HorizontalInfo=this.Filter(this.Frame.HorizontalInfo,t.Max>0&&t.Min<0&&this.IsShowYZero),this.RemoveZero(this.Frame.HorizontalInfo),this.Frame.HorizontalMax=t.Max,this.Frame.HorizontalMin=t.Min,this.GetEventCallback){var l=this.GetEventCallback(r.JSCommon_JSCHART_EVENT_ID.ON_SPLIT_YCOORDINATE);if(l&&l.Callback){var u={ID:this.Frame.Identify,Frame:this.Frame};l.Callback(l,u,this)}}},this.FilterIgnoreYValue=function(){if(this.IgnoreYValue&&!(this.IgnoreYValue.length<=0)){var t=new Set(this.IgnoreYValue);this.Frame.HorizontalInfo=this.Frame.HorizontalInfo.filter((function(e){return!t.has(e.Value)})),this.IsShowYZero=!t.has(0)}},this.IntegerCoordinateSplit2=function(t){null==this.IntegerSplitData&&(this.IntegerSplitData=new d),t.Max>0?t.Max=parseInt(t.Max+.5):t.Max<0&&(t.Max=parseInt(t.Max-.5)),t.Min>0?t.Min=parseInt(t.Min-.5):t.Min<0&&(t.Min=parseInt(t.Min+.5)),t.Interval=(t.Max-t.Min)/(t.Count-1);var e=this.IntegerSplitData.Find(t.Interval);if(!e)return!1;if(t.Interval==e.Interval)return!0;var a=parseInt((t.Max/e.FixInterval+.5).toFixed(0))*e.FixInterval+.5,i=parseInt((t.Min/e.FixInterval-.5).toFixed(0))*e.FixInterval;0==t.Min&&(i=0),i<0&&t.Min>0&&(i=0);for(var r=0,n=i;n-a<1e-8;n+=e.FixInterval)++r;return t.Interval=e.FixInterval,t.Max=a,t.Min=i,t.Count=r,!0}}function u(){this.newMethod=o,this.newMethod(),delete this.newMethod,this.ShowText=!0,this.MinDistance=12,this.Period,this.Symbol,this.MinTextDistance=50,this.SplitDateTime=function(){this.Frame.VerticalInfo=[];for(var t=this.Frame.DistanceWidth+this.Frame.DataWidth,e=this.Frame.Data.DataOffset,a=this.Frame.XPointCount,i=0,r=0,n=e;r<a&&n<this.Frame.Data.Data.length;++r,++n){i+=t;var h=null;if(0==r){var l=o.FormatDateString(this.Frame.Data.Data[n].Date,"MM-DD");h={Value:n-e,Text:l}}else if(i>this.MinTextDistance){var u=o.FormatTimeString(this.Frame.Data.Data[n].Time);h={Value:n-e,Text:u}}if(h){var C=new s;C.Value=h.Value,this.ShowText&&(C.Message[0]=h.Text),this.Frame.VerticalInfo.push(C),i=0,0==r&&(i=-this.MinTextDistance/2)}}},this.SplitSecond=function(){this.Frame.VerticalInfo=[];for(var t=this.Frame.DistanceWidth+this.Frame.DataWidth,e=this.Frame.Data.DataOffset,a=this.Frame.XPointCount,i=0,r=0,n=e;r<a&&n<this.Frame.Data.Data.length;++r,++n){i+=t;var h=null;if(0==r){var l=o.FormatDateString(this.Frame.Data.Data[n].Date,"MM-DD");h={Value:n-e,Text:l}}else if(i>this.MinTextDistance){var u=o.FormatTimeString(this.Frame.Data.Data[n].Time,"HH:MM:SS");h={Value:n-e,Text:u}}if(h){var C=new s;C.Value=h.Value,this.ShowText&&(C.Message[0]=h.Text),this.Frame.VerticalInfo.push(C),i=0,0==r&&(i=-this.MinTextDistance/2)}}},this.SplitDate=function(){this.Frame.VerticalInfo=[];for(var t=this.Frame.Data.DataOffset,e=this.Frame.XPointCount,a=null,i=null,r=0,n=0,o=t,h=this.MinDistance;n<e&&o<this.Frame.Data.Data.length;++n,++o){var l=parseInt(this.Frame.Data.Data[o].Date/1e4),u=parseInt(this.Frame.Data.Data[o].Date/100)%100;if(i!=u&&++r,h<this.MinDistance&&a==l||null!=a&&a==l&&null!=i&&i==u)i=u,++h;else{var C,D=new s;D.Value=o-t,null==a||a!=l?C=l.toString():null!=i&&i==u||(C=u.toString()+"月"),a=l,i=u,this.ShowText&&(D.Message[0]=C),this.Frame.VerticalInfo.push(D),h=0}}0==this.Period&&r<=2&&this.SplitShortDate()},this.SplitShortDate=function(){this.Frame.VerticalInfo=[];for(var t=this.Frame.Data.DataOffset,e=this.Frame.XPointCount,a=12,i=!0,r=0,n=t,h=a;r<e&&n<this.Frame.Data.Data.length;++r,++n){var l=parseInt(this.Frame.Data.Data[n].Date/1e4);if(h<a)++h;else{var u,C=new s;C.Value=n-t,i?(u=l.toString(),i=!1):u=o.FormatDateString(this.Frame.Data.Data[n].Date,"MM-DD"),this.ShowText&&(C.Message[0]=u),this.Frame.VerticalInfo.push(C),h=0}}},this.Operator=function(){null!=this.Frame.Data&&(u.SplitCustom?u.SplitCustom(this):r.JSCommon_ChartData.IsMinutePeriod(this.Period,!0)?this.SplitDateTime():r.JSCommon_ChartData.IsSecondPeriod(this.Period)?this.SplitSecond():this.SplitDate())},this.CreateCoordinateInfo=function(){return new s}}function C(){this.newMethod=o,this.newMethod(),delete this.newMethod,this.High=null,this.Low=null,this.YClose,this.Data,this.AverageData,this.OverlayChartPaint,this.SplitCount=7,this.Symbol,this.Custom,this.Operator=function(){if(this.Frame.HorizontalInfo=[],this.Frame.CustomHorizontalInfo=[],this.Data){var t=this.GetMaxMin();if(this.DefaultSplit(t),this.CustomCoordinate(),this.GetEventCallback){var e=this.GetEventCallback(r.JSCommon_JSCHART_EVENT_ID.ON_SPLIT_YCOORDINATE);if(e&&e.Callback){var a={ID:this.Frame.Identify,Frame:this.Frame};e.Callback(e,a,this)}}}},this.GetMaxMin=function(){var t=this.YClose,e=this.YClose;for(var a in this.Data.Data)this.Data.Data[a]&&(t<this.Data.Data[a]&&(t=this.Data.Data[a]),e>this.Data.Data[a]&&(e=this.Data.Data[a]));if(this.AverageData)for(var a in this.AverageData.Data)this.AverageData.Data[a]&&(t<this.AverageData.Data[a]&&(t=this.AverageData.Data[a]),e>this.AverageData.Data[a]&&(e=this.AverageData.Data[a]));if(this.OverlayChartPaint&&this.OverlayChartPaint.length>0&&this.OverlayChartPaint[0]&&this.OverlayChartPaint[0].Symbol){var i=this.OverlayChartPaint[0].GetMaxMin();i.Max&&i.Max>t&&(t=i.Max),i.Min&&i.Min<e&&(e=i.Min)}return o.IsNumber(this.High)&&o.IsNumber(this.Low)&&(t<this.High&&(t=this.High),e>this.Low&&(e=this.Low)),{Max:t,Min:e}},this.DefaultSplit=function(t){var e=t.Max,a=t.Min;if(this.YClose==e&&this.YClose==a)e=this.YClose+.1*this.YClose,a=this.YClose-.1*this.YClose;else{var r=Math.max(Math.abs(this.YClose-e),Math.abs(this.YClose-a));e=this.YClose+r,a=this.YClose-r,a<0&&(a=t.Min)}var h=this.SplitCount,l=(e-a)/(h-1),u=[1,.1,.01,.001,1e-4],C=n.JSCommonCoordinateData.GetfloatPrecision(this.Symbol);n.JSCommonCoordinateData.MARKET_SUFFIX_NAME.IsSHSZIndex(this.Symbol)&&(C=0),l<u[C]&&(l=u[C],e=this.YClose+l*(h-1)/2,a=this.YClose-l*(h-1)/2);for(var D=0;D<h;++D){var m=a+l*D;if(this.Frame.HorizontalInfo[D]=new s,this.Frame.HorizontalInfo[D].Value=m,this.Frame.HorizontalInfo[D].Message[0]=m.toFixed(C),this.YClose){var S=100*(m/this.YClose-1);S>0?this.Frame.HorizontalInfo[D].TextColor=i.JSCommonResource_Global_JSChartResource.UpTextColor:S<0&&(this.Frame.HorizontalInfo[D].TextColor=i.JSCommonResource_Global_JSChartResource.DownTextColor),this.Frame.HorizontalInfo[D].Message[1]=o.FormatValueString(S,2)+"%"}}this.Frame.HorizontalMax=e,this.Frame.HorizontalMin=a},this.CustomCoordinate=function(){if(this.Custom)for(var t in this.Custom){var e=this.Custom[t];if(1==e.Type)this.CustomFixedCoordinate(e);else if(0==e.Type){var a=n.JSCommonCoordinateData.GetfloatPrecision(this.Symbol),i=this.GetLatestPrice(a,e);i&&this.Frame.CustomHorizontalInfo.push(i)}}},this.GetLatestPrice=function(t,e){if(!this.Data||!this.Data.Data)return null;if(this.Data.Data.length<=0)return null;var a=this.Data.Data[this.Data.Data.length-1];if(!o.IsNumber(a)||!o.IsNumber(this.YClose))return null;var r=new s;return r.Type=0,r.Value=a,r.TextColor=i.JSCommonResource_Global_JSChartResource.FrameLatestPrice.TextColor,r.LineType=2,"left"==e.Position?r.Message[0]=a.toFixed(t):r.Message[1]=a.toFixed(t),a>this.YClose?r.LineColor=i.JSCommonResource_Global_JSChartResource.FrameLatestPrice.UpBarColor:a<this.YClose?r.LineColor=i.JSCommonResource_Global_JSChartResource.FrameLatestPrice.DownBarColor:r.LineColor=i.JSCommonResource_Global_JSChartResource.FrameLatestPrice.UnchagneBarColor,o.IsNumber(e.LineType)&&(r.LineType=e.LineType),0==e.IsShowLine&&(r.LineType=-1),r},this.CustomFixedCoordinate=function(t){var e=n.JSCommonCoordinateData.GetfloatPrecision(this.Symbol);for(var a in t.Data){var i,r=t.Data[a],h=new s;h.Type=1,h.TextColor=r.TextColor,h.LineColor=r.Color,h.LineType=2,o.IsNumber(t.LineType)&&(h.LineType=t.LineType),0==t.IsShowLine&&(h.LineType=-1),o.IsNumber(r.Increase)?(o.IsNumber(this.YClose)||conintue,h.Value=this.YClose*(1+r.Increase)):h.Value=r.Value,i=r.Text?r.Text:h.Value.toFixed(e),"left"==t.Position?h.Message[0]=i:h.Message[1]=i,this.Frame.CustomHorizontalInfo.push(h)}}}function D(){this.newMethod=o,this.newMethod(),delete this.newMethod,this.ShowText=!0,this.Symbol=null,this.DayCount=1,this.DayData,this.Operator=function(){this.Frame.VerticalInfo=[];this.Frame.XPointCount;var t=this.Frame.ChartBorder.GetWidth(),e=!0===this.Frame.IsHScreen;e&&(t=this.Frame.ChartBorder.GetHeight());var a=n.JSCommonCoordinateData.MinuteCoordinateData,i=a.GetCoordinateData(this.Symbol,t),r=i.Count,h=i.MiddleCount>0?i.MiddleCount:parseInt(r/2),l=i.Data;if(this.Frame.XPointCount=243,this.Frame.XPointCount=r*this.DayCount,this.Frame.MinuteCount=r,this.Frame.VerticalInfo=[],this.DayCount<=1)for(var u in l){var C=new s;C.Value=l[u][0],this.ShowText&&(C.Message[0]=l[u][3]),this.Frame.VerticalInfo[u]=C}else{u=this.DayData.length-1;for(var D=0;u>=0;--u,++D){C=new s;C.Value=D*r+h,C.LineType=-1,this.ShowText&&(C.Message[0]=o.FormatDateString(this.DayData[u].Date,"MM-DD")),this.Frame.VerticalInfo.push(C);C=new s;C.Value=(D+1)*r,this.Frame.VerticalInfo.push(C)}}}}function m(){this.newMethod=o,this.newMethod(),delete this.newMethod,this.ShowText=!0,this.Operator=function(){if(null!=this.Frame.Data&&null!=this.Frame.XData){this.Frame.VerticalInfo=[];for(var t=this.Frame.Data.DataOffset,e=this.Frame.XPointCount,a=0,i=t;a<e&&i<this.Frame.Data.Data.length;++a,++i){var r=new s;r.Value=i-t,this.ShowText&&(r.Message[0]=this.Frame.XData[a]),this.Frame.VerticalInfo.push(r)}}}}function S(){this.newMethod=o,this.newMethod(),delete this.newMethod,this.ShowText=!0,this.SplitCount=3,this.Symbol,this.LineType=3,this.Operator=function(){var t=this.Frame.VerticalRange;if(t){this.Frame.VerticalInfo=[];var e=2;this.Symbol&&(e=n.JSCommonCoordinateData.GetfloatPrecision(this.Symbol));var a=t.Max,i=t.Min;if(t.Bid)for(var r=(t.Bid.Max-i)/this.SplitCount,h=0;h<this.SplitCount;++h){var l=new s;l.Value=i+r*h,l.Value<=0||(o.IsNumber(this.LineType)&&(l.LineType=this.LineType),this.ShowText&&(l.Message[0]=l.Value.toFixed(e)),this.Frame.VerticalInfo.push(l))}l=new s;if(l.Value=t.Center,this.Frame.VerticalInfo.push(l),t.Ask)for(r=(a-t.Ask.Min)/this.SplitCount,h=1;h<=this.SplitCount;++h){l=new s;l.Value=t.Ask.Min+r*h,o.IsNumber(this.LineType)&&(l.LineType=this.LineType),this.ShowText&&(l.Message[0]=l.Value.toFixed(e)),this.Frame.VerticalInfo.push(l)}}}}function c(){this.Data=[[1e-6,2e-6,1e-6,1e-7],[2e-6,4e-6,2e-6,2e-7],[4e-6,5e-6,4e-6,1e-7],[5e-6,1e-5,5e-6,5e-7],[1e-5,2e-5,1e-5,1e-6],[2e-5,4e-5,2e-5,2e-6],[4e-5,5e-5,4e-5,1e-6],[5e-5,1e-4,5e-5,5e-6],[1e-4,2e-4,1e-4,1e-5],[2e-4,4e-4,2e-4,2e-5],[4e-4,5e-4,4e-4,1e-5],[5e-4,.001,5e-4,5e-5],[.001,.002,.001,1e-4],[.002,.004,.002,2e-4],[.004,.005,.004,1e-4],[.005,.01,.005,5e-4],[.01,.02,.01,.001],[.02,.04,.02,.002],[.04,.05,.04,.001],[.05,.1,.05,.005],[.1,.2,.1,.01],[.2,.4,.2,.02],[.4,.5,.4,.01],[.5,1,.5,.05],[1,2,1,.05],[2,4,2,.05],[4,5,4,.05],[5,10,5,.05],[10,20,10,2],[20,40,20,5],[40,50,40,2],[50,100,50,10],[100,200,100,10],[200,400,200,20],[400,500,400,10],[500,1e3,500,50],[1e3,2e3,1e3,50],[2e3,4e3,2e3,50],[4e3,5e3,4e3,50],[5e3,1e4,5e3,100],[1e4,2e4,1e4,1e3],[2e4,4e4,2e4,2e3],[4e4,5e4,4e4,1e3],[5e4,1e5,5e4,5e3],[1e5,2e5,1e5,1e4],[2e5,4e5,2e5,2e4],[4e5,5e5,4e5,1e4],[5e5,1e6,5e5,5e4],[1e6,2e6,1e6,1e5],[2e6,4e6,2e6,2e5],[4e6,5e6,4e6,1e5],[5e6,1e7,5e6,5e5],[1e7,2e7,1e7,1e6],[2e7,4e7,2e7,2e6],[4e7,5e7,4e7,1e6],[5e7,1e8,5e7,5e6],[1e8,2e8,1e8,1e7],[2e8,4e8,1e8,1e7],[4e8,5e8,1e8,1e7],[5e8,1e9,1e8,1e7],[1e9,2e9,1e9,1e8],[2e9,4e9,2e9,2e8],[4e9,5e9,4e9,1e8],[5e9,1e10,5e9,5e8]],this.Find=function(t){for(var e in this.Data){var a=this.Data[e];if(t>a[0]&&t<=a[1]){var i={};return i.FixInterval=a[2],i.Increase=a[3],i}}return null}}function f(){this.newMethod=c,this.newMethod(),delete this.newMethod,this.Data=[[1e-6,2e-6,1e-6,1e-7],[2e-6,4e-6,2e-6,2e-7],[4e-6,5e-6,4e-6,1e-7],[5e-6,1e-5,5e-6,5e-7],[1e-5,2e-5,1e-5,1e-6],[2e-5,4e-5,2e-5,2e-6],[4e-5,5e-5,4e-5,1e-6],[5e-5,1e-4,5e-5,5e-6],[1e-4,2e-4,1e-4,1e-5],[2e-4,4e-4,2e-4,2e-5],[4e-4,5e-4,4e-4,1e-5],[5e-4,.001,5e-4,5e-5],[.001,.002,.001,1e-4],[.002,.004,.002,2e-4],[.004,.005,.004,1e-4],[.005,.01,.005,5e-4],[.01,.02,.01,.001],[.02,.04,.02,.002],[.04,.05,.04,.001],[.05,.1,.05,.005],[.1,.2,.1,.01],[.2,.4,.2,.02],[.4,.5,.2,.01],[.5,.8,.2,.05],[.8,1,.5,.05],[1,2,.5,.05],[2,4,.5,.05],[4,5,.5,.05],[5,10,.5,.05],[10,12,10,2],[20,40,20,5],[40,50,40,2],[50,100,50,10],[100,200,100,10],[200,400,200,20],[400,500,400,10],[500,1e3,500,50],[1e3,2e3,1e3,50],[2e3,4e3,2e3,50],[4e3,5e3,4e3,50],[5e3,1e4,5e3,100],[1e4,2e4,1e4,1e3],[2e4,4e4,2e4,2e3],[4e4,5e4,4e4,1e3],[5e4,1e5,5e4,5e3],[1e5,2e5,1e5,1e4],[2e5,4e5,2e5,2e4],[4e5,5e5,4e5,1e4],[5e5,1e6,5e5,5e4],[1e6,2e6,1e6,1e5],[2e6,4e6,2e6,2e5],[4e6,5e6,4e6,1e5],[5e6,1e7,5e6,5e5],[1e7,2e7,1e7,1e6],[2e7,4e7,2e7,2e6],[4e7,5e7,4e7,1e6],[5e7,1e8,5e7,5e6],[1e8,2e8,1e8,1e7],[2e8,4e8,2e8,2e7],[4e8,5e8,4e8,1e7],[5e8,1e9,5e8,5e7],[1e9,2e9,1e9,1e8],[2e9,4e9,2e9,2e8],[4e9,5e9,4e9,1e8],[5e9,1e10,5e9,5e8]]}function d(){this.newMethod=c,this.newMethod(),delete this.newMethod,this.Data=[[1e-6,2e-6,1e-6,1e-7],[2e-6,4e-6,2e-6,2e-7],[4e-6,5e-6,4e-6,1e-7],[5e-6,1e-5,5e-6,5e-7],[1e-5,2e-5,1e-5,1e-6],[2e-5,4e-5,2e-5,2e-6],[4e-5,5e-5,4e-5,1e-6],[5e-5,1e-4,5e-5,5e-6],[1e-4,2e-4,1e-4,1e-5],[2e-4,4e-4,2e-4,2e-5],[4e-4,5e-4,4e-4,1e-5],[5e-4,.001,5e-4,5e-5],[.001,.002,.001,1e-4],[.002,.004,.002,2e-4],[.004,.005,.004,1e-4],[.005,.01,.005,5e-4],[.01,.02,.01,.001],[.02,.04,.02,.002],[.04,.05,.04,.001],[.05,.1,.05,.005],[.1,.2,1,1],[.2,.4,1,1],[.4,.5,1,1],[.5,.8,1,1],[.8,1,1,1],[1,2,1,1],[2,4,2,1],[4,5,4,1],[5,10,5,1],[10,12,10,2],[20,40,20,5],[40,50,40,2],[50,100,50,10],[100,200,100,10],[200,400,200,20],[400,500,400,10],[500,1e3,500,50],[1e3,2e3,1e3,50],[2e3,4e3,2e3,50],[4e3,5e3,4e3,50],[5e3,1e4,5e3,100],[1e4,2e4,1e4,1e3],[2e4,4e4,2e4,2e3],[4e4,5e4,4e4,1e3],[5e4,1e5,5e4,5e3],[1e5,2e5,1e5,1e4],[2e5,4e5,2e5,2e4],[4e5,5e5,4e5,1e4],[5e5,1e6,5e5,5e4],[1e6,2e6,1e6,1e5],[2e6,4e6,2e6,2e5],[4e6,5e6,4e6,1e5],[5e6,1e7,5e6,5e5],[1e7,2e7,1e7,1e6],[2e7,4e7,2e7,2e6],[4e7,5e7,4e7,1e6],[5e7,1e8,5e7,5e6],[1e8,2e8,1e8,1e7],[2e8,4e8,2e8,2e7],[4e8,5e8,4e8,1e7],[5e8,1e9,5e8,5e7],[1e9,2e9,1e9,1e8],[2e9,4e9,2e9,2e8],[4e9,5e9,4e9,1e8],[5e9,1e10,5e9,5e8]]}o.FormatValueThousandsString=function(t,e){if(null==t||isNaN(t)){if(e>0){for(var a="-.",i=0;i<e;++i)a+="-";return a}return"--"}var r="",n=t.toFixed(e);if(e>0){var s=n.split(".")[1],o=n.split(".")[0];while(o.length>3)r=","+o.slice(-3)+r,o=o.slice(0,o.length-3);o&&(r=o+r+"."+s)}else{while(n.length>3)r=","+n.slice(-3)+r,n=n.slice(0,n.length-3);n&&(r=n+r)}return r},o.FormatValueString=function(t,e,a){if(null==t||isNaN(t)){if(e>0){for(var r="-.",n=0;n<e;++n)r+="-";return r}return"--"}if(t<1e-11&&t>-1e-11)return"0";var s=Math.abs(t);return a===i.JSCommonResource_JSCHART_LANGUAGE_ID.LANGUAGE_ENGLISH_ID?s<1e4?t.toFixed(e):s<1e6?(t/1e3).toFixed(e)+"K":s<1e9?(t/1e6).toFixed(e)+"M":s<1e12?(t/1e9).toFixed(e)+"B":(t/1e12).toFixed(e)+"T":s<1e4?t.toFixed(e):s<1e8?(t/1e4).toFixed(e)+"万":s<1e12?(t/1e8).toFixed(e)+"亿":(t/1e12).toFixed(e)+"万亿"},o.FromatIntegerString=function(t,e,a){return t<1e4&&o.IsInteger(t)&&(e=0),o.FormatValueString(t,e,a)},o.NumberToString=function(t){return t<10?"0"+t.toString():t.toString()},o.FormatDateString=function(t,e){var a=parseInt(t/1e4),i=parseInt(t/100)%100,r=t%100;switch(e){case"MM-DD":return o.NumberToString(i)+"-"+o.NumberToString(r);default:return a.toString()+"-"+o.NumberToString(i)+"-"+o.NumberToString(r)}},o.FormatTimeString=function(t,e){if("HH:MM:SS"==e){var a=parseInt(t/1e4),i=parseInt(t%1e4/100),r=t%100;return o.NumberToString(a)+":"+o.NumberToString(i)+":"+o.NumberToString(r)}if("HH:MM"==e){a=parseInt(t/100),i=t%100;return o.NumberToString(a)+":"+o.NumberToString(i)}if(t<1e4){a=parseInt(t/100),i=t%100;return o.NumberToString(a)+":"+o.NumberToString(i)}a=parseInt(t/1e4),i=parseInt(t%1e4/100),r=t%100;return o.NumberToString(a)+":"+o.NumberToString(i)+":"+o.NumberToString(r)},o.FormatReportDateString=function(t){var e,a=parseInt(t/1e4),i=parseInt(t/100)%100;switch(i){case 3:e="一季度报";break;case 6:e="半年报";break;case 9:e="三季度报";break;case 12:e="年报";break}return a.toString()+e},o.FormatDateTimeString=function(t,e){var a=t.split(" ");if(a.length<2)return"";var i=parseInt(a[1]),r=i%100,n=parseInt(i/100),s=(n<10?"0"+n.toString():n.toString())+":"+(r<10?"0"+r.toString():r.toString());if(1==e){var o=parseInt(a[0]),h=parseInt(o/1e4),l=parseInt(o%1e4/100),u=o%100;s=h.toString()+"-"+(l<10?"0"+l.toString():l.toString())+"-"+(u<10?"0"+u.toString():u.toString())+" "+s}return s},o.FormatValueColor=function(t,e){return null!=t&&null==e?0==t?"PriceNull":t>0?"PriceUp":"PriceDown":null==t||null==e||t==e?"PriceNull":t>e?"PriceUp":"PriceDown"},o.IsNumber=function(t){return null!=t&&!isNaN(t)},o.IsPlusNumber=function(t){return null!=t&&(!isNaN(t)&&t>0)},o.IsInteger=function(t){return"number"===typeof t&&t%1===0},o.IsObjectExist=function(t){return void 0!==t&&null!=t},o.IsBool=function(t){return!0===t||!1===t},o.IsString=function(t){return!(!t||"string"!=typeof t)},o.IsFloat=function(t){return void 0!==t&&(null!=t&&(!isNaN(t)&&t!=parseInt(t)))},o.IsNonEmptyArray=function(t){if(t&&Array.isArray(t))return t.length>0},t.exports={JSCommonSplit:{CoordinateInfo:s,IFrameSplitOperator:o,FrameSplitKLinePriceY:h,FrameSplitY:l,FrameSplitKLineX:u,FrameSplitMinutePriceY:C,FrameSplitMinuteX:D,FrameSplitXData:m,SplitData:c,PriceSplitData:f,FrameSplitXDepth:S},JSCommonSplit_CoordinateInfo:s,JSCommonSplit_IFrameSplitOperator:o,JSCommonSplit_FrameSplitKLinePriceY:h,JSCommonSplit_FrameSplitY:l,JSCommonSplit_FrameSplitKLineX:u,JSCommonSplit_FrameSplitMinutePriceY:C,JSCommonSplit_FrameSplitMinuteX:D,JSCommonSplit_FrameSplitXData:m,JSCommonSplit_SplitData:c,JSCommonSplit_PriceSplitData:f,JSCommonSplit_FrameSplitXDepth:S}},"8cb2":function(t,e,a){function i(t){if("number"===typeof t){var e=new Date,a=e.getTime(),i=6e4*e.getTimezoneOffset(),r=a+i;return new Date(r+36e5*t)}}a("c975"),a("4ec9"),a("d3b7"),a("e25e"),a("ac1f"),a("3ca3"),a("5319"),a("ddb0");var r={SH:".SH",SZ:".SZ",SHSZ_C_Index:".CI",SHO:".SHO",HK:".HK",FHK:".FHK",SHFE:".SHF",SHFE2:".SHFE",CFFEX:".CFE",DCE:".DCE",CZCE:".CZC",USA:".USA",FTSE:".FTSE",BIT:".BIT",BIZ:".BIZ",NYMEX:".NYMEX",COMEX:".COMEX",NYBOT:".NYBOT",CBOT:".CBOT",LME:".LME",ET:".ET",IsET:function(t){return!!t&&t.indexOf(this.ET)>0},IsETShowAvPrice:function(t){return!1},IsNYMEX:function(t){return!!t&&t.indexOf(this.NYMEX)>0},IsCOMEX:function(t){return!!t&&t.indexOf(this.COMEX)>0},IsNYBOT:function(t){return!!t&&t.indexOf(this.NYBOT)>0},IsCBOT:function(t){return!!t&&t.indexOf(this.CBOT)>0},IsLME:function(t){return!!t&&t.indexOf(this.LME)>0},IsFTSE:function(t){return!!t&&t.indexOf(this.FTSE)>0},IsFHK:function(t){return!!t&&t.indexOf(this.FHK)>0},IsBIT:function(t){return!!t&&(t.indexOf(this.BIT)>0||t.indexOf(this.BIZ)>0)},IsUSA:function(t){return!!t&&t.indexOf(this.USA)>0},IsSH:function(t){var e=t.length-this.SH.length,a=t.indexOf(this.SH);return a==e},IsSZ:function(t){var e=t.length-this.SZ.length,a=t.indexOf(this.SZ);return a==e},IsSHSZCustomIndex:function(t){var e=t.length-this.SHSZ_C_Index.length,a=t.indexOf(this.SHSZ_C_Index);return a==e},IsSHO:function(t){var e=t.length-this.SHO.length,a=t.indexOf(this.SHO);return a==e},IsHK:function(t){var e=t.length-this.HK.length,a=t.indexOf(this.HK);return a==e},IsSHFE:function(t){return!!t&&(t.indexOf(this.SHFE)>0||t.indexOf(this.SHFE2)>0)},IsCFFEX:function(t){return!!t&&t.indexOf(this.CFFEX)>0},IsDCE:function(t){return!!t&&t.indexOf(this.DCE)>0},IsCZCE:function(t){return!!t&&t.indexOf(this.CZCE)>0},IsChinaFutures:function(t){return this.IsCFFEX(t)||this.IsCZCE(t)||this.IsDCE(t)||this.IsSHFE(t)},IsFutures:function(t){return this.IsChinaFutures(t)||this.IsNYMEX(t)||this.IsCOMEX(t)||this.IsNYBOT(t)||this.IsCBOT(t)||this.IsLME(t)},IsSHSZ:function(t){return this.IsSZ(t)||this.IsSH(t)||this.IsSHSZCustomIndex(t)},IsSHSZFund:function(t){if(!t)return!1;if(this.IsSH(t)){if("5"==t.charAt(0)&&"1"==t.charAt(1))return!0}else if(this.IsSZ(t)&&"1"==t.charAt(0)&&("5"==t.charAt(1)||"6"==t.charAt(1)||"7"==t.charAt(1)||"8"==t.charAt(1)))return!0;return!1},IsSHSZIndex:function(t){if(!t)return!1;var e=t.toUpperCase();if(this.IsSH(e)){var a=e.replace(".SH","");if("0"==e.charAt(0)&&parseInt(a)<=3e3)return!0}else if(this.IsSZ(e)){if("3"==e.charAt(0)&&"9"==e.charAt(1))return!0}else if(this.IsSHSZCustomIndex(e))return!0;return!1},IsSHSZStockA:function(t){if(!t)return!1;var e=t.toUpperCase();if(this.IsSH(e)){e.replace(".SH","");if("6"==e.charAt(0))return!0}else if(this.IsSZ(e)&&"0"==e.charAt(0)){if("0"==e.charAt(1)&&"2"==e.charAt(2))return!0;if("7"!=e.charAt(1)&&"8"!=e.charAt(1))return!0}return!1},IsSHStockSTAR:function(t){if(!t)return!1;var e=t.toUpperCase();return!!this.IsSH(e)&&("6"==e.charAt(0)&&"8"==e.charAt(1)&&"8"==e.charAt(2))},GetMarketStatus:function(t){if(!t)return 0;var e=t.toUpperCase(),a=new Date,r=a.getDay(),n=100*a.getHours()+a.getMinutes();if(this.IsUSA(e)){var s=i(-4);r=s.getDay(),n=100*s.getHours()+s.getMinutes();return 6==r||0==r?0:n>1730?3:n<930?1:2}return this.IsBIT(e)?2:this.IsFTSE(e)?6==r||0==r?0:n>=830&&n<=2359||n>=0&&n<=500?2:0:this.IsFHK(e)?6==r||0==r?0:n>=900&&n<=2359||n>=0&&n<=120?2:0:this.IsET(e)?this.GetETMarketStatus(t):this.IsHK(e)?6==r||0==r?0:n>1630?3:n<925?1:2:this.IsNYMEX(e)?this.GetNYMEXMarketStatus(e):this.IsCOMEX(e)?this.GetCOMEXMarketStatus(e):this.IsNYBOT(e)?this.GetNYBOTMarketStatus(e):this.IsCBOT(e)?this.GetCBOTMarketStatus(e):this.IsChinaFutures(e)?6==r||0==r?0:n>=2100||n<=240||n>=830&&n<=1510?2:1:6==r||0==r?0:n>1540?3:n<925?1:2},GetDefaultDecimal:function(t){return 2},GetFHKDecimal:function(t){return 0},GetFTSEDecimal:function(t){return 0},GetBITDecimal:function(t){return 2},GetETDecimal:function(t){return 2},GetSHODecimal:function(t){return 4},GetNYMEXDecimal:function(t){return f.GetDecimal(t)},GetCOMEXDecimal:function(t){return d.GetDecimal(t)},GetNYBOTDecimal:function(t){return I.GetDecimal(t)},GetCBOTDecimal:function(t){return v.GetDecimal(t)},GetLMEDecimal:function(t){return p.GetDecimal(t)},GetETMarketStatus:function(t){return 2},GetCOMEXMarketStatus:function(t){return d.GetMarketStatus(t)},GetNYBOTMarketStatus:function(t){return I.GetMarketStatus(t)},GetCBOTMarketStatus:function(t){return v.GetMarketStatus(t)},GetNYMEXMarketStatus:function(t){return f.GetMarketStatus(t)}};function n(){this.SHSZ=null,this.HK=null,this.Futures=new Map,this.USA=null,this.FTSE=null,this.FHK=null,this.BIT=null,this.Initialize=function(){},this.GetET=function(t){throw{Name:"MinuteTimeStringData::GetET",Error:"not implement"}},this.GetSHSZ=function(){return this.SHSZ||(this.SHSZ=this.CreateSHSZData()),this.SHSZ},this.GetSHO=function(){return this.SHO||(this.SHO=this.CreateSHOData()),this.SHO},this.GetHK=function(){return this.HK||(this.HK=this.CreateHKData()),this.HK},this.GetFutures=function(t){if(!this.Futures.has(t.Name)){var e=this.CreateTimeData(t.Data);this.Futures.set(t.Name,e)}return this.Futures.get(t.Name)},this.GetUSA=function(){return this.USA||(this.USA=this.CreateUSAData()),this.USA},this.GetFTSE=function(){return this.FTSE||(this.FTSE=this.CreateFTSEData()),this.FTSE},this.GetFHK=function(){return this.FHK||(this.FHK=this.CreateFHKData()),this.FHK},this.GetBIT=function(t){return this.BIT||(this.BIT=this.CreateBITData()),this.BIT},this.CreateSHSZData=function(){var t=[{Start:925,End:925},{Start:930,End:1130},{Start:1300,End:1500}];return this.CreateTimeData(t)},this.CreateSHOData=function(){var t=[{Start:930,End:1129},{Start:1300,End:1500}];return this.CreateTimeData(t)},this.CreateHKData=function(){var t=[{Start:930,End:1200},{Start:1300,End:1600}];return this.CreateTimeData(t)},this.CreateUSAData=function(){var t=[{Start:930,End:1600}];return this.CreateTimeData(t)},this.CreateFTSEData=function(){var t=[{Start:1700,End:2359},{Start:0,End:445},{Start:900,End:1630}];return this.CreateTimeData(t)},this.CreateFHKData=function(){var t=[{Start:1715,End:2359},{Start:0,End:100},{Start:915,End:1200},{Start:1300,End:1630}];return this.CreateTimeData(t)},this.CreateBITData=function(){var t=[{Start:600,End:2359},{Start:0,End:559}];return this.CreateTimeData(t)},this.CreateTimeData=function(t){var e=[];for(var a in t)for(var i=t[a],r=i.Start;r<=i.End;++r)r%100>=60||e.push(r);return e},this.GetTimeData=function(t){if(!t)return this.SHSZ;var e=t.toLocaleUpperCase();if(r.IsSH(e)||r.IsSZ(e)||r.IsSHSZIndex(e))return this.GetSHSZ();if(r.IsHK(e))return this.GetHK();if(r.IsCFFEX(e)||r.IsCZCE(e)||r.IsDCE(e)||r.IsSHFE(e)){var a=c.GetSplitData(e);return a?this.GetFutures(a):null}if(r.IsFTSE(e))return this.GetFTSE();if(r.IsFHK(e))return this.GetFHK();if(r.IsET(e))return this.GetET(e);if(r.IsBIT(e))return this.GetBIT(e);if(r.IsNYMEX(e)){a=f.GetSplitData(e);return a?this.GetFutures(a):null}if(r.IsCOMEX(e)){a=d.GetSplitData(e);return a?this.GetFutures(a):null}if(r.IsNYBOT(e)){a=I.GetSplitData(e);return a?this.GetFutures(a):null}if(r.IsCBOT(e)){a=v.GetSplitData(e);return a?this.GetFutures(a):null}if(r.IsLME(e)){a=p.GetSplitData(e);return a?this.GetFutures(a):null}}}function s(){var t={Full:[[0,0,"rgb(200,200,200)","09:30"],[31,0,"RGB(200,200,200)","10:00"],[61,0,"RGB(200,200,200)","10:30"],[91,0,"RGB(200,200,200)","11:00"],[122,1,"RGB(200,200,200)","13:00"],[152,0,"RGB(200,200,200)","13:30"],[182,0,"RGB(200,200,200)","14:00"],[212,0,"RGB(200,200,200)","14:30"],[242,1,"RGB(200,200,200)","15:00"]],Simple:[[0,0,"rgb(200,200,200)","09:30"],[61,0,"RGB(200,200,200)","10:30"],[122,1,"RGB(200,200,200)","13:00"],[182,0,"RGB(200,200,200)","14:00"],[242,1,"RGB(200,200,200)","15:00"]],Min:[[0,0,"rgb(200,200,200)","09:30"],[122,1,"RGB(200,200,200)","13:00"],[242,1,"RGB(200,200,200)","15:00"]],Count:243,MiddleCount:122,GetData:function(t){return t<200?this.Min:t<400?this.Simple:this.Full}},e={Full:[[0,0,"rgb(200,200,200)","09:30"],[30,0,"RGB(200,200,200)","10:00"],[60,0,"RGB(200,200,200)","10:30"],[90,0,"RGB(200,200,200)","11:00"],[120,1,"RGB(200,200,200)","13:00"],[150,0,"RGB(200,200,200)","13:30"],[180,0,"RGB(200,200,200)","14:00"],[210,0,"RGB(200,200,200)","14:30"],[240,1,"RGB(200,200,200)","15:00"]],Simple:[[0,0,"rgb(200,200,200)","09:30"],[60,0,"RGB(200,200,200)","10:30"],[120,1,"RGB(200,200,200)","13:00"],[180,0,"RGB(200,200,200)","14:00"],[240,1,"RGB(200,200,200)","15:00"]],Min:[[0,0,"rgb(200,200,200)","09:30"],[120,1,"RGB(200,200,200)","13:00"],[240,1,"RGB(200,200,200)","15:00"]],Count:241,MiddleCount:120,GetData:function(t){return t<200?this.Min:t<400?this.Simple:this.Full}},a={Full:[[0,1,"RGB(200,200,200)","09:30"],[30,0,"RGB(200,200,200)","10:00"],[60,1,"RGB(200,200,200)","10:30"],[90,0,"RGB(200,200,200)","11:00"],[120,1,"RGB(200,200,200)","11:30"],[151,0,"RGB(200,200,200)","13:00"],[181,1,"RGB(200,200,200)","13:30"],[211,0,"RGB(200,200,200)","14:00"],[241,1,"RGB(200,200,200)","14:30"],[271,0,"RGB(200,200,200)","15:00"],[301,1,"RGB(200,200,200)","15:30"],[331,1,"RGB(200,200,200)","16:00"]],Simple:[[0,1,"RGB(200,200,200)","09:30"],[60,1,"RGB(200,200,200)","10:30"],[120,1,"RGB(200,200,200)","11:30"],[211,0,"RGB(200,200,200)","14:00"],[271,0,"RGB(200,200,200)","15:00"],[331,1,"RGB(200,200,200)","16:00"]],Min:[[0,1,"RGB(200,200,200)","09:30"],[151,0,"RGB(200,200,200)","13:00"],[331,1,"RGB(200,200,200)","16:00"]],Count:332,MiddleCount:151,GetData:function(t){return t<200?this.Min:t<450?this.Simple:this.Full}},i={Full:[[0,1,"RGB(200,200,200)","17:00"],[120,1,"RGB(200,200,200)","19:00"],[240,1,"RGB(200,200,200)","21:00"],[360,1,"RGB(200,200,200)","23:00"],[480,1,"RGB(200,200,200)","01:00"],[600,1,"RGB(200,200,200)","03:00"],[706,1,"RGB(200,200,200)","09:00"],[826,1,"RGB(200,200,200)","11:00"],[946,1,"RGB(200,200,200)","13:00"],[1066,1,"RGB(200,200,200)","15:00"],[1156,1,"RGB(200,200,200)","16:30"]],Simple:[[0,1,"RGB(200,200,200)","17:00"],[240,1,"RGB(200,200,200)","21:00"],[480,1,"RGB(200,200,200)","01:00"],[706,1,"RGB(200,200,200)","09:00"],[946,1,"RGB(200,200,200)","13:00"],[1156,1,"RGB(200,200,200)","16:30"]],Min:[[0,1,"RGB(200,200,200)","17:00"],[706,1,"RGB(200,200,200)","09:00"],[1156,1,"RGB(200,200,200)","16:30"]],Count:1157,MiddleCount:707,GetData:function(t){return t<200?this.Min:t<450?this.Simple:this.Full}},n={Full:[[0,1,"RGB(200,200,200)","17:15"],[105,1,"RGB(200,200,200)","19:00"],[225,1,"RGB(200,200,200)","21:00"],[345,1,"RGB(200,200,200)","23:00"],[466,0,"RGB(200,200,200)","09:15"],[571,1,"RGB(200,200,200)","11:00"],[692,1,"RGB(200,200,200)","14:00"],[843,1,"RGB(200,200,200)","16:30"]],Simple:[[0,1,"RGB(200,200,200)","17:15"],[225,1,"RGB(200,200,200)","21:00"],[466,0,"RGB(200,200,200)","09:15"],[632,1,"RGB(200,200,200)","13:00"],[843,1,"RGB(200,200,200)","16:30"]],Min:[[0,1,"RGB(200,200,200)","17:15"],[466,0,"RGB(200,200,200)","09:15"],[843,1,"RGB(200,200,200)","16:30"]],Count:843,MiddleCount:466,GetData:function(t){return t<200?this.Min:t<450?this.Simple:this.Full}};this.GetCoordinateData=function(e,i){var n=null;if(e){var s=e.toLocaleUpperCase();if(r.IsSH(s)||r.IsSZ(s))n=this.GetSHSZData(s,i);else if(r.IsSHO(s))n=this.GetSHOData(s,i);else if(r.IsHK(s))n=a;else{if(r.IsCFFEX(s)||r.IsCZCE(s)||r.IsDCE(s)||r.IsSHFE(s))return this.GetChinatFuturesData(s,i);if(r.IsUSA(s))n=this.GetUSAData(s,i);else if(r.IsFTSE(s,i))n=this.GetFTSEData(s,i);else if(r.IsFHK(s,i))n=this.GetFHKData(s,i);else if(r.IsET(s))n=this.GetETData(s,i);else{if(r.IsNYMEX(s,i))return this.GetNYMEXData(s,i);if(r.IsCOMEX(s,i))return this.GetCOMEXData(s,i);if(r.IsNYBOT(s,i))return this.GetNYBOTData(s,i);if(r.IsCBOT(s,i))return this.GetCBOTData(s,i);if(r.IsLME(s,i))return this.GetLMEData(s,i);r.IsBIT(s,i)&&(n=this.GetBITData(s,i))}}}else n=t;var o={Count:n.Count,MiddleCount:n.MiddleCount,Data:n.GetData(i)};return o},this.GetSHSZData=function(e,a){var i=t;return i},this.GetFuturesData=function(t,e,a){var i=a.GetSplitData(t);if(!i)return null;var r=m.GetFutures(i);if(!r)return null;var n={Count:r.length},s=null,o=200,h=480;s=e<o?i.Coordinate.Min:e<h?i.Coordinate.Simple:i.Coordinate.Full;for(var l=[],u=0;u<r.length;++u)for(var C=r[u],D=0;D<s.length;++D){var S=s[D];if(C==S.Value){var c=[u,0,"RGB(200,200,200)",S.Text];l.push(c);break}}return n.Data=l,n},this.GetChinatFuturesData=function(t,e){return this.GetFuturesData(t,e,c)},this.GetNYMEXData=function(t,e){return this.GetFuturesData(t,e,f)},this.GetCOMEXData=function(t,e){return this.GetFuturesData(t,e,d)},this.GetNYBOTData=function(t,e){return this.GetFuturesData(t,e,I)},this.GetCBOTData=function(t,e){return this.GetFuturesData(t,e,v)},this.GetLMEData=function(t,e){return this.GetFuturesData(t,e,p)},this.GetFTSEData=function(t,e){var a=i;return a},this.GetFHKData=function(t,e){var a=n;return a},this.GetETData=function(t,e){throw{Name:"MinuteCoordinateData::GetETData",Error:"not implement"}},this.GetBITData=function(t,e){throw{Name:"MinuteCoordinateData::GetBITData",Error:"not implement"}},this.GetUSAData=function(t,e){var a=USA_MINUTE_X_COORDINATE;return a},this.GetSHOData=function(t,a){var i=e;return i}}function o(){this.TIME_SPLIT=[{Name:"9:00-10:15,10:30-11:30,13:30-15:00",Data:[{Start:900,End:1015},{Start:1031,End:1130},{Start:1331,End:1500}],Coordinate:{Full:[{Value:900,Text:"9:00"},{Value:930,Text:"9:30"},{Value:1e3,Text:"10:00"},{Value:1031,Text:"10:30"},{Value:1100,Text:"11:00"},{Value:1331,Text:"13:30"},{Value:1400,Text:"14:00"},{Value:1430,Text:"14:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:900,Text:"9:00"},{Value:1e3,Text:"10:00"},{Value:1331,Text:"13:30"},{Value:1430,Text:"14:30"},{Value:1500,Text:"15:00"}],Min:[{Value:900,Text:"9:00"},{Value:1331,Text:"13:30"},{Value:1500,Text:"15:00"}]}},{Name:"9:15-11:30,13:00-15:15",Data:[{Start:915,End:1130},{Start:1301,End:1515}],Coordinate:{Full:[{Value:930,Text:"9:30"},{Value:1e3,Text:"10:00"},{Value:1030,Text:"10:30"},{Value:1100,Text:"11:00"},{Value:1301,Text:"13:00"},{Value:1330,Text:"13:30"},{Value:1400,Text:"14:00"},{Value:1430,Text:"14:30"},{Value:1515,Text:"15:15"}],Simple:[{Value:930,Text:"9:30"},{Value:1030,Text:"10:30"},{Value:1301,Text:"13:00"},{Value:1400,Text:"14:00"},{Value:1515,Text:"15:15"}],Min:[{Value:930,Text:"9:30"},{Value:1301,Text:"13:00"},{Value:1515,Text:"15:15"}]}},{Name:"9:30-11:30,13:00-15:00",Data:[{Start:930,End:1130},{Start:1301,End:1500}],Coordinate:{Full:[{Value:930,Text:"9:30"},{Value:1e3,Text:"10:00"},{Value:1030,Text:"10:30"},{Value:1100,Text:"11:00"},{Value:1301,Text:"13:00"},{Value:1330,Text:"13:30"},{Value:1400,Text:"14:00"},{Value:1430,Text:"14:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:930,Text:"9:30"},{Value:1030,Text:"10:30"},{Value:1301,Text:"13:00"},{Value:1400,Text:"14:00"},{Value:1500,Text:"15:00"}],Min:[{Value:930,Text:"9:30"},{Value:1301,Text:"13:00"},{Value:1500,Text:"15:00"}]}},{Name:"21:00-23:30,9:00-10:15,10:30-11:30,13:30-15:00",Data:[{Start:2100,End:2330},{Start:901,End:1015},{Start:1031,End:1130},{Start:1331,End:1500}],Coordinate:{Full:[{Value:2100,Text:"21:00"},{Value:2200,Text:"22:00"},{Value:2300,Text:"23:00"},{Value:901,Text:"9:00"},{Value:1031,Text:"10:30"},{Value:1331,Text:"13:30"},{Value:1430,Text:"14:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:2100,Text:"21:00"},{Value:901,Text:"9:00"},{Value:1331,Text:"13:30"},{Value:1500,Text:"15:00"}],Min:[{Value:2100,Text:"21:00"},{Value:901,Text:"9:00"},{Value:1500,Text:"15:00"}]}},{Name:"21:00-1:00,9:00-10:15,10:30-11:30,13:30-15:00",Data:[{Start:2100,End:2359},{Start:0,End:100},{Start:901,End:1015},{Start:1031,End:1130},{Start:1301,End:1500}],Coordinate:{Full:[{Value:2100,Text:"21:00"},{Value:2200,Text:"22:00"},{Value:2300,Text:"23:00"},{Value:901,Text:"9:00"},{Value:1030,Text:"10:30"},{Value:1331,Text:"13:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:901,Text:"9:00"},{Value:1031,Text:"10:30"},{Value:1500,Text:"15:00"}],Min:[{Value:2100,Text:"21:00"},{Value:901,Text:"9:00"},{Value:1500,Text:"15:00"}]}},{Name:"21:00-2:30,9:00-10:15,10:30-11:30,13:30-15:00",Data:[{Start:2100,End:2359},{Start:0,End:230},{Start:901,End:1015},{Start:1031,End:1130},{Start:1331,End:1500}],Coordinate:{Full:[{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:100,Text:"1:00"},{Value:901,Text:"9:00"},{Value:1031,Text:"10:30"},{Value:1331,Text:"13:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:901,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1500,Text:"15:00"}],Min:[{Value:2100,Text:"21:00"},{Value:901,Text:"9:00"},{Value:1500,Text:"15:00"}]}},{Name:"21:00-23:00,9:00-10:15,10:30-11:30,13:30-15:00",Data:[{Start:2100,End:2300},{Start:901,End:1015},{Start:1031,End:1130},{Start:1331,End:1500}],Coordinate:{Full:[{Value:2100,Text:"21:00"},{Value:2200,Text:"22:00"},{Value:2300,Text:"23:00"},{Value:1031,Text:"10:30"},{Value:1331,Text:"13:30"},{Value:1430,Text:"14:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1331,Text:"13:30"},{Value:1500,Text:"15:00"}],Min:[{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1500,Text:"15:00"}]}}],this.MAP_TWOWORDS=new Map([[r.DCE+"-JD",{Time:0,Decimal:0,Name:"鸡蛋"}],[r.DCE+"-FB",{Time:0,Decimal:2,Name:"纤板"}],[r.DCE+"-BB",{Time:0,Decimal:2,Name:"胶板"}],[r.DCE+"-PP",{Time:6,Decimal:0,Name:"丙烯"}],[r.DCE+"-JM",{Time:6,Decimal:1,Name:"焦煤"}],[r.DCE+"-EG",{Time:6,Decimal:0,Name:"乙二醇"}],[r.DCE+"-EB",{Time:6,Decimal:0,Name:"苯乙烯"}],[r.DCE+"-CS",{Time:6,Decimal:0,Name:"淀粉"}],[r.DCE+"-PG",{Time:6,Decimal:0,Name:"液化气"}],[r.DCE+"-RR",{Time:6,Decimal:0,Name:"梗米"}],[r.SHFE+"-CU",{Time:4,Decimal:0}],[r.SHFE+"-AL",{Time:4,Decimal:0}],[r.SHFE+"-NI",{Time:4,Decimal:0}],[r.SHFE+"-SN",{Time:4,Decimal:0}],[r.SHFE+"-ZN",{Time:4,Decimal:0}],[r.SHFE+"-PB",{Time:4,Decimal:0}],[r.SHFE+"-RU",{Time:6,Decimal:0}],[r.SHFE+"-FU",{Time:6,Decimal:0}],[r.SHFE+"-RB",{Time:6,Decimal:0}],[r.SHFE+"-BU",{Time:6,Decimal:0}],[r.SHFE+"-HC",{Time:6,Decimal:0}],[r.SHFE+"-WR",{Time:0,Decimal:0}],[r.SHFE+"-AG",{Time:5,Decimal:0}],[r.SHFE+"-AU",{Time:5,Decimal:2}],[r.SHFE+"-NR",{Time:6,Decimal:1,Name:"20号胶"}],[r.SHFE+"-SC",{Time:6,Decimal:1,Name:"中质含硫原油"}],[r.SHFE+"-LU",{Time:6,Decimal:0,Name:"低硫燃料油"}],[r.CZCE+"-CF",{Time:3,Decimal:0}],[r.CZCE+"-SR",{Time:3,Decimal:0}],[r.CZCE+"-MA",{Time:3,Decimal:0}],[r.CZCE+"-ZC",{Time:3,Decimal:1}],[r.CZCE+"-TA",{Time:3,Decimal:0}],[r.CZCE+"-RM",{Time:3,Decimal:0}],[r.CZCE+"-OI",{Time:3,Decimal:0}],[r.CZCE+"-ME",{Time:3,Decimal:0}],[r.CZCE+"-FG",{Time:3,Decimal:0}],[r.CZCE+"-WS",{Time:0,Decimal:0}],[r.CZCE+"-WT",{Time:0,Decimal:0}],[r.CZCE+"-GN",{Time:0,Decimal:0}],[r.CZCE+"-RO",{Time:0,Decimal:0}],[r.CZCE+"-RS",{Time:0,Decimal:0}],[r.CZCE+"-ER",{Time:0,Decimal:0}],[r.CZCE+"-RI",{Time:0,Decimal:0}],[r.CZCE+"-WH",{Time:0,Decimal:0}],[r.CZCE+"-AP",{Time:0,Decimal:0}],[r.CZCE+"-PM",{Time:0,Decimal:0}],[r.CZCE+"-QM",{Time:0,Decimal:0}],[r.CZCE+"-TC",{Time:0,Decimal:0}],[r.CZCE+"-JR",{Time:0,Decimal:0}],[r.CZCE+"-LR",{Time:0,Decimal:0}],[r.CZCE+"-SF",{Time:0,Decimal:0}],[r.CZCE+"-SM",{Time:0,Decimal:0}],[r.CFFEX+"-TF",{Time:1,Decimal:3,Name:"二债"}],[r.CFFEX+"-TS",{Time:1,Decimal:3,Name:"五债"}],[r.CFFEX+"-IH",{Time:2,Decimal:1,Name:"上证股指期货"}],[r.CFFEX+"-IC",{Time:2,Decimal:1,Name:"中证股指期货"}],[r.CFFEX+"-IF",{Time:2,Decimal:1,Name:"沪深股指期货"}]]),this.MAP_ONEWORD=new Map([[r.DCE+"-C",{Time:6,Decimal:0,Name:"玉米"}],[r.DCE+"-L",{Time:6,Decimal:0,Name:"乙烯"}],[r.DCE+"-V",{Time:6,Decimal:0,Name:"PVC"}],[r.DCE+"-A",{Time:6,Decimal:0,Name:"豆一"}],[r.DCE+"-B",{Time:6,Decimal:0,Name:"豆二"}],[r.DCE+"-M",{Time:6,Decimal:0,Name:"豆粕"}],[r.DCE+"-Y",{Time:6,Decimal:0,Name:"豆油"}],[r.DCE+"-P",{Time:6,Decimal:0,Name:"棕榈"}],[r.DCE+"-J",{Time:6,Decimal:1,Name:"焦炭"}],[r.DCE+"-I",{Time:6,Decimal:1,Name:"铁矿"}],[r.CFFEX+"-T",{Time:1,Decimal:3,Name:"十债"}]]),this.GetData=function(t){var e=t.charAt(0),a=t.substr(0,2),i=null,n=null;return r.IsDCE(t)?(i=r.DCE+"-"+e,n=r.DCE+"-"+a):r.IsSHFE(t)?(i=r.SHFE+"-"+e,n=r.SHFE+"-"+a):r.IsCFFEX(t)?(i=r.CFFEX+"-"+e,n=r.CFFEX+"-"+a):r.IsCZCE(t)&&(i=r.CZCE+"-"+e,n=r.CZCE+"-"+a),this.MAP_TWOWORDS.has(n)?this.MAP_TWOWORDS.get(n):this.MAP_ONEWORD.has(i)?this.MAP_ONEWORD.get(i):null},this.GetSplitData=function(t){var e=this.GetData(t);return e?this.TIME_SPLIT[e.Time]:null},this.GetDecimal=function(t){var e=this.GetData(t);return e?e.Decimal:2},this.AddNewFutures=function(t){if(t){var e=t.Suffix+"-"+t.Symbol,a={Time:t.Time,Decimal:t.Decimal,Name:t.Name};1==t.Symbol.length?this.MAP_ONEWORD.set(e,a):2==t.Symbol.length&&this.MAP_TWOWORDS.set(e,a)}}}function h(){this.MarketSuffix=".NYMEX",this.TimeType=0,this.TIME_SPLIT=[{Name:"6:00-5:00",Data:[{Start:600,End:2359},{Start:0,End:500}],Coordinate:{Full:[{Value:600,Text:"6:00"},{Value:800,Text:"8:00"},{Value:1e3,Text:"10:00"},{Value:1200,Text:"12:00"},{Value:1400,Text:"14:00"},{Value:1600,Text:"16:00"},{Value:1800,Text:"18:00"},{Value:2e3,Text:"20:00"},{Value:2200,Text:"22:00"},{Value:0,Text:"0:00"},{Value:200,Text:"2:00"},{Value:400,Text:"4:00"}],Simple:[{Value:600,Text:"6:00"},{Value:1e3,Text:"10:00"},{Value:1400,Text:"14:00"},{Value:1800,Text:"18:00"},{Value:2200,Text:"22:00"},{Value:200,Text:"2:00"}],Min:[{Value:600,Text:"6:00"},{Value:1800,Text:"18:00"},{Value:500,Text:"5:00"}]}}],this.TIME_SPLIT2=[{Name:"7:00-6:00",Data:[{Start:700,End:2359},{Start:0,End:600}],Coordinate:{Full:[{Value:700,Text:"7:00"},{Value:900,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"},{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1,Text:"1:00"},{Value:300,Text:"3:00"},{Value:500,Text:"5:00"}],Simple:[{Value:700,Text:"7:00"},{Value:1100,Text:"11:00"},{Value:1500,Text:"15:00"},{Value:1900,Text:"19:00"},{Value:2300,Text:"23:00"},{Value:300,Text:"3:00"}],Min:[{Value:700,Text:"7:00"},{Value:1900,Text:"19:00"},{Value:500,Text:"5:00"}]}}],this.FUTURES_LIST=[{Symbol:"CL",Decimal:2,Time:0},{Symbol:"NG",Decimal:3,Time:0},{Symbol:"RB",Decimal:4,Time:0},{Symbol:"PL",Decimal:1,Time:0},{Symbol:"PA",Decimal:2,Time:0},{Symbol:"HR",Decimal:0,Time:0},{Symbol:"QM",Decimal:3,Time:0},{Symbol:"HO",Decimal:4,Time:0}],this.GetFuturesInfo=function(t){if(t.indexOf(this.MarketSuffix)<=0)return null;for(var e in this.FUTURES_LIST){var a=this.FUTURES_LIST[e];if(0==t.indexOf(a.Symbol))return a}return null},this.GetSplitData=function(t){var e=0==this.TimeType?this.TIME_SPLIT:this.TIME_SPLIT2,a=this.GetFuturesInfo(t);return a?e[a.Time]:e[0]},this.GetDecimal=function(t){var e=this.GetFuturesInfo(t);return e?e.Decimal:3},this.GetMarketStatus=function(t){var e=i(-4),a=new Date,r=e.getDay(),n=100*a.getHours()+a.getMinutes();return 6==r||0==r?0:n>430&&n<730?1:2}}function l(){this.newMethod=h,this.newMethod(),delete this.newMethod,this.FUTURES_LIST=[{Symbol:"GC",Decimal:1,Time:0},{Symbol:"QO",Decimal:2,Time:0},{Symbol:"MG",Decimal:1,Time:0},{Symbol:"QI",Decimal:4,Time:0},{Symbol:"SI",Decimal:3,Time:0},{Symbol:"QI",Decimal:4,Time:0},{Symbol:"HG",Decimal:4,Time:0}],this.MarketSuffix=".COMEX"}function u(){this.newMethod=h,this.newMethod(),delete this.newMethod,this.TIME_SPLIT=[{Name:"9:00-2:20",Data:[{Start:900,End:2359},{Start:0,End:220}],Coordinate:{Full:[{Value:900,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"},{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:100,Text:"1:00"}],Simple:[{Value:900,Text:"9:00"},{Value:1300,Text:"13:00"},{Value:1700,Text:"17:00"},{Value:2100,Text:"21:00"},{Value:100,Text:"1:00"}],Min:[{Value:900,Text:"9:00"},{Value:1700,Text:"17:00"},{Value:100,Text:"1:00"}]}},{Name:"15:30-1:00",Data:[{Start:1530,End:2359},{Start:0,End:100}],Coordinate:{Full:[{Value:1600,Text:"16:00"},{Value:1700,Text:"17:00"},{Value:1800,Text:"18:00"},{Value:1900,Text:"19:00"},{Value:2e3,Text:"20:00"},{Value:2100,Text:"21:00"},{Value:2200,Text:"22:00"},{Value:2300,Text:"23:00"},{Value:0,Text:"0:00"},{Value:100,Text:"1:00"}],Simple:[{Value:1600,Text:"16:00"},{Value:1800,Text:"18:00"},{Value:2e3,Text:"20:00"},{Value:2200,Text:"22:00"},{Value:0,Text:"0:00"}],Min:[{Value:1600,Text:"16:00"},{Value:2100,Text:"21:00"},{Value:100,Text:"1:00"}]}}],this.TIME_SPLIT2=[{Name:"10:00-3:20",Data:[{Start:1e3,End:2359},{Start:0,End:320}],Coordinate:{Full:[{Value:1e3,Text:"10:00"},{Value:1200,Text:"12:00"},{Value:1400,Text:"14:00"},{Value:1600,Text:"16:00"},{Value:1800,Text:"18:00"},{Value:2e3,Text:"20:00"},{Value:2200,Text:"22:00"},{Value:0,Text:"0:00"},{Value:200,Text:"2:00"}],Simple:[{Value:1e3,Text:"10:00"},{Value:1400,Text:"14:00"},{Value:1800,Text:"18:00"},{Value:2200,Text:"22:00"},{Value:200,Text:"2:00"}],Min:[{Value:1e3,Text:"10:00"},{Value:1800,Text:"18:00"},{Value:200,Text:"2:00"}]}},{Name:"16:30-2:00",Data:[{Start:1630,End:2359},{Start:0,End:200}],Coordinate:{Full:[{Value:1700,Text:"17:00"},{Value:1800,Text:"18:00"},{Value:1900,Text:"19:00"},{Value:2e3,Text:"20:00"},{Value:2100,Text:"21:00"},{Value:2200,Text:"22:00"},{Value:2300,Text:"23:00"},{Value:0,Text:"0:00"},{Value:100,Text:"1:00"},{Value:200,Text:"2:00"}],Simple:[{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:100,Text:"1:00"}],Min:[{Value:1700,Text:"17:00"},{Value:2100,Text:"21:00"},{Value:200,Text:"2:00"}]}}],this.FUTURES_LIST=[{Symbol:"SB",Decimal:2,Time:1},{Symbol:"CT",Decimal:2,Time:0}],this.MarketSuffix=".NYBOT",this.GetMarketStatus=function(t){var e=i(-4),a=e.getDay(),r=100*e.getHours()+e.getMinutes();if(6==a||0==a)return 0;var n=this.GetFuturesInfo(t);if(!n)return 2;if("SB"==n.Symbol){if(r>300&&r<1400)return 2}else if("CT"==n.Symbol)return r>=0&&r<=1500||r>=2e3&&r<=2359?2:1;return 0}}function C(){this.newMethod=h,this.newMethod(),delete this.newMethod,this.TIME_SPLIT=[{Name:"8:00-2:20",Data:[{Start:800,End:2359},{Start:0,End:220}],Coordinate:{Full:[{Value:800,Text:"8:00"},{Value:1e3,Text:"10:00"},{Value:1200,Text:"12:00"},{Value:1400,Text:"14:00"},{Value:1600,Text:"16:00"},{Value:1800,Text:"18:00"},{Value:2e3,Text:"20:00"},{Value:2200,Text:"22:00"},{Value:0,Text:"0:00"},{Value:200,Text:"2:00"}],Simple:[{Value:800,Text:"8:00"},{Value:1200,Text:"12:00"},{Value:1600,Text:"16:00"},{Value:2e3,Text:"20:00"},{Value:0,Text:"0:00"}],Min:[{Value:800,Text:"8:00"},{Value:1800,Text:"18:00"},{Value:200,Text:"2:00"}]}},{Name:"8:00-2:45",Data:[{Start:800,End:2359},{Start:0,End:245}],Coordinate:{Full:[{Value:800,Text:"8:00"},{Value:1e3,Text:"10:00"},{Value:1200,Text:"12:00"},{Value:1400,Text:"14:00"},{Value:1600,Text:"16:00"},{Value:1800,Text:"18:00"},{Value:2e3,Text:"20:00"},{Value:2200,Text:"22:00"},{Value:0,Text:"0:00"},{Value:200,Text:"2:00"}],Simple:[{Value:800,Text:"8:00"},{Value:1200,Text:"12:00"},{Value:1600,Text:"16:00"},{Value:2e3,Text:"20:00"},{Value:0,Text:"0:00"}],Min:[{Value:800,Text:"8:00"},{Value:1800,Text:"18:00"},{Value:200,Text:"2:00"}]}},{Name:"6:00-5:00",Data:[{Start:600,End:2359},{Start:0,End:500}],Coordinate:{Full:[{Value:600,Text:"6:00"},{Value:800,Text:"8:00"},{Value:1e3,Text:"10:00"},{Value:1200,Text:"12:00"},{Value:1400,Text:"14:00"},{Value:1600,Text:"16:00"},{Value:1800,Text:"18:00"},{Value:2e3,Text:"20:00"},{Value:2200,Text:"22:00"},{Value:0,Text:"0:00"},{Value:200,Text:"2:00"},{Value:400,Text:"4:00"}],Simple:[{Value:600,Text:"6:00"},{Value:1e3,Text:"10:00"},{Value:1400,Text:"14:00"},{Value:1800,Text:"18:00"},{Value:2200,Text:"22:00"},{Value:200,Text:"2:00"}],Min:[{Value:600,Text:"6:00"},{Value:1800,Text:"18:00"},{Value:500,Text:"5:00"}]}}],this.TIME_SPLIT2=[{Name:"9:00-3:20",Data:[{Start:900,End:2359},{Start:0,End:320}],Coordinate:{Full:[{Value:900,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"},{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1,Text:"1:00"},{Value:300,Text:"3:00"}],Simple:[{Value:900,Text:"9:00"},{Value:1300,Text:"13:00"},{Value:1700,Text:"17:00"},{Value:2100,Text:"21:00"},{Value:1,Text:"1:00"}],Min:[{Value:900,Text:"9:00"},{Value:1900,Text:"19:00"},{Value:300,Text:"3:00"}]}},{Name:"9:00-3:45",Data:[{Start:900,End:2359},{Start:0,End:345}],Coordinate:{Full:[{Value:900,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"},{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1,Text:"1:00"},{Value:300,Text:"3:00"}],Simple:[{Value:900,Text:"9:00"},{Value:1300,Text:"13:00"},{Value:1700,Text:"17:00"},{Value:2100,Text:"21:00"},{Value:1,Text:"1:00"}],Min:[{Value:900,Text:"9:00"},{Value:1900,Text:"19:00"},{Value:300,Text:"3:00"}]}},{Name:"7:00-6:00",Data:[{Start:700,End:2359},{Start:0,End:600}],Coordinate:{Full:[{Value:700,Text:"7:00"},{Value:900,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"},{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1,Text:"1:00"},{Value:300,Text:"3:00"},{Value:500,Text:"5:00"}],Simple:[{Value:700,Text:"7:00"},{Value:1100,Text:"11:00"},{Value:1500,Text:"15:00"},{Value:1900,Text:"19:00"},{Value:2300,Text:"23:00"},{Value:300,Text:"3:00"}],Min:[{Value:700,Text:"7:00"},{Value:1800,Text:"18:00"},{Value:500,Text:"5:00"}]}}],this.FUTURES_LIST=[{Symbol:"ZC",Decimal:2,Time:0},{Symbol:"XC",Decimal:2,Time:1},{Symbol:"ZS",Decimal:2,Time:0},{Symbol:"XK",Decimal:2,Time:1},{Symbol:"ZL",Decimal:2,Time:0},{Symbol:"ZR",Decimal:2,Time:0},{Symbol:"ZO",Decimal:2,Time:0},{Symbol:"ZW",Decimal:2,Time:0},{Symbol:"XW",Decimal:2,Time:1},{Symbol:"ZM",Decimal:1,Time:0},{Symbol:"EH",Decimal:3,Time:2},{Symbol:"YM",Decimal:0,Time:2},{Symbol:"ES",Decimal:2,Time:2},{Symbol:"NQ",Decimal:2,Time:2},{Symbol:"TY",Decimal:4,Time:2},{Symbol:"TU",Decimal:4,Time:2},{Symbol:"FV",Decimal:4,Time:2},{Symbol:"US",Decimal:4,Time:2},{Symbol:"UL",Decimal:4,Time:2}],this.MarketSuffix=".CBOT"}function D(){this.newMethod=h,this.newMethod(),delete this.newMethod,this.TIME_SPLIT=[{Name:"LME 9:00-3:00",Data:[{Start:900,End:2359},{Start:0,End:300}],Coordinate:{Full:[{Value:900,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"},{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:100,Text:"1:00"},{Value:300,Text:"3:00"}],Simple:[{Value:900,Text:"9:00"},{Value:1300,Text:"13:00"},{Value:1700,Text:"17:00"},{Value:2100,Text:"21:00"},{Value:100,Text:"1:00"}],Min:[{Value:900,Text:"9:00"},{Value:1800,Text:"18:00"},{Value:300,Text:"3:00"}]}}],this.TIME_SPLIT=[{Name:"LME 8:00-2:00",Data:[{Start:800,End:2359},{Start:0,End:200}],Coordinate:{Full:[{Value:800,Text:"8:00"},{Value:1e3,Text:"10:00"},{Value:1200,Text:"12:00"},{Value:1400,Text:"14:00"},{Value:1600,Text:"16:00"},{Value:1800,Text:"18:00"},{Value:2e3,Text:"20:00"},{Value:2200,Text:"22:00"},{Value:0,Text:"0:00"},{Value:200,Text:"2:00"}],Simple:[{Value:800,Text:"8:00"},{Value:1200,Text:"12:00"},{Value:1600,Text:"16:00"},{Value:2e3,Text:"20:00"},{Value:0,Text:"0:00"}],Min:[{Value:800,Text:"8:00"},{Value:1800,Text:"18:00"},{Value:200,Text:"2:00"}]}}],this.FUTURES_LIST=[{Symbol:"SND",Decimal:0,Time:0},{Symbol:"AHD",Decimal:2,Time:0},{Symbol:"PBD",Decimal:2,Time:0},{Symbol:"ZSD",Decimal:2,Time:0},{Symbol:"CAD",Decimal:2,Time:0},{Symbol:"NID",Decimal:0,Time:0}],this.MarketSuffix=".LME"}var m=new n,S=new s,c=new o,f=new h,d=new l,I=new u,v=new C,p=new D;function T(t){var e=2;if(!t)return e;var a=t.toUpperCase();return"function"==typeof r.GetCustomDecimal?r.GetCustomDecimal(a):(e=r.IsSHSZFund(a)?3:r.IsSHO(a)?r.GetSHODecimal(a):r.IsChinaFutures(a)?c.GetDecimal(a):r.IsFHK(a)?r.GetFHKDecimal(a):r.IsFTSE(a)?r.GetFTSEDecimal(a):r.IsBIT(a)?r.GetBITDecimal(a):r.IsET(a)?r.GetETDecimal(a):r.IsNYMEX(a)?f.GetDecimal(a):r.IsCOMEX(a)?d.GetDecimal(a):r.IsNYBOT(a)?I.GetDecimal(a):r.IsCBOT(a)?v.GetDecimal(a):r.GetDefaultDecimal(a),e)}t.exports={JSCommonCoordinateData:{MinuteCoordinateData:S,MinuteTimeStringData:m,MARKET_SUFFIX_NAME:r,GetfloatPrecision:T},JSCommonCoordinateData_MARKET_SUFFIX_NAME:r,JSCommonCoordinateData_Global_FuturesTimeData:c,JSCommonCoordinateData_Global_NYMEXTimeData:f,JSCommonCoordinateData_Global_COMEXTimeData:d,JSCommonCoordinateData_Global_NYBOTTimeData:I,JSCommonCoordinateData_Global_LMETimeData:p,JSCommonCoordinateData_Global_CBOTTimeData:v}},"8f32":function(t,e,a){"use strict";a("4ec9"),a("d3b7"),a("e25e"),a("25f0"),a("3ca3"),a("ddb0");var i=a("8cb2");function r(){function t(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}function n(){this.Date,this.YClose,this.Open,this.Close,this.High,this.Low,this.Vol,this.Amount,this.Time,this.FlowCapital=0,this.Position=null,this.Stop,this.Up,this.Down,this.Unchanged}function s(){this.Close,this.Open,this.High,this.Low,this.Vol,this.Amount,this.DateTime,this.Increase,this.Risefall,this.AvPrice,this.Date,this.Time,this.Position=null}function o(){this.Date,this.Value}function h(){}function l(){this.Data=new Array,this.DataOffset=0,this.Period=0,this.Right=0,this.Symbol,this.Data2=new Array,this.GetCloseMA=function(t){for(var e=new Array,a=0,i=this.Data.length;a<i;a++)if(a<t)e[a]=null;else{for(var r=0,n=0;n<t;n++)r+=this.Data[a-n].Close;e[a]=r/t}return e},this.GetVolMA=function(t){for(var e=new Array,a=0,i=this.Data.length;a<i;a++)if(a<t)e[a]=null;else{for(var r=0,n=0;n<t;n++)r+=this.Data[a-n].Vol;e[a]=r/t}return e},this.GetAmountMA=function(t){for(var e=new Array,a=0,i=this.Data.length;a<i;a++)if(a<t)e[a]=null;else{for(var r=0,n=0;n<t;n++)r+=this.Data[a-n].Amount;e[a]=r/t}return e},this.GetClose=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].Close;return t},this.GetYClose=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].YClose;return t},this.GetHigh=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].High;return t},this.GetLow=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].Low;return t},this.GetOpen=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].Open;return t},this.GetVol=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].Vol;return t},this.GetAmount=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].Amount;return t},this.GetPosition=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].Position;return t},this.GetDate=function(){var t=[];for(var e in this.Data)t[e]=this.Data[e].Date;return t},this.GetTime=function(){var t=[];for(var e in this.Data)t[e]=this.Data[e].Time;return t},this.GetUp=function(){var t=[];for(var e in this.Data)t[e]=this.Data[e].Up;return t},this.GetDown=function(){var t=[];for(var e in this.Data)t[e]=this.Data[e].Down;return t},this.GetYear=function(){var t=new Array;for(var e in this.Data)t[e]=parseInt(this.Data[e].Date/1e4);return t},this.GetMonth=function(){var t=new Array;for(var e in this.Data)t[e]=parseInt(this.Data[e].Date%1e4/100);return t},this.GetAvPrice=function(){var t=new Array;for(var e in this.Data){var a=this.Data[e].AvPrice;l.IsNumber(a)?t[e]=a:t[e]=0}return t},this.GetDateRange=function(){if(!this.Data||this.Data.length<=0)return null;var t=this.Data[0],e=this.Data[this.Data.length-1],a={Start:{Date:t.Date},End:{Date:e.Date}};return l.IsNumber(t.Time)&&(a.Start.Time=t.Time),l.IsNumber(e.Time)&&(a.End.Time=e.Time),a},this.GetDateIndex=function(t){for(var e=0,a=0;e<this.Data.length;){var i=this.Data[e].Date;if(a>=t.length)break;var r=t[a];r.Date==i?(r.Index=e,++a):r.Date<i?++a:++e}},this.GetDateTimeIndex=function(t){for(var e=0,a=0;e<this.Data.length;){var i=this.Data[e].Date,r=this.Data[e].Time;if(a>=t.length)break;var n=t[a];n.Date==i&&n.Time==r?(n.Index=e,++a):n.Date<i||n.Date==i&&n.Time<r?++a:++e}},this.GetMinutePeriodData=function(t){if(h.GetMinutePeriodData)return h.GetMinutePeriodData(t,this.Data,this);if(t>D&&t<=m)return this.GetMinuteCustomPeriodData(t-D);var e=[],a=5;if(5==t)a=5;else if(6==t)a=15;else if(7==t)a=30;else if(8==t)a=60;else if(11==t)a=120;else{if(12!=t)return this.Data;a=240}for(var i=!1,r=null,s=null,o=0;o<this.Data.length;){i=!0;for(var l=0;l<a&&o<this.Data.length;++o){i&&(r=new n,e.push(r),i=!1);var u=this.Data[o];if(null!=u){if((925!=u.Time||null!=s&&924==s)&&(930!=u.Time||null!=s&&929==s)&&(1300!=u.Time||null!=s&&1259==s)&&++l,r.Date=u.Date,r.Time=u.Time,s=r.Time,null!=u.Open&&null!=u.Close&&(null==r.Open||null==r.Close?(r.Open=u.Open,r.High=u.High,r.Low=u.Low,r.YClose=u.YClose,r.Close=u.Close,r.Vol=u.Vol,r.Amount=u.Amount,r.Position=u.Position,r.FlowCapital=u.FlowCapital):(r.High<u.High&&(r.High=u.High),r.Low>u.Low&&(r.Low=u.Low),r.Close=u.Close,r.Vol+=u.Vol,r.Amount+=u.Amount,r.Position=u.Position,r.FlowCapital=u.FlowCapital),o+1<this.Data.length)){var C=this.Data[o+1];if(C&&C.Date!=u.Date){++o;break}}}else++l}}return e},this.GetMinuteCustomPeriodData=function(t){for(var e=new Array,a=t,i=!1,r=null,s=0;s<this.Data.length;){i=!0;for(var o=0;o<a&&s<this.Data.length;++s,++o){i&&(r=new n,e.push(r),i=!1);var h=this.Data[s];null!=h&&(r.Date=h.Date,r.Time=h.Time,null!=h.Open&&null!=h.Close&&(null==r.Open||null==r.Close?(r.Open=h.Open,r.High=h.High,r.Low=h.Low,r.YClose=h.YClose,r.Close=h.Close,r.Vol=h.Vol,r.Amount=h.Amount,r.FlowCapital=h.FlowCapital,r.Position=h.Position):(r.High<h.High&&(r.High=h.High),r.Low>h.Low&&(r.Low=h.Low),r.Close=h.Close,r.Vol+=h.Vol,r.Amount+=h.Amount,r.FlowCapital=h.FlowCapital,r.Position=h.Position)))}}return e},this.GetDayPeriodData=function(t){if(t>u&&t<=C)return this.GetDayCustomPeriodData(t-u);var e=i.JSCommonCoordinateData_MARKET_SUFFIX_NAME.IsBIT(this.Symbol),a=[],r=0,s=2,o=null;for(var h in this.Data){var D=!1,m=this.Data[h];switch(t){case 1:if(e)var S=l.GetSunday(m.Date);else S=l.GetFirday(m.Date);S!=r&&(D=!0,r=S);break;case 21:if(e)S=l.GetSunday(m.Date);else S=l.GetFirday(m.Date);S!=r&&(++s,s>=2&&(D=!0,s=0),r=S);break;case 2:parseInt(m.Date/100)!=parseInt(r/100)&&(D=!0,r=m.Date);break;case 3:parseInt(m.Date/1e4)!=parseInt(r/1e4)&&(D=!0,r=m.Date);break;case 9:var c=l.GetQuarter(m.Date);c=10*parseInt(m.Date/1e4)+c;var f=l.GetQuarter(r);f=10*parseInt(r/1e4)+f,c!=f&&(D=!0,r=m.Date);break}if(D){if(o=new n,o.Date=m.Date,a.push(o),null==m.Open||null==m.Close)continue;o.Open=m.Open,o.High=m.High,o.Low=m.Low,o.YClose=m.YClose,o.Close=m.Close,o.Vol=m.Vol,o.Amount=m.Amount,o.FlowCapital=m.FlowCapital,o.Position=m.Position}else{if(null==o)continue;if(null==m.Open||null==m.Close)continue;null==o.Open||null==o.Close?(o.Open=m.Open,o.High=m.High,o.Low=m.Low,o.YClose=m.YClose,o.Close=m.Close,o.Vol=m.Vol,o.Amount=m.Amount,o.FlowCapital=m.FlowCapital,o.Position=m.Position):(o.High<m.High&&(o.High=m.High),o.Low>m.Low&&(o.Low=m.Low),o.Close=m.Close,o.Vol+=m.Vol,o.Amount+=m.Amount,o.Date=m.Date,o.FlowCapital=m.FlowCapital,o.Position=m.Position)}}return a},this.GetDayCustomPeriodData=function(t){for(var e=[],a=t,i=!1,r=null,s=0;s<this.Data.length;){i=!0;for(var o=0;o<a&&s<this.Data.length;++s,++o){i&&(r=new n,e.push(r),i=!1);var h=this.Data[s];null!=h&&(r.Date=h.Date,null!=h.Open&&null!=h.Close&&(null==r.Open||null==r.Close?(r.Open=h.Open,r.High=h.High,r.Low=h.Low,r.YClose=h.YClose,r.Close=h.Close,r.Vol=h.Vol,r.Amount=h.Amount,r.FlowCapital=h.FlowCapital,r.Position=h.Position):(r.High<h.High&&(r.High=h.High),r.Low>h.Low&&(r.Low=h.Low),r.Close=h.Close,r.Vol+=h.Vol,r.Amount+=h.Amount,r.Position=h.Position,r.FlowCapital=h.FlowCapital)))}}return e},this.GetPeriodData=function(t){return 1==t||2==t||3==t||9==t||21==t||t>u&&t<=C?this.GetDayPeriodData(t):5==t||6==t||7==t||8==t||11==t||12==t||t>D&&t<=m?this.GetMinutePeriodData(t):void 0},this.GetRightDate=function(t){var e=[];if(this.Data.length<=0)return e;if(1==t){var a=this.Data.length-1,i=1,r=this.Data[a].YClose;for(e[a]=n.Copy(this.Data[a]),--a;a>=0;--a){if(r!=this.Data[a].Close)break;e[a]=n.Copy(this.Data[a]),r=this.Data[a].YClose}for(;a>=0;--a)r!=this.Data[a].Close&&(i*=r/this.Data[a].Close),e[a]=n.CopyRight(this.Data[a],i),r=this.Data[a].YClose}else if(2==t){a=0,i=1;var s=this.Data[a].Close;for(e[a]=n.Copy(this.Data[a]),++a;a<this.Data.length;++a){if(s!=this.Data[a].YClose)break;e[a]=n.Copy(this.Data[a]),s=this.Data[a].Close}for(;a<this.Data.length;++a)s!=this.Data[a].YClose&&(i*=s/this.Data[a].YClose),e[a]=n.CopyRight(this.Data[a],i),s=this.Data[a].Close}return e},this.GetOverlayData=function(t){for(var e=[],a=0,i=0;a<this.Data.length;){var r=this.Data[a].Date;if(i>=t.length)e[a]=new n,e[a].Date=r,++a;else{var s=t[i].Date;s==r?(e[a]=new n,e[a].Date=t[i].Date,e[a].YClose=t[i].YClose,e[a].Open=t[i].Open,e[a].High=t[i].High,e[a].Low=t[i].Low,e[a].Close=t[i].Close,e[a].Vol=t[i].Vol,e[a].Amount=t[i].Amount,e[a].Stop=t[i].Stop,e[a].Up=t[i].Up,e[a].Down=t[i].Down,e[a].Unchanged=t[i].Unchanged,++i,++a):s<r?++i:(e[a]=new n,e[a].Date=r,++a)}}return e},this.GetFittingData=function(t){for(var e=new Array,a=0,i=0;a<this.Data.length;){var r=this.Data[a].Date;if(i>=t.length)e[a]=null,++a;else{var n=t[i].Date;if(n==r){var s=new o;s.Date=t[i].Date,s.Value=t[i].Value,e[a]=s,++i,++a}else n<r?++i:(e[a]=new o,e[a].Date=r,++a)}}return e},this.GetFittingData2=function(t,e){for(var a=new Array,i=0,r=0;i<this.Data.length;){var n=this.Data[i].Date;if(r>=t.length)a[i]=new o,a[i].Date=n,a[i].Value=e,++i;else{var s=t[r].Date;if(s==n){var h=new o;h.Date=t[r].Date,h.Value=t[r].Value,a[i]=h,++r,++i}else s<n?++r:(a[i]=new o,a[i].Date=n,a[i].Value=e,++i)}}return a},this.GetMinuteFittingData=function(t){for(var e=[],a=0,i=0;a<this.Data.length;){var r=this.Data[a].Date,n=this.Data[a].Time;if(i>=t.length)e[a]=null,++a;else{var s=t[i].Date,h=t[i].Time,l=t[i];if(s==r&&h==n){var u=new o;u.Date=l.Date,u.Time=l.Time,u.Value=l.Value,e[a]=u,++i,++a}else if(s<r||s==r&&h<n)++i;else{u=new o;u.Date=r,u.Time=n,e[a]=u,++a}}}return e},this.GetFittingFinanceData=function(t){for(var e=[],a=0,i=0;a<this.Data.length;){var r=this.Data[a].Date;if(i<t.length){var n=t[i].Date;if(r<n){++a;continue}}if(i+1<t.length&&t[i].Date<r&&t[i+1].Date<=r)++i;else{var s=new o;s.Date=r,s.Value=t[i].Value,s.FinanceDate=t[i].Date,e[a]=s,++a}}return e},this.GetMinuteFittingFinanceData=function(t){var e=[];if(!Array.isArray(t)||t.length<=0)return e;var a=0,i=t[0];for(a=0;a<this.Data.length;++a){var r=this.Data[a].Date,n=this.Data[a].Time;if(r>i.Date||r==i.Date&&n>=i.Time)break}for(var s=0;a<this.Data.length;){r=this.Data[a].Date,n=this.Data[a].Time;if(s+1<t.length&&(t[s].Date<r&&t[s+1].Date<=r||t[s].Date==r&&t[s].Time<n&&t[s+1].Time<=n))++s;else{var h=new o;h.Date=r,h.Time=n,s<t.length?(h.Value=t[s].Value,h.FinanceDate=t[s].Date,h.FinanceTime=t[s].Time):(h.Value=null,h.FinanceDate=null,h.FinanceTime=null),e[a]=h,++a}}return e},this.GetFittingMarketValueData=function(t){for(var e=[],a=0,i=0;a<this.Data.length;){var r=this.Data[a].Date,n=this.Data[a].Close;if(i+1<t.length&&t[i].Date<r&&t[i+1].Date<=r)++i;else{var s=new o;s.Date=r,s.Value=t[i].Value*n,s.FinanceDate=t[i].Date,e[a]=s,++a}}return e},this.GetFittingMonthData=function(t){for(var e=new Array,a=null,i=0,r=0;i<this.Data.length;){var n=this.Data[i].Date;if(r>=t.length)e[i]=null,++i;else{var s=t[r].Date;if(s==n){var h=new o;h.Date=t[r].Date,h.Value=t[r].Value,h.Text=t[r].Text,e[i]=h,++r,++i}else if(null!=a&&a<s&&n>s){h=new o;h.Date=n,h.OverlayDate=t[r].Date,h.Value=t[r].Value,h.Text=t[r].Text,e[i]=h,++r,++i}else s<n?++r:(e[i]=new o,e[i].Date=n,++i);a=n}}return e},this.GetValue=function(){var t=new Array;for(var e in this.Data)null==this.Data[e]||null==this.Data[e].Value?t[e]=null:isNaN(this.Data[e].Value)?this.Data[e].Value instanceof Array?t[e]=this.Data[e].Value:t[e]=null:t[e]=this.Data[e].Value;return t},this.GetPeriodSingleData=function(t){var e=new Array,a=0,i=null;for(var r in this.Data){var n=!1,s=this.Data[r];if(null!=s&&null!=s.Date){switch(t){case 1:var h=l.GetFirday(s.Date);h!=a&&(n=!0,a=h);break;case 2:parseInt(s.Date/100)!=parseInt(a/100)&&(n=!0,a=s.Date);break;case 3:parseInt(s.Date/1e4)!=parseInt(a/1e4)&&(n=!0,a=s.Date);break}if(n)i=new o,i.Date=s.Date,i.Value=s.Value,e.push(i);else{if(null==i)continue;if(null==s.Value||isNaN(s.Value))continue;(null==i.Value||isNaN(i.Value))&&(i.Value=s.Value)}}}return e},this.GetMinuteAvPrice=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].AvPrice;return t},this.MergeMinuteData=function(t){for(var e=this.Data[0],a=0,i=null,r=0;r<t.length;++r){var s=t[r];if(s.Date>e.Date){a=r,i=s;break}if(s.Date==e.Date&&s.Time>=e.Time){a=r,i=s;break}}if(null==i)return!1;var o=null,h=!1;for(r=this.Data.length-1;r>=0;--r){var l=this.Data[r].Date,u=this.Data[r].Time;if(i.Date>l||i.Date==l&&i.Time>=u){o=r,i.Date==l&&i.Time==u&&(h=!0);break}}if(null==o)return!1;var C=o;r=a;if(1==h){s=t[r];C-1>0&&!s.YClose&&(s.YClose=this.Data[C-1].Close);var D=n.Copy(s);this.Data[C]=D,++C,++r}else++C;for(;r<t.length;){s=t[r];if(C>=this.Data.length-1){C-1>0&&!s.YClose&&(s.YClose=this.Data[C-1].YClose);D=n.Copy(s);this.Data[C]=D,++C,++r}else{var m=this.Data[C];m.Date==s.Date&&m.Time==s.Time?(n.CopyTo(m,s),++C,++r):++C}}return!0},this.GetFittingTradeData=function(t,e,a){for(var i=[],r=!1,n=0,s=0;n<this.Data.length;){var h=this.Data[n].Date;if(s<t.length&&t[s].Date>h){var l=new o;l.Date=h,l.Value=e,i[n]=l,++n}else if(s+1<t.length&&t[s].Date<h&&t[s+1].Date<=h)++s,r=!1;else{l=new o;if(l.Date=h,l.Value=e,l.FinanceDate=null,s<t.length){var u=t[s];0==this.Period&&!0===a?u.Date==l.Date&&(l.Value=u.Value,l.FinanceDate=u.Date,r=!0):0==r&&(l.Value=u.Value,l.FinanceDate=u.Date,r=!0)}i[n]=l,++n}}return i},this.GetMinuteFittingTradeData=function(t,e,a){for(var i=[],r=!1,n=0,s=0;n<this.Data.length;){var h=this.Data[n].Date,l=this.Data[n].Time;if(s<t.length&&(t[s].Date>h||t[s].Date==h&&t[s].Time>l)){var u=new o;u.Date=h,u.Time=l,u.Value=e,i[n]=u,++n}else if(s+1<t.length&&(t[s].Date<h&&t[s+1].Date<=h||t[s].Date==h&&t[s].Time<l&&t[s+1].Time<=l))++s,r=!1;else{u=new o;if(u.Date=h,u.FinanceDate=null,u.Time=l,u.Value=e,s<t.length){var C=t[s];4==this.Period&&!0===a?C.Date==u.Date&&C.Time==u.Time&&(u.Value=C.Value,u.FinanceDate=C.Date,u.FinanceTime=C.Time,r=!0):0==r&&(u.Value=C.Value,u.FinanceDate=C.Date,u.FinanceTime=C.Time,r=!0)}i[n]=u,++n}}return i}}n.Copy=function(t){var e=new n;return e.Date=t.Date,e.YClose=t.YClose,e.Open=t.Open,e.Close=t.Close,e.High=t.High,e.Low=t.Low,e.Vol=t.Vol,e.Amount=t.Amount,e.Time=t.Time,e.FlowCapital=t.FlowCapital,e.Position=t.Position,e.Stop=t.Stop,e.Up=t.Up,e.Down=t.Down,e.Unchanged=t.Unchanged,e},n.CopyTo=function(t,e){t.Date=e.Date,t.YClose=e.YClose,t.Open=e.Open,t.Close=e.Close,t.High=e.High,t.Low=e.Low,t.Vol=e.Vol,t.Amount=e.Amount,t.Time=e.Time,t.FlowCapital=e.FlowCapital,t.Stop=e.Stop,t.Up=e.Up,t.Down=e.Down,t.Unchanged=e.Unchanged},n.CopyRight=function(t,e){var a=new n;return a.Date=t.Date,a.YClose=t.YClose*e,a.Open=t.Open*e,a.Close=t.Close*e,a.High=t.High*e,a.Low=t.Low*e,a.Vol=t.Vol,a.Amount=t.Amount,a.FlowCapital=t.FlowCapital,a.Position=t.Position,a},h.GetMinutePeriodData=null,l.IsNumber=function(t){return null!=t&&!isNaN(t)},l.GetFirday=function(t){var e=new Date(parseInt(t/1e4),t/100%100-1,t%100),a=e.getDay();if(5==a)return t;var i=e.getTime();if(a<5){var r=864e5*(5-a);i+=r}else{r=864e5*(a-5);i-=r}e.setTime(i);var n=1e4*e.getFullYear()+100*(e.getMonth()+1)+e.getDate();e.getDay();return n},l.GetSunday=function(t){var e=new Date(parseInt(t/1e4),t/100%100-1,t%100),a=e.getDay();if(0==a)return t;var i=e.getTime();if(a>0){var r=864e5*(7-a);i+=r}e.setTime(i);var n=1e4*e.getFullYear()+100*(e.getMonth()+1)+e.getDate();e.getDay();return n},l.GetQuarter=function(t){var e=parseInt(t%1e4/100);return 1==e||2==e||3==e?1:4==e||5==e||6==e?2:7==e||8==e||9==e?3:10==e||11==e||12==e?4:0};var u=4e4,C=49999;l.IsDayPeriod=function(t,e){return 1==t||2==t||3==t||9==t||21==t||(t>u&&t<=C||0==t&&1==e)};var D=2e4,m=29999;l.IsMinutePeriod=function(t,e){return 5==t||6==t||7==t||8==t||11==t||12==t||(t>D&&t<=m||4==t&&1==e)};var S=3e4,c=32e3;function f(t,e,a,i){this.Left=t,this.Top=e,this.Right=t+a,this.Bottom=e+i,this.IsPointIn=function(t,e){return t>=this.Left&&t<=this.Right&&e>=this.Top&&e<=this.Bottom}}function d(t){return parseInt(t)+.5}function I(t){return.5+t<<0}l.IsSecondPeriod=function(t){return t>S&&t<=c},l.IsTickPeriod=function(t){return 10==t},l.GetPeriodName=function(t){var e=new Map([[0,"日线"],[1,"周线"],[2,"月线"],[3,"年线"],[9,"季线"],[21,"双周"],[4,"1分"],[5,"5分"],[6,"15分"],[7,"30分"],[8,"60分"],[11,"2小时"],[12,"4小时"],[10,"分笔"]]);return e.has(t)?e.get(t):""};var v={RECV_INDEX_DATA:2,RECV_HISTROY_DATA:3,RECV_TRAIN_MOVE_STEP:4,CHART_STATUS:5,BARRAGE_PLAY_END:6,RECV_START_AUTOUPDATE:9,RECV_STOP_AUTOUPDATE:10,ON_TITLE_DRAW:12,RECV_MINUTE_DATA:14,ON_CLICK_INDEXTITLE:15,RECV_KLINE_UPDATE_DATA:16,ON_INDEXTITLE_DRAW:19,ON_CUSTOM_VERTICAL_DRAW:20,ON_ENABLE_SPLASH_DRAW:22,ON_DRAW_DEPTH_TOOLTIP:25,ON_PHONE_TOUCH:27,ON_SPLIT_YCOORDINATE:29};t.exports={JSCommonData:{HistoryData:n,ChartData:l,SingleData:o,MinuteData:s,Rect:f,DataPlus:h,JSCHART_EVENT_ID:v},JSCommon_ChartData:l,JSCommon_HistoryData:n,JSCommon_SingleData:o,JSCommon_MinuteData:s,JSCommon_CUSTOM_DAY_PERIOD_START:u,JSCommon_CUSTOM_DAY_PERIOD_END:C,JSCommon_CUSTOM_MINUTE_PERIOD_START:D,JSCommon_CUSTOM_MINUTE_PERIOD_END:m,JSCommon_CUSTOM_SECOND_PERIOD_START:S,JSCommon_CUSTOM_SECOND_PERIOD_END:c,JSCommon_Rect:f,JSCommon_DataPlus:h,JSCommon_Guid:r,JSCommon_ToFixedPoint:d,JSCommon_ToFixedRect:I,JSCommon_JSCHART_EVENT_ID:v}},"90f8":function(t,e,a){function i(){this.TooltipBGColor="rgb(255, 255, 255)",this.TooltipAlpha=.92,this.SelectRectBGColor="rgba(1,130,212,0.06)",this.BGColor="rgb(255,255,255)",this.UpBarColor="rgb(238,21,21)",this.DownBarColor="rgb(25,158,0)",this.UnchagneBarColor="rgb(0,0,0)",this.MinKLineBarWidth=4,this.Minute={},this.Minute.VolBarColor=null,this.Minute.PriceColor="rgb(50,171,205)",this.Minute.AreaPriceColor="rgba(50,171,205,0.1)",this.Minute.AvPriceColor="rgb(238,127,9)",this.DefaultTextColor="rgb(43,54,69)",this.DefaultTextFont="14px 微软雅黑",this.IndexTitleBGColor="rgb(217,219,220)",this.DynamicTitleFont="12px 微软雅黑",this.UpTextColor="rgb(238,21,21)",this.DownTextColor="rgb(25,158,0)",this.UnchagneTextColor="rgb(0,0,0)",this.CloseLineColor="rgb(0,191,255)",this.CloseLineAreaColor=["rgba(0,191,255,0.8)","rgba(0,191,255,0.2)"],this.Title={TradeIndexColor:"rgb(105,105,105)",ColorIndexColor:"rgb(112,128,144)",VolColor:"rgb(43,54,69)",AmountColor:"rgb(43,54,69)",DateTimeColor:"rgb(43,54,69)",SettingColor:"rgb(43,54,69)",NameColor:"rgb(43,54,69)",TurnoverRateColor:"rgb(43,54,69)",PositionColor:"rgb(43,54,69)"},this.FrameBorderPen="rgb(225,236,242)",this.FrameSplitPen="rgb(225,236,242)",this.FrameSplitTextColor="rgb(51,51,51)",this.FrameSplitTextFont="12px 微软雅黑",this.FrameYLineDash=[2,2],this.FrameXLineDash=null,this.FrameTitleBGColor="rgb(246,251,253)",this.Frame={XBottomOffset:0,YTopOffset:2},this.FrameLatestPrice={TextColor:"rgb(255,255,255)",UpBarColor:"rgb(238,21,21)",DownBarColor:"rgb(25,158,0)",UnchagneBarColor:"rgb(0,0,0)",BGAlpha:.6},this.FrameMargin=4,this.FrameLeftMargin=2,this.FrameRightMargin=2,this.CorssCursorBGColor="rgb(43,54,69)",this.CorssCursorTextColor="rgb(255,255,255)",this.CorssCursorTextFont="12px 微软雅黑",this.CorssCursorHPenColor="rgb(130,130,130)",this.CorssCursorVPenColor="rgb(130,130,130)",this.Domain="https://opensource.zealink.com",this.CacheDomain="https://opensourcecache.zealink.com",this.KLine={MaxMin:{Font:"12px 微软雅黑",Color:"rgb(111,111,111)"},Info:{Color:"rgb(205,149,12)",Color2:"rgb(255,133,3)",TextColor:"#197de9",TextBGColor:"rgba(220,220,220,0.5)",Investor:{ApiUrl:"/API/NewsInteract"},Announcement:{ApiUrl:"/API/ReportList"},Pforecast:{ApiUrl:"/API/StockHistoryDay"},Research:{ApiUrl:"/API/InvestorRelationsList"},BlockTrading:{ApiUrl:"/API/StockHistoryDay"},TradeDetail:{ApiUrl:"/API/StockHistoryDay"},Policy:{ApiUrl:"/API/StockHistoryDay"}}},this.Index={},this.Index.LineColor=["rgb(255,189,09)","rgb(22,198,255)","rgb(174,35,161)","rgb(236,105,65)","rgb(68,114,196)","rgb(229,0,79)","rgb(0,128,255)","rgb(252,96,154)","rgb(42,230,215)","rgb(24,71,178)"],this.ColorArray=["rgb(255,174,0)","rgb(25,199,255)","rgb(175,95,162)","rgb(236,105,65)","rgb(68,114,196)","rgb(229,0,79)","rgb(0,128,255)","rgb(252,96,154)","rgb(42,230,215)","rgb(24,71,178)"],this.Index.StockHistoryDayApiUrl="https://opensource.zealink.com/API/StockHistoryDay",this.Index.MarketLongShortApiUrl="https://opensource.zealink.com/API/FactorTiming",this.Index.MarketAttentionApiUrl="https://opensource.zealink.com/API/MarketAttention",this.Index.MarketHeatApiUrl="https://opensource.zealink.com/API/MarketHeat",this.Index.CustomIndexHeatApiUrl="https://opensource.zealink.com/API/QuadrantCalculate",this.Index.NotSupport={Font:"14px 微软雅黑",TextColor:"rgb(52,52,52)"},this.DrawPicture={},this.DrawPicture.LineColor=["rgb(30,144,255)"],this.DrawPicture.PointColor=["rgb(105,105,105)"],this.KLineTrain={Font:"bold 14px 宋体",LastDataIcon:{Color:"rgb(0,0,205)",Text:"⬇"},BuyIcon:{Color:"rgb(255,185, 15)",Text:"买"},SellIcon:{Color:"rgb(70,130,180)",Text:"卖"}},this.TooltipPaint={BGColor:"rgba(250,250,250,0.8)",BorderColor:"rgb(120,120,120)",TitleColor:"rgb(120,120,120)",TitleFont:"13px 微软雅黑"},this.Barrage={Font:"16px 微软雅黑",Height:20,Color:"RGB(109,109,109)"},this.MinuteInfo={TextColor:"rgb(84,143,255)",Font:"14px 微软雅黑",PointColor:"rgb(38,113,254)",LineColor:"rgb(120,167,255)",TextBGColor:"rgba(255,255,255,0.8)"},this.DRAWICON={Text:{MaxSize:50,MinSize:20,Zoom:{Type:2,Value:1},FontName:"Arial"}},this.DRAWTEXT={MaxSize:18,MinSize:18,Zoom:{Type:1,Value:1},FontName:"微软雅黑"},this.DRAWNUMBER={MaxSize:18,MinSize:18,Zoom:{Type:1,Value:1},FontName:"微软雅黑"},this.DRAWABOVE={YOffset:0},this.CIRCLEDOT={Radius:1.3},this.POINTDOT={Radius:2},this.DepthChart={BidColor:{Line:"rgb(82,176,123)",Area:"rgba(82,176,123,0.8)"},AskColor:{Line:"rgb(207,76,89)",Area:"rgba(207,76,89, 0.8)"},LineWidth:4},this.DepthCorss={BidColor:{Line:"rgb(82,176,123)"},AskColor:{Line:"rgb(207,76,89)"},LineWidth:2,LineDash:[3,3],Tooltip:{BGColor:"rgba(236,240,245, 0.8)",TextColor:"rgb(130,140,151)",Border:{Top:5,Left:20,Bottom:5,Center:5},Font:"14px 微软雅黑",LineHeight:16}},this.SetStyle=function(t){if(t.TooltipBGColor&&(this.TooltipBGColor=t.TooltipBGColor),t.TooltipAlpha&&(this.TooltipAlpha=t.TooltipAlpha),t.BGColor&&(this.BGColor=t.BGColor),t.SelectRectBGColor&&(this.SelectRectBGColor=t.SelectRectBGColor),t.UpBarColor&&(this.UpBarColor=t.UpBarColor),t.DownBarColor&&(this.DownBarColor=t.DownBarColor),t.UnchagneBarColor&&(this.UnchagneBarColor=t.UnchagneBarColor),t.Minute&&(t.Minute.VolBarColor&&(this.Minute.VolBarColor=t.Minute.VolBarColor),t.Minute.PriceColor&&(this.Minute.PriceColor=t.Minute.PriceColor),t.Minute.AvPriceColor&&(this.Minute.AvPriceColor=t.Minute.AvPriceColor),t.Minute.AreaPriceColor&&(this.Minute.AreaPriceColor=t.Minute.AreaPriceColor)),t.DefaultTextColor&&(this.DefaultTextColor=t.DefaultTextColor),t.DefaultTextFont&&(this.DefaultTextFont=t.DefaultTextFont),t.DynamicTitleFont&&(this.DynamicTitleFont=t.DynamicTitleFont),t.IndexTitleBGColor&&(this.IndexTitleBGColor=t.IndexTitleBGColor),t.UpTextColor&&(this.UpTextColor=t.UpTextColor),t.DownTextColor&&(this.DownTextColor=t.DownTextColor),t.UnchagneTextColor&&(this.UnchagneTextColor=t.UnchagneTextColor),t.CloseLineColor&&(this.CloseLineColor=t.CloseLineColor),t.CloseLineAreaColor&&(this.CloseLineAreaColor=t.CloseLineAreaColor),t.FrameBorderPen&&(this.FrameBorderPen=t.FrameBorderPen),t.FrameSplitPen&&(this.FrameSplitPen=t.FrameSplitPen),t.FrameSplitTextColor&&(this.FrameSplitTextColor=t.FrameSplitTextColor),t.FrameSplitTextFont&&(this.FrameSplitTextFont=t.FrameSplitTextFont),t.FrameTitleBGColor&&(this.FrameTitleBGColor=t.FrameTitleBGColor),t.Frame&&(t.Frame.XBottomOffset&&(this.Frame.XBottomOffset=t.Frame.XBottomOffset),t.Frame.YTopOffset&&(this.Frame.YTopOffset=t.Frame.YTopOffset)),t.FrameLatestPrice&&(t.FrameLatestPrice.TextColor&&(this.FrameLatestPrice.TextColor=t.FrameLatestPrice.TextColor),t.FrameLatestPrice.UpBarColor&&(this.FrameLatestPrice.UpBarColor=t.FrameLatestPrice.UpBarColor),t.FrameLatestPrice.DownBarColor&&(this.FrameLatestPrice.DownBarColor=t.FrameLatestPrice.DownBarColor),t.FrameLatestPrice.UnchagneBarColor&&(this.FrameLatestPrice.UnchagneBarColor=t.FrameLatestPrice.UnchagneBarColor),t.FrameLatestPrice.BGAlpha&&(this.FrameLatestPrice.BGAlpha=t.FrameLatestPrice.BGAlpha)),t.CorssCursorBGColor&&(this.CorssCursorBGColor=t.CorssCursorBGColor),t.CorssCursorTextColor&&(this.CorssCursorTextColor=t.CorssCursorTextColor),t.CorssCursorTextFont&&(this.CorssCursorTextFont=t.CorssCursorTextFont),t.CorssCursorHPenColor&&(this.CorssCursorHPenColor=t.CorssCursorHPenColor),t.CorssCursorVPenColor&&(this.CorssCursorVPenColor=t.CorssCursorVPenColor),t.KLine&&(this.KLine=t.KLine),t.Index&&(t.Index.LineColor&&(this.Index.LineColor=t.Index.LineColor),t.Index.NotSupport&&(this.Index.NotSupport=t.Index.NotSupport)),t.ColorArray&&(this.ColorArray=t.ColorArray),t.DrawPicture&&(this.DrawPicture.LineColor=t.DrawPicture.LineColor,this.DrawPicture.PointColor=t.DrawPicture.PointColor),t.TooltipPaint&&(t.TooltipPaint.BGColor&&(this.TooltipPaint.BGColor=t.TooltipPaint.BGColor),t.TooltipPaint.BorderColor&&(this.TooltipPaint.BorderColor=t.TooltipPaint.BorderColor),t.TooltipPaint.TitleColor&&(this.TooltipPaint.TitleColor=t.TooltipPaint.TitleColor),t.TooltipPaint.TitleFont&&(this.TooltipPaint.TitleFont=t.TooltipPaint.TitleFont)),t.Title&&(t.Title.TradeIndexColor&&(this.Title.TradeIndexColor=t.Title.TradeIndexColor),t.Title.ColorIndexColor&&(this.Title.ColorIndexColor=t.Title.ColorIndexColor),t.Title.VolColor&&(this.Title.VolColor=t.Title.VolColor),t.Title.AmountColor&&(this.Title.AmountColor=t.Title.AmountColor),t.Title.DateTimeColor&&(this.Title.DateTimeColor=t.Title.DateTimeColor),t.Title.NameColor&&(this.Title.NameColor=t.Title.NameColor),t.Title.SettingColor&&(this.Title.SettingColor=t.Title.SettingColor),t.Title.TurnoverRateColor&&(this.Title.TurnoverRateColor=t.Title.TurnoverRateColor),t.Title.PositionColor&&(this.Title.PositionColor=t.Title.PositionColor)),t.DRAWICON&&t.DRAWICON.Text){var e=t.DRAWICON.Text;IFrameSplitOperator.IsPlusNumber(e.MaxSize)&&(this.DRAWICON.Text.MaxSize=e.MaxSize),IFrameSplitOperator.IsPlusNumber(e.MinSize)&&(this.DRAWICON.Text.MinSize=e.MinSize),e.Zoom&&(this.DRAWICON.Text.Zoom=e.Zoom),e.FontName&&(this.DRAWICON.Text.FontName=e.FontName)}if(t.DRAWTEXT){e=t.DRAWTEXT;IFrameSplitOperator.IsPlusNumber(e.MaxSize)&&(this.DRAWICON.MaxSize=e.MaxSize),IFrameSplitOperator.IsPlusNumber(e.MinSize)&&(this.DRAWICON.MinSize=e.MinSize),e.Zoom&&(this.DRAWICON.Zoom=e.Zoom),e.FontName&&(this.DRAWICON.FontName=e.FontName)}if(t.DRAWNUMBER){e=t.DRAWNUMBER;this.IsPlusNumber(e.MaxSize)&&(this.DRAWNUMBER.Text.MaxSize=e.MaxSize),this.IsPlusNumber(e.MinSize)&&(this.DRAWNUMBER.Text.MinSize=e.MinSize),e.Zoom&&(this.DRAWNUMBER.Text.Zoom=e.Zoom),e.FontName&&(this.DRAWNUMBER.Text.FontName=e.FontName)}if(t.DRAWABOVE){e=t.DRAWABOVE;this.IsNumber(e.YOffset)&&(this.DRAWABOVE.YOffset=e.YOffset)}if(t.DepthChart){e=t.DepthChart;e.BidColor&&(e.BidColor.Line&&(this.DepthChart.BidColor.Line=e.BidColor.Line),e.BidColor.Area&&(this.DepthChart.BidColor.Area=e.BidColor.Area)),e.AskColor&&(e.AskColor.Line&&(this.DepthChart.AskColor.Line=e.AskColor.Line),e.AskColor.Area&&(this.DepthChart.AskColor.Area=e.AskColor.Area)),e.LineWidth&&(this.DepthChart.LineWidth=e.LineWidth)}if(t.DepthCorss){e=t.DepthCorss;if(e.BidColor&&e.BidColor.Line&&(this.DepthCorss.BidColor.Line=e.BidColor.Line),e.AskColor&&e.AskColor.Line&&(this.DepthCorss.AskColor.Line=e.AskColor.Line),e.LineWidth&&(this.DepthCorss.LineWidth=e.LineWidth),e.LineDash&&(this.DepthCorss.LineDash=e.LineDash),e.Tooltip){var a=e.Tooltip;a.BGColor&&(this.DepthCorss.Tooltip.BGColor=a.BGColor),a.TextColor&&(this.DepthCorss.Tooltip.TextColor=a.TextColor),a.Font&&(this.DepthCorss.Tooltip.Font=a.Font),a.LineHeight&&(this.DepthCorss.Tooltip.LineHeight=a.LineHeight);var i=a.Border;this.IsNumber(i.Top)&&(this.DepthCorss.Tooltip.Border.Top=i.Top),this.IsNumber(i.Left)&&(this.DepthCorss.Tooltip.Border.Left=i.Left),this.IsNumber(i.Bottom)&&(this.DepthCorss.Tooltip.Border.Bottom=i.Bottom),this.IsNumber(i.Center)&&(this.DepthCorss.Tooltip.Border.Center=i.Center)}}if(t.CIRCLEDOT){e=t.CIRCLEDOT;this.IsNumber(e.Radius)&&(this.CIRCLEDOT.Radius=e.Radius)}if(t.POINTDOT){e=t.POINTDOT;this.IsNumber(e.Radius)&&(this.POINTDOT.Radius=e.Radius)}},this.IsNumber=function(t){return null!=t&&!isNaN(t)},this.IsPlusNumber=function(t){return null!=t&&(!isNaN(t)&&t>0)}}a("4ec9"),a("d3b7"),a("3ca3"),a("ddb0");var r=new i,n={LANGUAGE_CHINESE_ID:0,LANGUAGE_ENGLISH_ID:1};function s(){this.TextResource=new Map([["Tooltip-Open",{CN:"开:",EN:"O:"}],["Tooltip-High",{CN:"高:",EN:"H:"}],["Tooltip-Low",{CN:"低:",EN:"L:"}],["Tooltip-Close",{CN:"收:",EN:"C:"}],["Tooltip-Increase",{CN:"幅:",EN:"I:"}],["Tooltip-Vol",{CN:"量:",EN:"V:"}],["Tooltip-Amount",{CN:"额:",EN:"A:"}],["Tooltip-AvPrice",{CN:"均:",EN:"AP:"}],["Tooltip-Price",{CN:"价:",EN:"P:"}],["Tooltip-Exchange",{CN:"换:",EN:"E:"}],["Tooltip-Position",{CN:"持:",EN:"P:"}],["KTitle-Open",{CN:"开:",EN:"O:"}],["KTitle-High",{CN:"高:",EN:"H:"}],["KTitle-Low",{CN:"低:",EN:"L:"}],["KTitle-Close",{CN:"收:",EN:"C:"}],["KTitle-Increase",{CN:"幅:",EN:"I:"}],["KTitle-Vol",{CN:"量:",EN:"V:"}],["KTitle-Amount",{CN:"额:",EN:"A:"}],["KTitle-Exchange",{CN:"换:",EN:"E:"}],["KTitle-Position",{CN:"持:",EN:"P:"}],["MTitle-Close",{CN:"价:",EN:"C:"}],["MTitle-AvPrice",{CN:"均:",EN:"AC:"}],["MTitle-Increase",{CN:"幅:",EN:"I:"}],["MTitle-Vol",{CN:"量:",EN:"V:"}],["MTitle-Amount",{CN:"额:",EN:"A:"}],["MTitle-Position",{CN:"持:",EN:"P:"}],["日线",{CN:"日线",EN:"1D"}],["周线",{CN:"周线",EN:"1W"}],["双周",{CN:"双周",EN:"2W"}],["月线",{CN:"月线",EN:"1M"}],["年线",{CN:"年线",EN:"1Y"}],["1分",{CN:"1分",EN:"1Min"}],["5分",{CN:"5分",EN:"5Min"}],["15分",{CN:"15分",EN:"15Min"}],["30分",{CN:"30分",EN:"30Min"}],["60分",{CN:"60分",EN:"60Min"}],["季线",{CN:"季线",EN:"1Q"}],["分笔",{CN:"分笔",EN:"Tick"}],["2小时",{CN:"2小时",EN:"2H"}],["4小时",{CN:"4小时",EN:"4H"}],["不复权",{CN:"不复权",EN:"No Right"}],["前复权",{CN:"前复权",EN:"Pro Right"}],["后复权",{CN:"后复权",EN:"Post Right"}],["日",{CN:"日",EN:"Sun."}],["一",{CN:"一",EN:"Mon."}],["二",{CN:"二",EN:"Tues."}],["三",{CN:"三",EN:"Wed."}],["四",{CN:"四",EN:"Thur."}],["五",{CN:"五",EN:"Fri."}],["六",{CN:"六",EN:"Sat."}],["1月",{CN:"1月",EN:"Jan"}],["2月",{CN:"2月",EN:"Feb"}],["3月",{CN:"3月",EN:"Mar"}],["4月",{CN:"4月",EN:"Apr"}],["5月",{CN:"5月",EN:"May"}],["6月",{CN:"6月",EN:"Jun"}],["7月",{CN:"7月",EN:"Jul"}],["8月",{CN:"8月",EN:"Aug"}],["9月",{CN:"9月",EN:"Sept"}],["10月",{CN:"10月",EN:"Oct"}],["11月",{CN:"11月",EN:"Nov"}],["12月",{CN:"12月",EN:"Dec"}],["自定义分钟",{CN:"分",EN:"Min"}],["自定义日线",{CN:"日",EN:"D"}],["自定义秒",{CN:"秒",EN:"S"}]]),this.GetText=function(t,e){var a=this.TextResource.get(t);if(!a)return"";switch(e){case n.LANGUAGE_CHINESE_ID:return a.CN;case n.LANGUAGE_ENGLISH_ID:return a.EN;default:return a.CN}},this.SetTextResource=function(t,e){this.TextResource.set(t,e)}}var o=new s;t.exports={JSCommonResource:{JSChartResource:i,Global_JSChartResource:r,Global_JSChartLocalization:o,JSCHART_LANGUAGE_ID:n},JSCommonResource_JSChartResource:i,JSCommonResource_Global_JSChartResource:r,JSCommonResource_Global_JSChartLocalization:o,JSCommonResource_JSCHART_LANGUAGE_ID:n}},9132:function(t,e,a){"use strict";var i=a("4ea4");a("99af"),a("4ec9"),a("d3b7"),a("e25e"),a("ac1f"),a("3ca3"),a("1276"),a("ddb0");var r=i(a("b85c")),n=a("a0cd"),s=a("8f32"),o=a("8cb2"),h=a("90f8"),l=a("621d");function u(){this.Canvas,this.ChartBorder,this.ChartFrame,this.Name,this.Data,this.ClassName="IExtendChartPainting",this.IsDynamic=!1,this.IsEraseBG=!1,this.IsAnimation=!1,this.DrawAfterTitle=!1,this.Left=5,this.Right=5,this.Top=5,this.Bottom=5,this.Draw=function(){},this.SetOption=function(t){}}function C(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.IsDynamic=!0,this.IsEraseBG=!0,this.DrawAfterTitle=!0,this.ClassName="KLineTooltipPaint",this.LatestPoint,this.ShowPosition=0,this.BorderColor=h.JSCommonResource_Global_JSChartResource.TooltipPaint.BorderColor,this.BGColor=h.JSCommonResource_Global_JSChartResource.TooltipPaint.BGColor,this.TitleColor=h.JSCommonResource_Global_JSChartResource.TooltipPaint.TitleColor,this.Font=[h.JSCommonResource_Global_JSChartResource.TooltipPaint.TitleFont],this.Width=50,this.Height=100,this.LineHeight=15,this.Left=1,this.Top=0,this.HQChart,this.KLineTitlePaint,this.IsHScreen=!1,this.LanguageID=h.JSCommonResource_JSCHART_LANGUAGE_ID.LANGUAGE_CHINESE_ID,this.GetLeft=function(){return this.IsHScreen?this.ChartBorder.GetRightEx()-this.Height-this.Top:0==this.ShowPosition?this.ChartBorder.GetLeft()+this.Left:this.ChartBorder.GetRight()-this.Width-this.Left},this.GetTop=function(){return this.IsHScreen?0==this.ShowPosition?this.ChartBorder.GetTop()+this.Left:this.ChartBorder.GetBottom()-this.Width-this.Left:this.ChartBorder.GetTopEx()+this.Top},this.Draw=function(){if(this.HQChart&&this.HQChart.TitlePaint&&this.HQChart.TitlePaint[0]&&this.HQChart.IsOnTouch){this.KLineTitlePaint=this.HQChart.TitlePaint[0];var t=this.KLineTitlePaint.GetCurrentKLineData();if(t){var e;this.HQChart.Symbol&&(e=this.HQChart.Symbol.toUpperCase());var a=!!o.JSCommonCoordinateData_MARKET_SUFFIX_NAME.IsChinaFutures(e),i=8;"MinuteTooltipPaint"===this.ClassName?(i=7,a&&l.JSCommonSplit_IFrameSplitOperator.IsNumber(t.Position)&&++i):(l.JSCommonSplit_IFrameSplitOperator.IsNumber(t.Time)&&++i,a&&l.JSCommonSplit_IFrameSplitOperator.IsNumber(t.Position)&&++i),this.IsHScreen=!0===this.ChartFrame.IsHScreen,this.Canvas.font=this.Font[0];var r=o.JSCommonCoordinateData.GetfloatPrecision(this.HQChart.Symbol),n=" 擎: 9999.99亿 ";if(r>=5&&(n=" 擎: ".concat(99.99.toFixed(r)," ")),this.Width=this.Canvas.measureText(n).width,this.Height=this.LineHeight*i+4,t&&t.High>0){n=" 擎: ".concat(t.High.toFixed(r)," ");var s=this.Canvas.measureText(n).width;s>this.Width&&(this.Width=s)}this.CalculateShowPosition(),this.DrawBG(),this.DrawTooltipData(t),this.DrawBorder()}}},this.CalculateShowPosition=function(){if(this.ShowPosition=0,this.LatestPoint)if(this.IsHScreen){var t=this.ChartBorder.GetTop(),e=this.ChartBorder.GetHeight(),a=t+e/2;this.LatestPoint.Y<a&&(this.ShowPosition=1)}else{var i=this.ChartBorder.GetLeft(),r=this.ChartBorder.GetWidth(),n=i+r/2;this.LatestPoint.X<n&&(this.ShowPosition=1)}},this.DrawBorder=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.GetLeft(),a=this.GetTop();this.Canvas.strokeStyle=this.BorderColor,t?this.Canvas.strokeRect(this.HQChart.ToFixedPoint(e),this.HQChart.ToFixedPoint(a),this.HQChart.ToFixedRect(this.Height),this.HQChart.ToFixedRect(this.Width)):this.Canvas.strokeRect(this.HQChart.ToFixedPoint(e),this.HQChart.ToFixedPoint(a),this.HQChart.ToFixedRect(this.Width),this.HQChart.ToFixedRect(this.Height))},this.DrawBG=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.GetLeft(),a=this.GetTop();this.Canvas.fillStyle=this.BGColor,t?this.Canvas.fillRect(e,a,this.Height,this.Width):this.Canvas.fillRect(e,a,this.Width,this.Height)},this.DrawTooltipData=function(t){var e=o.JSCommonCoordinateData.GetfloatPrecision(this.HQChart.Symbol),a=this.GetLeft()+2,i=this.GetTop()+3;if(this.IsHScreen){this.Canvas.save();var r=this.GetLeft()+this.Height,n=this.GetTop();this.Canvas.translate(r,n),this.Canvas.rotate(90*Math.PI/180),a=2,i=3}this.Canvas.textBaseline="top",this.Canvas.textAlign="left",this.Canvas.font=this.Font[0];var u=this.Canvas.measureText("擎: ").width,C=this.HQChart.FormatDateString(t.Date);this.Canvas.fillStyle=this.TitleColor,this.Canvas.fillText(C,a,i);var D=this.HQChart.Period;s.JSCommon_ChartData.IsMinutePeriod(D,!0)&&l.JSCommonSplit_IFrameSplitOperator.IsNumber(t.Time)?(i+=this.LineHeight,C=this.HQChart.FormatTimeString(t.Time),this.Canvas.fillText(C,a,i)):s.JSCommon_ChartData.IsSecondPeriod(D)&&l.JSCommonSplit_IFrameSplitOperator.IsNumber(t.Time)&&(i+=this.LineHeight,C=this.HQChart.FormatTimeString(t.Time,"HH:MM:SS"),this.Canvas.fillText(C,a,i)),i+=this.LineHeight,this.Canvas.fillStyle=this.TitleColor,C=h.JSCommonResource_Global_JSChartLocalization.GetText("Tooltip-Open",this.LanguageID),this.Canvas.fillText(C,a,i);var m=this.KLineTitlePaint.GetColor(t.Open,t.YClose);C=t.Open.toFixed(e),this.Canvas.fillStyle=m,this.Canvas.fillText(C,a+u,i),i+=this.LineHeight,this.Canvas.fillStyle=this.TitleColor,C=h.JSCommonResource_Global_JSChartLocalization.GetText("Tooltip-High",this.LanguageID),this.Canvas.fillText(C,a,i);m=this.KLineTitlePaint.GetColor(t.High,t.YClose),C=t.High.toFixed(e);this.Canvas.fillStyle=m,this.Canvas.fillText(C,a+u,i),i+=this.LineHeight,this.Canvas.fillStyle=this.TitleColor,C=h.JSCommonResource_Global_JSChartLocalization.GetText("Tooltip-Low",this.LanguageID),this.Canvas.fillText(C,a,i);m=this.KLineTitlePaint.GetColor(t.Low,t.YClose),C=t.Low.toFixed(e);this.Canvas.fillStyle=m,this.Canvas.fillText(C,a+u,i),i+=this.LineHeight,this.Canvas.fillStyle=this.TitleColor,C=h.JSCommonResource_Global_JSChartLocalization.GetText("Tooltip-Close",this.LanguageID),this.Canvas.fillText(C,a,i);var S;m=this.KLineTitlePaint.GetColor(t.Close,t.YClose),C=t.Close.toFixed(e);if(this.Canvas.fillStyle=m,this.Canvas.fillText(C,a+u,i),i+=this.LineHeight,this.Canvas.fillStyle=this.TitleColor,C=h.JSCommonResource_Global_JSChartLocalization.GetText("Tooltip-Increase",this.LanguageID),this.Canvas.fillText(C,a,i),t.YClose>0){var c=(t.Close-t.YClose)/t.YClose*100;m=this.KLineTitlePaint.GetColor(c,0),C=c.toFixed(2)+"%"}else C="--.--",m=this.KLineTitlePaint.GetColor(0,0);if(this.Canvas.fillStyle=m,this.Canvas.fillText(C,a+u,i),this.Canvas.fillStyle=this.TitleColor,l.JSCommonSplit_IFrameSplitOperator.IsNumber(t.Vol)){i+=this.LineHeight,C=h.JSCommonResource_Global_JSChartLocalization.GetText("Tooltip-Vol",this.LanguageID),this.Canvas.fillText(C,a,i);C=this.HQChart.FormatValueString(t.Vol,2,this.LanguageID);this.Canvas.fillText(C,a+u,i)}if(l.JSCommonSplit_IFrameSplitOperator.IsNumber(t.Amount)){i+=this.LineHeight,C=h.JSCommonResource_Global_JSChartLocalization.GetText("Tooltip-Amount",this.LanguageID),this.Canvas.fillText(C,a,i);C=this.HQChart.FormatValueString(t.Amount,2,this.LanguageID);this.Canvas.fillText(C,a+u,i)}if(this.HQChart.Symbol&&(S=this.HQChart.Symbol.toUpperCase()),o.JSCommonCoordinateData_MARKET_SUFFIX_NAME.IsChinaFutures(S)&&l.JSCommonSplit_IFrameSplitOperator.IsNumber(t.Position)){this.Canvas.fillStyle=this.TitleColor,i+=this.LineHeight,C=h.JSCommonResource_Global_JSChartLocalization.GetText("Tooltip-Position",this.LanguageID),this.Canvas.fillText(C,a,i);C=l.JSCommonSplit_IFrameSplitOperator.FormatValueString(t.Position,2,this.LanguageID);this.Canvas.fillText(C,a+u,i)}this.IsHScreen&&this.Canvas.restore()},this.SetOption=function(t){t.LineHeight>0&&(this.LineHeight=t.LineHeight),t.BGColor&&(this.BGColor=t.BGColor),t.LanguageID>0&&(this.LanguageID=t.LanguageID)}}function D(){this.newMethod=C,this.newMethod(),delete this.newMethod,this.ClassName="MinuteTooltipPaint",this.IsShowAveragePrice=!0,this.GetTop=function(){return this.IsHScreen?0==this.ShowPosition?this.ChartBorder.GetTop()+this.Left:this.ChartBorder.GetBottom()-this.Width-this.Left:this.ChartBorder.GetTop()+this.Top},this.GetLeft=function(){return this.IsHScreen?this.ChartBorder.GetRight()-this.Height-this.Top:0==this.ShowPosition?this.ChartBorder.GetLeft()+this.Left:this.ChartBorder.GetRight()-this.Width-this.Left},this.DrawTooltipData=function(t){var e=o.JSCommonCoordinateData.GetfloatPrecision(this.HQChart.Symbol),a=this.GetLeft()+2,i=this.GetTop()+3;if(this.YClose=this.KLineTitlePaint.YClose,this.IsHScreen){this.Canvas.save();var r=this.GetLeft()+this.Height,n=this.GetTop();this.Canvas.translate(r,n),this.Canvas.rotate(90*Math.PI/180),a=2,i=3}this.Canvas.textBaseline="top",this.Canvas.textAlign="left",this.Canvas.font=this.Font[0];var s=this.Canvas.measureText("擎: ").width,u=t.DateTime.split(" ");if(u&&2==u.length){var C=this.HQChart.FormatDateString(u[0]);this.Canvas.fillStyle=this.TitleColor,this.Canvas.fillText(C,a,i),i+=this.LineHeight,C=this.HQChart.FormatTimeString(u[1]),this.Canvas.fillText(C,a,i)}i+=this.LineHeight,this.Canvas.fillStyle=this.TitleColor,C=h.JSCommonResource_Global_JSChartLocalization.GetText("Tooltip-Price",this.LanguageID),this.Canvas.fillText(C,a,i);var D=this.KLineTitlePaint.GetColor(t.Close,this.YClose);if(C=t.Close.toFixed(e),this.Canvas.fillStyle=D,this.Canvas.fillText(C,a+s,i),l.JSCommonSplit_IFrameSplitOperator.IsNumber(t.AvPrice)&&1==this.IsShowAveragePrice){i+=this.LineHeight,this.Canvas.fillStyle=this.TitleColor,C=h.JSCommonResource_Global_JSChartLocalization.GetText("Tooltip-AvPrice",this.LanguageID),this.Canvas.fillText(C,a,i);D=this.KLineTitlePaint.GetColor(t.AvPrice,this.YClose),C=t.AvPrice.toFixed(e);this.Canvas.fillStyle=D,this.Canvas.fillText(C,a+s,i)}i+=this.LineHeight,this.Canvas.fillStyle=this.TitleColor,C=h.JSCommonResource_Global_JSChartLocalization.GetText("Tooltip-Increase",this.LanguageID),this.Canvas.fillText(C,a,i);var m,S=(t.Close-this.YClose)/this.YClose*100;D=this.KLineTitlePaint.GetColor(S,0),C=S.toFixed(2)+"%";if(this.Canvas.fillStyle=D,this.Canvas.fillText(C,a+s,i),l.JSCommonSplit_IFrameSplitOperator.IsNumber(t.Vol)){this.Canvas.fillStyle=this.TitleColor,i+=this.LineHeight,C=h.JSCommonResource_Global_JSChartLocalization.GetText("Tooltip-Vol",this.LanguageID),this.Canvas.fillText(C,a,i);C=this.HQChart.FormatValueString(t.Vol,2,this.LanguageID);this.Canvas.fillText(C,a+s,i)}if(l.JSCommonSplit_IFrameSplitOperator.IsNumber(t.Amount)){i+=this.LineHeight,C=h.JSCommonResource_Global_JSChartLocalization.GetText("Tooltip-Amount",this.LanguageID),this.Canvas.fillText(C,a,i);C=this.HQChart.FormatValueString(t.Amount,2,this.LanguageID);this.Canvas.fillText(C,a+s,i)}if(this.HQChart.Symbol&&(m=this.HQChart.Symbol.toUpperCase()),o.JSCommonCoordinateData_MARKET_SUFFIX_NAME.IsChinaFutures(m)&&l.JSCommonSplit_IFrameSplitOperator.IsNumber(t.Position)){this.Canvas.fillStyle=this.TitleColor,i+=this.LineHeight,C=h.JSCommonResource_Global_JSChartLocalization.GetText("Tooltip-Position",this.LanguageID),this.Canvas.fillText(C,a,i);C=l.JSCommonSplit_IFrameSplitOperator.FormatValueString(t.Position,2,this.LanguageID);this.Canvas.fillText(C,a+s,i)}this.IsHScreen&&this.Canvas.restore()}}function m(){this.PlayList=[],this.Cache=[],this.MinLineHeight=40,this.Height,this.Step=1,this.GetPlayList=function(t){for(var e=t.Canves,a=t.Right,i=t.Left,r=a-i,n=t.IsMoveStep,s=[],o=0,h=0;h<this.PlayList.length;++h){var l=this.PlayList[h],u=this.MinLineHeight;l.Height>this.MinLineHeight&&(u=l.Height);for(var C=!0,D=!1,m=0;m<l.Data.length;++m){var S=l.Data[m],c={X:S.X,Y:o,Text:S.Text,Color:S.Color,Height:u,Font:S.Font,Info:S.Info};s.push(c),n&&(m==l.Data.length-1&&this.Cache.length>0?(C=!1,S.TextWidth||(S.Font&&S.Font.Name?e.font=S.Font.Name:e.font=t.Font,S.TextWidth=e.measureText(c.Text+"擎擎").width),S.X>=S.TextWidth&&(C=!0)):0==m&&(D=!1,S.TextWidth||(S.Font&&S.Font.Name?e.font=S.Font.Name:e.font=t.Font,S.TextWidth=e.measureText(c.Text+"擎擎").width),S.X>r+S.TextWidth&&(D=!0)),S.X+=this.Step)}if(n&&C&&this.Cache.length>0){var f=this.Cache.shift(),d={X:0,Text:f.Text,Color:f.Color,Font:f.Font,Info:f.Info};l.Data.push(d)}if(n&&D&&l.Data.length>0){var I=l.Data.shift();this.OnItemPlayEnd(t.HQChart,I)}o+=u}return s},this.CacluatePlayLine=function(t){this.Height=t;var e=parseInt(t/this.MinLineHeight);if(this.PlayList.length<e)for(var a=e-this.PlayList.length,i=0;i<a;++i)this.PlayList.push({Data:[]});else if(this.PlayList.length>e){var r=this.PlayList.length-e;for(i=0;i<r;++i)for(var s=this.PlayList.pop(),o=0;o<s.Data.length;++o){var h=s.Data[o],l={Text:h.Text,Color:h.Color,Font:h.Font,Info:h.Info};this.Cache.unshift(l)}}n.JSConsole.Chart.Log("[BarrageList::CacluatePlayLine] LineCount=".concat(this.PlayList.length," Height=").concat(this.Height))},this.AddBarrage=function(t){for(var e in t){var a=t[e];this.Cache.push(a)}},this.OnItemPlayEnd=function(t,e){var a=t.GetBarrageEvent();a&&a.Callback&&a.Callback(a,e,this)},this.Count=function(){return this.Cache.length}}function S(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.ClassName="BackgroundPaint",this.IsDynamic=!1,this.IsCallbackDraw=!0,this.FrameID=0,this.Data,this.ID=(0,s.JSCommon_Guid)(),this.ChartSubFrame,this.ChartBorder,this.KData,this.Period,this.XPointCount=0,this.SetOption=function(t){t.FrameID>0&&(this.FrameID=t.FrameID),l.JSCommonSplit_IFrameSplitOperator.IsObjectExist(t.ID)&&(this.ID=t.ID)},this.Draw=function(){if(this.Data&&this.HQChart&&this.ChartFrame&&this.ChartFrame.SubFrame&&!(this.ChartFrame.SubFrame.length<=this.FrameID)){var t=this.HQChart.ChartPaint[0];if(t&&t.Data&&(this.ChartSubFrame=this.ChartFrame.SubFrame[this.FrameID].Frame,this.ChartBorder=this.ChartSubFrame.ChartBorder,this.KData=t.Data,this.Period=this.HQChart.Period,this.KData&&!(this.KData.Data.length<=0))){var e=!0===this.ChartSubFrame.IsHScreen;this.XPointCount=this.ChartSubFrame.XPointCount;var a=this.ChartSubFrame.XPointCount,i=this.KData.Data[this.KData.DataOffset],r=this.KData.DataOffset+a-1;r>=this.KData.Data.length&&(r=this.KData.Data.length-1);var n=this.KData.Data[r],o=this.GetShowData(i,n);if(o&&!(o.length<=0)){var h=this.BuildKLineMap(),l=this.ChartBorder.GetBottomEx(),u=this.ChartBorder.GetTopEx(),C=this.ChartBorder.GetHeightEx();for(var D in e&&(u=this.ChartBorder.GetRightEx(),l=this.ChartBorder.GetLeftEx(),C=this.ChartBorder.GetWidthEx()),o){var m=o[D],S=this.GetBGCoordinate(m,h);if(S){if(Array.isArray(m.Color)){var c;c=e?this.Canvas.createLinearGradient(l,S.Left,u,S.Left):this.Canvas.createLinearGradient(S.Left,u,S.Left,l);var f=1/m.Color.length;for(var D in m.Color)c.addColorStop(D*f,m.Color[D]);this.Canvas.fillStyle=c}else this.Canvas.fillStyle=m.Color;e?this.Canvas.fillRect((0,s.JSCommon_ToFixedRect)(l),(0,s.JSCommon_ToFixedRect)(S.Left),(0,s.JSCommon_ToFixedRect)(C),(0,s.JSCommon_ToFixedRect)(S.Width)):this.Canvas.fillRect((0,s.JSCommon_ToFixedRect)(S.Left),(0,s.JSCommon_ToFixedRect)(u),(0,s.JSCommon_ToFixedRect)(S.Width),(0,s.JSCommon_ToFixedRect)(C))}}}}}},this.GetShowData=function(t,e){var a=[];for(var i in this.Data){var r=this.Data[i],n={};r.Start.Date>=t.Date&&r.Start.Date<=e.Date&&(n.Start=r.Start),r.End.Date>=t.Date&&r.End.Date<=e.Date&&(n.End=r.End),(n.Start||n.End)&&(n.Color=r.Color,a.push(n))}return a},this.BuildKLineMap=function(){var t=!0===this.ChartSubFrame.IsHScreen,e=this.ChartSubFrame.DataWidth,a=this.ChartSubFrame.DistanceWidth,i=this.ChartBorder.GetLeft()+a/2+h.JSCommonResource_Global_JSChartResource.FrameLeftMargin;t&&(i=this.ChartBorder.GetTop()+a/2+h.JSCommonResource_Global_JSChartResource.FrameLeftMargin);var r=this.ChartBorder.GetRight();t&&(r=this.ChartBorder.GetBottom());for(var n={Data:new Map},o=this.KData.DataOffset,l=0;o<this.KData.Data.length&&l<this.XPointCount;++o,++l,i+=e+a){var u=this.KData.Data[o],C=i,D=i+e;if(D>r)break;var m=C+(D-C)/2;0==l&&(n.XLeft=C),n.XRight=D;var S={Index:o,ShowIndex:l,X:m,Right:D,Left:C,Date:u.Date};if(s.JSCommon_ChartData.IsMinutePeriod(this.Period,!0)){var c="Date:".concat(u.Date," Time:").concat(u.Time);S.Time=u.Time}else c="Date:".concat(u.Date);n.Data.set(c,S)}return n},this.GetBGCoordinate=function(t,e){var a=null,i=null;if(t.Start){if(s.JSCommon_ChartData.IsMinutePeriod(this.Period,!0))var n="Date:".concat(t.Start.Date," Time:").concat(t.Start.Time);else n="Date:".concat(t.Start.Date);if(e.Data.has(n)){var o=e.Data.get(n);a=o.Left}else{var h,l=(0,r.default)(e.Data);try{for(l.s();!(h=l.n()).done;){var u=h.value,C=u[1];if(C.Date>t.Start.Date){a=C.Left;break}}}catch(c){l.e(c)}finally{l.f()}}}else a=e.XLeft;if(t.End){if(s.JSCommon_ChartData.IsMinutePeriod(this.Period,!0))n="Date:".concat(t.End.Date," Time:").concat(t.End.Time);else n="Date:".concat(t.End.Date);if(e.Data.has(n)){o=e.Data.get(n);i=o.Right}else{var D,m=null,S=(0,r.default)(e.Data);try{for(S.s();!(D=S.n()).done;){u=D.value,C=u[1];if(C.Date>t.End.Date){i=m;break}m=C.Right}}catch(c){S.e(c)}finally{S.f()}}}else i=e.XRight;return null==a||null==i?null:{Left:a,Right:i,Width:i-a}}}function c(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.ClassName="BarragePaint",this.IsAnimation=!0,this.IsEraseBG=!0,this.HQChart,this.Font=h.JSCommonResource_Global_JSChartResource.Barrage.Font,this.TextColor=h.JSCommonResource_Global_JSChartResource.Barrage.Color,this.FontHeight=h.JSCommonResource_Global_JSChartResource.Barrage.Height,this.BarrageList=new m,this.IsMoveStep=!1,this.SetOption=function(t){t&&(t.Step>0&&(this.BarrageList.Step=t.Step),t.MinLineHeight&&(this.Barrage.MinLineHeight=t.MinLineHeight))},this.DrawHScreen=function(){var t=this.ChartBorder.GetWidth(),e=this.ChartBorder.GetTop(),a=this.ChartBorder.GetBottom(),i=this.ChartBorder.GetRightEx();this.ChartBorder.GetChartWidth();t!=this.BarrageList.Height&&this.BarrageList.CacluatePlayLine(t),this.Canvas.textBaseline="middle",this.Canvas.textAlign="left";var r=this.BarrageList.GetPlayList({Canves:this.Canvas,Right:a,Left:e,Font:this.Font,IsMoveStep:this.IsMoveStep,HQChart:this.HQChart});if(this.IsMoveStep=!1,r){this.Canvas.save(),this.Canvas.translate(this.ChartBorder.GetChartHeight(),0),this.Canvas.rotate(90*Math.PI/180);for(var n=0;n<r.length;++n){var s=r[n];s.Color?this.Canvas.fillStyle=s.Color:this.Canvas.fillStyle=this.TextColor,s.Font?this.Canvas.font=s.Font.Name:this.Canvas.font=this.Font;var o=this.FontHeight;s.Font&&s.Font.Height>0&&(o=s.Font.Height);var h=s.Y+parseInt((s.Height-o)/2);this.Canvas.fillText(s.Text,a-s.X,i+h)}this.Canvas.restore()}},this.Draw=function(){if(this.ChartFrame.IsHScreen)this.DrawHScreen();else{var t=this.ChartBorder.GetLeft(),e=this.ChartBorder.GetRight(),a=this.ChartBorder.GetTopEx(),i=this.ChartBorder.GetHeight();i!=this.BarrageList.Height&&this.BarrageList.CacluatePlayLine(i),this.Canvas.textBaseline="middle",this.Canvas.textAlign="left";var r=this.BarrageList.GetPlayList({Canves:this.Canvas,Right:e,Left:t,Font:this.Font,IsMoveStep:this.IsMoveStep,HQChart:this.HQChart});if(this.IsMoveStep=!1,r)for(var n=0;n<r.length;++n){var s=r[n];s.Color?this.Canvas.fillStyle=s.Color:this.Canvas.fillStyle=this.TextColor,s.Font?this.Canvas.font=s.Font.Name:this.Canvas.font=this.Font;var o=this.FontHeight;s.Font&&s.Font.Height>0&&(o=s.Font.Height);var h=s.Y+parseInt((s.Height-o)/2);this.Canvas.fillText(s.Text,e-s.X,a+h)}}}}t.exports={JSCommonExtendChartPaint:{IExtendChartPainting:u,KLineTooltipPaint:C,BarragePaint:c,MinuteTooltipPaint:D,BackgroundPaint:S},JSCommonExtendChartPaint_IExtendChartPainting:u,JSCommonExtendChartPaint_KLineTooltipPaint:C,JSCommonExtendChartPaint_BarragePaint:c,JSCommonExtendChartPaint_MinuteTooltipPaint:D,JSCommonExtendChartPaint_BackgroundPaint:S}},"9dc6":function(t,e,a){"use strict";a("c975"),a("4ec9"),a("d3b7"),a("e25e"),a("ac1f"),a("25f0"),a("3ca3"),a("5319"),a("ddb0");var i=a("90f8"),r=a("5946"),n=a("e78a"),s=a("621d"),o=a("dbf1");function h(t,e){this.Name=t,this.Param=e,this.LineColor,this.ReqeustData=null}function l(t){this.Index,this.Name=t,this.UpdateUICallback,this.Create=function(t,e){for(var a in this.Index)if(this.Index[a].Name){var i=new n.JSCommonChartPaint_ChartLine;i.Canvas=t.Canvas,i.Name=this.Name+"-"+a.toString(),i.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,i.ChartFrame=t.Frame.SubFrame[e].Frame,i.Color=this.Index[a].LineColor,t.ChartPaint.push(i)}},this.NotSupport=function(t,e,a){var i=t.GetChartPaint(e);for(var r in i)i[r].Data.Data=[],0==r&&(i[r].NotSupportMessage=a)},this.FormatIndexTitle=function(){var t=this.Name,e=null;for(var a in this.Index){var i=this.Index[a];null!=i.Param&&(e?e+=","+i.Param.toString():e=i.Param.toString())}return e&&(t+="("+e+")"),t},this.InvokeUpdateUICallback=function(t){if("function"==typeof this.UpdateUICallback){var e=new Array;for(var a in t)e.push({Name:this.Index[a].Name,Data:t[a].Data});this.UpdateUICallback(e)}}}function u(t,e,a,h){this.newMethod=l,this.newMethod(t),delete this.newMethod,this.Script=e,this.Arguments=[],this.OutVar=[],this.ID,this.FloatPrecision=2,this.StringFormat,this.KLineType=null,this.InstructionType,this.YSpecificMaxMin=null,this.YSplitScale=null,this.OutName=null,this.IsLocked=!1,this.LockCallback=null,this.LockID=null,this.LockBG=null,this.LockTextColor=null,this.LockText=null,this.LockFont=null,this.LockCount=10,h&&(h.FloatPrecision>=0&&(this.FloatPrecision=h.FloatPrecision),h.StringFormat>0&&(this.StringFormat=h.StringFormat),h.ID&&(this.ID=h.ID),h.KLineType&&(this.KLineType=h.KLineType),h.InstructionType&&(this.InstructionType=h.InstructionType),h.YSpecificMaxMin&&(this.YSpecificMaxMin=h.YSpecificMaxMin),h.YSplitScale&&(this.YSplitScale=h.YSplitScale),h.OutName&&(this.OutName=h.OutName)),h&&h.Lock&&(1==h.Lock.IsLocked&&(this.IsLocked=!0),h.Lock.Callback&&(this.LockCallback=h.Lock.Callback),h.Lock.ID&&(this.LockID=h.Lock.ID),h.Lock.BG&&(this.LockBG=h.Lock.BG),h.Lock.TextColor&&(this.LockTextColor=h.Lock.TextColor),h.Lock.Text&&(this.LockText=h.Lock.Text),h.Lock.Font&&(this.LockFont=h.Lock.Font),h.Lock.Count&&(this.LockCount=h.Lock.Count)),a&&(this.Arguments=a),this.SetLock=function(t){1==t.IsLocked?(this.IsLocked=!0,t.Callback&&(this.LockCallback=t.Callback),t.ID&&(this.LockID=t.ID),t.BG&&(this.LockBG=t.BG),t.TextColor&&(this.LockTextColor=t.TextColor),t.Text&&(this.LockText=t.Text),t.Font&&(this.LockFont=t.Font),t.Count&&(this.LockCount=t.Count)):(this.IsLocked=!1,this.LockCallback=null,this.LockID=null,this.LockBG=null,this.LockTextColor=null,this.LockText=null,this.LockFont=null,this.LockCount=10)},this.ExecuteScript=function(t,e,a){this.OutVar=[];var i={HQChart:t,WindowIndex:e,HistoryData:a,Self:this},n=0;"MinuteChartContainer"===t.ClassName&&(n=2);var s={HQDataType:n,Symbol:t.Symbol,Data:a,SourceData:t.SourceData,Callback:this.RecvResultData,CallbackParam:i,Async:!0,MaxReqeustDataCount:t.MaxReqeustDataCount,MaxRequestMinuteDayCount:t.MaxRequestMinuteDayCount,Arguments:this.Arguments};t.NetworkFilter&&(s.NetworkFilter=t.NetworkFilter);var o=this.Script;r.JSCommonComplier.JSComplier.Execute(o,s,t.ScriptErrorCallback)},this.RecvResultData=function(t,e){var a=e.HQChart,i=e.WindowIndex,r=e.HistoryData;if(e.Self.OutVar=t,e.Self.BindData(a,i,r),0==e.Self.IsLocked)e.HQChart.Frame.SubFrame[i].Frame.SetLock(null);else{var n={IsLocked:!0,Callback:e.Self.LockCallback,IndexName:e.Self.Name,ID:e.Self.LockID,BG:e.Self.LockBG,Text:e.Self.LockText,TextColor:e.Self.LockTextColor,Font:e.Self.LockFont,Count:e.Self.LockCount};e.HQChart.Frame.SubFrame[i].Frame.SetLock(n)}e.HQChart.UpdataDataoffset(),e.HQChart.UpdateFrameMaxMin(),e.HQChart.Draw();var s=a.GetIndexEvent();if(s){var o=e.Self,h={OutVar:o.OutVar,WindowIndex:i,Name:o.Name,Arguments:o.Arguments,HistoryData:r,Stock:{Symbol:a.Symbol,Name:a.Name}};s.Callback(s,h,o)}},this.CreateLine=function(t,e,a,i){var r=new n.JSCommonChartPaint_ChartLine;if(r.Canvas=t.Canvas,r.DrawType=1,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),0==a.IsShow&&(r.IsShow=!1),a.LineWidth){var h=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(h)&&h>0&&(r.LineWidth=h)}a.IsDotLine&&(r.IsDotLine=!0),0==a.IsShow&&(r.IsShow=!1);var l=e+1;r.Data.Data=a.Data,!1===a.IsShowTitle||s.JSCommonSplit_IFrameSplitOperator.IsString(a.Name)&&0==a.Name.indexOf("NOTEXT")||(t.TitlePaint[l].Data[i]=new o.JSCommonChartTitle_DynamicTitleData(r.Data,1==a.NoneName?null:a.Name,r.Color)),t.ChartPaint.push(r)},this.CreateOverlayLine=function(t,e,a,i){var r=new n.JSCommonChartPaint_ChartSubLine;if(r.Canvas=t.Canvas,r.DrawType=1,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),a.LineWidth){var s=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(s)&&s>0&&(r.LineWidth=s)}a.IsDotLine&&(r.IsDotLine=!0),0==a.IsShow&&(r.IsShow=!1);var h=e+1;r.Data.Data=a.Data,t.TitlePaint[h].Data[i]=new o.JSCommonChartTitle_DynamicTitleData(r.Data,a.Name,r.Color),t.ChartPaint.push(r)},this.CreateBar=function(t,e,a,i){var r=new n.JSCommonChartPaint_ChartStickLine;r.Canvas=t.Canvas,a.Draw.Width>0?r.LineWidth=a.Draw.Width:r.LineWidth=1,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i);r.Data.Data=a.Draw.DrawData,r.BarType=a.Draw.Type,t.ChartPaint.push(r)},this.CreateText=function(t,e,a,i){var r=new n.JSCommonChartPaint_ChartSingleText;r.Canvas=t.Canvas,r.TextAlign="left",r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.ReloadResource(),a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i);a.Draw.Position&&(r.Position=a.Draw.Position),a.Draw.DrawData&&(r.Data.Data=a.Draw.DrawData),r.Text=a.Draw.Text,a.Draw.Direction>0&&(r.Direction=a.Draw.Direction),a.Draw.YOffset>0&&(r.YOffset=a.Draw.YOffset),a.Draw.TextAlign&&(r.TextAlign=a.Draw.TextAlign),t.ChartPaint.push(r)},this.CreateMACD=function(t,e,a,i){var r=new n.JSCommonChartPaint_ChartMACD;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.LineWidth){var s=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(s)&&s>0&&(r.LineWidth=s)}var h=e+1;r.Data.Data=a.Data;var l=this.GetDefaultColor(i);a.Color&&(l=this.GetColor(a.Color)),t.TitlePaint[h].Data[i]=new o.JSCommonChartTitle_DynamicTitleData(r.Data,a.Name,l),t.ChartPaint.push(r)},this.CreatePointDot=function(t,e,a,i){var r=new n.JSCommonChartPaint_ChartPointDot;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),a.Radius&&(r.Radius=a.Radius),a.LineWidth){var s=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(s)&&s>0&&(r.Radius=s)}var h=e+1;r.Data.Data=a.Data,t.TitlePaint[h].Data[i]=new o.JSCommonChartTitle_DynamicTitleData(r.Data,a.Name,r.Color),t.ChartPaint.push(r)},this.CreateStick=function(t,e,a,i){var r=new n.JSCommonChartPaint_ChartStick;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),a.LineWidth){var s=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(s)&&s>0&&(r.LineWidth=s)}var h=e+1;r.Data.Data=a.Data,t.TitlePaint[h].Data[i]=new o.JSCommonChartTitle_DynamicTitleData(r.Data,a.Name,r.Color),t.ChartPaint.push(r)},this.CreateLineStick=function(t,e,a,i){var r=new n.JSCommonChartPaint_ChartLineStick;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),a.LineWidth){var s=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(s)&&s>0&&(r.LineWidth=s)}var h=e+1;r.Data.Data=a.Data,t.TitlePaint[h].Data[i]=new o.JSCommonChartTitle_DynamicTitleData(r.Data,a.Name,r.Color),t.ChartPaint.push(r)},this.CreateStraightLine=function(t,e,a,i){var r=new n.JSCommonChartPaint_ChartLine;if(r.DrawType=1,r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),a.LineWidth){var s=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(s)&&s>0&&(r.LineWidth=s)}r.Data.Data=a.Draw.DrawData,t.ChartPaint.push(r)},this.CreateVolStick=function(t,e,a,i,r){var s=new n.JSCommonChartPaint_ChartVolStick;s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,s.ChartFrame=t.Frame.SubFrame[e].Frame,s.KLineDrawType=t.KLineDrawType,a.Color?s.Color=this.GetColor(a.Color):s.Color=this.GetDefaultColor(i);var h=e+1;s.Data.Data=a.Data,s.HistoryData=r,t.TitlePaint[h].Data[i]=new o.JSCommonChartTitle_DynamicTitleData(s.Data,a.Name,s.Color),t.ChartPaint.push(s)},this.CreateBand=function(t,e,a,i){var r=new n.JSCommonChartPaint_ChartBand;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.FirstColor=a.Draw.Color[0],r.SecondColor=a.Draw.Color[1],r.Data.Data=a.Draw.DrawData,t.ChartPaint.push(r)},this.CreatePolyLine=function(t,e,a,i){var r=new n.JSCommonChartPaint_ChartLine;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),a.LineWidth){var s=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(s)&&s>0&&(r.LineWidth=s)}r.Data.Data=a.Draw.DrawData,t.ChartPaint.push(r)},this.CreateKLine=function(t,e,a,i){var r=new n.JSCommonChartPaint_ChartKLine;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Data.Data=a.Draw.DrawData,r.IsShowMaxMinPrice=!1,a.Color&&(r.UnchagneColor=r.DownColor=r.UpColor=this.GetColor(a.Color)),t.ChartPaint.push(r)},this.CreateNumberText=function(t,e,a,i){var r=new n.JSCommonChartPaint_ChartSingleText;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.ReloadResource(),r.TextAlign="center",a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),a.IsDrawAbove?r.Direction=1:r.Direction=2;r.Data.Data=a.Draw.DrawData.Value,r.Text=a.Draw.DrawData.Text,t.ChartPaint.push(r)},this.CreateIcon=function(t,e,a,i){var r=new n.JSCommonChartPaint_ChartSingleText;r.Canvas=t.Canvas,r.TextAlign="center",r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame;r.Data.Data=a.Draw.DrawData,r.Text=a.Draw.Icon.Symbol,a.Color?r.Color=this.GetColor(a.Color):a.Draw.Icon.Color?r.Color=a.Draw.Icon.Color:r.Color="rgb(0,0,0)",t.ChartPaint.push(r)},this.CreateRectangle=function(t,e,a,i){var r=new n.JSCommonChartPaint_ChartRectangle;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Color=[a.Draw.DrawData.Color],r.Rect=a.Draw.DrawData.Rect,a.Color&&(r.BorderColor=this.GetColor(a.Color)),t.ChartPaint.push(r)},this.CreateBackgroud=function(t,e,a,i){var r=new n.JSCommonChartPaint_ChartBackground;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Draw&&a.Draw.DrawData){var s=a.Draw.DrawData;r.Color=s.Color,r.ColorAngle=s.Angle,s.Data&&(r.Data.Data=s.Data)}t.ChartPaint.push(r)},this.CreateMultiText=function(t,e,a,i){var r=new n.JSCommonChartPaint_ChartMultiText;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Data=t.ChartPaint[0].Data,r.Texts=a.Draw.DrawData,t.ChartPaint.push(r)},this.CreateMulitHtmlDom=function(t,e,a,i){var r=new n.JSCommonChartPaint_ChartMultiHtmlDom;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Data=t.ChartPaint[0].Data,r.Texts=a.Draw.DrawData,r.DrawCallback=a.Draw.Callback,t.ChartPaint.push(r)},this.CreateMultiLine=function(t,e,a,i){var r=new n.JSCommonChartPaint_ChartMultiLine;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Data=t.ChartPaint[0].Data,r.Lines=a.Draw.DrawData,t.ChartPaint.push(r)},this.CreateMultiBar=function(t,e,a,i){var r=new n.JSCommonChartPaint_ChartMultiBar;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Data=t.ChartPaint[0].Data,r.Bars=a.Draw.DrawData,t.ChartPaint.push(r)},this.CreateSelfKLine=function(t,e,a){var i=new n.JSCommonChartPaint_ChartKLine;i.Canvas=t.Canvas,i.Name="Self Kline",i.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,i.ChartFrame=t.Frame.SubFrame[e].Frame,i.Data=a,i.IsShowMaxMinPrice=!1,i.IsShowKTooltip=!1,i.DrawType=this.KLineType,t.ChartPaint.push(i)},this.BindInstructionData=function(t,e,a){if(!(null==this.OutVar||this.OutVar.length<0)){if(2==this.InstructionType){var i=this.OutVar[this.OutVar.length-1];return t.SetInstructionData(this.InstructionType,{Data:i.Data}),!0}if(1==this.InstructionType){var r,n;for(var s in this.OutVar){var o=this.OutVar[s];"ENTERLONG"==o.Name?r=o.Data:"EXITLONG"==o.Name&&(n=o.Data)}return t.SetInstructionData(this.InstructionType,{Buy:r,Sell:n}),!0}}},this.BindData=function(t,e,a){if(0==e&&this.InstructionType)this.BindInstructionData(t,e,a);else if(t.DeleteIndexPaint(e),0==e&&t.ShowKLine(!0),!(null==this.OutVar||this.OutVar.length<0)){for(var i in null!=this.KLineType&&(0===this.KLineType||1===this.KLineType||2===this.KLineType?this.CreateSelfKLine(t,e,a):-1===this.KLineType&&0==e&&t.ShowKLine(!1)),e>=1&&t.Frame&&(t.Frame.SubFrame[e].Frame.YSplitOperator.FloatPrecision=this.FloatPrecision,this.YSpecificMaxMin&&(t.Frame.SubFrame[e].Frame.YSpecificMaxMin=this.YSpecificMaxMin),this.YSplitScale&&(t.Frame.SubFrame[e].Frame.YSplitScale=this.YSplitScale)),this.OutVar){var r=this.OutVar[i];if(!0!==r.IsExData){if(0==r.Type)r.IsOverlayLine?this.CreateOverlayLine(t,e,r,i):this.CreateLine(t,e,r,i);else if(1==r.Type)switch(r.Draw.DrawType){case"STICKLINE":this.CreateBar(t,e,r,i);break;case"DRAWTEXT":case"SUPERDRAWTEXT":case"DRAWTEXT_FIX":this.CreateText(t,e,r,i);break;case"DRAWLINE":this.CreateStraightLine(t,e,r,i);break;case"DRAWBAND":this.CreateBand(t,e,r,i);break;case"DRAWKLINE":this.CreateKLine(t,e,r,i);break;case"DRAWKLINE_IF":this.CreateKLine(t,e,r,i);break;case"POLYLINE":this.CreatePolyLine(t,e,r,i);break;case"DRAWNUMBER":this.CreateNumberText(t,e,r,i);break;case"DRAWICON":this.CreateIcon(t,e,r,i);break;case"DRAWRECTREL":this.CreateRectangle(t,e,r,i);break;case"DRAWGBK":case"DRAWGBK2":this.CreateBackgroud(t,e,r,i);break;case"MULTI_TEXT":this.CreateMultiText(t,e,r,i);break;case"MULTI_HTMLDOM":this.CreateMulitHtmlDom(t,e,r,i);break;case"MULTI_LINE":this.CreateMultiLine(t,e,r,i);break;case"MULTI_BAR":this.CreateMultiBar(t,e,r,i);break;case"KLINE_BG":this.CreateBackgroud(t,e,r,i);break}else 2==r.Type?this.CreateMACD(t,e,r,i):3==r.Type?this.CreatePointDot(t,e,r,i):4==r.Type?this.CreateLineStick(t,e,r,i):5==r.Type?this.CreateStick(t,e,r,i):6==r.Type&&this.CreateVolStick(t,e,r,i,a);var n=t.TitlePaint[e+1];n&&n.Data&&i<n.Data.length&&(this.StringFormat>0&&(n.Data[i].StringFormat=this.StringFormat),this.FloatPrecision>=0&&(n.Data[i].FloatPrecision=this.FloatPrecision),this.OutName&&this.OutName.length>0&&this.Arguments&&this.Arguments.length>0&&n.SetDynamicOutName(this.OutName,this.Arguments))}}var s=e+1;t.TitlePaint[s].Title=this.Name;var o="";for(var h in this.Arguments){var l=this.Arguments[h];o.length>0&&(o+=","),o+=l.Value.toString()}return o.length>0&&(t.TitlePaint[s].Title=this.Name+"("+o+")"),t.UpdateUICallback&&t.UpdateUICallback("ScriptIndex",this.OutVar,{WindowIndex:e,Name:this.Name,Arguments:this.Arguments,HistoryData:a}),!0}},this.GetDefaultColor=function(t){var e=i.JSCommonResource_Global_JSChartResource.ColorArray,a=parseInt(t);return e[a%(e.length-1)]},this.GetColor=function(t){var e=new Map([["COLORBLACK","rgb(0,0,0)"],["COLORBLUE","rgb(18,95,216)"],["COLORGREEN","rgb(25,158,0)"],["COLORCYAN","rgb(0,255,198)"],["COLORRED","rgb(238,21,21)"],["COLORMAGENTA","rgb(255,0,222)"],["COLORBROWN","rgb(149,94,15)"],["COLORLIGRAY","rgb(218,218,218)"],["COLORGRAY","rgb(133,133,133)"],["COLORLIBLUE","rgb(94,204,255)"],["COLORLIGREEN","rgb(183,255,190)"],["COLORLICYAN","rgb(154,255,242)"],["COLORLIRED","rgb(255,172,172)"],["COLORLIMAGENTA","rgb(255,145,241)"],["COLORWHITE","rgb(255,255,255)"],["COLORYELLOW","rgb(255,198,0)"]]);return e.has(t)?e.get(t):0==t.indexOf("COLOR")?"#"+t.substr(5):"rgb(30,144,255)"}}t.exports={JSCommonIndex:{IndexInfo:h,BaseIndex:l,ScriptIndex:u},JSCommonIndex_IndexInfo:h,JSCommonIndex_BaseIndex:l,JSCommonIndex_ScriptIndex:u}},a0cd:function(t,e){var a={Chart:{Log:console.log,Warn:console.warn},Complier:{Log:console.log,Warn:console.warn}};t.exports={JSConsole:{Chart:a.Chart,Complier:a.Complier}}},a401:function(t,e,a){"use strict";a("4ec9"),a("d3b7"),a("6062"),a("3ca3"),a("ddb0");var i=a("90f8"),r={INVESTOR:1,ANNOUNCEMENT:2,PFORECAST:3,ANNOUNCEMENT_QUARTER_1:4,ANNOUNCEMENT_QUARTER_2:5,ANNOUNCEMENT_QUARTER_3:6,ANNOUNCEMENT_QUARTER_4:7,RESEARCH:8,BLOCKTRADING:9,TRADEDETAIL:10,POLICY:11};function n(){this.ID,this.Date,this.Title,this.InfoType,this.ExtendData}function s(){}function o(){this.MaxReqeustDataCount=1e3,this.StartDate=20160101,this.Data,this.GetToday=function(){var t=new Date,e=1e4*t.getFullYear()+100*(t.getMonth()+1)+t.getDate();return e}}function h(){this.newMethod=o,this.newMethod(),delete this.newMethod,this.RequestData=function(t){var e=this,a={HQChart:t};return this.Data=[],wx.request({url:i.JSCommonResource_Global_JSChartResource.Domain+i.JSCommonResource_Global_JSChartResource.KLine.Info.Investor.ApiUrl,data:{filed:["question","answerdate","symbol","id"],symbol:[a.HQChart.Symbol],querydate:{StartDate:this.StartDate,EndDate:this.GetToday()},start:0,end:this.MaxReqeustDataCount},method:"post",dataType:"json",success:function(t){e.RecvData(t,a)}}),!0},this.RecvData=function(t,e){var a=t.data;if(a&&a.list&&!(a.list.length<=0)){for(var i in a.list){var s=a.list[i],o=new n;o.Date=s.answerdate,o.Title=s.question,o.InfoType=r.INVESTOR,this.Data.push(o)}e.HQChart.UpdataChartInfo(),e.HQChart.Draw()}}}function l(){this.newMethod=o,this.newMethod(),delete this.newMethod,this.RequestData=function(t){var e=this,a={HQChart:t};return this.Data=[],wx.request({url:i.JSCommonResource_Global_JSChartResource.Domain+i.JSCommonResource_Global_JSChartResource.KLine.Info.Announcement.ApiUrl,data:{filed:["title","releasedate","symbol","id"],symbol:[a.HQChart.Symbol],querydate:{StartDate:this.StartDate,EndDate:this.GetToday()},start:0,end:this.MaxReqeustDataCount},method:"post",dataType:"json",success:function(t){e.RecvData(t,a)}}),!0},this.RecvData=function(t,e){var a=t.data;if(a&&a.report&&!(a.report.length<=0)){for(var i in a.report){var s=a.report[i],o=new n;for(var h in o.Date=s.releasedate,o.Title=s.title,o.InfoType=r.ANNOUNCEMENT,s.type){var l=s.type[h];switch(l){case"一季度报告":o.InfoType=r.ANNOUNCEMENT_QUARTER_1;break;case"半年度报告":o.InfoType=r.ANNOUNCEMENT_QUARTER_2;break;case"三季度报告":o.InfoType=r.ANNOUNCEMENT_QUARTER_3;break;case"年度报告":o.InfoType=r.ANNOUNCEMENT_QUARTER_4;break}}this.Data.push(o)}e.HQChart.UpdataChartInfo(),e.HQChart.Draw()}}}function u(){this.newMethod=o,this.newMethod(),delete this.newMethod,this.RequestData=function(t){var e=this;this.Data=[];var a={HQChart:t};return wx.request({url:i.JSCommonResource_Global_JSChartResource.Domain+i.JSCommonResource_Global_JSChartResource.KLine.Info.Pforecast.ApiUrl,data:{field:["pforecast.type","pforecast.reportdate","fweek"],condition:[{item:["pforecast.reportdate","int32","gte",this.StartDate]}],symbol:[a.HQChart.Symbol],start:0,end:this.MaxReqeustDataCount},method:"post",dataType:"json",success:function(t){e.RecvData(t,a)}}),!0},this.RecvData=function(t,e){var a=t.data;if(a.stock&&1==a.stock.length&&a.stock[0].stockday&&!(a.stock[0].stockday.length<=0)){for(var i in a.stock[0].stockday){var s=a.stock[0].stockday[i];if(s.pforecast.length>0){var o=s.pforecast[0],h=new n;h.Date=s.date,h.Title=o.type,h.InfoType=r.PFORECAST,h.ExtendData={Type:o.type,ReportDate:o.reportdate},s.fweek&&(h.ExtendData.FWeek={},null!=s.fweek.week1&&(h.ExtendData.FWeek.Week1=s.fweek.week1),null!=s.fweek.week4&&(h.ExtendData.FWeek.Week4=s.fweek.week4)),this.Data.push(h)}}e.HQChart.UpdataChartInfo(),e.HQChart.Draw()}}}function C(){this.newMethod=o,this.newMethod(),delete this.newMethod,this.RequestData=function(t){var e=this,a={HQChart:t};return this.Data=[],wx.request({url:i.JSCommonResource_Global_JSChartResource.Domain+i.JSCommonResource_Global_JSChartResource.KLine.Info.Research.ApiUrl,data:{filed:["releasedate","researchdate","level","symbol","id"],querydate:{StartDate:this.StartDate,EndDate:this.GetToday()},symbol:[a.HQChart.Symbol],start:0,end:this.MaxReqeustDataCount},method:"post",dataType:"json",success:function(t){e.RecvData(t,a)}}),!0},this.RecvData=function(t,e){var a=t.data;if(a&&a.list&&!(a.list.length<=0)){for(var i in a.list){var s=a.list[i],o=new n;o.ID=s.id,o.Date=s.researchdate,o.InfoType=r.RESEARCH,o.ExtendData={Level:s.level},this.Data.push(o)}e.HQChart.UpdataChartInfo(),e.HQChart.Draw()}}}function D(){this.newMethod=o,this.newMethod(),delete this.newMethod,this.RequestData=function(t){var e=this,a={HQChart:t};return this.Data=[],wx.request({url:i.JSCommonResource_Global_JSChartResource.Domain+i.JSCommonResource_Global_JSChartResource.KLine.Info.BlockTrading.ApiUrl,data:{field:["blocktrading.price","blocktrading.vol","blocktrading.premium","fweek","price"],condition:[{item:["date","int32","gte",this.StartDate]},{item:["blocktrading.vol","int32","gte","0"]}],symbol:[a.HQChart.Symbol],start:0,end:this.MaxReqeustDataCount},method:"post",dataType:"json",success:function(t){e.RecvData(t,a)}}),!0},this.RecvData=function(t,e){var a=t.data;if(a&&a.stock&&1==a.stock.length&&a.stock[0].stockday&&!(a.stock[0].stockday.length<=0)){for(var i in a.stock[0].stockday){var s=a.stock[0].stockday[i],o=new n;o.Date=s.date,o.InfoType=r.BLOCKTRADING,o.ExtendData={Price:s.blocktrading.price,Premium:s.blocktrading.premium,Vol:s.blocktrading.vol,ClosePrice:s.price},s.fweek&&(o.ExtendData.FWeek={},null!=s.fweek.week1&&(o.ExtendData.FWeek.Week1=s.fweek.week1),null!=s.fweek.week4&&(o.ExtendData.FWeek.Week4=s.fweek.week4)),this.Data.push(o)}e.HQChart.UpdataChartInfo(),e.HQChart.Draw()}}}function m(){this.newMethod=o,this.newMethod(),delete this.newMethod,this.RequestData=function(t){var e=this,a={HQChart:t};return this.Data=[],wx.request({url:i.JSCommonResource_Global_JSChartResource.Domain+i.JSCommonResource_Global_JSChartResource.KLine.Info.TradeDetail.ApiUrl,data:{field:["tradedetail.typeexplain","tradedetail.type","fweek"],condition:[{item:["date","int32","gte",this.StartDate]},{item:["tradedetail.type","int32","gte","0"]}],symbol:[a.HQChart.Symbol],start:0,end:this.MaxReqeustDataCount},method:"post",dataType:"json",success:function(t){e.RecvData(t,a)}}),!0},this.RecvData=function(t,e){var a=t.data;if(a&&a.stock&&1==a.stock.length&&a.stock[0].stockday&&!(a.stock[0].stockday.length<=0)){for(var i in a.stock[0].stockday){var s=a.stock[0].stockday[i],o=new n;for(var h in o.Date=s.date,o.InfoType=r.TRADEDETAIL,o.ExtendData={Detail:new Array},s.tradedetail){var l=s.tradedetail[h];o.ExtendData.Detail.push({Type:l.type,TypeExplain:l.typeexplain})}s.fweek&&(o.ExtendData.FWeek={},null!=s.fweek.week1&&(o.ExtendData.FWeek.Week1=s.fweek.week1),null!=s.fweek.week4&&(o.ExtendData.FWeek.Week4=s.fweek.week4)),this.Data.push(o)}e.HQChart.UpdataChartInfo(),e.HQChart.Draw()}}}function S(){this.newMethod=o,this.newMethod(),delete this.newMethod,this.PolicyList=[],this.SetPolicyList=function(t){for(var e in t)this.PolicyList.push({Name:t[e]})},this.RequestData=function(t){var e=this;this.Data=[];var a={HQChart:t};return wx.request({url:i.JSCommonResource_Global_JSChartResource.Domain+i.JSCommonResource_Global_JSChartResource.KLine.Info.Policy.ApiUrl,data:{symbol:[a.HQChart.Symbol],field:["policy"],condition:[{item:["date","int32","gte",this.StartDate,"lte",this.GetToday()]}],start:0,end:this.MaxReqeustDataCount},method:"post",dataType:"json",success:function(t){e.RecvData(t,a)}}),!0},this.RecvData=function(t,e){var a=t.data;if(a.stock&&1==a.stock.length&&a.stock[0].stockday&&!(a.stock[0].stockday.length<=0)){var i=new Set;for(var s in this.PolicyList)i.add(this.PolicyList[s].Name);for(var s in a.stock[0].stockday){var o=a.stock[0].stockday[s],h=new n;for(var l in h.Date=o.date,h.InfoType=r.POLICY,h.ExtendData=[],o.policy){var u=o.policy[l].name;i.has(u)&&h.ExtendData.push({Name:u})}h.ExtendData.length>0&&this.Data.push(h)}e.HQChart.UpdataChartInfo(),e.HQChart.Draw(),e.HQChart.UpdateUICallback&&e.HQChart.UpdateUICallback("RecvPolicyInfoData",this)}}}function c(){}function f(){this.Data,this.ClassName="IMinuteInfo"}function d(){this.newMethod=f,this.newMethod(),delete this.newMethod,this.ClassName="MarketEventInfo",this.RequestData=function(t){var e=this;this.Data=[];var a={HQChart:t},r=i.JSCommonResource_Global_JSChartResource.CacheDomain+"/cache/analyze/shszevent/marketevent/concept/"+t.TradeDate+".json";if(t.NetworkFilter){var n={Name:"MarketEventInfo::RequestData",Explain:"大盘异动",Request:{Url:r,Type:"Get",Data:{Date:t.TradeDate,Symbol:t.Symbol}},Self:this,PreventDefault:!1};if(t.NetworkFilter(n,(function(t){e.RecvData(t,a),a.HQChart.UpdataChartInfo(),a.HQChart.Draw()})),1==n.PreventDefault)return}return wx.request({url:r,method:"get",dataType:"json",success:function(t){e.RecvData(t,a)},error:function(t,e){console.warn("[MarketEventInfo::RequestData] error, http ",e,t)}}),!0},this.RecvData=function(t,e){var a=t.data;for(var i in a.event){var r=a.event[i];for(var n in r.data){var s=r.data[n];if(!(s.length<2)){var o={Date:r.date,Time:s[0],Title:s[1],Type:0};this.Data.push(o)}}}e.HQChart.UpdataChartInfo(),e.HQChart.Draw()}}s.Get=function(t){var e=new Map([["互动易",{Create:function(){return new h}}],["公告",{Create:function(){return new l}}],["业绩预告",{Create:function(){return new u}}],["调研",{Create:function(){return new C}}],["大宗交易",{Create:function(){return new D}}],["龙虎榜",{Create:function(){return new m}}],["策略选股",{Create:function(){return new S}}]]);return e.get(t)},c.InfoMap=new Map([["大盘异动",{Create:function(){return new d}}]]),c.Get=function(t){return c.InfoMap.get(t)},t.exports={JSCommonKLineInfo:{JSKLineInfoMap:s,KLINE_INFO_TYPE:r,JSMinuteInfoMap:c},JSCommon_JSKLineInfoMap:s,JSCommon_KLINE_INFO_TYPE:r,JSCommon_JSMinuteInfoMap:c}},b849:function(t,e,a){a("4ec9"),a("d3b7"),a("3ca3"),a("ddb0");var i={MINUTE_ID:101,MULTIDAY_MINUTE_ID:102,HISTORY_MINUTE_ID:103,KLINE_DAY_ID:0,KLINE_WEEK_ID:1,KLINE_MONTH_ID:2,KLINE_YEAR_ID:3,KLINE_MINUTE_ID:4,KLINE_5_MINUTE_ID:5,KLINE_15_MINUTE_ID:6,KLINE_30_MINUTE_ID:7,KLINE_60_MINUTE_ID:8};function r(){this.DataMap=new Map,this.Get=function(t){return this.DataMap.has(t)?this.DataMap.get(t):null},this.Add=function(t){this.DataMap.set(t.ID,t)}}var n=new r;function s(){this.DataMap=new Map([["MA",this.MA],["均线",this.MA],["BOLL",this.BOLL],["BBI",this.BBI],["MA4",this.MA4],["MA5",this.MA5],["MA6",this.MA6],["MA7",this.MA7],["MA8",this.MA8],["DKX",this.DKX],["MIKE",this.MIKE],["PBX",this.PBX],["ENE",this.ENE],["MACD",this.MACD],["KDJ",this.KDJ],["MACD2",this.MACD2],["VOL",this.VOL],["成交量",this.VOL],["RSI",this.RSI],["BRAR",this.BRAR],["WR",this.WR],["BIAS",this.BIAS],["OBV",this.OBV],["DMI",this.DMI],["CR",this.CR],["PSY",this.PSY],["CCI",this.CCI],["DMA",this.DMA],["TRIX",this.TRIX],["VR",this.VR],["EMV",this.EMV],["ROC",this.ROC],["MIM",this.MIM],["FSL",this.FSL],["CYR",this.CYR],["MASS",this.MASS],["WAD",this.WAD],["CHO",this.CHO],["ADTM",this.ADTM],["HSL",this.HSL],["BIAS36",this.BIAS36],["BIAS_QL",this.BIAS_QL],["DPO",this.DPO],["OSC",this.OSC],["ATR",this.ATR],["NVI",this.NVI],["PVI",this.PVI],["UOS",this.UOS],["CYW",this.CYW],["LON",this.LON],["NDB",this.NDB],["SKDJ",this.SKDJ],["KD",this.KD],["FKX",this.FKX],["DKCOL",this.DKCOL],["UDL",this.UDL],["MFI",this.MFI],["LWR",this.LWR],["MARSI",this.MARSI],["CYD",this.CYD],["CYF",this.CYF],["TAPI",this.TAPI],["VMACD",this.VMACD],["QACD",this.QACD],["VPT",this.VPT],["WVAD",this.WVAD],["DBQR",this.DBQR],["JS",this.JS],["CYE",this.CYE],["QR",this.QR],["GDX",this.GDX],["JLHB",this.JLHB],["PCNT",this.PCNT],["BTX",this.BTX],["AMO",this.AMO],["VRSI",this.VRSI],["HSCOL",this.HSCOL],["DBQRV",this.DBQRV],["DBLB",this.DBLB],["ACD",this.ACD],["EXPMA",this.EXPMA],["EXPMA_S",this.EXPMA_S],["HMA",this.HMA],["LMA",this.LMA],["VMA",this.VMA],["AMV",this.AMV],["BBIBOLL",this.BBIBOLL],["ALLIGAT",this.ALLIGAT],["ZX",this.ZX],["XS",this.XS],["XS2",this.XS2],["SG-XDT",this.SG_XDT],["SG-SMX",this.SG_SMX],["SG-LB",this.SG_LB],["SG-PF",this.SG_PF],["RAD",this.RAD],["SHT",this.SHT],["ZLJC",this.ZLJC],["ZLMM",this.ZLMM],["SLZT",this.SLZT],["ADVOL",this.ADVOL],["CYC",this.CYC],["CYS",this.CYS],["CYQKL",this.CYQKL],["SQJZ",this.SQJZ],["XT",this.XT],["CFJT",this.CFJT],["CYX",this.CYX],["WAVE",this.WAVE],["SCR",this.SCR],["ASR",this.ASR],["SAR",this.SAR],["TJCJL",this.TJCJL],["量比",this.VOLRate],["EMPTY",this.EMPTY],["操盘BS点",this.FXG_BSPoint],["CJL2",this.CJL],["Zealink-资金吸筹",this.Zealink_Index1],["Zealink-牛熊区间",this.Zealink_Index2],["Zealink-持仓信号",this.Zealink_Index3],["Zealink-增减持",this.Zealink_Index4],["Zealink-大宗交易",this.Zealink_Index5],["Zealink-信托持股",this.Zealink_Index6],["Zealink-官网新闻",this.Zealink_Index7],["Zealink-高管要闻",this.Zealink_Index8],["Zealink-股权质押",this.Zealink_Index9],["飞龙四式",this.Dragon4_Main],["飞龙四式-附图",this.Dragon4_Fig],["资金分析",this.FundsAnalysis],["融资占比",this.MarginProportion],["负面新闻",this.NewsNegative],["机构调研",this.NewsResearch],["董秘连线",this.NewsInteract],["涨跌趋势",this.UpDownAnalyze],["放心股-操盘BS点",this.FXG_BSPoint],["放心股-涨停多空线",this.FXG_INDEX],["放心股-涨停吸筹区",this.FXG_INDEX2],["放心股-量能黄金点",this.FXG_INDEX3],["五彩K线-十字星",this.COLOR_KSTAR1],["五彩K线-早晨之星",this.COLOR_KSTAR2],["五彩K线-黄昏之星",this.COLOR_KSTAR3],["五彩K线-长十字",this.COLOR_SHI1],["五彩K线-身怀六甲",this.COLOR_K220],["五彩K线-三个白武士",this.COLOR_K300],["五彩K线-三只乌鸦",this.COLOR_K310],["五彩K线-光头阳线",this.COLOR_K380],["五彩K线-光脚阴线",this.COLOR_K390],["五彩K线-垂死十字",this.COLOR_K134],["五彩K线-早晨十字星",this.COLOR_K140],["五彩K线-黄昏十字星",this.COLOR_K150],["五彩K线-射击之星",this.COLOR_K160],["五彩K线-倒转锤头",this.COLOR_K165],["五彩K线-锤头",this.COLOR_K170],["五彩K线-吊颈",this.COLOR_K180],["五彩K线-穿头破脚",this.COLOR_K190],["五彩K线-出水芙蓉",this.COLOR_CSFR],["五彩K线-乌云盖顶",this.COLOR_WYGD],["五彩K线-曙光初现",this.COLOR_SGCJ],["五彩K线-十字胎",this.COLOR_SZTAI],["五彩K线-剑",this.COLOR_SWORD],["五彩K线-平顶",this.COLOR_PINGDING],["五彩K线-平底",this.COLOR_PINGDI],["五彩K线-大阳烛",this.COLOR_DAYANZHU],["五彩K线-大阴烛",this.COLOR_DAYINGZHU],["五彩K线-好友反攻",this.COLOR_HYFG],["五彩K线-跳空缺口",this.COLOR_TKQK],["五彩K线-双飞乌鸦",this.COLOR_SFWY],["五彩K线-上升三部曲",this.COLOR_SSSBQ],["五彩K线-下跌三部曲",this.COLOR_XDSBQ],["五彩K线-长下影",this.COLOR_CHXY],["五彩K线-长上影",this.COLOR_CHSY],["五彩K线-分离",this.COLOR_FENLI],["交易系统-BIAS",this.TRADE_BIAS],["交易系统-CCI",this.TRADE_CCI],["交易系统-DMI",this.TRADE_DMI],["交易系统-KD",this.TRADE_KD],["交易系统-BOLL",this.TRADE_BOLL],["交易系统-KDJ",this.TRADE_KDJ],["交易系统-MA",this.TRADE_MA],["交易系统-MACD",this.TRADE_MACD],["交易系统-MTM",this.TRADE_MTM],["交易系统-PSY",this.TRADE_PSY],["交易系统-ROC",this.TRADE_ROC],["交易系统-RSI",this.TRADE_RSI],["交易系统-VR",this.TRADE_VR],["交易系统-DPSJ",this.TRADE_DPSJ],["TEST",this.TEST]])}s.AddIndex=function(t){for(var e in t)n.Add(t[e])},s.prototype.Get=function(t){var e=n.Get(t);if(e)return e;var a=this.DataMap.get(t);return a?a():(console.log("[JSIndexScript::Get] can't find index by id=".concat(t)),null)},s.prototype.MA=function(){var t={Name:"MA",Description:"均线",IsMainIndex:!0,StringFormat:2,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"},{Name:"MA3",DynamicName:"MA{M3}"}],Script:"MA1:MA(CLOSE,M1);\nMA2:MA(CLOSE,M2);\nMA3:MA(CLOSE,M3);"};return t},s.prototype.MA4=function(){var t={Name:"MA",Description:"均线",IsMainIndex:!0,StringFormat:2,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20},{Name:"M4",Value:60}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"},{Name:"MA3",DynamicName:"MA{M3}"},{Name:"MA4",DynamicName:"MA{M4}"}],Script:"MA1:MA(CLOSE,M1);\nMA2:MA(CLOSE,M2);\nMA3:MA(CLOSE,M3);\nMA4:MA(CLOSE,M4);"};return t},s.prototype.MA5=function(){var t={Name:"MA",Description:"均线",IsMainIndex:!0,StringFormat:2,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20},{Name:"M4",Value:60},{Name:"M5",Value:0}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"},{Name:"MA3",DynamicName:"MA{M3}"},{Name:"MA4",DynamicName:"MA{M4}"},{Name:"MA5",DynamicName:"MA{M5}"}],Script:"MA1:MA(CLOSE,M1);\nMA2:MA(CLOSE,M2);\nMA3:MA(CLOSE,M3);\nMA4:MA(CLOSE,M4);\nMA5:MA(CLOSE,M5);"};return t},s.prototype.MA6=function(){var t={Name:"MA",Description:"均线",IsMainIndex:!0,StringFormat:2,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20},{Name:"M4",Value:60},{Name:"M5",Value:0},{Name:"M6",Value:0}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"},{Name:"MA3",DynamicName:"MA{M3}"},{Name:"MA4",DynamicName:"MA{M4}"},{Name:"MA5",DynamicName:"MA{M5}"},{Name:"MA6",DynamicName:"MA{M6}"}],Script:"MA1:MA(CLOSE,M1);\nMA2:MA(CLOSE,M2);\nMA3:MA(CLOSE,M3);\nMA4:MA(CLOSE,M4);\nMA5:MA(CLOSE,M5);\nMA6:MA(CLOSE,M6);"};return t},s.prototype.MA7=function(){var t={Name:"MA",Description:"均线",IsMainIndex:!0,StringFormat:2,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20},{Name:"M4",Value:60},{Name:"M5",Value:0},{Name:"M6",Value:0},{Name:"M7",Value:0}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"},{Name:"MA3",DynamicName:"MA{M3}"},{Name:"MA4",DynamicName:"MA{M4}"},{Name:"MA5",DynamicName:"MA{M5}"},{Name:"MA6",DynamicName:"MA{M6}"},{Name:"MA7",DynamicName:"MA{M7}"}],Script:"MA1:MA(CLOSE,M1);\nMA2:MA(CLOSE,M2);\nMA3:MA(CLOSE,M3);\nMA4:MA(CLOSE,M4);\nMA5:MA(CLOSE,M5);\nMA6:MA(CLOSE,M6);\nMA7:MA(CLOSE,M7);"};return t},s.prototype.MA8=function(){var t={Name:"MA",Description:"均线",IsMainIndex:!0,StringFormat:2,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20},{Name:"M4",Value:60},{Name:"M5",Value:0},{Name:"M6",Value:0},{Name:"M7",Value:0},{Name:"M8",Value:0}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"},{Name:"MA3",DynamicName:"MA{M3}"},{Name:"MA4",DynamicName:"MA{M4}"},{Name:"MA5",DynamicName:"MA{M5}"},{Name:"MA6",DynamicName:"MA{M6}"},{Name:"MA7",DynamicName:"MA{M7}"},{Name:"MA8",DynamicName:"MA{M8}"}],Script:"MA1:MA(CLOSE,M1);\nMA2:MA(CLOSE,M2);\nMA3:MA(CLOSE,M3);\nMA4:MA(CLOSE,M4);\nMA5:MA(CLOSE,M5);\nMA6:MA(CLOSE,M6);\nMA7:MA(CLOSE,M7);\nMA8:MA(CLOSE,M8);"};return t},s.prototype.BOLL=function(){var t={Name:"BOLL",Description:"布林线",IsMainIndex:!0,KLineType:2,Args:[{Name:"M",Value:20}],Script:"BOLL:MA(CLOSE,M);\nUB:BOLL+2*STD(CLOSE,M);\nLB:BOLL-2*STD(CLOSE,M);"};return t},s.prototype.BBI=function(){var t={Name:"BBI",Description:"多空均线",IsMainIndex:!0,Args:[{Name:"M1",Value:3},{Name:"M2",Value:6},{Name:"M3",Value:12},{Name:"M4",Value:24}],Script:"BBI:(MA(CLOSE,M1)+MA(CLOSE,M2)+MA(CLOSE,M3)+MA(CLOSE,M4))/4;"};return t},s.prototype.DKX=function(){var t={Name:"DKX",Description:"多空线",IsMainIndex:!1,Args:[{Name:"M",Value:10}],Script:"MID:=(3*CLOSE+LOW+OPEN+HIGH)/6;\nDKX:(20*MID+19*REF(MID,1)+18*REF(MID,2)+17*REF(MID,3)+\n16*REF(MID,4)+15*REF(MID,5)+14*REF(MID,6)+\n13*REF(MID,7)+12*REF(MID,8)+11*REF(MID,9)+\n10*REF(MID,10)+9*REF(MID,11)+8*REF(MID,12)+\n7*REF(MID,13)+6*REF(MID,14)+5*REF(MID,15)+\n4*REF(MID,16)+3*REF(MID,17)+2*REF(MID,18)+REF(MID,20))/210;\nMADKX:MA(DKX,M);"};return t},s.prototype.MIKE=function(){var t={Name:"MIKE",Description:"麦克支撑压力",IsMainIndex:!0,Args:[{Name:"N",Value:10}],Script:"HLC:=REF(MA((HIGH+LOW+CLOSE)/3,N),1);\nHV:=EMA(HHV(HIGH,N),3);\nLV:=EMA(LLV(LOW,N),3);\nSTOR:EMA(2*HV-LV,3);\nMIDR:EMA(HLC+HV-LV,3);\nWEKR:EMA(HLC*2-LV,3);\nWEKS:EMA(HLC*2-HV,3);\nMIDS:EMA(HLC-HV+LV,3);\nSTOS:EMA(2*LV-HV,3);"};return t},s.prototype.PBX=function(){var t={Name:"PBX",Description:"瀑布线",IsMainIndex:!0,Args:[{Name:"M1",Value:4},{Name:"M2",Value:6},{Name:"M3",Value:9},{Name:"M4",Value:13},{Name:"M5",Value:18},{Name:"M6",Value:24}],Script:"PBX1:(EMA(CLOSE,M1)+MA(CLOSE,M1*2)+MA(CLOSE,M1*4))/3;\nPBX2:(EMA(CLOSE,M2)+MA(CLOSE,M2*2)+MA(CLOSE,M2*4))/3;\nPBX3:(EMA(CLOSE,M3)+MA(CLOSE,M3*2)+MA(CLOSE,M3*4))/3;\nPBX4:(EMA(CLOSE,M4)+MA(CLOSE,M4*2)+MA(CLOSE,M4*4))/3;\nPBX5:(EMA(CLOSE,M5)+MA(CLOSE,M5*2)+MA(CLOSE,M5*4))/3;\nPBX6:(EMA(CLOSE,M6)+MA(CLOSE,M6*2)+MA(CLOSE,M6*4))/3;"};return t},s.prototype.ENE=function(){var t={Name:"ENE",Description:"轨道线",IsMainIndex:!0,Args:[{Name:"N",Value:25},{Name:"M1",Value:6},{Name:"M2",Value:6}],Script:"UPPER:(1+M1/100)*MA(CLOSE,N);\nLOWER:(1-M2/100)*MA(CLOSE,N);\nENE:(UPPER+LOWER)/2;"};return t},s.prototype.MACD=function(){var t={Name:"MACD",Description:"平滑异同平均",IsMainIndex:!1,Args:[{Name:"SHORT",Value:12},{Name:"LONG",Value:26},{Name:"MID",Value:9}],Script:"DIF:EMA(CLOSE,SHORT)-EMA(CLOSE,LONG);\nDEA:EMA(DIF,MID);\nMACD:(DIF-DEA)*2,COLORSTICK;"};return t},s.prototype.MACD2=function(){var t={Name:"MACD",Description:"平滑异同平均",IsMainIndex:!1,Args:[{Name:"SHORT",Value:12},{Name:"LONG",Value:26},{Name:"MID",Value:9}],Script:"DIF2:=EMA(CLOSE,SHORT)-EMA(CLOSE,LONG);\nDEA2:=EMA(DIF2,MID);\nMACD:(DIF2-DEA2)*2,COLORSTICK,LINETHICK50;\nDIF:DIF2;\nDEA:DEA2;"};return t},s.prototype.KDJ=function(){var t={Name:"KDJ",Description:"随机指标",IsMainIndex:!1,Args:[{Name:"N",Value:9},{Name:"M1",Value:3},{Name:"M2",Value:3}],Script:"RSV:=(CLOSE-LLV(LOW,N))/(HHV(HIGH,N)-LLV(LOW,N))*100;\nK:SMA(RSV,M1,1);\nD:SMA(K,M2,1);\nJ:3*K-2*D;"};return t},s.prototype.VOL=function(){var t={Name:"VOL",Description:"成交量",IsMainIndex:!1,FloatPrecision:0,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"}],Script:"VOLUME:=VOL;\nVOL:VOL,VOLSTICK;\nMA1:MA(VOLUME,M1);\nMA2:MA(VOLUME,M2);"};return t},s.prototype.RSI=function(){var t={Name:"RSI",Description:"相对强弱指标",IsMainIndex:!1,Args:[{Name:"N1",Value:6},{Name:"N2",Value:12},{Name:"N3",Value:24}],Script:"LC:=REF(CLOSE,1);\nRSI1:SMA(MAX(CLOSE-LC,0),N1,1)/SMA(ABS(CLOSE-LC),N1,1)*100;\nRSI2:SMA(MAX(CLOSE-LC,0),N2,1)/SMA(ABS(CLOSE-LC),N2,1)*100;\nRSI3:SMA(MAX(CLOSE-LC,0),N3,1)/SMA(ABS(CLOSE-LC),N3,1)*100;"};return t},s.prototype.BRAR=function(){var t={Name:"BRAR",Description:"情绪指标",IsMainIndex:!1,Args:[{Name:"N",Value:26}],Script:"BR:SUM(MAX(0,HIGH-REF(CLOSE,1)),N)/SUM(MAX(0,REF(CLOSE,1)-LOW),N)*100;\nAR:SUM(HIGH-OPEN,N)/SUM(OPEN-LOW,N)*100;"};return t},s.prototype.WR=function(){var t={Name:"WR",Description:"威廉指标",IsMainIndex:!1,Args:[{Name:"N",Value:10},{Name:"N1",Value:6}],Script:"WR1:100*(HHV(HIGH,N)-CLOSE)/(HHV(HIGH,N)-LLV(LOW,N));\nWR2:100*(HHV(HIGH,N1)-CLOSE)/(HHV(HIGH,N1)-LLV(LOW,N1));"};return t},s.prototype.BIAS=function(){var t={Name:"BIAS",Description:"乖离率",IsMainIndex:!1,Args:[{Name:"N1",Value:6},{Name:"N2",Value:12},{Name:"N3",Value:24}],Script:"BIAS1 :(CLOSE-MA(CLOSE,N1))/MA(CLOSE,N1)*100;\nBIAS2 :(CLOSE-MA(CLOSE,N2))/MA(CLOSE,N2)*100;\nBIAS3 :(CLOSE-MA(CLOSE,N3))/MA(CLOSE,N3)*100;"};return t},s.prototype.OBV=function(){var t={Name:"OBV",Description:"累积能量线",IsMainIndex:!1,Args:[{Name:"M",Value:30}],Script:"VA:=IF(CLOSE>REF(CLOSE,1),VOL,-VOL);\nOBV:SUM(IF(CLOSE==REF(CLOSE,1),0,VA),0);\nMAOBV:MA(OBV,M);"};return t},s.prototype.DMI=function(){var t={Name:"DMI",Description:"趋向指标",IsMainIndex:!1,Args:[{Name:"N",Value:14},{Name:"MM",Value:6}],Script:"MTR:=EXPMEMA(MAX(MAX(HIGH-LOW,ABS(HIGH-REF(CLOSE,1))),ABS(REF(CLOSE,1)-LOW)),N);\nHD :=HIGH-REF(HIGH,1);\nLD :=REF(LOW,1)-LOW;\nDMP:=EXPMEMA(IF(HD>0&&HD>LD,HD,0),N);\nDMM:=EXPMEMA(IF(LD>0&&LD>HD,LD,0),N);\nPDI: DMP*100/MTR;\nMDI: DMM*100/MTR;\nADX: EXPMEMA(ABS(MDI-PDI)/(MDI+PDI)*100,MM);\nADXR:EXPMEMA(ADX,MM);"};return t},s.prototype.CR=function(){var t={Name:"CR",Description:"带状能量线",IsMainIndex:!1,Args:[{Name:"N",Value:26},{Name:"M1",Value:10},{Name:"M2",Value:20},{Name:"M3",Value:40},{Name:"M4",Value:62}],Script:"MID:=REF(HIGH+LOW,1)/2;\nCR:SUM(MAX(0,HIGH-MID),N)/SUM(MAX(0,MID-LOW),N)*100;\nMA1:REF(MA(CR,M1),M1/2.5+1);\nMA2:REF(MA(CR,M2),M2/2.5+1);\nMA3:REF(MA(CR,M3),M3/2.5+1);\nMA4:REF(MA(CR,M4),M4/2.5+1);"};return t},s.prototype.PSY=function(){var t={Name:"PSY",Description:"心理线",IsMainIndex:!1,Args:[{Name:"N",Value:12},{Name:"M",Value:6}],Script:"PSY:COUNT(CLOSE>REF(CLOSE,1),N)/N*100;\rPSYMA:MA(PSY,M);"};return t},s.prototype.CCI=function(){var t={Name:"CCI",Description:"商品路径指标",IsMainIndex:!1,Args:[{Name:"N",Value:14}],Script:"TYP:=(HIGH+LOW+CLOSE)/3;\nCCI:(TYP-MA(TYP,N))/(0.015*AVEDEV(TYP,N));"};return t},s.prototype.DMA=function(){var t={Name:"DMA",Description:"平均差",IsMainIndex:!1,Args:[{Name:"N1",Value:10},{Name:"N2",Value:50},{Name:"M",Value:10}],Script:"DIF:MA(CLOSE,N1)-MA(CLOSE,N2);\nDIFMA:MA(DIF,M);"};return t},s.prototype.TRIX=function(){var t={Name:"TRIX",Description:"三重指数平均线",IsMainIndex:!1,Args:[{Name:"N",Value:12},{Name:"M",Value:9}],Script:"MTR:=EMA(EMA(EMA(CLOSE,N),N),N);\nTRIX:(MTR-REF(MTR,1))/REF(MTR,1)*100;\nMATRIX:MA(TRIX,M) ;"};return t},s.prototype.VR=function(){var t={Name:"VR",Description:"成交量变异率",IsMainIndex:!1,Args:[{Name:"N",Value:26},{Name:"M",Value:6}],Script:"TH:=SUM(IF(CLOSE>REF(CLOSE,1),VOL,0),N);\nTL:=SUM(IF(CLOSE<REF(CLOSE,1),VOL,0),N);\nTQ:=SUM(IF(CLOSE==REF(CLOSE,1),VOL,0),N);\nVR:100*(TH*2+TQ)/(TL*2+TQ);\nMAVR:MA(VR,M);"};return t},s.prototype.EMV=function(){var t={Name:"EMV",Description:"简易波动指标",IsMainIndex:!1,Args:[{Name:"N",Value:14},{Name:"M",Value:9}],Script:"VOLUME:=MA(VOL,N)/VOL;\nMID:=100*(HIGH+LOW-REF(HIGH+LOW,1))/(HIGH+LOW);\nEMV:MA(MID*VOLUME*(HIGH-LOW)/MA(HIGH-LOW,N),N);\nMAEMV:MA(EMV,M);"};return t},s.prototype.ROC=function(){var t={Name:"ROC",Description:"变动率指标",IsMainIndex:!1,Args:[{Name:"N",Value:12},{Name:"M",Value:6}],Script:"ROC:100*(CLOSE-REF(CLOSE,N))/REF(CLOSE,N);\nMAROC:MA(ROC,M);"};return t},s.prototype.MIM=function(){var t={Name:"MIM",Description:"动量线",IsMainIndex:!1,Args:[{Name:"N",Value:12},{Name:"M",Value:6}],Script:"MTM:CLOSE-REF(CLOSE,N);\nMAMTM:MA(MTM,M);"};return t},s.prototype.FSL=function(){var t={Name:"FSL",Description:"分水岭",IsMainIndex:!1,Args:[],Script:"SWL:(EMA(CLOSE,5)*7+EMA(CLOSE,10)*3)/10;\nSWS:DMA(EMA(CLOSE,12),MAX(1,100*(SUM(VOL,5)/(3*CAPITAL))));"};return t},s.prototype.CYR=function(){var t={Name:"CYR",Description:"市场强弱",IsMainIndex:!1,Args:[{Name:"N",Value:13},{Name:"M",Value:5}],Script:"DIVE:=0.01*EMA(AMOUNT,N)/EMA(VOL,N);\nCYR:(DIVE/REF(DIVE,1)-1)*100;\nMACYR:MA(CYR,M);"};return t},s.prototype.MASS=function(){var t={Name:"MASS",Description:"市场强弱",IsMainIndex:!1,Args:[{Name:"N1",Value:9},{Name:"N2",Value:25},{Name:"M",Value:6}],Script:"MASS:SUM(MA(HIGH-LOW,N1)/MA(MA(HIGH-LOW,N1),N1),N2);\nMAMASS:MA(MASS,M);"};return t},s.prototype.WAD=function(){var t={Name:"WAD",Description:"威廉多空力度线",IsMainIndex:!1,Args:[{Name:"M",Value:30}],Script:"MIDA:=CLOSE-MIN(REF(CLOSE,1),LOW);\nMIDB:=IF(CLOSE<REF(CLOSE,1),CLOSE-MAX(REF(CLOSE,1),HIGH),0);\nWAD:SUM(IF(CLOSE>REF(CLOSE,1),MIDA,MIDB),0);\nMAWAD:MA(WAD,M);"};return t},s.prototype.CHO=function(){var t={Name:"CHO",Description:"佳庆指标",IsMainIndex:!1,Args:[{Name:"N1",Value:10},{Name:"N2",Value:20},{Name:"M",Value:6}],Script:"MID:=SUM(VOL*(2*CLOSE-HIGH-LOW)/(HIGH+LOW),0);\nCHO:MA(MID,N1)-MA(MID,N2);\nMACHO:MA(CHO,M);"};return t},s.prototype.ADTM=function(){var t={Name:"ADTM",Description:"动态买卖气指标",IsMainIndex:!1,Args:[{Name:"N",Value:23},{Name:"M",Value:8}],Script:"DTM:=IF(OPEN<=REF(OPEN,1),0,MAX((HIGH-OPEN),(OPEN-REF(OPEN,1))));\nDBM:=IF(OPEN>=REF(OPEN,1),0,MAX((OPEN-LOW),(OPEN-REF(OPEN,1))));\nSTM:=SUM(DTM,N);\nSBM:=SUM(DBM,N);\nADTM:IF(STM>SBM,(STM-SBM)/STM,IF(STM==SBM,0,(STM-SBM)/SBM));\nMAADTM:MA(ADTM,M);"};return t},s.prototype.HSL=function(){var t={Name:"HSL",Description:"换手线",IsMainIndex:!1,Args:[{Name:"N",Value:5}],Script:"HSL:IF((SETCODE==0||SETCODE==1),100*VOL,VOL)/(FINANCE(7)/100);\nMAHSL:MA(HSL,N);"};return t},s.prototype.BIAS36=function(){var t={Name:"BIAS36",Description:"三六乖离",IsMainIndex:!1,Args:[{Name:"M",Value:6}],Script:"BIAS36:MA(CLOSE,3)-MA(CLOSE,6);\nBIAS612:MA(CLOSE,6)-MA(CLOSE,12);\nMABIAS:MA(BIAS36,M);"};return t},s.prototype.BIAS_QL=function(){var t={Name:"BIAS_QL",Description:"乖离率-传统版",IsMainIndex:!1,Args:[{Name:"N",Value:6},{Name:"M",Value:6}],Script:"BIAS :(CLOSE-MA(CLOSE,N))/MA(CLOSE,N)*100;\nBIASMA :MA(BIAS,M);"};return t},s.prototype.DPO=function(){var t={Name:"DPO",Description:"区间震荡线",IsMainIndex:!1,Args:[{Name:"N",Value:20},{Name:"M",Value:6}],Script:"DPO:CLOSE-REF(MA(CLOSE,N),N/2+1);\nMADPO:MA(DPO,M);"};return t},s.prototype.OSC=function(){var t={Name:"OSC",Description:"变动速率线",IsMainIndex:!1,Args:[{Name:"N",Value:20},{Name:"M",Value:6}],Script:"OSC:100*(CLOSE-MA(CLOSE,N));\nMAOSC:EXPMEMA(OSC,M);"};return t},s.prototype.ATR=function(){var t={Name:"ATR",Description:"真实波幅",IsMainIndex:!1,Args:[{Name:"N",Value:14}],Script:"MTR:MAX(MAX((HIGH-LOW),ABS(REF(CLOSE,1)-HIGH)),ABS(REF(CLOSE,1)-LOW));\nATR:MA(MTR,N);"};return t},s.prototype.NVI=function(){var t={Name:"ATR",Description:"负成交量",IsMainIndex:!1,Args:[{Name:"N",Value:72}],Script:"NVI:100*MULAR(IF(V<REF(V,1),C/REF(C,1),1),0);\nMANVI:MA(NVI,N);"};return t},s.prototype.PVI=function(){var t={Name:"PVI",Description:"正成交量",IsMainIndex:!1,Args:[{Name:"N",Value:72}],Script:"NVI:100*MULAR(IF(V>REF(V,1),C/REF(C,1),1),0);\nMANVI:MA(NVI,N);"};return t},s.prototype.UOS=function(){var t={Name:"UOS",Description:"终极指标",IsMainIndex:!1,Args:[{Name:"N1",Value:7},{Name:"N2",Value:14},{Name:"N3",Value:28},{Name:"M",Value:6}],Script:"TH:=MAX(HIGH,REF(CLOSE,1));\nTL:=MIN(LOW,REF(CLOSE,1));\nACC1:=SUM(CLOSE-TL,N1)/SUM(TH-TL,N1);\nACC2:=SUM(CLOSE-TL,N2)/SUM(TH-TL,N2);\nACC3:=SUM(CLOSE-TL,N3)/SUM(TH-TL,N3);\nUOS:(ACC1*N2*N3+ACC2*N1*N3+ACC3*N1*N2)*100/(N1*N2+N1*N3+N2*N3);\nMAUOS:EXPMEMA(UOS,M);"};return t},s.prototype.CYW=function(){var t={Name:"CYW",Description:"主力控盘",IsMainIndex:!1,Args:[],Script:"VAR1:=CLOSE-LOW;\nVAR2:=HIGH-LOW;\nVAR3:=CLOSE-HIGH;\nVAR4:=IF(HIGH>LOW,(VAR1/VAR2+VAR3/VAR2)*VOL,0);\nCYW: SUM(VAR4,10)/10000, COLORSTICK;"};return t},s.prototype.LON=function(){var t={Name:"LON",Description:"龙系长线",IsMainIndex:!1,Args:[{Name:"N",Value:10}],Script:"LC := REF(CLOSE,1);\nVID := SUM(VOL,2)/(((HHV(HIGH,2)-LLV(LOW,2)))*100);\nRC := (CLOSE-LC)*VID;\nLONG := SUM(RC,0);\nDIFF := SMA(LONG,10,1);\nDEA := SMA(LONG,20,1);\nLON : DIFF-DEA;\nLONMA : MA(LON,10);\nLONT : LON, COLORSTICK;"};return t},s.prototype.NDB=function(){var t={Name:"NDB",Description:"脑电波",IsMainIndex:!1,Args:[{Name:"P1",Value:5},{Name:"P2",Value:10}],Script:"HH:=IF(C/REF(C,1)>1.098 AND L>REF(H,1),2*C-REF(C,1)-H,2*C-H-L);\nV1:= BARSCOUNT(C) - 1;\nV2:= 2 * REF(C, V1) - REF(H, V1) - REF(L, V1);\nDK: SUM(HH, 0) + V2;\nMDK5: MA(DK, P1);\nMDK10: MA(DK, P2);"};return t},s.prototype.SKDJ=function(){var t={Name:"SKDJ",Description:"慢速随机指标",IsMainIndex:!1,Args:[{Name:"N",Value:9},{Name:"M",Value:3}],Script:"LOWV:=LLV(LOW,N);\nHIGHV:=HHV(HIGH,N);\nRSV:=EMA((CLOSE-LOWV)/(HIGHV-LOWV)*100,M);\nK:EMA(RSV,M);\nD:MA(K,M);"};return t},s.prototype.KD=function(){var t={Name:"KD",Description:"随机指标KD",IsMainIndex:!1,Args:[{Name:"N",Value:9},{Name:"M1",Value:3},{Name:"M2",Value:3}],Script:"RSV:=(CLOSE-LLV(LOW,N))/(HHV(HIGH,N)-LLV(LOW,N))*100;\nK:SMA(RSV,M1,1);\nD:SMA(K,M2,1);"};return t},s.prototype.FKX=function(){var t={Name:"FKX",Description:"反K线",IsMainIndex:!0,Args:[],Script:"DRAWKLINE(-LOW, -OPEN, -HIGH, -CLOSE);"};return t},s.prototype.DKCOL=function(){var t={Name:"DKCOL",Description:"多空能量柱(适用于分时主图)",IsMainIndex:!0,Args:[{Name:"N",Value:5}],Script:"FF:=(C-REF(C,N))/REF(C,N);\nSTICKLINE(FF>0,DYNAINFO(3),DYNAINFO(3)*(1+FF),0.5,0),COLORRED;\nSTICKLINE(FF<0,DYNAINFO(3),DYNAINFO(3)*(1+FF),0.5,0),COLORGREEN;"};return t},s.prototype.UDL=function(){var t={Name:"UDL",Description:"引力线",IsMainIndex:!1,Args:[{Name:"N1",Value:3},{Name:"N2",Value:5},{Name:"N3",Value:10},{Name:"N4",Value:20},{Name:"M",Value:6}],Script:"UDL:(MA(CLOSE,N1)+MA(CLOSE,N2)+MA(CLOSE,N3)+MA(CLOSE,N4))/4;\nMAUDL:MA(UDL,M);"};return t},s.prototype.MFI=function(){var t={Name:"MFI",Description:"资金流量指标",IsMainIndex:!1,Args:[{Name:"N",Value:14},{Name:"N2",Value:6}],Script:"TYP := (HIGH + LOW + CLOSE)/3;\nV1:=SUM(IF(TYP>REF(TYP,1),TYP*VOL,0),N)/SUM(IF(TYP<REF(TYP,1),TYP*VOL,0),N);\nMFI:100-(100/(1+V1));"};return t},s.prototype.LWR=function(){var t={Name:"LWR",Description:"LWR威廉指标",IsMainIndex:!1,Args:[{Name:"N",Value:9},{Name:"M1",Value:3},{Name:"M2",Value:3}],Script:"RSV:= (HHV(HIGH,N)-CLOSE)/(HHV(HIGH,N)-LLV(LOW,N))*100;\nLWR1:SMA(RSV,M1,1);\nLWR2:SMA(LWR1,M2,1);"};return t},s.prototype.MARSI=function(){var t={Name:"MARSI",Description:"相对强弱平均线",IsMainIndex:!1,Args:[{Name:"M1",Value:10},{Name:"M2",Value:6}],Script:"DIF:=CLOSE-REF(CLOSE,1);\nVU:=IF(DIF>=0,DIF,0);\nVD:=IF(DIF<0,-DIF,0);\nMAU1:=MEMA(VU,M1);\nMAD1:=MEMA(VD,M1);\nMAU2:=MEMA(VU,M2);\nMAD2:=MEMA(VD,M2);\nRSI10:MA(100*MAU1/(MAU1+MAD1),M1);\nRSI6:MA(100*MAU2/(MAU2+MAD2),M2);"};return t},s.prototype.CYD=function(){var t={Name:"CYD",Description:"承接因子",IsMainIndex:!1,Args:[{Name:"N",Value:21}],Script:"CYDS:WINNER(CLOSE)/(VOL/CAPITAL);\nCYDN:WINNER(CLOSE)/MA(VOL/CAPITAL,N);"};return t},s.prototype.CYF=function(){var t={Name:"CYF",Description:"市场能量",IsMainIndex:!1,Args:[{Name:"N",Value:21}],Script:"CYF:100-100/(1+EMA(HSL,N));"};return t},s.prototype.TAPI=function(){var t={Name:"TAPI",Description:"加权指数成交值",IsMainIndex:!1,Args:[{Name:"M",Value:6}],Script:"TAPI:AMOUNT/INDEXC;\nMATAIP:MA(TAPI,M);"};return t},s.prototype.VMACD=function(){var t={Name:"VMACD",Description:"量平滑异同平均",IsMainIndex:!1,Args:[{Name:"SHORT",Value:12},{Name:"LONG",Value:26},{Name:"MID",Value:9}],Script:"DIF:EMA(VOL,SHORT)-EMA(VOL,LONG);\nDEA:EMA(DIF,MID);\nMACD:DIF-DEA,COLORSTICK;"};return t},s.prototype.QACD=function(){var t={Name:"QACD",Description:"快速异同平均",IsMainIndex:!1,Args:[{Name:"N1",Value:12},{Name:"N2",Value:26},{Name:"M",Value:9}],Script:"DIF:EMA(CLOSE,N1)-EMA(CLOSE,N2);\nMACD:EMA(DIF,M);\nDDIF:DIF-MACD;"};return t},s.prototype.VPT=function(){var t={Name:"VPT",Description:"量价曲线",IsMainIndex:!1,Args:[{Name:"N",Value:51},{Name:"M",Value:6}],Script:"VPT:SUM(VOL*(CLOSE-REF(CLOSE,1))/REF(CLOSE,1),N);\nMAVPT:MA(VPT,M);"};return t},s.prototype.WVAD=function(){var t={Name:"WVAD",Description:"威廉变异离散量",IsMainIndex:!1,Args:[{Name:"N",Value:24},{Name:"M",Value:6}],Script:"WVAD:SUM((CLOSE-OPEN)/(HIGH-LOW)*VOL,N)/10000;\nMAWVAD:MA(WVAD,M);"};return t},s.prototype.DBQR=function(){var t={Name:"WVAD",Description:"对比强弱",IsMainIndex:!1,Args:[{Name:"N",Value:5},{Name:"M1",Value:10},{Name:"M2",Value:20},{Name:"M3",Value:60}],Script:"ZS:(INDEXC-REF(INDEXC,N))/REF(INDEXC,N);\nGG:(CLOSE-REF(CLOSE,N))/REF(CLOSE,N);\nMADBQR1:MA(GG,M1);\nMADBQR2:MA(GG,M2);\nMADBQR3:MA(GG,M3);"};return t},s.prototype.JS=function(){var t={Name:"JS",Description:"加速线",IsMainIndex:!1,Args:[{Name:"N",Value:5},{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20}],Script:"JS:100*(CLOSE-REF(CLOSE,N))/(N*REF(CLOSE,N));\nMAJS1:MA(JS,M1);\nMAJS2:MA(JS,M2);\nMAJS3:MA(JS,M3);"};return t},s.prototype.CYE=function(){var t={Name:"CYE",Description:"市场趋势",IsMainIndex:!1,Args:[],Script:"MAL:=MA(CLOSE,5);\nMAS:=MA(MA(CLOSE,20),5);\nCYEL:(MAL-REF(MAL,1))/REF(MAL,1)*100;\nCYES:(MAS-REF(MAS,1))/REF(MAS,1)*100;"};return t},s.prototype.QR=function(){var t={Name:"QR",Description:"强弱指标",IsMainIndex:!1,Args:[{Name:"N",Value:21}],Script:"个股: (CLOSE-REF(CLOSE,N))/REF(CLOSE,N)*100; \n大盘: (INDEXC-REF(INDEXC,N))/REF(INDEXC,N)*100; \n强弱值:EMA(个股-大盘,2),COLORSTICK;"};return t},s.prototype.GDX=function(){var t={Name:"GDX",Description:"轨道线",IsMainIndex:!1,Args:[{Name:"N",Value:30},{Name:"M",Value:9}],Script:"AA:=ABS((2*CLOSE+HIGH+LOW)/4-MA(CLOSE,N))/MA(CLOSE,N); \n轨道:DMA(CLOSE,AA);\n压力线:(1+M/100)*轨道; \n支撑线:(1-M/100)*轨道;"};return t},s.prototype.JLHB=function(){var t={Name:"JLHB",Description:"绝路航标",IsMainIndex:!1,Args:[{Name:"N",Value:7},{Name:"M",Value:5}],Script:"VAR1:=(CLOSE-LLV(LOW,60))/(HHV(HIGH,60)-LLV(LOW,60))*80; \nB:SMA(VAR1,N,1); \nVAR2:SMA(B,M,1); \n绝路航标:IF(CROSS(B,VAR2) AND B<40,50,0);"};return t},s.prototype.PCNT=function(){var t={Name:"PCNT",Description:"幅度比",IsMainIndex:!1,Args:[{Name:"M",Value:5}],Script:"PCNT:(CLOSE-REF(CLOSE,1))/CLOSE*100;\nMAPCNT:EXPMEMA(PCNT,M);"};return t},s.prototype.AMO=function(){var t={Name:"AMO",Description:"成交金额",IsMainIndex:!1,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10}],Script:"AMOW:AMOUNT/10000.0,VOLSTICK;\nAMO1:MA(AMOW,M1);\nAMO2:MA(AMOW,M2);"};return t},s.prototype.VRSI=function(){var t={Name:"VRSI",Description:"相对强弱量",IsMainIndex:!1,Args:[{Name:"N1",Value:6},{Name:"N2",Value:12},{Name:"N3",Value:24}],Script:"LC:=REF(VOL,1);\nRSI1:SMA(MAX(VOL-LC,0),N1,1)/SMA(ABS(VOL-LC),N1,1)*100;\nRSI2:SMA(MAX(VOL-LC,0),N2,1)/SMA(ABS(VOL-LC),N2,1)*100;\nRSI3:SMA(MAX(VOL-LC,0),N3,1)/SMA(ABS(VOL-LC),N3,1)*100;"};return t},s.prototype.HSCOL=function(){var t={Name:"HSCOL",Description:"换手柱",IsMainIndex:!1,Args:[{Name:"N",Value:5}],Script:"HSCOL:IF((SETCODE==0||SETCODE==1),100*VOL,VOL)/(FINANCE(7)/100),VOLSTICK;\nMAHSL:MA(HSCOL,N);"};return t},s.prototype.DBQRV=function(){var t={Name:"DBQRV",Description:"对比强弱量(需下载日线)",IsMainIndex:!1,Args:[{Name:"N",Value:5}],Script:"ZS:(INDEXV-REF(INDEXV,N))/REF(INDEXV,N);\nGG:(VOL-REF(VOL,N))/REF(VOL,N);"};return t},s.prototype.DBLB=function(){var t={Name:"DBLB",Description:"对比量比(需下载日线)",IsMainIndex:!1,Args:[{Name:"N",Value:5},{Name:"M",Value:5}],Script:"GG:=VOL/SUM(REF(VOL,1),N);\nZS:=INDEXV/SUM(REF(INDEXV,1),N);\nDBLB:GG/ZS;\nMADBLB:MA(DBLB,M);"};return t},s.prototype.ACD=function(){var t={Name:"ACD",Description:"升降线",IsMainIndex:!1,Args:[{Name:"M",Value:20}],Script:"LC:=REF(CLOSE,1);\nDIF:=CLOSE-IF(CLOSE>LC,MIN(LOW,LC),MAX(HIGH,LC));\nACD:SUM(IF(CLOSE==LC,0,DIF),0);\nMAACD:EXPMEMA(ACD,M);"};return t},s.prototype.EXPMA=function(){var t={Name:"EXPMA",Description:"指数平均线",IsMainIndex:!0,Args:[{Name:"M1",Value:12},{Name:"M2",Value:50}],Script:"EXP1:EMA(CLOSE,M1);\nEXP2:EMA(CLOSE,M2);"};return t},s.prototype.EXPMA_S=function(){var t={Name:"EXPMA_S",Description:"指数平均线-副图",IsMainIndex:!1,Args:[{Name:"M1",Value:12},{Name:"M2",Value:50}],Script:"EXP1:EMA(CLOSE,M1);\nEXP2:EMA(CLOSE,M2);"};return t},s.prototype.HMA=function(){var t={Name:"HMA",Description:"高价平均线",IsMainIndex:!0,Args:[{Name:"M1",Value:6},{Name:"M2",Value:12},{Name:"M3",Value:30},{Name:"M4",Value:72},{Name:"M5",Value:144}],Script:"HMA1:MA(HIGH,M1);\nHMA2:MA(HIGH,M2);\nHMA3:MA(HIGH,M3);\nHMA4:MA(HIGH,M4);\nHMA5:MA(HIGH,M5);"};return t},s.prototype.LMA=function(){var t={Name:"LMA",Description:"低价平均线",IsMainIndex:!0,Args:[{Name:"M1",Value:6},{Name:"M2",Value:12},{Name:"M3",Value:30},{Name:"M4",Value:72},{Name:"M5",Value:144}],Script:"LMA1:MA(LOW,M1);\nLMA2:MA(LOW,M2);\nLMA3:MA(LOW,M3);\nLMA4:MA(LOW,M4);\nLMA5:MA(LOW,M5);"};return t},s.prototype.VMA=function(){var t={Name:"VMA",Description:"变异平均线",IsMainIndex:!0,Args:[{Name:"M1",Value:6},{Name:"M2",Value:12},{Name:"M3",Value:30},{Name:"M4",Value:72},{Name:"M5",Value:144}],Script:"VV:=(HIGH+OPEN+LOW+CLOSE)/4;\nVMA1:MA(VV,M1);\nVMA2:MA(VV,M2);\nVMA3:MA(VV,M3);\nVMA4:MA(VV,M4);\nVMA5:MA(VV,M5);"};return t},s.prototype.AMV=function(){var t={Name:"AMV",Description:"成本价均线",IsMainIndex:!1,Args:[{Name:"M1",Value:6},{Name:"M2",Value:12},{Name:"M3",Value:30},{Name:"M4",Value:72},{Name:"M5",Value:144}],Script:"AMOV:=VOL*(OPEN+CLOSE)/2;\nAMV1:SUM(AMOV,M1)/SUM(VOL,M1);\nAMV2:SUM(AMOV,M2)/SUM(VOL,M2);\nAMV3:SUM(AMOV,M3)/SUM(VOL,M3);\nAMV4:SUM(AMOV,M4)/SUM(VOL,M4);"};return t},s.prototype.BBIBOLL=function(){var t={Name:"BBIBOLL",Description:"多空布林线",IsMainIndex:!0,Args:[{Name:"N",Value:11},{Name:"M",Value:6}],Script:"CV:=CLOSE;\nBBIBOLL:(MA(CV,3)+MA(CV,6)+MA(CV,12)+MA(CV,24))/4;\nUPR:BBIBOLL+M*STD(BBIBOLL,N);\nDWN:BBIBOLL-M*STD(BBIBOLL,N);"};return t},s.prototype.ALLIGAT=function(){var t={Name:"ALLIGAT",Description:"鳄鱼线",IsMainIndex:!0,Args:[],Script:"NN:=(H+L)/2;\n上唇:REF(MA(NN,5),3),COLOR40FF40;\n牙齿:REF(MA(NN,8),5),COLOR0000C0;\n下颚:REF(MA(NN,13),8),COLORFF4040;"};return t},s.prototype.ZX=function(){var t={Name:"ZX",Description:"重心线",IsMainIndex:!1,Args:[],Script:"AV:0.01*AMOUNT/VOL;"};return t},s.prototype.XS=function(){var t={Name:"XS",Description:"薛斯通道",IsMainIndex:!0,Args:[{Name:"N",Value:13}],Script:"VAR2:=CLOSE*VOL;\nVAR3:=EMA((EMA(VAR2,3)/EMA(VOL,3)+EMA(VAR2,6)/EMA(VOL,6)+EMA(VAR2,12)/EMA(VOL,12)+EMA(VAR2,24)/EMA(VOL,24))/4,N);\nSUP:1.06*VAR3;\nSDN:VAR3*0.94;\nVAR4:=EMA(CLOSE,9);\nLUP:EMA(VAR4*1.14,5);\nLDN:EMA(VAR4*0.86,5);"};return t},s.prototype.XS2=function(){var t={Name:"XS2",Description:"薛斯通道II",IsMainIndex:!0,Args:[{Name:"N",Value:102},{Name:"M",Value:7}],Script:"AA:=MA((2*CLOSE+HIGH+LOW)/4,5); \n通道1:AA*N/100; \n通道2:AA*(200-N)/100; \nCC:=ABS((2*CLOSE+HIGH+LOW)/4-MA(CLOSE,20))/MA(CLOSE,20); \nDD:=DMA(CLOSE,CC); \n通道3:(1+M/100)*DD; \n通道4:(1-M/100)*DD;"};return t},s.prototype.SG_XDT=function(){var t={Name:"SG-XDT",Description:"心电图(需下载日线)",IsMainIndex:!1,Args:[{Name:"P1",Value:5},{Name:"P2",Value:10}],Script:"QR:CLOSE/INDEXC*1000;\nMQR1:MA(QR,5);\nMQR2:MA(QR,10);"};return t},s.prototype.SG_SMX=function(){var t={Name:"SG-SMX",Description:"生命线(需下载日线)",IsMainIndex:!1,Args:[{Name:"N",Value:50}],Script:"H1:=HHV(HIGH,N);\nL1:=LLV(LOW,N);\nH2:=HHV(INDEXH,N);\nL2:=LLV(INDEXL,N);\nZY:=CLOSE/INDEXC*2000;\nZY1:EMA(ZY,3);\nZY2:EMA(ZY,17);\nZY3:EMA(ZY,34);"};return t},s.prototype.SG_LB=function(){var t={Name:"SG-LB",Description:"量比(需下载日线)",IsMainIndex:!1,Args:[],Script:"ZY2:=VOL/INDEXV*1000;\n量比:ZY2;\nMA5:MA(ZY2,5);\nMA10:MA(ZY2,10);"};return t},s.prototype.SG_PF=function(){var t={Name:"SG-PF",Description:"强势股评分(需下载日线)",IsMainIndex:!1,Args:[],Script:"ZY1:=CLOSE/INDEXC*1000;\nA1:=IF(ZY1>HHV(ZY1,3),10,0);\nA2:=IF(ZY1>HHV(ZY1,5),15,0);\nA3:=IF(ZY1>HHV(ZY1,10),20,0);\nA4:=IF(ZY1>HHV(ZY1,2),10,0);\nA5:=COUNT(ZY1>REF(ZY1,1) ,9)*5;\n强势股评分:A1+A2+A3+A4+A5;"};return t},s.prototype.RAD=function(){var t={Name:"RAD",Description:"威力雷达(需下载日线)",IsMainIndex:!1,Args:[{Name:"D",Value:3},{Name:"S",Value:30},{Name:"M",Value:30}],Script:"SM:=(OPEN+HIGH+CLOSE+LOW)/4;\nSMID:=MA(SM,D);\nIM:=(INDEXO+INDEXH+INDEXL+INDEXC)/4;\nIMID:=MA(IM,D);\nSI1:=(SMID-REF(SMID,1))/SMID;\nII:=(IMID-REF(IMID,1))/IMID;\nRADER1:SUM((SI1-II)*2,S)*1000;\nRADERMA:SMA(RADER1,M,1);"};return t},s.prototype.SHT=function(){var t={Name:"SHT",Description:"龙系短线",IsMainIndex:!1,Args:[{Name:"N",Value:5}],Script:"VAR1:=MA((VOL-REF(VOL,1))/REF(VOL,1),5);\nVAR2:=(CLOSE-MA(CLOSE,24))/MA(CLOSE,24)*100;\nMY: VAR2*(1+VAR1);\nSHT: MY, COLORSTICK;\nSHTMA: MA(SHT,N);"};return t},s.prototype.ZLJC=function(){var t={Name:"ZLJC",Description:"主力进出",IsMainIndex:!1,Args:[],Script:"VAR1:=(CLOSE+LOW+HIGH)/3; \nVAR2:=SUM(((VAR1-REF(LOW,1))-(HIGH-VAR1))*VOL/100000/(HIGH-LOW),0); \nVAR3:=EMA(VAR2,1); \nJCS:VAR3; \nJCM:MA(VAR3,12); \nJCL:MA(VAR3,26);"};return t},s.prototype.ZLMM=function(){var t={Name:"ZLMM",Description:"主力买卖",IsMainIndex:!1,Args:[],Script:"LC :=REF(CLOSE,1);\nRSI2:=SMA(MAX(CLOSE-LC,0),12,1)/SMA(ABS(CLOSE-LC),12,1)*100;\nRSI3:=SMA(MAX(CLOSE-LC,0),18,1)/SMA(ABS(CLOSE-LC),18,1)*100;\nMMS:MA(3*RSI2-2*SMA(MAX(CLOSE-LC,0),16,1)/SMA(ABS(CLOSE-LC),16,1)*100,3);\nMMM:EMA(MMS,8);\nMML:MA(3*RSI3-2*SMA(MAX(CLOSE-LC,0),12,1)/SMA(ABS(CLOSE-LC),12,1)*100,5);"};return t},s.prototype.SLZT=function(){var t={Name:"SLZT",Description:"神龙在天",IsMainIndex:!1,Args:[],Script:"白龙: MA(CLOSE,125);\n黄龙: 白龙+2*STD(CLOSE,170);\n紫龙: 白龙-2*STD(CLOSE,145);\n青龙: SAR(125,1,7), LINESTICK;\nVAR2:=HHV(HIGH,70);\nVAR3:=HHV(HIGH,20);\n红龙: VAR2*0.83;\n蓝龙: VAR3*0.91;"};return t},s.prototype.ADVOL=function(){var t={Name:"ADVOL",Description:"龙系离散量",IsMainIndex:!1,Args:[],Script:"A:=SUM(((CLOSE-LOW)-(HIGH-CLOSE))*VOL/10000/(HIGH-LOW),0);\nADVOL:A;\nMA1:MA(A,30);\nMA2:MA(MA1,100);"};return t},s.prototype.CYC=function(){var t={Name:"CYC",Description:"成本均线",IsMainIndex:!0,Args:[{Name:"P1",Value:5},{Name:"P2",Value:13},{Name:"P3",Value:34}],Script:"JJJ:=IF(DYNAINFO(8)>0.01,0.01*DYNAINFO(10)/DYNAINFO(8),DYNAINFO(3));\nDDD:=(DYNAINFO(5)<0.01 || DYNAINFO(6)<0.01);\nJJJT:=IF(DDD,1,(JJJ<(DYNAINFO(5)+0.01) && JJJ>(DYNAINFO(6)-0.01)));\nCYC1:IF(JJJT,0.01*EMA(AMOUNT,P1)/EMA(VOL,P1),EMA((HIGH+LOW+CLOSE)/3,P1));\nCYC2:IF(JJJT,0.01*EMA(AMOUNT,P2)/EMA(VOL,P2),EMA((HIGH+LOW+CLOSE)/3,P2));\nCYC3:IF(JJJT,0.01*EMA(AMOUNT,P3)/EMA(VOL,P3),EMA((HIGH+LOW+CLOSE)/3,P3));\nCYC4:IF(JJJT,DMA(AMOUNT/(100*VOL),100*VOL/FINANCE(7)),EMA((HIGH+LOW+CLOSE)/3,120));"};return t},s.prototype.CYS=function(){var t={Name:"CYS",Description:"市场盈亏",IsMainIndex:!1,Args:[],Script:"CYC13:EMA(AMOUNT,13)/EMA(VOL,13);\nCYS:(CLOSE-CYC13)/CYC13*100;"};return t},s.prototype.CYQKL=function(){var t={Name:"CYQKL",Description:"博弈K线长度",IsMainIndex:!1,Args:[],Script:"KL:100*(WINNER(CLOSE)-WINNER(OPEN));"};return t},s.prototype.SCR=function(){var t={Name:"SCR",Description:"筹码集中度",IsMainIndex:!1,Args:[{Name:"P1",Value:90}],Script:"A:=P1+(100-P1)/2;\nB:=(100-P1)/2;\nCC:=COST(A);\nDD:=COST(B);\nSCR:(CC-DD)/(CC+DD)*100/2;"};return t},s.prototype.ASR=function(){var t={Name:"ASR",Description:"浮筹比例",IsMainIndex:!1,Args:[],Script:"ASR:(WINNER(C*1.1)-WINNER(C*0.9))/WINNER(HHV(H,0))*100;"};return t},s.prototype.SAR=function(){var t={Name:"SAR",Description:"抛物转向",IsMainIndex:!0,Args:[{Name:"P",Value:10},{Name:"STEP",Value:2},{Name:"MAXP",Value:20}],Script:"S:SAR(P,STEP,MAXP),CIRCLEDOT;"};return t},s.prototype.TJCJL=function(){var t={Name:"太极成交量",Description:"太极成交量",IsMainIndex:!0,Args:[],Script:"总手:VOL,NODRAW;\nZZ:=IF(REF(C,1)>REF(O,1) AND O>REF(C,1)*1.014 AND C<O*1.02,1,3);\nV5:=MA(V,5);\nV12:=MA(V,12);\nV34:=MA(V,34);\nC6:=MA(C,6);\nSTICKLINE(VOL,0,VOL,10,0),COLORLIGRAY;\nSTICKLINE(CROSS(C,C6) AND V>V5*1.2 AND V>V12*1.2 AND ZZ>2 AND C>H*0.975,0,VOL,10,0),COLORRED;\nSTICKLINE(CROSS(C6,C) AND V>V5*1.2 AND V>V12*1.2,0,VOL,10,0),COLORGREEN;\nSTICKLINE(VOL>MA(VOL,5)*2 AND V>V34*3 AND C<REF(C,1)*1.05,0,VOL,10,0),COLORYELLOW;\nSTICKLINE(VOL<MA(VOL,5)/2 AND V<V12/2,0,VOL,10,0),COLORBLUE;\nSTICKLINE(VOL>MA(VOL,5)*2 AND V>V34*3 AND C<REF(C,1)*1.05 AND CROSS(C,C6) AND V>V5*1.2 AND V>V12*1.2 AND ZZ>2 AND C>H*0.975,VOL*0.5,0,10,0),COLORRED;\nSTICKLINE(VOL>MA(VOL,5)*2 AND V>V34*3 AND C<REF(C,1)*1.05 AND CROSS(C6,C) AND V>V5*1.2 AND V>V12*1.2,VOL*0.5,0,10,0),COLORRED;"};return t},s.prototype.VOLRate=function(){var t={Name:"量比",Description:"量比",IsMainIndex:!1,Condition:{Period:[i.MINUTE_ID,i.MULTIDAY_MINUTE_ID]},Args:[],Script:"LIANGBI:VOLR;"};return t},s.prototype.Dragon4_Main=function(){var t={Name:"飞龙四式",Description:"飞龙四式",IsMainIndex:!0,Args:[{Name:"N1",Value:5},{Name:"N2",Value:10},{Name:"N3",Value:50},{Name:"N4",Value:60}],Script:"蜻蜓点水:=EMA(CLOSE,N1),COLORGRAY;\n魔界:=EMA(CLOSE,N2),COLORGREEN;\n水:=EMA(CLOSE,N3),COLORRED;\nDRAWKLINE(HIGH,OPEN,LOW,CLOSE);\n生命线:MA(CLOSE,N4),COLORBLUE,LINETHICK2;\nDRAWBAND(魔界,'RGB(186,225,250)',水,'RGB(253,194,124)');\nDRAWBAND(蜻蜓点水,'RGB(128,138,135)',魔界,'RGB(0,0,255)');"};return t},s.prototype.Dragon4_Fig=function(){var t={Name:"飞龙四式",Description:"飞龙四式",IsMainIndex:!1,Args:[],Script:"倍:VOL>=REF(V,1)*1.90 AND C>REF(C,1),COLORYELLOW;\n低:VOL<REF(LLV(VOL,13),1),COLORGREEN;\n地:VOL<REF(LLV(VOL,100),1),COLORMAGENTA; \n平:=ABS(VOL-HHV(REF(VOL,1),5))/HHV(REF(VOL,1),5)<=0.03 OR ABS(VOL-REF(VOL,1))/REF(VOL,1)<=0.03,NODRAW,COLORWHITE;\n倍缩:VOL<=REF(V,1)*0.5,COLORFF8000;\n梯量:COUNT(V>REF(V,1),3)==3 AND COUNT(C>O,3)==3,COLORBROWN;\n缩量涨:COUNT(C>REF(C,1),2)==2 AND COUNT(V<REF(V,1),2)==2,COLORBLUE;\nSTICKLINE(C>=REF(C,1),V,0,2,0),COLORRED;\nSTICKLINE(C<REF(C,1),V,0,2,0),COLORGREEN;\nSTICKLINE(倍,0,V,2,0),COLORYELLOW;\nSTICKLINE(低,0,V,2,0),COLORGREEN;\nSTICKLINE(地,0,V,2,0),COLORLIMAGENTA;\nSTICKLINE(平,0,V,2,0),COLORGRAY;\nSTICKLINE(倍缩,0,V,2,0),COLORFF8000;\nSTICKLINE(梯量,0,V,2,0),COLORBROWN;\nSTICKLINE(缩量涨,0,V,2,0),COLORBLUE;"};return t},s.prototype.FundsAnalysis=function(){var t={Name:"资金分析",Description:"资金分析",IsMainIndex:!1,Args:[{Name:"M",Value:55},{Name:"N",Value:34}],Script:"LC:=REF(CLOSE,1);\nRSI:=((SMA(MAX((CLOSE - LC),0),3,1) / SMA(ABS((CLOSE - LC)),3,1)) * 100);\nFF:=EMA(CLOSE,3);\nMA15:=EMA(CLOSE,21); DRAWTEXT(CROSS(85,RSI),75,'▼'),COLORGREEN;\nVAR1:=IF(YEAR>=2038 AND MONTH>=1,0,1);\nVAR2:=REF(LOW,1)*VAR1;\nVAR3:=SMA(ABS(LOW-VAR2),3,1)/SMA(MAX(LOW-VAR2,0),3,1)*100*VAR1;\nVAR4:=EMA(IF(CLOSE*1.3,VAR3*10,VAR3/10),3)*VAR1;\nVAR5:=LLV(LOW,30)*VAR1;\nVAR6:=HHV(VAR4,30)*VAR1;\nVAR7:=IF(MA(CLOSE,58),1,0)*VAR1;\nVAR8:=EMA(IF(LOW<=VAR5,(VAR4+VAR6*2)/2,0),3)/618*VAR7*VAR1;\n吸筹A:IF(VAR8>100,100,VAR8)*VAR1,COLORFB2F3B;\n{吸筹B}STICKLINE(吸筹A>-150,0,吸筹A,8,0),COLORFB2F3B;\n\n散户线: 100*(HHV(HIGH,M)-CLOSE)/(HHV(HIGH,M)-LLV(LOW,M)),COLORAA89BD,LINETHICK2;\nRSV:=(CLOSE-LLV(LOW,N))/(HHV(HIGH,N)-LLV(LOW,N))*100;\nK:=SMA(RSV,3,1);\nD:=SMA(K,3,1);\nJ:=3*K-2*D;\n主力线:EMA(J,5),COLORF39800,LINETHICK2;\nDRAWICON(CROSS(主力线,散户线),主力线,1);\nDRAWICON(CROSS(散户线,主力线),主力线,2);"};return t},s.prototype.MarginProportion=function(){var t={Name:"融资占比(%)",Description:"融资占比",IsMainIndex:!1,Args:[],Script:"占比:MARGIN(2);"};return t},s.prototype.BTX=function(){var t={Name:"BTX",Description:"宝塔线",IsMainIndex:!1,Args:[],Script:"B1:=REF(C,1);\nB2:= REF(C, 2);\nSS:= IF(C > REF(C, 1) AND REF(C, 1) >= REF(C, 2), 1, IF(C < REF(C, 1) AND REF(C, 1) <= REF(C, 2), -1, IF(C > REF(C, 2) AND REF(C, 2) > REF(C, 1), 2, IF(C < REF(C, 2) AND REF(C, 2) < REF(C, 1), -2, 0))));\nSM:= IF(REF(SS, 1) <> 0, REF(SS, 1), IF(REF(SS, 2) <> 0, REF(SS, 2), IF(REF(SS, 3) <> 0, REF(SS, 3), IF(REF(SS, 5) <> 0, REF(SS, 5), IF(REF(SS, 6) <> 0, REF(SS, 6), IF(REF(SS, 7) <> 0, REF(SS, 7), 0))))));\nMC:= IF(REF(SS, 1) <> 0, B2, IF(SM > 0, MIN(B1, B2), MAX(B1, B2)));\nTOW1:= IF(C > REF(C, 1), C, REF(C, 1));\nTOW2:= IF((SS == -1 OR SS == -2) AND SM > 0, B2, TOW1);\nTOWER:= IF(TOW1 > TOW2, TOW1, TOW2);\nSTICKLINE(SS == 1 OR SM >= 1 AND SS == 0, B1, C, 10, 1), COLORRED;\nSTICKLINE(SS == -1 OR SM <= -1 AND SS == 0, B1, C, 10, 0), COLORCYAN;\nSTICKLINE(SS == 2, B2, C, 10, 1), COLORRED;\nSTICKLINE(SS == -2, B2, C, 10, 0), COLORCYAN;\nSTICKLINE((SS == -1 OR SS == -2) AND SM > 0, B2, B1, 10, 1), COLORRED;\nSTICKLINE((SS == 1 OR SS == 2) AND SM < 0, B2, B1, 10, 0), COLORCYAN;"};return t},s.prototype.EMPTY=function(){var t={Name:"",Description:"空指标",IsMainIndex:!0,Args:[],Script:"VAR2:=C;"};return t},s.prototype.FXG_BSPoint=function(){var t={Name:"操盘BS点",Description:"操盘BS点",IsMainIndex:!0,Args:[],Script:"MA5:MA(CLOSE,5);\n        MA13:MA(CLOSE,13);\n        MA21:MA(CLOSE,21);\n        MA34:MA(CLOSE,34);\n        {MA55:MA(CLOSE,55),COLOR0000FF;}\n        {MA120:=MA(CLOSE,120),COLORFFFF00;}\n        天使:=EMA(C,2),COLOR000000;\n        魔鬼:=EMA(SLOPE(C,21)*20+C,42),COLOR000000;\n        买:=CROSS(天使,魔鬼);\n        卖:=CROSS(魔鬼,天使);\n        DRAWICON(买,L*0.99,13),COLORYELLOW;\n        DRAWICON(卖,H*1.01,14),COLORGREEN;\n        DRAWKLINE_IF(天使>=魔鬼,HIGH,CLOSE,LOW,OPEN),COLORRED;\n        DRAWKLINE_IF(天使<魔鬼,HIGH,CLOSE,LOW,OPEN),COLORBLUE;\n        DRAWKLINE_IF(CROSS(天使,魔鬼),HIGH,CLOSE,LOW,OPEN),COLORYELLOW;\n        DRAWKLINE_IF(CROSS(魔鬼,天使),HIGH,CLOSE,LOW,OPEN),COLORBLACK;"};return t},s.prototype.NewsNegative=function(){var t={Name:"负面新闻",Description:"负面新闻统计",IsMainIndex:!1,Args:[{Name:"N",Value:5},{Name:"N2",Value:10}],Script:"负面:NEWS(1);\n                MA1:MA(负面,N);\n                MA2:MA(负面,N2);"};return t},s.prototype.NewsResearch=function(){var t={Name:"机构调研",Description:"机构调研统计",IsMainIndex:!1,Args:[{Name:"N",Value:5},{Name:"N2",Value:10}],Script:"次数:NEWS(2);\n                MA1:MA(次数,N);\n                MA2:MA(次数,N2);"};return t},s.prototype.NewsInteract=function(){var t={Name:"董秘连线",Description:"互动易统计",IsMainIndex:!1,Args:[{Name:"N",Value:5},{Name:"N2",Value:10}],Script:"个数:NEWS(3);\n                MA1:MA(个数,N);\n                MA2:MA(个数,N2);"};return t},s.prototype.UpDownAnalyze=function(){var t={Name:"涨跌趋势",Description:"涨跌趋势",IsMainIndex:!1,FloatPrecision:0,Args:[],Script:"上涨家数:UPCOUNT('CNA.CI'),COLORRED;\n下跌家数:DOWNCOUNT('CNA.CI'),COLORGREEN;"};return t},s.prototype.FXG_BSPoint=function(){var t={Name:"操盘BS点",Description:"操盘BS点",IsMainIndex:!0,Args:[],Script:'MA5:MA(CLOSE,5);\n        MA13:MA(CLOSE,13);\n        MA21:MA(CLOSE,21);\n        MA34:MA(CLOSE,34);\n        {MA55:MA(CLOSE,55),COLOR0000FF;}\n        {MA120:=MA(CLOSE,120),COLORFFFF00;}\n        天使:=EMA(C,2),COLOR000000;\n        魔鬼:=EMA(SLOPE(C,21)*20+C,42),COLOR000000;\n        买:=CROSS(天使,魔鬼);\n        卖:=CROSS(魔鬼,天使);\n        SUPERDRAWTEXT(买,L,"B",2,5),COLORYELLOW;\n        SUPERDRAWTEXT(卖,L,"S",1,5),COLORGREEN;\n        DRAWKLINE_IF(天使>=魔鬼,HIGH,CLOSE,LOW,OPEN),COLORRED;\n        DRAWKLINE_IF(天使<魔鬼,HIGH,CLOSE,LOW,OPEN),COLORBLUE;\n        DRAWKLINE_IF(CROSS(天使,魔鬼),HIGH,CLOSE,LOW,OPEN),COLORYELLOW;\n        DRAWKLINE_IF(CROSS(魔鬼,天使),HIGH,CLOSE,LOW,OPEN),COLORBLACK;'};return t},s.prototype.FXG_INDEX=function(){var t={Name:"涨停多空线",Description:"涨停多空线",IsMainIndex:!1,Args:[],Script:"做多能量线: SMA((CLOSE-LLV(LOW,9))/(HHV(HIGH,9)-LLV(LOW,9))*100,5,1)-8,COLORRED,LINETHICK3;\n做空能量线: SMA((HHV(HIGH,36)-CLOSE)/(HHV(HIGH,36)-LLV(LOW,36))*100,2,1),COLORGREEN,LINETHICK3;\n20,POINTDOT,COLORF00FF0;\n50,POINTDOT,COLORGREEN;\n80,POINTDOT,COLORLIBLUE;"};return t},s.prototype.FXG_INDEX2=function(){var t={Name:"涨停吸筹区",Description:"涨停吸筹区",IsMainIndex:!1,Args:[],Script:"VAR0:=EMA(HHV(HIGH,500),21); \nVAR1:=EMA(HHV(HIGH,250),21);\nVAR2:=EMA(HHV(HIGH,90),21); \nVAR3:=EMA(LLV(LOW,500),21); \nVAR4:=EMA(LLV(LOW,250),21); \nVAR5:=EMA(LLV(LOW,90),21);\n\nVAR6:=EMA((VAR3*0.96+VAR4*0.96+VAR5*0.96+VAR0*0.558+VAR1*0.558+VAR2*0.558)/6,21); \nVAR7:=EMA((VAR3*1.25+VAR4*1.23+VAR5*1.2+VAR0*0.55+VAR1*0.55+VAR2*0.65)/6,21); \nVAR8:=EMA((VAR3*1.3+VAR4*1.3+VAR5*1.3+VAR0*0.68+VAR1*0.68+VAR2*0.68)/6,21); \nVAR9:=EMA((VAR6*3+VAR7*2+VAR8)/6*1.738,21); \nVAR10:=REF(LOW,1); \nVAR11:=SMA(ABS(LOW-VAR10),3,1)/SMA(MAX(LOW-VAR10,0),3,1)*100; \nVAR12:=EMA(IFF(CLOSE*1.35<=VAR9,VAR11*10,VAR11/10),3); \nVAR13:=LLV(LOW,30); \nVAR14:=HHV(VAR12,30); \nVAR15:=IFF(MA(CLOSE,58),1,0); \nVAR16:=EMA(IFF(LOW<=VAR13,(VAR12+VAR14*2)/2,0),3)/618*VAR15;\n\n资金入场:IFF(VAR16>0,VAR16,0),LINETHICK,LINETHICK2, COLORFF0000; \n\nA1:IFF(资金入场>0,资金入场*1.2,0),STICK,LINETHICK5, COLORFF0000;\nA2:IFF(资金入场>0,资金入场*0.8,0),STICK,LINETHICK5, COLORFF6600;\nA3:IFF(资金入场>0,资金入场*0.6,0),STICK,LINETHICK5, COLORFF9900;\nA4:IFF(资金入场>0,资金入场*0.4,0) ,STICK,LINETHICK5,COLORFFCC00;\nA5:IFF(资金入场>0,资金入场*0.2,0) ,STICK,LINETHICK5,COLORFFFF00;"};return t},s.prototype.FXG_INDEX3=function(){var t={Name:"量能黄金点",Description:"量能黄金点",IsMainIndex:!1,Args:[],Script:"A:=IFF((CLOSE>126.32),VOL,VOL); \n主力:=MA(A,4),COLORRED;\n游资:=MA(A,8),COLORYELLOW;\n大户:=MA(A,16),COLORF0F000;\n散户:=MA(A,32),COLOR00FF00;\n主比:=ABS(((主力)/(主力 + 游资 + 大户 + 散户))*(100)),LINESTICK,COLORRED;\n游比:=ABS(((游资)/(主力 + 游资 + 大户 + 散户))*(100)),LINESTICK,COLORYELLOW;\n大比:=ABS(((大户)/(主力 + 游资 + 大户 + 散户))*(100)),LINESTICK,COLORF0F000;\n散比:=ABS(((散户)/(主力 + 游资 + 大户 + 散户))*(100)),LINESTICK,COLOR00FF00;\n警戒线:MA(A,180),COLORFF66FF;\nSTICKLINE((主力 > 0),0,主力,2.5,0),COLOR1020BB;\nSTICKLINE((主力 > 0),0,主力,0.7,0),COLORRED;\nSTICKLINE((游资 > 0),0,游资,2.5,0),COLOR009CFF;\nSTICKLINE((游资 > 0),0,游资,0.7,0),COLORYELLOW;\nSTICKLINE((大户 > 0),0,大户,2.5,0),COLORFF8800;\nSTICKLINE((大户 > 0),0,大户,0.7,0),COLORLIBLUE;\nSTICKLINE((散户 > 0),0,散户,2.5,0),COLOR00CA00;\nSTICKLINE((散户 > 0),0,散户,0.7,0),COLORGREEN;"};return t},s.prototype.COLOR_KSTAR1=function(){var t={Name:"十字星",Description:"十字星",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:CLOSE==OPEN&&HIGH>LOW;"};return t},s.prototype.COLOR_KSTAR2=function(){var t={Name:"早晨之星",Description:"早晨之星",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:(REF(CLOSE,2)/REF(OPEN,2)<0.95) && (REF(OPEN,1) < REF(CLOSE,2)) && (ABS(REF(OPEN,1)-REF(CLOSE,1))/REF(CLOSE,1)<0.03) && CLOSE/OPEN>1.05 && CLOSE>REF(CLOSE,2);"};return t},s.prototype.COLOR_KSTAR3=function(){var t={Name:"黄昏之星",Description:"黄昏之星",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:REF(CLOSE,2)/REF(OPEN,2)>1.05 && REF(OPEN,1)>REF(CLOSE,2) && ABS(REF(OPEN,1)-REF(CLOSE,1))/REF(CLOSE,1)<0.03 && CLOSE/OPEN<0.95 && CLOSE<REF(CLOSE,2);"};return t},s.prototype.COLOR_SHI1=function(){var t={Name:"长十字",Description:"长十字",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:CLOSE==OPEN&&HIGH/LOW>1.03;"};return t},s.prototype.COLOR_K220=function(){var t={Name:"身怀六甲",Description:"身怀六甲",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:ABS(REF(CLOSE,1)-REF(OPEN,1))/REF(CLOSE,1)>0.04&&\n            ABS(CLOSE-OPEN)/CLOSE<0.005&&\n            MAX(CLOSE,OPEN)<MAX(REF(CLOSE,1),REF(OPEN,1))&&\n            MIN(CLOSE,OPEN)>MIN(REF(CLOSE,1),REF(OPEN,1));"};return t},s.prototype.COLOR_K300=function(){var t={Name:"三个白武士",Description:"三个白武士",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:UPNDAY(CLOSE,3)&&NDAY(CLOSE,OPEN,3);"};return t},s.prototype.COLOR_K310=function(){var t={Name:"三只乌鸦",Description:"三只乌鸦",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:DOWNNDAY(CLOSE,3)&&NDAY(OPEN,CLOSE,3);"};return t},s.prototype.COLOR_K380=function(){var t={Name:"光头阳线",Description:"光头阳线",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:HIGH==CLOSE&&HIGH>LOW;"};return t},s.prototype.COLOR_K390=function(){var t={Name:"光脚阴线",Description:"光脚阴线",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:LOW==CLOSE&&HIGH>LOW;"};return t},s.prototype.COLOR_K134=function(){var t={Name:"垂死十字",Description:"垂死十字",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:CLOSE==OPEN&&CLOSE==LOW&&CLOSE<HIGH;"};return t},s.prototype.COLOR_K140=function(){var t={Name:"早晨十字星",Description:"早晨十字星",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:REF(CLOSE,2)/REF(OPEN,2)<0.95&&\nREF(OPEN,1)<REF(CLOSE,2)&&\nREF(OPEN,1)==REF(CLOSE,1)&&\nCLOSE/OPEN>1.05&&CLOSE>REF(CLOSE,2);"};return t},s.prototype.COLOR_K150=function(){var t={Name:"黄昏十字星",Description:"黄昏十字星",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:REF(CLOSE,2)/REF(OPEN,2)>1.05&&\nREF(OPEN,1)>REF(CLOSE,2)&&\nREF(OPEN,1)=REF(CLOSE,1)&&\nCLOSE/OPEN<0.95&&CLOSE<REF(CLOSE,2);"};return t},s.prototype.COLOR_K160=function(){var t={Name:"射击之星",Description:"射击之星",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:MIN(OPEN,CLOSE)==LOW&&\nHIGH-LOW>3*(MAX(OPEN,CLOSE)-LOW)&&\nCLOSE>MA(CLOSE,5);"};return t},s.prototype.COLOR_K165=function(){var t={Name:"倒转锤头",Description:"倒转锤头",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:MIN(OPEN,CLOSE)==LOW&&\nHIGH-LOW>3*(MAX(OPEN,CLOSE)-LOW)&&\nCLOSE<MA(CLOSE,5);"};return t},s.prototype.COLOR_K170=function(){var t={Name:"锤头",Description:"锤头",IsMainIndex:!0,InstructionType:2,Script:"OUT:HIGH==MAX(OPEN,CLOSE)&&\nHIGH-LOW>3*(HIGH-MIN(OPEN,CLOSE))&&\nCLOSE<MA(CLOSE,5);"};return t},s.prototype.COLOR_K180=function(){var t={Name:"吊颈",Description:"吊颈",IsMainIndex:!0,InstructionType:2,Script:"OUT:HIGH==MAX(OPEN,CLOSE)&&\nHIGH-LOW>3*(HIGH-MIN(OPEN,CLOSE))&&\nCLOSE>MA(CLOSE,5);"};return t},s.prototype.COLOR_K190=function(){var t={Name:"穿头破脚",Description:"穿头破脚",IsMainIndex:!0,InstructionType:2,Script:"OUT:(REF(CLOSE,1)/REF(OPEN,1)>1.03&&\nCLOSE/OPEN<0.96&&\nCLOSE<REF(OPEN,1)&&OPEN>REF(CLOSE,1))||\n(REF(CLOSE,1)/REF(OPEN,1)<0.97&&\nCLOSE/OPEN>1.04&&\nCLOSE>REF(OPEN,1)&&OPEN<REF(CLOSE,1));"};return t},s.prototype.COLOR_SWORD=function(){var t={Name:"剑",Description:"剑",IsMainIndex:!0,InstructionType:2,Script:"AA:=VOL>REF(VOL,1)||VOL>(CAPITAL*0.1);\nBB:=OPEN>=(REF(HIGH,1))&&REF(HIGH,1)>(REF(HIGH,2)*1.06);\nCC:=CLOSE>(REF(CLOSE,1))-(REF(CLOSE,1)*0.01);\nDD:=CLOSE<(HIGH*0.965) && HIGH>(OPEN*1.05);\nEE:=LOW<OPEN && LOW<CLOSE&&HIGH>(REF(CLOSE,1)*1.06);\nFF:=(HIGH-(MAX(OPEN,CLOSE)))/2>(MIN(OPEN,CLOSE))-LOW;\nGG:=(ABS(OPEN-CLOSE))/2<(MIN(OPEN,CLOSE)-LOW);\nSWORDO:AA&&BB&&CC&&DD&&EE&&FF&&GG;"};return t},s.prototype.COLOR_CSFR=function(){var t={Name:"出水芙蓉",Description:"出水芙蓉",IsMainIndex:!0,InstructionType:2,Script:"A:=CLOSE>OPEN;\nB:=A&&CLOSE>MA(CLOSE,S)&&CLOSE>MA(CLOSE,M)&&CLOSE>MA(CLOSE,LL);\nCC:=B&&OPEN<MA(CLOSE,M)&&OPEN<MA(CLOSE,LL);\nCSFRO:CC&&(CLOSE-OPEN)>0.0618*CLOSE;"};return t},s.prototype.COLOR_WYGD=function(){var t={Name:"乌云盖顶",Description:"乌云盖顶",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET( \nREF(CLOSE,1)/REF(OPEN,1)>1.03 AND \nCLOSE/OPEN<0.97 AND \nOPEN>REF(CLOSE,1) AND CLOSE<REF(CLOSE,1), 3);"};return t},s.prototype.COLOR_SGCJ=function(){var t={Name:"乌云盖顶",Description:"乌云盖顶",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET( \nREF(CLOSE,1)/REF(OPEN,1)<0.97 AND \nCLOSE/OPEN>1.03 AND \nOPEN<REF(CLOSE,1) AND CLOSE>REF(CLOSE,1), 3);"};return t},s.prototype.COLOR_SZTAI=function(){var t={Name:"十字胎",Description:"十字胎",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET( ABS(REF(CLOSE,1)-REF(OPEN,1))/REF(CLOSE,1) > 0.04 AND \nCLOSE==OPEN AND CLOSE < MAX(REF(CLOSE,1),REF(OPEN,1)) AND \nCLOSE > MIN(REF(CLOSE,1),REF(OPEN,1)), 2);"};return t},s.prototype.COLOR_PINGDING=function(){var t={Name:"平顶",Description:"平顶",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET(ABS(HIGH-REF(HIGH,1))/HIGH<0.001,2);"};return t},s.prototype.COLOR_PINGDI=function(){var t={Name:"平底",Description:"平底",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET((ABS(LOW-REF(LOW,1))/LOW<0.001 AND \nABS(REF(LOW,1)-REF(LOW,2))/REF(LOW,1)<=0.001),2);"};return t},s.prototype.COLOR_DAYANZHU=function(){var t={Name:"大阳烛",Description:"大阳烛",IsMainIndex:!0,InstructionType:2,Script:"VAR1:CLOSE/OPEN>1.05 AND HIGH/LOW < CLOSE/OPEN+0.018;"};return t},s.prototype.COLOR_DAYINGZHU=function(){var t={Name:"大阴烛",Description:"大阴烛",IsMainIndex:!0,InstructionType:2,Script:"VAR1:OPEN/CLOSE > 1.05 AND HIGH/LOW < OPEN/CLOSE+0.018;"};return t},s.prototype.COLOR_HYFG=function(){var t={Name:"好友反攻",Description:"好友反攻",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET( (REF(CLOSE,1)<REF(OPEN,1) AND \nCLOSE>OPEN AND ABS(CLOSE-REF(CLOSE,1))/CLOSE<0.002),2);"};return t},s.prototype.COLOR_TKQK=function(){var t={Name:"跳空缺口",Description:"跳空缺口",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET( HIGH<REF(LOW,1) OR LOW>REF(HIGH,1),2);"};return t},s.prototype.COLOR_SFWY=function(){var t={Name:"双飞乌鸦",Description:"双飞乌鸦",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET( REF(CLOSE,1)<REF(OPEN,1) AND CLOSE<OPEN AND CLOSE/OPEN<0.98,1);"};return t},s.prototype.COLOR_SSSBQ=function(){var t={Name:"上升三部曲",Description:"上升三部曲",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET( \nREF(CLOSE,4)/REF(OPEN,4)>1.03 AND \nREF(CLOSE,3)<REF(OPEN,3) AND \nREF(CLOSE,2)<REF(OPEN,2) AND \nREF(CLOSE,1)<REF(OPEN,1) AND \nREF(LOW,4)<REF(LOW,3) AND \nREF(LOW,4)<REF(LOW,2) AND \nREF(LOW,4)<REF(LOW,1) AND \nREF(HIGH,4)>REF(HIGH,3) AND \nREF(HIGH,4)>REF(HIGH,2) AND \nREF(HIGH,4)>REF(HIGH,1) AND \nCLOSE/OPEN>1.03 AND \nCLOSE>REF(CLOSE,4), 5);"};return t},s.prototype.COLOR_XDSBQ=function(){var t={Name:"下跌三部曲",Description:"下跌三部曲",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET( \nREF(CLOSE,4)/REF(OPEN,4)<0.97 AND \nREF(CLOSE,3)>REF(OPEN,3) AND \nREF(CLOSE,2)>REF(OPEN,2) AND \nREF(CLOSE,1)>REF(OPEN,1) AND \nREF(LOW,4)<REF(LOW,3) AND \nREF(LOW,4)<REF(LOW,2) AND \nREF(LOW,4)<REF(LOW,1) AND \nREF(HIGH,4)>REF(HIGH,3) AND \nREF(HIGH,4)>REF(HIGH,2) AND \nREF(HIGH,4)>REF(HIGH,1) AND \nCLOSE/OPEN<0.97 AND \nCLOSE<REF(CLOSE,4), 5);"};return t},s.prototype.COLOR_CHXY=function(){var t={Name:"长下影",Description:"长下影",IsMainIndex:!0,InstructionType:2,Script:"VAR2:(MIN(CLOSE,OPEN)-LOW)/(HIGH-LOW)>0.667;"};return t},s.prototype.COLOR_CHSY=function(){var t={Name:"长上影",Description:"长上影",IsMainIndex:!0,InstructionType:2,Script:"VAR2:(HIGH-MAX(CLOSE,OPEN))/(HIGH-LOW)>0.667,COLORBLUE;"};return t},s.prototype.COLOR_FENLI=function(){var t={Name:"分离",Description:"分离",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET( OPEN==REF(OPEN,1) AND (CLOSE-OPEN)*(REF(CLOSE,1)-REF(OPEN,1))<0,2);"};return t},s.prototype.TRADE_BIAS=function(){var t={Name:"BIAS",Description:"乖离率专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:12},{Name:"LL",Value:6},{Name:"LH",Value:6}],Script:"BIAS:=(CLOSE-MA(CLOSE,N))/MA(CLOSE,N)*100;\nENTERLONG:CROSS(-LL,BIAS);\nEXITLONG:CROSS(BIAS,LH);"};return t},s.prototype.TRADE_CCI=function(){var t={Name:"CCI",Description:"CCI专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:14}],Script:"TYP:=(HIGH+LOW+CLOSE)/3;\nCCI:=(TYP-MA(TYP,N))/(0.015*AVEDEV(TYP,N));\nINDEX:=CCI;\nENTERLONG:CROSS(INDEX,-100);\nEXITLONG:CROSS(100,INDEX);"};return t},s.prototype.TRADE_DMI=function(){var t={Name:"DMI",Description:"趋向专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:14}],Script:"MTR:=SUM(MAX(MAX(HIGH-LOW,ABS(HIGH-REF(CLOSE,1))),ABS(LOW-REF(CLOSE,1))),N);\nHD :=HIGH-REF(HIGH,1);\nLD :=REF(LOW,1)-LOW;\nPDM:=SUM(IF(HD>0&&HD>LD,HD,0),N);\nMDM:=SUM(IF(LD>0&&LD>HD,LD,0),N);\nPDI:=PDM*100/MTR;\nMDI:=MDM*100/MTR;\nENTERLONG:CROSS(PDI,MDI);\nEXITLONG:CROSS(MDI,PDI);"};return t},s.prototype.TRADE_KD=function(){var t={Name:"KD",Description:"KD指标专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:9},{Name:"M1",Value:3},{Name:"M2",Value:3}],Script:"WRSV:=(CLOSE-LLV(LOW,N))/(HHV(HIGH,N)-LLV(LOW,N))*100;\nWK:=SMA(WRSV,M1,1);\nD:=SMA(WK,M2,1);\nENTERLONG:CROSS(WK,D)&&WK<20;\nEXITLONG:CROSS(D,WK)&&WK>80;"};return t},s.prototype.TRADE_BOLL=function(){var t={Name:"BOLL",Description:"布林带专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:20}],Script:"MID :=MA(CLOSE,N);\nUPPER:=MID+2*STD(CLOSE,N);\nLOWER:=MID-2*STD(CLOSE,N);\nENTERLONG:CROSS(CLOSE,LOWER);\nEXITLONG:CROSS(CLOSE,UPPER);"};return t},s.prototype.TRADE_KDJ=function(){var t={Name:"KDJ",Description:"KDJ专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:9},{Name:"M1",Value:3}],Script:"RSV:=(CLOSE-LLV(LOW,N))/(HHV(HIGH,N)-LLV(LOW,N))*100;\nK:=SMA(RSV,M1,1);\nD:=SMA(K,M1,1);\nJ:=3*K-2*D;\nENTERLONG:CROSS(J,0);\nEXITLONG:CROSS(100,J);"};return t},s.prototype.TRADE_MA=function(){var t={Name:"MA",Description:"均线专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"SHORT",Value:5},{Name:"LONG",Value:20}],Script:"ENTERLONG:CROSS(MA(CLOSE,SHORT),MA(CLOSE,LONG));\nEXITLONG:CROSS(MA(CLOSE,LONG),MA(CLOSE,SHORT));"};return t},s.prototype.TRADE_MACD=function(){var t={Name:"MACD",Description:"MACD专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"LONG",Value:26},{Name:"SHORT",Value:12},{Name:"M",Value:9}],Script:"DIFF:=EMA(CLOSE,SHORT) - EMA(CLOSE,LONG);\nDEA  := EMA(DIFF,M);\nMACD := 2*(DIFF-DEA);\nENTERLONG:CROSS(MACD,0);\nEXITLONG:CROSS(0,MACD);"};return t},s.prototype.TRADE_MTM=function(){var t={Name:"MTM",Description:"动力指标专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:6}],Script:"WMTM:=C-REF(C,N);\nENTERLONG:CROSS(WMTM,0);\nEXITLONG:CROSS(0,WMTM);"};return t},s.prototype.TRADE_PSY=function(){var t={Name:"PSY",Description:"PSY心理线专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:12},{Name:"LL",Value:10},{Name:"LH",Value:85}],Script:"MYPSY:=COUNT(CLOSE>REF(CLOSE,1),N)/N*100;\nENTERLONG:CROSS(LL,MYPSY);\nEXITLONG:CROSS(MYPSY,LH);"};return t},s.prototype.TRADE_ROC=function(){var t={Name:"ROC",Description:"变动速率专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:12},{Name:"M",Value:6}],Script:"WROC:=MA(100*(CLOSE-REF(CLOSE,N))/REF(CLOSE,N),M);\nENTERLONG:CROSS(WROC,0);\nEXITLONG:CROSS(0,WROC);"};return t},s.prototype.TRADE_RSI=function(){var t={Name:"RSI",Description:"相对强弱专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:6},{Name:"LL",Value:20},{Name:"LH",Value:80}],Script:"LC:=REF(CLOSE,1);\nWRSI:=SMA(MAX(CLOSE-LC,0),N,1)/SMA(ABS(CLOSE-LC),N,1)*100;\nENTERLONG:CROSS(WRSI,LL);\nEXITLONG:CROSS(LH,WRSI);"};return t},s.prototype.TRADE_VR=function(){var t={Name:"VR",Description:"VR容量比率专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:26},{Name:"LL",Value:70},{Name:"LH",Value:250}],Script:"WVR := SUM((IF(CLOSE>OPEN,VOL,0)+IF(CLOSE=OPEN,VOL/2,0)),N)/SUM((IF(CLOSE<OPEN,VOL,0)+IF(CLOSE=OPEN,VOL/2,0)),N)*100;\nENTERLONG:CROSS(LL,WVR);\nEXITLONG:CROSS(WVR,LH);"};return t},s.prototype.TRADE_DPSJ=function(){var t={Name:"DPSJ",Description:"大盘随机专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N1",Value:18},{Name:"N2",Value:12}],Script:"RSV:=(INDEXC-LLV(INDEXL,N1))/(HHV(INDEXH,N1)-LLV(INDEXL,N1))*100;\nK:=SMA(RSV,N2,1);\nHSL:VOL/100/(FINANCE(7));\nENTERLONG: CROSS(K,20);\nEXITLONG: (CROSS(HSL,5) OR CROSS(K,80));"};return t},s.prototype.TEST=function(){var t={Name:"TEST",Description:"测试脚本",IsMainIndex:!1,Args:[{Name:"N",Value:10}],Script:"买入压力:=H-REF(C,1)+(C-L);\n                卖出压力:=REF(C,1)-L+(H-C);\n                K1:=买入压力/(买入压力+卖出压力)/10;\n                K2:=卖出压力/(买入压力+卖出压力)/10;\n                A01:=(2*C+O+L+H)/5;\n                A02:=(WINNER((A01 * 1.04)) * 100);\n                套牢角度:=57.2958*ATAN(A02-REF(A02,1));\n                A03:=(WINNER((A01 * 0.96)) * 100);\n                盈利筹码:A03;\n                A04:=A03;\n                A08:=A02-A03;\n                A06:=(100 - A02);\n                套牢筹码:=A06;\n                STICKLINE( 1,0,A04, 2,0),COLOR0000FF;\n                STICKLINE( 1, 100,A02, 2,0),COLOR00FF00;\n                STICKLINE( 1,A04,(100-A06), 2,0),COLORYELLOW;"};return t},s.prototype.Zealink_Index1=function(){var t={Name:"资金吸筹",Description:"资金吸筹",IsMainIndex:!1,Args:[],Script:"VAR1:=REF((LOW+OPEN+CLOSE+HIGH)/4,1);  \nVAR2:= SMA(ABS(LOW - VAR1), 13, 1) / SMA(MAX(LOW - VAR1, 0), 10, 1);\nVAR3:= EMA(VAR2, 10);\nVAR4:= LLV(LOW, 33);\nVAR5:= EMA(IF(LOW <= VAR4, VAR3, 0), 3) * 0.2;\n主力进场: IF(VAR5 > REF(VAR5, 1), VAR5,0), COLORRED, NODRAW;\n洗盘: IF(VAR5 < REF(VAR5, 1), VAR5,0), COLORYELLOW, NODRAW;\nSTICKLINE(VAR5> REF(VAR5, 1),0, VAR5, 50, 0), COLORRED;\nSTICKLINE(VAR5 < REF(VAR5, 1), 0, VAR5, 50, 0), COLORYELLOW;"};return t},s.prototype.Zealink_Index2=function(){var t={Name:"牛熊区间",Description:"牛熊区间",IsMainIndex:!1,YSpecificMaxMin:{Max:100,Min:1,Count:4},YSplitScale:[1,50,100],Args:[],Script:"短高H:=(20*H+19*REF(H,1)+18*REF(H,2)+17*REF(H,3)+16*REF(H,4)+15*REF(H,5)+14*REF(H,6)\n+ 13 * REF(H, 7) + 12 * REF(H, 8) + 11 * REF(H, 9) + 10 * REF(H, 10) + 9 * REF(H, 11) + 8 * REF(H, 12)\n+ 7 * REF(H, 13) + 6 * REF(H, 14) + 5 * REF(H, 15) + 4 * REF(H, 16) + 3 * REF(H, 17) + 2 * REF(H, 18) +\nREF(H, 20))/ 210, COLORBLUE, LINETHICK1;\n短低L:= (20 * L + 19 * REF(L, 1) + 18 * REF(L, 2) + 17 * REF(L, 3) + 16 * REF(L, 4) + 15 * REF(L, 5) + 14 * REF(L, 6)\n+ 13 * REF(L, 7) + 12 * REF(L, 8) + 11 * REF(L, 9) + 10 * REF(L, 10) + 9 * REF(L, 11) + 8 * REF(L, 12)\n+ 7 * REF(L, 13) + 6 * REF(L, 14) + 5 * REF(L, 15) + 4 * REF(L, 16) + 3 * REF(L, 17) + 2 * REF(L, 18) +\nREF(L, 20)) / 210, COLORBLUE, LINETHICK1;\nD90H:= EMA(短高H, 90), COLORRED, LINETHICK1;\nD90L:= EMA(短低L, 90), COLORRED, LINETHICK1;\nD90差:= D90H - D90L;\nD90顶:= D90H + D90差 * 2, COLORRED, LINETHICK1;\nD90底:= D90L - D90差 * 2, COLORRED, LINETHICK1;\n高0:= (EMA(EMA(H, 25), 25) - EMA(EMA(L, 25), 25)) * 1 + EMA(EMA(H, 25), 25), LINETHICK1, COLORWHITE;\n低0:= EMA(EMA(L, 25), 25) - (EMA(EMA(H, 25), 25) - EMA(EMA(L, 25), 25)) * 1, LINETHICK1, COLORWHITE;\n多头定位:= 低0 >= D90底 AND 高0 >= D90顶;\n空头定位:= 高0 <= D90顶 AND 低0 <= D90底;\n震荡定位:= 低0 >= D90底 AND 高0 <= D90顶;\n牛市: IF(多头定位 == 1, 100, 1), COLORRED, NODRAW;\n熊市: IF(空头定位 == 1, 100, 1), COLORGREEN, NODRAW;\n震荡: IF(震荡定位 == 1, 100, 1), COLORGRAY, NODRAW;\nSTICKLINE(多头定位 == 1, 100, 1, 100, 0), COLORRED;\nSTICKLINE(空头定位 == 1, 100, 1, 100, 0), COLORGREEN;\nSTICKLINE(震荡定位 == 1, 100, 1, 100, 0), COLORGRAY;"};return t},s.prototype.Zealink_Index3=function(){var t={Name:"持仓信号",Description:"持仓信号",IsMainIndex:!0,Args:[],Script:'买线:=EMA(C,2);\n卖线:=EMA(SLOPE(C,30)*5+C,20); \nBU:=CROSS(买线,卖线);\nSEL:=CROSS(卖线,买线);\n\nSTICKLINE(买线>=卖线 AND CLOSE>OPEN,LOW,HIGH,0,1),COLORRED;\nSTICKLINE(买线>=卖线 AND CLOSE<OPEN,LOW,HIGH,0,1),COLORRED;\nSTICKLINE(买线>=卖线 AND CLOSE>OPEN,CLOSE,OPEN,50,1),COLORRED;\nSTICKLINE(买线>=卖线 AND CLOSE<OPEN,CLOSE,OPEN,50,0),COLORRED;\nSTICKLINE(买线<卖线 AND CLOSE<OPEN,LOW,HIGH,0,1),COLORGREEN;\nSTICKLINE(买线<卖线 AND CLOSE>OPEN,LOW,HIGH,0,1),COLORGREEN;\nSTICKLINE(买线<卖线 AND CLOSE<OPEN,CLOSE,OPEN,50,0),COLORGREEN;\nSTICKLINE(买线<卖线 AND CLOSE>OPEN,CLOSE,OPEN,50,1),COLORGREEN;\n\nHHJSJDA:=(3*CLOSE+OPEN+LOW+HIGH)/6;\nHHJSJDB:=(19*HHJSJDA+19*REF(HHJSJDA,1)+18*REF(HHJSJDA,2)+17*REF(HHJSJDA,3)+16*REF(HHJSJDA,4)+15*REF(HHJSJDA,5)+14*REF(HHJSJDA,6)\n+13*REF(HHJSJDA,7)+12*REF(HHJSJDA,8)+11*REF(HHJSJDA,9)+10*REF(HHJSJDA,10)+9*REF(HHJSJDA,11)+8*REF(HHJSJDA,12)+7*REF(HHJSJDA,13)+6*REF(HHJSJDA,14)+5*REF(HHJSJDA,15)+4*REF(HHJSJDA,16)+3*REF(HHJSJDA,17)+2*REF\n(HHJSJDA,20)+REF(HHJSJDA,19))/210,COLORYELLOW;\nHHJSJDC:=MA(HHJSJDB,5),COLORRED;\n快线:HHJSJDB,COLORYELLOW;\n慢线:HHJSJDC,COLORRED;\n\nSVAR11:=HHV(HIGH,34);\nSVAR14:=CLOSE-REF(CLOSE,1);\nSVAR15:=MAX(SVAR14,0);\nSVAR16:=ABS(SVAR14);\nSVAR17:=SMA(SVAR15,7,1)/SMA(SVAR16,7,1)*100;\nSVAR18:=SMA(SVAR15,13,1)/SMA(SVAR16,13,1)*100;\nSVAR19:=BARSCOUNT(CLOSE);\nSVAR20:=SMA(MAX(SVAR14,0),6,1)/SMA(ABS(SVAR14),6,1)*100;\nSVAR21:=(-200)*(HHV(HIGH,60)-CLOSE)/(HHV(HIGH,60)-LLV(LOW,60))+100;\nSVAR1A:=(CLOSE-LLV(LOW,15))/(HHV(HIGH,15)-LLV(LOW,15))*100;\nSVAR1B:=SMA((SMA(SVAR1A,4,1)-50)*2,3,1);\nSVAR1C:=(INDEXC-LLV(INDEXL,14))/(HHV(INDEXH,14)-LLV(INDEXL,14))*100;\nSVAR1D:=SMA(SVAR1C,4,1);\nSVAR1E:=SMA(SVAR1D,3,1);\nSVAR1F:=(HHV(HIGH,30)-CLOSE)/CLOSE*100;\nSVAR22:=SVAR20<=25 AND SVAR21<-95 AND SVAR1F>20 AND SVAR1B<-30 AND SVAR1E<30 AND SVAR11-CLOSE>=-0.25 AND SVAR17<22 AND SVAR18<28 AND SVAR19>50;\nBUY3:=CROSS(SVAR22,0.5) AND COUNT(SVAR22==1,10)==1;\n\nSVARF:=LOW*0.9;\nSVAR10X:=100-3*SMA((OPEN-LLV(LOW,75))/(HHV(HIGH,75)-LLV(LOW,75))*100,20,1)+2*SMA(SMA((OPEN-LLV(LOW,75))/(HHV(HIGH,75)-LLV(LOW,75))*100,20,1),15,1);\nSVAR11X:=SVARF<REF(SVAR10X,1) AND VOL>REF(VOL,1) AND CLOSE>REF(CLOSE,1);\nBUY2:=SVAR11X AND COUNT(SVAR11X,30)==1;\n\nVAR1:=(CLOSE+HIGH+LOW+OPEN)/4;\nVAR2:=SUMBARS(VOL,CAPITAL);\nVAR3:=HHV(VAR1,VAR2);\nVAR4:=LLV(VAR1,VAR2);\nVAR5:=(2*VAR1-VAR4-REF(VAR4,1))/(VAR3-VAR4);\nVAR6:=(VAR1-VAR4)/(VAR3-VAR4);\nVAR7:=IF(VAR1<=VAR4,VAR5*60,VAR6*60);\nVAR8:=600*(EMA(CLOSE,3)-EMA(LOW,30))/EMA(LOW,30);\nVAR9:=EMA(VAR8,7);\nVARC:=HHV(HIGH,9)-LLV(LOW,9);\nVARD:=HHV(HIGH,9)-CLOSE;\nVARE:=CLOSE-LLV(LOW,9);\nVARF:=VARD/VARC*100-70;\nVAR10:=(CLOSE-LLV(LOW,60))/(HHV(HIGH,60)-LLV(LOW,60))*100;\nVAR11:=(2*CLOSE+HIGH+LOW)/4;\nVAR12:=SMA(VARE/VARC*100,3,1);\nVAR13:=LLV(LOW,34);\nVAR14:=SMA(VAR12,3,1)-SMA(VARF,9,1);\nVAR15:=IF(VAR14>100,VAR14-100,0);\nVAR16:=HHV(HIGH,34);\nVAR17:=EMA((VAR11-VAR13)/(VAR16-VAR13)*100,8);\nVAR18:=EMA(VAR17,5);\nBUY:=STICKLINE(VAR17-VAR18>0,VAR17,VAR18,8,1),COLORRED;\nSELL:=STICKLINE(VAR17-VAR18<0,VAR17,VAR18,8,1),COLORGREEN;\nBUY1:=VAR17>VAR18 AND REF(VAR17,1)<REF(VAR18,1);\nSELL1:=VAR17<VAR18 AND REF(VAR17,1)>REF(VAR18,1);\n\n短高H:=(20*H+19*REF(H,1)+18*REF(H,2)+17*REF(H,3)+16*REF(H,4)+15*REF(H,5)+14*REF(H,6)\n+13*REF(H,7)+12*REF(H,8)+11*REF(H,9)+10*REF(H,10)+9*REF(H,11)+8*REF(H,12)\n+7*REF(H,13)+6*REF(H,14)+5*REF(H,15)+4*REF(H,16)+3*REF(H,17)+2*REF(H,18)+\nREF(H,20))/210,COLORBLUE,LINETHICK1;\n短低L:=(20*L+19*REF(L,1)+18*REF(L,2)+17*REF(L,3)+16*REF(L,4)+15*REF(L,5)+14*REF(L,6)\n+13*REF(L,7)+12*REF(L,8)+11*REF(L,9)+10*REF(L,10)+9*REF(L,11)+8*REF(L,12)\n+7*REF(L,13)+6*REF(L,14)+5*REF(L,15)+4*REF(L,16)+3*REF(L,17)+2*REF(L,18)+\nREF(L,20))/210,COLORBLUE,LINETHICK1;\nD90H:=EMA(短高H,90),COLORRED,LINETHICK1;\nD90L:=EMA(短低L,90),COLORRED,LINETHICK1;\nD90差:=D90H-D90L;\nD90顶:=D90H+D90差*2,COLORRED,LINETHICK1;\nD90底:=D90L-D90差*2,COLORRED,LINETHICK1;\n高0:=(EMA(EMA(H,25),25)-EMA(EMA(L,25),25))*1+EMA(EMA(H,25),25),LINETHICK1,COLORWHITE;\n低0:=EMA(EMA(L,25),25)-(EMA(EMA(H,25),25)-EMA(EMA(L,25),25))*1,LINETHICK1,COLORWHITE;\n多头定位:=低0>=D90底 AND 高0>=D90顶;\n空头定位:=高0<=D90顶 AND 低0<=D90底;\n震荡定位:=低0>=D90底 AND 高0<=D90顶;\n\n牛市:=多头定位==1;\n熊市:=空头定位==1;\n震荡:=震荡定位==1;\n\n非牛市:=熊市 OR 震荡;\n非熊市:=牛市 OR 震荡;\n\nBUY11:=BUY1 AND 非熊市;\nSELL11:=SELL1 AND 震荡定位==0;\n\nBUY111:=BUY11 AND COUNT(BUY11,10)<2;\nBUY0:=BUY111 AND COUNT(BUY111,21)==1;\nSELL111:=SELL11 AND COUNT(SELL11,10)<2;\nSELL0:=SELL111 AND COUNT(SELL111,10)==1;\n\nXK1:=EMA(100*(CLOSE-LLV(LOW,34))/(HHV(HIGH,34)-LLV(LOW,34)),3)/4;\n上穿:=REF(XK1,1)<5 AND XK1>=5;\nBUY4:=上穿 AND COUNT(XK1<2,12)<1;\n\nSELL2:=REF(XK1,1)<=22.5 AND XK1>22.5 AND COUNT(REF(XK1,1)>=22.5 AND XK1<22.5,5)>0;\nSELL3:=REF(XK1,1)>=21.5 AND XK1<21.5 AND COUNT(REF(XK1,1)>=22.5 AND XK1<22.5,12)>1;\nSELL4:=SELL2 OR SELL3 AND COUNT((SELL2 OR SELL3)==1,5)==1;\n\nSUPERDRAWTEXT(BUY0,L,"机会",2,10),COLORRED;\nSUPERDRAWTEXT(SELL0,H,"风险",1,10),COLORGREEN;\nSUPERDRAWTEXT(BUY2,L,"机会",2,10),COLORRED;\nSUPERDRAWTEXT(BUY4,L,"机会",2,10),COLORRED;\nSUPERDRAWTEXT(SELL4,H,"风险",1,10),COLORGREEN;'};return t},s.prototype.Zealink_Index4=function(){var t={Name:"股东实际增减持",Description:"股东实际增减持",IsMainIndex:!1,FloatPrecision:0,Args:[],Script:"增持:NEWS(4),NODRAW,COLORRED;\n减持:NEWS(5),NODRAW,COLORGREEN;\nSTICKLINE(增持>0,0,增持,1,0),COLORRED;\nSTICKLINE(减持<0,0,减持,1,0),COLORGREEN;"};return t},s.prototype.Zealink_Index5=function(){var t={Name:"大宗交易",Description:"大宗交易",IsMainIndex:!1,FloatPrecision:0,Args:[],Script:"交易次数:NEWS(7);"};return t},s.prototype.Zealink_Index6=function(){var t={Name:"信托持股",Description:"信托持股",IsMainIndex:!1,FloatPrecision:0,Args:[],Script:"家数:NEWS(6);"};return t},s.prototype.Zealink_Index7=function(){var t={Name:"官网新闻",Description:"官网新闻",IsMainIndex:!1,FloatPrecision:0,Args:[],Script:"个数:NEWS(8);"};return t},s.prototype.Zealink_Index8=function(){var t={Name:"高管要闻",Description:"高管要闻",IsMainIndex:!1,FloatPrecision:0,Args:[],Script:"个数:NEWS(9);"};return t},s.prototype.Zealink_Index9=function(){var t={Name:"股权质押",Description:"股权质押",IsMainIndex:!1,FloatPrecision:0,Args:[],Script:"次数:NEWS(10);"};return t},s.prototype.CJL=function(){var t={Name:"CJL",Description:"期货持仓量",IsMainIndex:!1,Args:[],Script:"成交量:VOL,VOLSTICK;\n持仓量:VOLINSTK,LINEOVERLAY;"};return t},s.prototype.SQJZ=function(){var t={Name:"SQJZ",Description:"神奇九转",IsMainIndex:!0,Script:"B:=C<REF(C,4);\nN:=CURRBARSCOUNT;\nB1:=(N=6 AND REFXV(COUNT(B,6),5)=6) OR (N=7 AND REFXV(COUNT(B,7),6)=7) OR (N=8 AND REFXV(COUNT(B,8),7)=8) OR (N>=9 AND REFXV(COUNT(B,9),8)=9);\nDRAWNUMBER(B1 AND REF(B,1)=0,L,1),COLORMAGENTA;\nB2:=(N=5 AND REFXV(COUNT(B,6),4)=6) OR (N=6 AND REFXV(COUNT(B,7),5)=7) OR (N=7 AND REFXV(COUNT(B,8),6)=8) OR (N>=8 AND REFXV(COUNT(B,9),7)=9);\nDRAWNUMBER(B2 AND REF(B,2)=0,L,2),COLORMAGENTA;\nB8:=(N=1 AND COUNT(B,8)=8) OR (N>=2 AND REFXV(COUNT(B,9),1)=9);\nDRAWNUMBER(B8 AND REF(B,8)=0,L,8),COLORMAGENTA;\nB9:=(N>=1 AND COUNT(B,9)=9);\nDRAWNUMBER(B9 AND REF(B,9)=0,L,9),COLORBROWN;\nS:=C>REF(C,4);\nS1:=(N=6 AND REFXV(COUNT(S,6),5)=6) OR (N=7 AND REFXV(COUNT(S,7),6)=7) OR (N=8 AND REFXV(COUNT(S,8),7)=8) OR (N>=9 AND REFXV(COUNT(S,9),8)=9);\nDRAWNUMBER(S1 AND REF(S,1)=0,H,1),COLORMAGENTA,DRAWABOVE;\nS2:=(N=5 AND REFXV(COUNT(S,6),4)=6) OR (N=6 AND REFXV(COUNT(S,7),5)=7) OR (N=7 AND REFXV(COUNT(S,8),6)=8) OR (N>=8 AND REFXV(COUNT(S,9),7)=9);\nDRAWNUMBER(S2 AND REF(S,2)=0,H,2),COLORMAGENTA,DRAWABOVE;\nS8:=(N=1 AND COUNT(S,8)=8) OR (N>=2 AND REFXV(COUNT(S,9),1)=9);\nDRAWNUMBER(S8 AND REF(S,8)=0,H,8),COLORMAGENTA,DRAWABOVE;\nS9:=(N>=1 AND COUNT(S,9)=9);\nDRAWNUMBER(S9 AND REF(S,9)=0,H,9),COLORGREEN,DRAWABOVE;"};return t},s.prototype.XT=function(){var t={Name:"XT",Description:"箱体",IsMainIndex:!0,Args:[{Name:"N",Value:10}],Script:"【箱顶】:PEAK(CLOSE,N,1)*0.98;\n【箱底】:TROUGH(CLOSE,N,1)*1.02;\n【箱高】:100*(【箱顶】-【箱底】)/【箱底】,NODRAW;"};return t},s.prototype.CFJT=function(){var t={Name:"CFJT",Description:"财富阶梯",IsMainIndex:!0,Script:"突破:=REF(EMA(C,14),1);\nA1X:=(EMA(C,10)-突破)/突破*100;\n多方:=IF(A1X>=0,REF(EMA(C,10),BARSLAST(CROSS(A1X,0))+1),DRAWNULL);\n空方:=IF(A1X<0,REF(EMA(C,10),BARSLAST(CROSS(0,A1X))+1),DRAWNULL);\nSTICKLINE(A1X>=0,多方,突破,110,0),COLORRED;\nSTICKLINE(A1X<0,空方,突破,110,0),COLORGREEN;"};return t},s.prototype.CYX=function(){var t={Name:"CYX",Description:"撑压线",IsMainIndex:!0,Args:[{Name:"N",Value:7}],Script:"Z1:=STRCAT(HYBLOCK,' ');\nZ2:=STRCAT(Z1,DYBLOCK);\nZ3:=STRCAT(Z2,' ');\nDRAWTEXT_FIX(ISLASTBAR,0,0,0,STRCAT(Z3,GNBLOCK)),COLOR00C0C0;\nA1:=REF(H,N)=HHV(H,2*N+1);\nB1:=FILTER(A1,N);\nC1:=BACKSET(B1,N+1);\nD1:=FILTER(C1,N);\nA2:=REF(L,N)=LLV(L,2*N+1);\nB2:=FILTER(A2,N);\nC2:=BACKSET(B2,N+1);\nD2:=FILTER(C2,N);\nE1:=(REF(LLV(L,2*N),1)+REF(HHV(H,2*N),1))/2;\nE2:=(H+L)/2;\nH1:=(D1 AND NOT(D2 AND E1>=E2)) OR ISLASTBAR OR BARSCOUNT(C)=1;\nL1:=(D2 AND NOT(D1 AND E1<E2));\nH2:=D1 AND NOT(D2 AND E1>=E2);\nX1:=REF(BARSLAST(H1),1)+1;\nF1:=BACKSET(H1 AND COUNT(L1,X1)>0,LLVBARS(IF(L1,L,10000),X1));\nG1:=F1>REF(F1,1);\nI1:=BACKSET(G1,2);\nLD:=I1>REF(I1,1);\nL2:=LD OR ISLASTBAR OR BARSCOUNT(C)=1;\nX2:=REF(BARSLAST(L2),1)+1;\nF2:=BACKSET(L2 AND COUNT(H2,X2)>0,HHVBARS(IF(H2,H,0),X2));\nG2:=F2>REF(F2,1);\nI2:=BACKSET(G2,2);\nHD:=I2>REF(I2,1);\nR1:=BACKSET(ISLASTBAR,BARSLAST(HD)+1);\nS1:=R1>REF(R1,1);\nT1:=BACKSET(ISLASTBAR,BARSLAST(LD)+1);\nU1:=T1>REF(T1,1);\nR2:=BACKSET(S1,REF(BARSLAST(HD),1)+2);\nS2:=R2>REF(R2,1);\nT2:=BACKSET(U1,REF(BARSLAST(LD),1)+2);\nU2:=T2>REF(T2,1);\nDRAWLINE(S2,H,S1,H,1),LINETHICK2,COLORRED;\nDRAWLINE(U2,L,U1,L,1),LINETHICK2,COLORGREEN;"};return t},s.prototype.WAVE=function(){var t={Name:"WAVE",Description:"波浪分析",IsMainIndex:!0,Args:[{Name:"N",Value:5}],Script:"ZIG(3,N);"};return t},t.exports={JSCommonIndexScript:{JSIndexScript:s}}},cac6:function(t,e,a){function i(){}a("fb6a"),i.EMA=function(t,e){var a=[],i=0;if(i>=t.length)return a;for(;i<t.length;++i)if(null!=t[i]&&!isNaN(t[i]))break;var r=i,n=i+1;a[r]=t[r];for(var s=i+1;s<t.length;++s,++r,++n)a[n]=(2*t[n]+(e-1)*a[r])/(e+1);return a},i.SMA=function(t,e,a){for(var i=[],r=0,n=null;r<t.length;++r)if(null!=t[r]&&!isNaN(t[r])){n=t[r],i[r]=n;break}for(++r;r<t.length;++r)i[r]=(a*t[r]+(e-a)*n)/e,n=i[r];return i},i.DMA=function(t,e){var a=[];if(t.length<0||t.length!=e.length)return a;for(var i=0;i<t.length;++i)if(null!=t[i]&&!isNaN(t[i])&&null!=e[i]&&!isNaN(e[i])){a[i]=t[i];break}for(i+=1;i<t.length;++i)null==t[i]||null==e[i]?a[i]=null:t[i]<1?a[i]=e[i]*t[i]+(1-e[i])*a[i-1]:a[i]=t[i];return a},i.HHV=function(t,e){var a=[];if(e>t.length)return a;for(var i=-1e4,r=e,n=0;r<t.length;++r,++n){if(r<e+i)i=t[r]<t[i]?i:r;else for(n=1+(i=r-e+1);n<=r;++n)t[n]>t[i]&&(i=n);a[r]=t[i]}return a},i.LLV=function(t,e){var a=[];if(e>t.length)return a;for(var i=-1e4,r=e;r<t.length;++r,++n){if(r<e+i)i=t[r]>t[i]?i:r;else for(var n=1+(i=r-e+1);n<=r;++n)t[n]<t[i]&&(i=n);a[r]=t[i]}return a},i.REF=function(t,e){var a=[];if(t.length<=0)return a;if(e>=t.length)return a;a=t.slice(0,t.length-e);for(var i=0;i<e;++i)a.unshift(null);return a},i.REFDATE=function(t,e){var a=[];if(t.length<=0)return a;for(var i in e=t.length-1,t)a[i]=t[e];return a},i.SUM=function(t,e){var a=[];if(0==e){a[0]=t[0];for(var i=1;i<t.length;++i)a[i]=a[i-1]+t[i]}else{i=e-1;for(var r=0;i<t.length;++i,++r)for(var n=0;n<e;++n)0==n?a[i]=t[n+r]:a[i]+=t[n+r]}return a},i.ARRAY_SUBTRACT=function(t,e){var a=[],i="number"==typeof e;if(i)for(var r in t)null==t[r]||isNaN(t[r])?a[r]=null:a[r]=t[r]-e;else{var n=Math.max(t.length,e.length);for(r=0;r<n;++r)r<t.length&&r<e.length?null==t[r]||null==e[r]?a[r]=null:a[r]=t[r]-e[r]:a[r]=null}return a},i.ARRAY_GT=function(t,e){var a=[],i="number"==typeof e;if(i)for(var r in t)a[r]=t[r]>e?1:0;else{var n=Math.max(t.length,e.length);for(r=0;r<n;++r)r<t.length&&r<e.length?a[r]=t[r]>e[r]?1:0:a[r]=null}return a},i.ARRAY_GTE=function(t,e){var a=[],i="number"==typeof e;if(i)for(var r in t)a[r]=t[r]>=e?1:0;else{var n=Math.max(t.length,e.length);for(r=0;r<n;++r)r<t.length&&r<e.length?a[r]=t[r]>=e[r]?1:0:a[r]=null}return a},i.ARRAY_LT=function(t,e){var a=[],i="number"==typeof e;if(i)for(var r in t)a[r]=t[r]<e?1:0;else{var n=Math.max(t.length,e.length);for(r=0;r<n;++r)r<t.length&&r<e.length?a[r]=t[r]<e[r]?1:0:a[r]=null}return a},i.ARRAY_LTE=function(t,e){var a=[],i="number"==typeof e;if(i)for(var r in t)a[r]=t[r]<=e?1:0;else{var n=Math.max(t.length,e.length);for(r=0;r<n;++r)r<t.length&&r<e.length?a[r]=t[r]<=e[r]?1:0:a[r]=null}return a},i.ARRAY_EQ=function(t,e){var a=[],i="number"==typeof e;if(i)for(var r in t)a[r]=t[r]==e?1:0;else{var n=Math.max(t.length,e.length);for(r=0;r<n;++r)r<t.length&&r<e.length?a[r]=t[r]==e[r]?1:0:a[r]=null}return a},i.ARRAY_IF=function(t,e,a){var i=[],r=["number"==typeof e,"number"==typeof a];for(var n in t)t[n]?r[0]?i[n]=e:i[n]=e[n]:r[1]?i[n]=a:i[n]=a[n];return i},i.ARRAY_AND=function(t,e){var a=[],i="number"==typeof trueData;if(i)for(var r in t)a[r]=t[r]&&e?1:0;else{var n=Math.max(t.length,e.length);for(r=0;r<n;++r)r<t.length&&r<e.length?a[r]=t[r]&&e[r]?1:0:a[r]=0}return a},i.ARRAY_OR=function(t,e){var a=[],i="number"==typeof e;if(i)for(var r in t)a[r]=t[r]||e?1:0;else{var n=Math.max(t.length,e.length);for(r=0;r<n;++r)r<t.length&&t[r]||r<e.length&&e[r]?a[r]=1:a[r]=0}return a},i.ARRAY_MULTIPLY=function(t,e){if(2==arguments.length){var a=[],r="number"==typeof e;if(r)for(var n in t)null==t[n]||isNaN(t[n])?a[n]=null:a[n]=t[n]*e;else{var s=Math.max(t.length,e.length);for(n=0;n<s;++n)n<t.length&&n<e.length?a[n]=t[n]*e[n]:a[n]=null}return a}for(a=i.ARRAY_MULTIPLY(arguments[0],arguments[1]),n=2;n<arguments.length;++n)a=i.ARRAY_MULTIPLY(a,arguments[n]);return a},i.ARRAY_DIVIDE=function(t,e){var a=[],i="number"==typeof e;if(i)for(var r in t)a[r]=t[r]/e;else{var n=Math.max(t.length,e.length);for(r=0;r<n;++r)r<t.length&&r<e.length?null==t[r]||null==e[r]||isNaN(t[r])||isNaN(e[r])||0==e[r]?a[r]=null:a[r]=t[r]/e[r]:a[r]=null}return a},i.ARRAY_ADD=function(t,e){if(2==arguments.length){var a=[],r="number"==typeof e;if(r)for(var n in t)a[n]=t[n]+e;else{var s=Math.max(t.length,e.length);for(n=0;n<s;++n)n<t.length&&n<e.length?null==t[n]||null==e[n]||isNaN(t[n])||isNaN(e[n])?a[n]=null:a[n]=t[n]+e[n]:a[n]=null}return a}for(a=i.ARRAY_ADD(arguments[0],arguments[1]),n=2;n<arguments.length;++n)a=i.ARRAY_ADD(a,arguments[n]);return a},i.MAX=function(t,e){var a=[],i="number"==typeof e;if(i)for(var r in t)null==t[r]?a[r]=null:a[r]=Math.max(t[r],e);else{var n=Math.max(t.length,e.length);for(r=0;r<n;++r)r<t.length&&r<e.length?null==t[r]||null==e[r]?a[r]=null:a[r]=Math.max(t[r],e[r]):a[r]=null}return a},i.MIN=function(t,e){var a=[],i="number"==typeof e;if(i)for(var r in t)null==t[r]?a[r]=null:a[r]=Math.min(t[r],e);else{var n=Math.max(t.length,e.length);for(r=0;r<n;++r)r<t.length&&r<e.length?null==t[r]||null==e[r]?a[r]=null:a[r]=Math.min(t[r],e[r]):a[r]=null}return a},i.ABS=function(t){var e=[];for(var a in t)null==t[a]?e[a]=null:e[a]=Math.abs(t[a]);return e},i.MA=function(t,e){for(var a=[],i=0,r=t.length;i<r;i++)if(i<e)a[i]=null;else{for(var n=0,s=0;s<e;s++)n+=t[i-s];a[i]=n/e}return a},i.EXPMA=function(t,e){var a=[];if(e>=t.length)return a;for(var i=e;i<t.length;++i)if(null!=t[i]){a[i]=t[i];break}for(i+=1;i<t.length;++i)null!=a[i-1]&&null!=t[i]?a[i]=(2*t[i]+(e-1)*a[i-1])/(e+1):null!=a[i-1]&&(a[i]=a[i-1]);return a},i.EXPMEMA=function(t,e){var a=[];if(e>=t.length)return a;for(var i=0;i<t.length;++i)if(t[i]&&!isNaN(t[i]))break;for(var r=0,n=0;i<t.length&&n<e;++n,++i)t[i]&&!isNaN(t[i])?r+=t[i]:r+=t[i-1];for(a[i-1]=r/e;i<t.length;++i)null!=a[i-1]&&null!=t[i]?a[i]=(2*t[i]+(e-1)*a[i-1])/(e+1):null!=a[i-1]&&(a[i]=a[i-1]);return a},i.STD=function(t,e){for(var a=[],i=0,r=[],n=e-1;n<t.length;++n){i=0;for(var s=0;s<e;++s)i+=t[n-s];r[n]=i/e}for(n=e-1;n<t.length;++n){i=0;for(s=0;s<e;++s)i+=Math.pow(t[n-s]-r[n],2);a[n]=Math.sqrt(i/e)}return a},i.AVEDEV=function(t,e){for(var a=[],i=0,r=[],n=e-1;n<t.length;++n){i=0;for(var s=0;s<e;++s)i+=t[n-s];r[n]=i/e}for(n=e-1;n<t.length;++n){i=0;for(s=0;s<e;++s)i+=Math.abs(t[n-s]-r[n]);a[n]=i/e}return a},i.COUNT=function(t,e){for(var a=[],i=e-1;i<t.length;++i){for(var r=0,n=0;n<e;++n)t[i-n]&&++r;a[i]=r}return a},i.CROSS=function(t,e){var a=[];if(t.length!=e.length)return[];for(var i=0;i<t.length;++i)if(null!=t[i]&&!isNaN(t[i])&&null!=e[i]&&isNaN(e[i]))break;for(++i;i<t.length;++i)a[i]=t[i]>e[i]&&t[i-1]<e[i-1]?1:0;return a},i.MULAR=function(t,e){var a=[];if(t.length<e)return a;for(var i=e;i<t.length;++i)if(null!=t[i]&&!isNaN(t[i])){a[i]=t[i];break}for(++i;i<t.length;++i)a[i]=a[i-1]*t[i];return a},i.STICKLINE=function(t,e,a){var i=[];if(t.length<=0)return i;var r="number"==typeof e,n="number"==typeof a;for(var s in t)if(i[s]=null,!isNaN(t[s])&&t[s])if(r&&n)i[s]={Value:e,Value2:a};else if(r&&!n){if(isNaN(a[s]))continue;i[s]={Value:e,Value2:a[s]}}else if(!r&&n){if(isNaN(e[s]))continue;i[s]={Value:e[s],Value2:a}}else{if(isNaN(e[s])||isNaN(a[s]))continue;i[s]={Value:e[s],Value2:a[s]}}return i},t.exports={JSCommon_HQIndexFormula:i}},dbf1:function(t,e,a){"use strict";a("4ec9"),a("d3b7"),a("e25e"),a("ac1f"),a("25f0"),a("3ca3"),a("466d"),a("5319"),a("ddb0");var i=a("90f8"),r=a("8f32"),n=a("8cb2"),s=a("a401"),o=a("621d"),h=n.JSCommonCoordinateData.MARKET_SUFFIX_NAME;function l(){this.Frame,this.Data=new Array,this.Canvas,this.IsDynamic=!1,this.Position=0,this.CursorIndex,this.Font=i.JSCommonResource_Global_JSChartResource.DynamicTitleFont,this.Title,this.TitleColor=i.JSCommonResource_Global_JSChartResource.DefaultTextColor,this.LanguageID=i.JSCommonResource_JSCHART_LANGUAGE_ID.LANGUAGE_CHINESE_ID,this.UpdateUICallback,this.OnDrawEvent}var u=["不复权","前复权","后复权"];function C(){this.newMethod=l,this.newMethod(),delete this.newMethod,this.ClassName="DynamicKLineTitlePainting",this.IsDynamic=!0,this.IsShow=!0,this.LineCount=1,this.SpaceWidth=1,this.Period,this.UpColor=i.JSCommonResource_Global_JSChartResource.UpTextColor,this.DownColor=i.JSCommonResource_Global_JSChartResource.DownTextColor,this.UnchagneColor=i.JSCommonResource_Global_JSChartResource.UnchagneTextColor,this.VolColor=i.JSCommonResource_Global_JSChartResource.Title.VolColor,this.AmountColor=i.JSCommonResource_Global_JSChartResource.Title.AmountColor,this.DateTimeColor=i.JSCommonResource_Global_JSChartResource.Title.DateTimeColor,this.NameColor=i.JSCommonResource_Global_JSChartResource.Title.NameColor,this.SettingColor=i.JSCommonResource_Global_JSChartResource.Title.SettingColor,this.PositionColor=i.JSCommonResource_Global_JSChartResource.Title.PositionColor,this.Symbol,this.UpperSymbol,this.Name,this.InfoData,this.InfoTextHeight=15,this.InfoTextColor=i.JSCommonResource_Global_JSChartResource.KLine.Info.TextColor,this.InfoTextBGColor=i.JSCommonResource_Global_JSChartResource.KLine.Info.TextBGColor,this.IsShowName=!0,this.IsShowSettingInfo=!0,this.GetCurrentKLineData=function(){if(null==this.CursorIndex||!this.Data)return null;if(this.Data.length<=0)return null;var t=this.CursorIndex;t=parseInt(t.toFixed(0));var e=this.Data.DataOffset+t;if(e>=this.Data.Data.length&&(e=this.Data.Data.length-1),e<0)return null;var a=this.Data.Data[e];return a},this.GetDataIndex=function(){if(null==this.CursorIndex||!this.Data)return null;if(this.Data.length<=0)return null;var t=this.CursorIndex;t=parseInt(t.toFixed(0));var e=this.Data.DataOffset+t;return e>=this.Data.Data.length&&(e=this.Data.Data.length-1),e<0?null:e},this.SendUpdateUIMessage=function(t){if(this.UpdateUICallback){var e={TitleName:"K线标题",CallFunction:t,Stock:{Name:this.Name,Symbol:this.Symbol},Rect:{Left:this.Frame.ChartBorder.GetLeft(),Right:this.Frame.ChartBorder.GetRight(),Top:0,Bottom:this.Frame.ChartBorder.GetTop()}};if(this.Data&&this.Data.Data&&this.Data.Data.length>0){var a=this.Data.Data.length-1;if(this.CursorIndex){var i=Math.abs(this.CursorIndex-.5);i=parseInt(i.toFixed(0)),a=this.Data.DataOffset+i,a>=this.Data.Data.length&&(a=this.Data.Data.length-1)}if(a>=0){var r=this.Data.Data[a];e.Stock.Data={Date:r.Date,YClose:r.YClose,Open:r.Open,High:r.High,Low:r.Low,Close:r.Close,Vol:r.Vol,Amount:r.Amount},r.Time&&(e.Stock.Time=r.Time)}null!=this.Data.Period&&(e.Stock.PeriodName=this.GetPeriodName(this.Data.Period)),null!=this.Data.Right&&(e.Stock.RightName=u[this.Data.Right])}this.UpdateUICallback(e)}},this.GetPeriodName=function(t){var e="";return e=t>r.JSCommon_CUSTOM_MINUTE_PERIOD_START&&t<=r.JSCommon_CUSTOM_MINUTE_PERIOD_END?t-r.JSCommon_CUSTOM_MINUTE_PERIOD_START+i.JSCommonResource_Global_JSChartLocalization.GetText("自定义分钟",this.LanguageID):t>r.JSCommon_CUSTOM_DAY_PERIOD_START&&t<=r.JSCommon_CUSTOM_DAY_PERIOD_END?t-r.JSCommon_CUSTOM_DAY_PERIOD_START+i.JSCommonResource_Global_JSChartLocalization.GetText("自定义日线",this.LanguageID):t>r.JSCommon_CUSTOM_SECOND_PERIOD_START&&t<=r.JSCommon_CUSTOM_SECOND_PERIOD_END?t-r.JSCommon_CUSTOM_SECOND_PERIOD_START+i.JSCommonResource_Global_JSChartLocalization.GetText("自定义秒",this.LanguageID):i.JSCommonResource_Global_JSChartLocalization.GetText(r.JSCommon_ChartData.GetPeriodName(t),this.LanguageID),e},this.GetRightName=function(t,e){if(r.JSCommon_ChartData.IsMinutePeriod(e,!0)||r.JSCommon_ChartData.IsSecondPeriod(e))return null;if(h.IsSHSZStockA(this.UpperSymbol)){var a=u[t];return a}return null},this.FullDraw=function(){if(this.IsShow)if(this.UpperSymbol=this.Symbol?this.Symbol.toUpperCase():"",null==this.CursorIndex||!this.Data||this.Data.length<=0)this.OnDrawEventCallback(null,"DynamicKLineTitlePainting::FullDraw");else{this.SpaceWidth=this.Canvas.measureText(" ").width;var t=this.CursorIndex;t=parseInt(t.toFixed(0));var e=this.Data.DataOffset+t;if(e>=this.Data.Data.length&&(e=-1),e<0)this.OnDrawEventCallback(null,"DynamicKLineTitlePainting::FullDraw");else{var a=this.Data.Data[e];this.OnDrawEventCallback(a,"DynamicKLineTitlePainting::FullDraw"),!0===this.Frame.IsHScreen?(this.Canvas.save(),this.LineCount>1?this.DrawMulitLine(a):this.DrawSingleLine(a,!0),this.Canvas.restore(),!a.Time&&a.Date&&this.InfoData&&this.HSCreenKLineInfoDraw(a.Date)):(this.LineCount>1?this.DrawMulitLine(a):this.DrawSingleLine(a,!0),!a.Time&&a.Date&&this.InfoData&&this.KLineInfoDraw(a.Date))}}},this.DrawTitle=function(){if(this.UpperSymbol=this.Symbol?this.Symbol.toUpperCase():"",this.SendUpdateUIMessage("DrawTitle"),this.OnDrawEventCallback(null,"DynamicKLineTitlePainting::DrawTitle"),this.IsShow&&(this.IsShowName||this.IsShowSettingInfo)&&!(this.LineCount>1)){if(!0===this.Frame.IsHScreen)return this.Canvas.save(),this.HScreenDrawTitle(),void this.Canvas.restore();var t=this.Frame.ChartBorder.GetLeft(),e=this.Frame.ChartBorder.GetTop();this.Frame.ChartBorder.GetRight();if(!(e<5)){this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom",this.Canvas.font=this.Font;var a={Left:t,Bottom:e,IsHScreen:!1};if((!this.IsShowName||!this.Name||this.DrawKLineText(this.Name,this.NameColor,a))&&this.IsShowSettingInfo&&null!=this.Data.Period&&null!=this.Data.Right){var i=this.GetPeriodName(this.Data.Period),r=this.GetRightName(this.Data.Right,this.Data.Period),n="("+i+")";if(r&&(n="("+i+" "+r+")"),!this.DrawKLineText(n,this.SettingColor,a))return}}}},this.HScreenDrawTitle=function(){var t=this.Frame.ChartBorder.GetRight(),e=this.Frame.ChartBorder.GetTop();this.Frame.ChartBorder.GetHeight();if(!(this.Frame.ChartBorder.Right<10)){this.Canvas.translate(t,e),this.Canvas.rotate(90*Math.PI/180),this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom",this.Canvas.font=this.Font;var a=2,i=-2,r={Left:a,Bottom:i,IsHScreen:!1};if((!this.IsShowName||!this.Name||this.DrawKLineText(this.Name,this.NameColor,r))&&this.IsShowSettingInfo&&null!=this.Data.Period&&null!=this.Data.Right){var n=this.GetPeriodName(this.Data.Period),s=this.GetRightName(this.Data.Right,this.Data.Period),o="("+n+")";if(s&&(o="("+n+" "+s+")"),!this.DrawKLineText(o,this.SettingColor,r))return}}},this.DrawMulitLine=function(t){var e=!0===this.Frame.IsHScreen,a=1,s=1,h=this.Frame.ChartBorder.GetLeft()+a,l=this.Frame.ChartBorder.GetWidth(),u=this.Frame.ChartBorder.GetTop(),C=n.JSCommonCoordinateData.GetfloatPrecision(this.Symbol);if(e){h=a,l=this.Frame.ChartBorder.GetHeight(),u=this.Frame.ChartBorder.Right;var D=this.Frame.ChartBorder.GetChartWidth(),m=this.Frame.ChartBorder.GetTop();this.Canvas.translate(D,m),this.Canvas.rotate(90*Math.PI/180)}var S=(u-s)/this.LineCount,c=(l-a)/4,f=S;this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom",this.Canvas.font=this.Font;var d=o.JSCommonSplit_IFrameSplitOperator.FormatDateString(t.Date);this.Canvas.fillStyle=this.DateTimeColor,this.Canvas.fillText(d,h,f,c),h+=c,this.Canvas.textAlign="left",this.Canvas.fillStyle=this.GetColor(t.Open,t.YClose);d=i.JSCommonResource_Global_JSChartLocalization.GetText("Tooltip-Open",this.LanguageID)+t.Open.toFixed(C);this.Canvas.fillText(d,h,f,c),h+=c,this.Canvas.fillStyle=this.GetColor(t.High,t.YClose);d=i.JSCommonResource_Global_JSChartLocalization.GetText("Tooltip-High",this.LanguageID)+t.High.toFixed(C);this.Canvas.fillText(d,h,f,c),h+=c;var I=(t.Close-t.YClose)/t.YClose*100;this.Canvas.fillStyle=this.GetColor(I,0);d=i.JSCommonResource_Global_JSChartLocalization.GetText("Tooltip-Increase",this.LanguageID)+I.toFixed(2)+"%";this.Canvas.fillText(d,h,f,c),h+=c,f+=S;h=this.Frame.ChartBorder.GetLeft()+a;if(e&&(h=a),r.JSCommon_ChartData.IsMinutePeriod(this.Period,!0)&&t.Time){this.Canvas.fillStyle=this.DateTimeColor;d=o.JSCommonSplit_IFrameSplitOperator.FormatTimeString(t.Time);this.Canvas.fillText(d,h,f,c)}else if(r.JSCommon_ChartData.IsSecondPeriod(this.Period)&&t.Time){this.Canvas.fillStyle=this.SettingColor;d=o.JSCommonSplit_IFrameSplitOperator.FormatTimeString(t.Time,"HH:MM:SS");this.Canvas.fillText(d,h,f,c)}h+=c,this.Canvas.fillStyle=this.GetColor(t.Close,t.YClose);d=i.JSCommonResource_Global_JSChartLocalization.GetText("Tooltip-Close",this.LanguageID)+t.Close.toFixed(C);this.Canvas.fillText(d,h,f,c),h+=c,this.Canvas.fillStyle=this.GetColor(t.Low,t.YClose);d=i.JSCommonResource_Global_JSChartLocalization.GetText("Tooltip-Low",this.LanguageID)+t.Low.toFixed(C);this.Canvas.fillText(d,h,f,c),h+=c,this.Canvas.fillStyle=this.AmountColor;d=i.JSCommonResource_Global_JSChartLocalization.GetText("Tooltip-Amount",this.LanguageID)+o.JSCommonSplit_IFrameSplitOperator.FormatValueString(t.Amount,2,this.LanguageID);this.Canvas.fillText(d,h,f,c),h+=c},this.DrawSingleLine=function(t,e){var a=!0===this.Frame.IsHScreen,s=this.Frame.ChartBorder.GetLeft(),l=this.Frame.ChartBorder.GetTop(),u=(this.Frame.ChartBorder.GetRight(),n.JSCommonCoordinateData.GetfloatPrecision(this.Symbol));if(a){if(this.Frame.ChartBorder.GetHeight(),this.Frame.ChartBorder.Right<5)return;s=2,l=-2;var C=this.Frame.ChartBorder.GetRight(),D=this.Frame.ChartBorder.GetTop();this.Canvas.translate(C,D),this.Canvas.rotate(90*Math.PI/180)}else if(l<5)return;this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom",this.Canvas.font=this.Font;var m={Left:s,Bottom:l,IsHScreen:a};if(!this.IsShowName||this.DrawKLineText(this.Name,this.NameColor,m,1==e)){if(this.IsShowSettingInfo){var S=this.GetPeriodName(this.Data.Period),c=this.GetRightName(this.Data.Right,this.Data.Period),f="("+S+")";if(c&&(f="("+S+" "+c+")"),!this.DrawKLineText(f,this.SettingColor,m,1==e))return}f=o.JSCommonSplit_IFrameSplitOperator.FormatDateString(t.Date);if(this.DrawKLineText(f,this.DateTimeColor,m)){if(r.JSCommon_ChartData.IsMinutePeriod(this.Period,!0)&&o.JSCommonSplit_IFrameSplitOperator.IsNumber(t.Time)){f=o.JSCommonSplit_IFrameSplitOperator.FormatTimeString(t.Time);if(!this.DrawKLineText(f,this.DateTimeColor,m))return}else if(r.JSCommon_ChartData.IsSecondPeriod(this.Period)&&o.JSCommonSplit_IFrameSplitOperator.IsNumber(t.Time)){f=o.JSCommonSplit_IFrameSplitOperator.FormatTimeString(t.Time,"HH:MM:SS");if(!this.DrawKLineText(f,this.DateTimeColor,m))return}var d=this.GetColor(t.Open,t.YClose);f=i.JSCommonResource_Global_JSChartLocalization.GetText("KTitle-Open",this.LanguageID)+t.Open.toFixed(u);if(this.DrawKLineText(f,d,m)){d=this.GetColor(t.High,t.YClose),f=i.JSCommonResource_Global_JSChartLocalization.GetText("KTitle-High",this.LanguageID)+t.High.toFixed(u);if(this.DrawKLineText(f,d,m)){d=this.GetColor(t.Low,t.YClose),f=i.JSCommonResource_Global_JSChartLocalization.GetText("KTitle-Low",this.LanguageID)+t.Low.toFixed(u);if(this.DrawKLineText(f,d,m)){d=this.GetColor(t.Close,t.YClose),f=i.JSCommonResource_Global_JSChartLocalization.GetText("KTitle-Close",this.LanguageID)+t.Close.toFixed(u);if(this.DrawKLineText(f,d,m)){if(o.JSCommonSplit_IFrameSplitOperator.IsNumber(t.Vol)){f=i.JSCommonResource_Global_JSChartLocalization.GetText("KTitle-Vol",this.LanguageID)+o.JSCommonSplit_IFrameSplitOperator.FormatValueString(t.Vol,2);if(!this.DrawKLineText(f,this.VolColor,m))return}if(o.JSCommonSplit_IFrameSplitOperator.IsNumber(t.Amount)){f=i.JSCommonResource_Global_JSChartLocalization.GetText("KTitle-Amount",this.LanguageID)+o.JSCommonSplit_IFrameSplitOperator.FormatValueString(t.Amount,2);if(!this.DrawKLineText(f,this.AmountColor,m))return}if(h.IsChinaFutures(this.UpperSymbol)&&o.JSCommonSplit_IFrameSplitOperator.IsNumber(t.Position)){f=i.JSCommonResource_Global_JSChartLocalization.GetText("KTitle-Position",this.LanguageID)+o.JSCommonSplit_IFrameSplitOperator.FormatValueString(t.Position,2);if(!this.DrawKLineText(f,this.PositionColor,m))return}}}}}}}},this.OnDrawEventCallback=function(t,e){if(this.OnDrawEvent&&this.OnDrawEvent.Callback){var a={Draw:t,Name:this.ClassName,Explain:e};if(this.Data&&this.Data.Data){if(o.JSCommonSplit_IFrameSplitOperator.IsNumber(this.CursorIndex)){var i=this.CursorIndex;i=parseInt(i.toFixed(0));var r=this.Data.DataOffset+i}else r=this.Data.Data.length-1;var n=this.Data.Data.length;a.DataIndex=r,a.DataCount=n}this.OnDrawEvent.Callback(this.OnDrawEvent,a,this)}},this.Draw=function(){if(this.UpperSymbol=this.Symbol?this.Symbol.toUpperCase():"",this.SendUpdateUIMessage("Draw"),this.IsShow)if(null==this.CursorIndex||!this.Data||this.Data.length<=0)this.OnDrawEventCallback(null,"DynamicKLineTitlePainting::Draw");else{this.SpaceWidth=this.Canvas.measureText(" ").width;var t=this.CursorIndex;t=parseInt(t.toFixed(0));var e=this.Data.DataOffset+t;if(e>=this.Data.Data.length&&(e=this.Data.Data.length-1),e<0)this.OnDrawEventCallback(null,"DynamicKLineTitlePainting::Draw");else{var a=this.Data.Data[e];this.OnDrawEventCallback(a,"DynamicKLineTitlePainting::Draw"),!0===this.Frame.IsHScreen?(this.Canvas.save(),this.LineCount>1?this.DrawMulitLine(a):this.DrawSingleLine(a),this.Canvas.restore(),!a.Time&&a.Date&&this.InfoData&&this.HSCreenKLineInfoDraw(a.Date)):(this.LineCount>1?this.DrawMulitLine(a):this.DrawSingleLine(a),!a.Time&&a.Date&&this.InfoData&&this.KLineInfoDraw(a.Date))}}},this.KLineInfoDraw=function(t){var e=this.InfoData.get(t.toString());if(e){var a=0,i=0,r=0,n=0,h=0,l=null,u=null,C=null;for(var D in e.Data){var m=e.Data[D];switch(m.InfoType){case s.JSCommon_KLINE_INFO_TYPE.INVESTOR:++a;break;case s.JSCommon_KLINE_INFO_TYPE.PFORECAST:C=m.Title;break;case s.JSCommon_KLINE_INFO_TYPE.ANNOUNCEMENT:++r;break;case s.JSCommon_KLINE_INFO_TYPE.ANNOUNCEMENT_QUARTER_1:case s.JSCommon_KLINE_INFO_TYPE.ANNOUNCEMENT_QUARTER_2:case s.JSCommon_KLINE_INFO_TYPE.ANNOUNCEMENT_QUARTER_3:case s.JSCommon_KLINE_INFO_TYPE.ANNOUNCEMENT_QUARTER_4:u=m.Title;break;case s.JSCommon_KLINE_INFO_TYPE.RESEARCH:++i;break;case s.JSCommon_KLINE_INFO_TYPE.BLOCKTRADING:++n;break;case s.JSCommon_KLINE_INFO_TYPE.TRADEDETAIL:++h;break;case s.JSCommon_KLINE_INFO_TYPE.POLICY:l=m;break}}var S=!0===this.Frame.IsHScreen,c=this.Frame.ChartBorder.GetRight()-4,f=this.Frame.ChartBorder.GetTopEx();S&&(c=this.Frame.ChartBorder.GetBottom()-4,f=this.Frame.ChartBorder.GetRightEx(),this.Canvas.translate(f,c),this.Canvas.rotate(90*Math.PI/180),c=0,f=0),this.Canvas.font=this.Font;var d=[],I={Top:f,Right:c,IsHScreen:S};if(d.push(o.JSCommonSplit_IFrameSplitOperator.FormatDateString(t)),u&&d.push(u),C&&d.push(C),r>0&&d.push("公告数量:"+r),i>0&&d.push("机构调研次数:"+i),h>0&&d.push("龙虎榜上榜次数:"+h),a>0&&d.push("互动易数量:"+a),n>0&&d.push("大宗交易次数:"+n),l)for(var v in l.ExtendData)d.push(l.ExtendData[v].Name);var p=0,T=0;for(var F in d){m=d[F];var A=this.Canvas.measureText(m).width+2;p<A&&(p=A),T+=this.InfoTextHeight}for(var M in this.Canvas.fillStyle=this.InfoTextBGColor,this.Canvas.fillRect(I.Right-p,I.Top,p+2,T+2),d){m=d[M];this.DrawInfoText(m,I)}}},this.HSCreenKLineInfoDraw=function(t){this.Canvas.save(),this.KLineInfoDraw(t),this.Canvas.restore()},this.GetColor=function(t,e){return t>e?this.UpColor:t<e?this.DownColor:this.UnchagneColor},this.DrawInfoText=function(t,e){return!t||(this.Canvas.textAlign="right",this.Canvas.textBaseline="top",this.Canvas.fillStyle=this.InfoTextColor,this.Canvas.fillText(t,e.Right,e.Top),e.Top+=this.InfoTextHeight,!0)},this.DrawKLineText=function(t,e,a,i){if(!t)return!0;var r=!0===this.Frame.IsHScreen,n=this.Frame.ChartBorder.GetRight();r&&(n=this.Frame.ChartBorder.GetHeight()),this.Canvas.fillStyle=e;var s=this.Canvas.measureText(t).width;return!(a.Left+s>n)&&(!1!==i&&this.Canvas.fillText(t,a.Left,a.Bottom,s),a.Left+=s+this.SpaceWidth,!0)}}function D(){this.newMethod=C,this.newMethod(),delete this.newMethod,this.YClose,this.IsShowDate=!1,this.IsShowName=!0,this.Symbol,this.UpperSymbol,this.LastShowData,this.ClassName="DynamicMinuteTitlePainting",this.SpaceWidth=2,this.IsShowAveragePrice=!0,this.GetCurrentKLineData=function(){if(this.LastShowData)return this.LastShowData;if(null==this.CursorIndex||!this.Data)return null;if(this.Data.length<=0)return null;var t=Math.abs(this.CursorIndex);t=parseInt(t.toFixed(0));var e=this.Data.DataOffset+t;if(e>=this.Data.Data.length&&(e=this.Data.Data.length-1),e<0)return null;var a=this.Data.Data[e];return a},this.SendUpdateUIMessage=function(t){if(this.UpdateUICallback){var e={TitleName:"分钟标题",CallFunction:t,Stock:{Name:this.Name,Symbol:this.Symbol},Rect:{Left:this.Frame.ChartBorder.GetLeft(),Right:this.Frame.ChartBorder.GetRight(),Top:0,Bottom:this.Frame.ChartBorder.GetTop()}};if(this.Data&&this.Data.Data&&this.Data.Data.length>0){var a=this.Data.Data.length-1;if(this.CursorIndex){var i=Math.abs(this.CursorIndex-.5);i=parseInt(i.toFixed(0)),a=this.Data.DataOffset+i,a>=this.Data.Data.length&&(a=this.Data.Data.length-1)}if(a>=0){var r=this.Data.Data[a];this.LastShowData=r,e.Stock.Data={Time:r.Time,Close:r.Close,AvPrice:r.AvPrice,Vol:r.Vol,Amount:r.Amount},r.Time&&(e.Stock.Time=r.Time)}}this.UpdateUICallback(e)}},this.DrawTitle=function(){this.UpperSymbol=this.Symbol?this.Symbol.toUpperCase():"",this.SendUpdateUIMessage("DrawTitle"),this.OnDrawEventCallback(null,"DynamicMinuteTitlePainting::DrawTitle")},this.GetDecimal=function(t){return n.JSCommonCoordinateData.GetfloatPrecision(t)},this.DrawMulitLine=function(t){var e=5,a=2,r=this.Frame.ChartBorder.GetLeft()+e,n=(this.Frame.ChartBorder.GetRight(),this.Frame.ChartBorder.GetWidth()),s=this.Frame.ChartBorder.GetTop(),h=this.GetDecimal(this.Symbol),l=(s-a)/this.LineCount,u=l;this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom",this.Canvas.font=this.Font,this.Canvas.fillStyle=this.UnchagneColor,this.Canvas.fillStyle=this.UnchagneColor;var C=o.JSCommonSplit_IFrameSplitOperator.FormatDateTimeString(t.DateTime,this.IsShowDate?"YYYY-MM-DD":"HH-MM"),D=this.Canvas.measureText(C).width+5;if(this.Canvas.fillText(C,r,u,D),this.IsShowDate){C=o.JSCommonSplit_IFrameSplitOperator.FormatDateTimeString(t.DateTime,"HH-MM");this.Canvas.fillText(C,r,u+l,D)}var m=(n-e-D)/2;if(r+=D,null!=t.Close){this.Canvas.fillStyle=this.GetColor(t.Close,this.YClose);C=i.JSCommonResource_Global_JSChartLocalization.GetText("Tooltip-Price",this.LanguageID)+t.Close.toFixed(h);this.Canvas.fillText(C,r,u,m),r+=m}if(null!=t.Increase){this.Canvas.fillStyle=this.GetColor(t.Increase,0);C=i.JSCommonResource_Global_JSChartLocalization.GetText("Tooltip-Increase",this.LanguageID)+t.Increase.toFixed(2)+"%";this.Canvas.fillText(C,r,u,m),r+=m}u+=l;r=this.Frame.ChartBorder.GetLeft()+e+D;this.Canvas.fillStyle=this.VolColor;C=i.JSCommonResource_Global_JSChartLocalization.GetText("Tooltip-Vol",this.LanguageID)+o.JSCommonSplit_IFrameSplitOperator.FormatValueString(t.Vol,2,this.LanguageID);this.Canvas.fillText(C,r,u,m),r+=m,this.Canvas.fillStyle=this.AmountColor;C=i.JSCommonResource_Global_JSChartLocalization.GetText("Tooltip-Amount",this.LanguageID)+o.JSCommonSplit_IFrameSplitOperator.FormatValueString(t.Amount,2,this.LanguageID);this.Canvas.fillText(C,r,u,m),r+=m},this.DrawItem=function(t){var e=!0===this.Frame.IsHScreen,a=this.Frame.ChartBorder.GetLeft(),r=this.Frame.ChartBorder.GetTop()-this.Frame.ChartBorder.Top/2,n=(this.Frame.ChartBorder.GetRight(),this.GetDecimal(this.Symbol));if(e){if(this.Frame.ChartBorder.Right<5)return;a=2,r=this.Frame.ChartBorder.Right/2,this.Frame.ChartBorder.GetHeight();var s=this.Frame.ChartBorder.GetChartWidth(),l=this.Frame.ChartBorder.GetTop();this.Canvas.translate(s,l),this.Canvas.rotate(90*Math.PI/180)}else if(r<5)return;this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.font=this.Font;var u={Left:a,Bottom:r,IsHScreen:e};if(!this.IsShowName||this.DrawMinuteText(this.Name,this.NameColor,u,!0)){this.Canvas.fillStyle=this.UnchagneColor;var C=o.JSCommonSplit_IFrameSplitOperator.FormatDateTimeString(t.DateTime,this.IsShowDate?"YYYY-MM-DD HH-MM":"HH-MM");if(this.DrawMinuteText(C,this.DateTimeColor,u)){if(o.JSCommonSplit_IFrameSplitOperator.IsNumber(t.Close)){var D=this.GetColor(t.Close,this.YClose);C=i.JSCommonResource_Global_JSChartLocalization.GetText("MTitle-Close",this.LanguageID)+t.Close.toFixed(n);if(!this.DrawMinuteText(C,D,u))return}if(o.JSCommonSplit_IFrameSplitOperator.IsNumber(t.Increase)){D=this.GetColor(t.Increase,0),C=i.JSCommonResource_Global_JSChartLocalization.GetText("MTitle-Increase",this.LanguageID)+t.Increase.toFixed(2)+"%";if(!this.DrawMinuteText(C,D,u))return}if(o.JSCommonSplit_IFrameSplitOperator.IsNumber(t.AvPrice)&&1==this.IsShowAveragePrice){D=this.GetColor(t.AvPrice,this.YClose),C=i.JSCommonResource_Global_JSChartLocalization.GetText("MTitle-AvPrice",this.LanguageID)+t.AvPrice.toFixed(n);if(!this.DrawMinuteText(C,D,u))return}if(o.JSCommonSplit_IFrameSplitOperator.IsNumber(t.Vol)){C=i.JSCommonResource_Global_JSChartLocalization.GetText("MTitle-Vol",this.LanguageID)+o.JSCommonSplit_IFrameSplitOperator.FormatValueString(t.Vol,2,this.LanguageID);if(!this.DrawMinuteText(C,this.VolColor,u))return}if(o.JSCommonSplit_IFrameSplitOperator.IsNumber(t.Amount)){C=i.JSCommonResource_Global_JSChartLocalization.GetText("MTitle-Amount",this.LanguageID)+o.JSCommonSplit_IFrameSplitOperator.FormatValueString(t.Amount,2,this.LanguageID);if(!this.DrawMinuteText(C,this.AmountColor,u))return}if(h.IsChinaFutures(this.UpperSymbol)&&o.JSCommonSplit_IFrameSplitOperator.IsNumber(t.Position)){C=i.JSCommonResource_Global_JSChartLocalization.GetText("MTitle-Position",this.LanguageID)+o.JSCommonSplit_IFrameSplitOperator.FormatValueString(t.Position,2,this.LanguageID);if(!this.DrawMinuteText(C,this.VolColor,u))return}}}},this.FullDraw=function(){this.Draw()},this.Draw=function(){if(this.UpperSymbol=this.Symbol?this.Symbol.toUpperCase():"",this.LastShowData=null,this.SendUpdateUIMessage("Draw"),this.IsShow)if(null==this.CursorIndex||!this.Data||!this.Data.Data||this.Data.Data.length<=0)this.OnDrawEventCallback(null,"DynamicMinuteTitlePainting::Draw");else{var t=this.CursorIndex;t=parseInt(t.toFixed(0));var e=t+this.Data.DataOffset;e>=this.Data.Data.length&&(e=this.Data.Data.length-1);var a=this.Data.Data[e];this.LastShowData=a,this.OnDrawEventCallback(a,"DynamicMinuteTitlePainting::Draw"),this.LineCount>1&&!0!==this.Frame.IsHScreen?this.DrawMulitLine(a):(this.Canvas.save(),this.DrawItem(a),this.Canvas.restore())}},this.DrawMinuteText=function(t,e,a,i){if(!t)return!0;var r=!0===this.Frame.IsHScreen,n=this.Frame.ChartBorder.GetRight();r&&(n=this.Frame.ChartBorder.GetHeight()),this.Canvas.fillStyle=e;var s=this.Canvas.measureText(t).width;return!(a.Left+s>n)&&(!1!==i&&this.Canvas.fillText(t,a.Left,a.Bottom,s),a.Left+=s+this.SpaceWidth,!0)}}var m={DEFAULT:1,ORIGINAL:2,THOUSANDS:21};function S(t,e,a){this.Data=t,this.Name=e,this.Color=a,this.DataType,this.StringFormat=m.DEFAULT,this.FloatPrecision=2,this.GetTextCallback}function c(){this.newMethod=l,this.newMethod(),delete this.newMethod,this.IsDynamic=!0,this.Data=new Array,this.Explain,this.TitleBG,this.TitleBGHeight=20,this.TitleAlign="middle",this.TitleBottomDistance=1,this.Text=new Array,this.EraseRect,this.EraseColor=i.JSCommonResource_Global_JSChartResource.BGColor,this.TitleRect,this.IsDrawTitleBG=!1,this.BGColor=i.JSCommonResource_Global_JSChartResource.IndexTitleBGColor,this.IsShowIndexName=!0,this.ParamSpace=2,this.OutName=null,this.IsFullDraw=!0,this.SetDynamicOutName=function(t,e){this.OutName?this.OutName.clear():this.OutName=new Map;var a=new Map;for(var i in e){var r=e[i];a.set("{".concat(r.Name,"}"),r)}for(var i in t){r=t[i];var n=r.DynamicName.match(/{\w*}/i);if(!n||n.length<=0)this.OutName.set(r.Name,r.DynamicName);else{for(var s=r.DynamicName,o=!0,h=0;h<n.length;++h){var l=n[h];if(!a.has(l)){o=!1;break}var u=a.get(l).Value;s=s.replace(l,u.toString())}o&&this.OutName.set(r.Name,s)}}},this.GetDynamicOutName=function(t){return!this.OutName||this.OutName.size<=0?null:this.OutName.has(t)?this.OutName.get(t):null},this.IsClickTitle=function(t,e){return!!this.TitleRect&&(t>this.TitleRect.Left&&t<this.TitleRect.Left+this.TitleRect.Width&&e>this.TitleRect.Top&&e<this.TitleRect.Top+this.TitleRect.Height)},this.FormatValue=function(t,e){return e.StringFormat==m.DEFAULT?o.JSCommonSplit_IFrameSplitOperator.FormatValueString(t,e.FloatPrecision,this.LanguageID):(e.StringFormat=m.THOUSANDS)?o.JSCommonSplit_IFrameSplitOperator.FormatValueThousandsString(t,e.FloatPrecision):e.StringFormat==m.ORIGINAL?t.toFixed(e.FloatPrecision).toString():void 0},this.FormatMultiReport=function(t,e){var a="";for(var i in t){var r=t[i],n=r.Quarter,s=r.Year,o=r.Value;switch(a.length>0&&(a+=","),a+=s.toString(),n){case 1:a+="一季报 ";break;case 2:a+="半年报 ";break;case 3:a+="三季报 ";break;case 4:a+="年报 ";break}a+=this.FormatValue(o,e)}return a},this.SendUpdateUIMessage=function(t){if(this.UpdateUICallback){var e={TitleName:"指标标题",CallFunction:t,TitleData:{Title:this.Title,Identify:this.Frame.Identify,Data:[]},Rect:{Top:this.Frame.ChartBorder.GetTop(),Left:this.Frame.ChartBorder.GetLeft(),Right:this.Frame.ChartBorder.GetRight(),Bottom:this.Frame.ChartBorder.GetBottom()}};for(var a in this.Data){var i=this.Data[a];if(i&&i.Data&&i.Data.Data&&!(i.Data.Data.length<=0)){var r={Name:i.Name,Color:i.Color};if(i.DataType&&(r.DataType=i.DataType),"StraightLine"==i.DataType)r.Value=i.Data.Data[0];else{var n=i.Data.Data.length-1;if(null!=this.CursorIndex){var s=Math.abs(this.CursorIndex-.5);s=parseInt(s.toFixed(0)),n=i.Data.DataOffset+s}n>=i.Data.Data.length&&(n=i.Data.Data.length-1),r.Value=i.Data.Data[n]}e.TitleData.Data.push(r)}}this.UpdateUICallback(e)}},this.FullDraw=function(){if(this.EraseRect=null,this.TitleRect=null,this.IsDrawTitleBG=this.Frame.IsDrawTitleBG,!(this.Frame.ChartBorder.TitleHeight<5)&&0!=this.Frame.IsShowTitle){if(this.IsShowIndexName=this.Frame.IsShowIndexName,this.ParamSpace=this.Frame.IndexParamSpace,!0===this.Frame.IsHScreen)return this.Canvas.save(),this.DrawItem(!0,!0),void this.Canvas.restore();this.DrawItem(!0,!0)}},this.DrawTitle=function(){if(this.IsDrawTitleBG=this.Frame.IsDrawTitleBG,this.EraseRect=null,this.TitleRect=null,this.SendUpdateUIMessage("DrawTitle"),!(this.Frame.ChartBorder.TitleHeight<5)&&0!=this.Frame.IsShowTitle){if(this.IsShowIndexName=this.Frame.IsShowIndexName,this.ParamSpace=this.Frame.IndexParamSpace,!0===this.Frame.IsHScreen)return this.Canvas.save(),this.DrawItem(!0,!1),void this.Canvas.restore();this.DrawItem(!0,!1)}},this.EraseTitle=function(){this.EraseRect&&(this.Canvas.fillStyle=this.EraseColor,this.Canvas.fillRect(this.EraseRect.Left,this.EraseRect.Top,this.EraseRect.Width,this.EraseRect.Height))},this.Draw=function(){if(this.TitleRect=null,this.SendUpdateUIMessage("Draw"),null!=this.CursorIndex&&this.Data&&!(this.Frame.ChartBorder.TitleHeight<5)&&0!=this.Frame.IsShowTitle){if(this.IsShowIndexName=this.Frame.IsShowIndexName,this.ParamSpace=this.Frame.IndexParamSpace,!0===this.Frame.IsHScreen)return this.Canvas.save(),this.DrawItem(!1,!0),void this.Canvas.restore();this.DrawItem(!1,!0)}},this.DrawItem=function(t,e){var a=!0===this.Frame.IsHScreen,i=this.Frame.ChartBorder.GetLeft()+1,r=this.Frame.ChartBorder.GetTop()+this.Frame.ChartBorder.TitleHeight/2;"bottom"==this.TitleAlign&&(r=this.Frame.ChartBorder.GetTopEx()-this.TitleBottomDistance);var n,s=this.Frame.ChartBorder.GetRight();if(a){var o=this.Frame.ChartBorder.GetRightTitle(),h=this.Frame.ChartBorder.GetTop();this.Canvas.translate(o,h),this.Canvas.rotate(90*Math.PI/180),i=1,r=-this.Frame.ChartBorder.TitleHeight/2,"bottom"==this.TitleAlign&&(r=-this.TitleBottomDistance),s=this.Frame.ChartBorder.GetHeight()}if(this.EraseTitle(),this.Canvas.textAlign="left",this.Canvas.textBaseline=this.TitleAlign,this.Canvas.font=this.Font,this.TitleBG&&this.Title){n=this.Canvas.measureText(this.Title).width+2;var l=this.Frame.ChartBorder.TitleHeight,u=this.Frame.ChartBorder.GetTop();l>20&&(u+=(l-20)/2+(l-45)/2,l=20),"bottom"==this.TitleAlign&&(u=this.Frame.ChartBorder.GetTopEx()-20,u<0&&(u=0)),t&&(this.Canvas.fillStyle=this.TitleBG,this.Canvas.fillRect(i,u,n,l))}if(this.Title&&this.IsShowIndexName){var C=this.Canvas.measureText(this.Title);if(n=C.width+2,t){if(this.IsDrawTitleBG){var D=1;if(this.Canvas.fillStyle=this.BGColor,a){this.TitleRect={Left:this.Frame.ChartBorder.GetRightTitle(),Top:this.Frame.ChartBorder.GetTop(),Width:this.Frame.ChartBorder.TitleHeight,Height:n};var m={Left:i,Top:-this.Frame.ChartBorder.TitleHeight+D,Width:n,Height:this.Frame.ChartBorder.TitleHeight-2*D};this.Canvas.fillRect(m.Left,m.Top,m.Width,m.Height)}else this.TitleRect={Left:i,Top:this.Frame.ChartBorder.GetTop()+D,Width:n,Height:this.Frame.ChartBorder.TitleHeight-2*D},this.Canvas.fillRect(this.TitleRect.Left,this.TitleRect.Top,this.TitleRect.Width,this.TitleRect.Height)}this.Canvas.fillStyle=this.TitleColor,this.Canvas.fillText(this.Title,i,r,n)}i+=n}if(this.Text&&this.Text.length>0)for(var S in this.Text){var c=this.Text[S];this.Canvas.fillStyle=c.Color,n=this.Canvas.measureText(c.Text).width+2,this.Canvas.fillText(c.Text,i,r,n),i+=n}if(e)for(var f in this.Data){var d=this.Data[f];if(d&&d.Data&&d.Data.Data&&!(d.Data.Data.length<=0)){var I,v=null,p=null;if("StraightLine"==d.DataType)v=d.Data.Data[0],p=this.FormatValue(v,d);else{var T=this.CursorIndex-.5;if(T<0&&(T=0),T=parseInt(T.toFixed(0)),d.Data.DataOffset+T>=d.Data.Data.length)continue;if(v=d.Data.Data[d.Data.DataOffset+T],null==v)continue;"HistoryData-Vol"==d.DataType?(v=v.Vol,p=this.FormatValue(v,d)):p="MultiReport"==d.DataType?this.FormatMultiReport(v,d):d.GetTextCallback?d.GetTextCallback(v,d):this.FormatValue(v,d)}if(this.Canvas.fillStyle=d.Color,d.Name){var F=this.GetDynamicOutName(d.Name);I=F?F+":"+p:d.Name+":"+p}else I=p;n=this.Canvas.measureText(I).width+this.ParamSpace,this.Canvas.fillText(I,i,r,n),i+=n}}else{i+=4;var A=i,M=i;for(var f in this.Data){d=this.Data[f];if(d&&d.Data&&d.Data.Data&&!(d.Data.Data.length<=0)){var E="●"+d.Name;if(this.Canvas.fillStyle=d.Color,n=this.Canvas.measureText(E).width+this.ParamSpace,i+n>=s)break;this.Canvas.fillText(E,i,r,n),i+=n,A=i}}A>M&&(this.EraseRect=a?{Left:M,Right:A,Top:-(this.Frame.ChartBorder.TitleHeight-1),Width:A-M,Height:this.Frame.ChartBorder.TitleHeight-2}:{Left:M,Right:A,Top:this.Frame.ChartBorder.GetTop()+1,Width:A-M,Height:this.Frame.ChartBorder.TitleHeight-2})}}}t.exports={JSCommonChartTitle:{IChartTitlePainting:l,DynamicKLineTitlePainting:C,DynamicMinuteTitlePainting:D,DynamicChartTitlePainting:c,DynamicTitleData:S,STRING_FORMAT_TYPE:m},JSCommonChartTitle_IChartTitlePainting:l,JSCommonChartTitle_DynamicKLineTitlePainting:C,JSCommonChartTitle_DynamicMinuteTitlePainting:D,JSCommonChartTitle_DynamicChartTitlePainting:c,JSCommonChartTitle_DynamicTitleData:S,JSCommonChartTitle_STRING_FORMAT_TYPE:m}},e78a:function(t,e,a){"use strict";a("99af"),a("cb29"),a("26e9"),a("4ec9"),a("d3b7"),a("e25e"),a("25f0"),a("6062"),a("3ca3"),a("ddb0");var i=a("8f32"),r=a("90f8"),n=a("621d"),s=a("8cb2");function o(){this.Index={NotSupport:{Font:"14px 微软雅黑",TextColor:"rgb(52,52,52)"}}}var h=new o;function l(){this.Canvas,this.ChartBorder,this.ChartFrame,this.Name,this.ClassName="IChartPainting",this.Data=new i.JSCommon_ChartData,this.NotSupportMessage=null,this.MessageFont=h.Index.NotSupport.Font,this.MessageColor=h.Index.NotSupport.TextColor,this.IsDrawFirst=!1,this.IsShow=!0,this.Draw=function(){},this.IsMinuteFrame=function(){var t="MinuteFrame"==this.ChartFrame.ClassName||"MinuteHScreenFrame"==this.ChartFrame.ClassName;return t},this.DrawNotSupportmessage=function(){this.Canvas.font=this.MessageFont,this.Canvas.fillStyle=this.MessageColor;var t=this.ChartBorder.GetLeft(),e=this.ChartBorder.GetWidth(),a=this.ChartBorder.GetTopEx(),i=this.ChartBorder.GetHeightEx(),r=t+e/2,n=a+i/2;this.Canvas.textAlign="center",this.Canvas.textBaseline="middle",this.Canvas.fillText(this.NotSupportMessage,r,n)},this.GetTooltipData=function(t,e,a){return!1},this.GetMaxMin=function(){var t=this.ChartFrame.XPointCount,e={Min:null,Max:null};if(!this.Data||!this.Data.Data)return e;for(var a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];null==r||isNaN(r)||(null==e.Max&&(e.Max=r),null==e.Min&&(e.Min=r),e.Max<r&&(e.Max=r),e.Min>r&&(e.Min=r))}return e},this.GetDynamicFont=function(t){var e;return e=t<5?"4px Arial":t<7?"6px Arial":t<9?"8px Arial":t<11?"10px Arial":t<13?"12px Arial":t<15?"14px Arial":"16px Arial",e},this.GetDynamicFontEx=function(t,e,a,i,r,s){if(a==i){var o="".concat(a.toFixed(0),"px ").concat(s);return o}var h=t+e;r&&(0==r.Type?r.Value>0&&(h=t*r.Value):1==r.Type?r.Value>0&&(h=(t+e)*r.Value):2==r.Type&&n.JSCommonSplit_IFrameSplitOperator.IsNumber(r.Value)&&(h=t+e+2*r.Value)),h<i?h=i:h>a&&(h=a);o="".concat(h.toFixed(0),"px ").concat(s);return o},this.SetFillStyle=function(t,e,a,i,r){if(Array.isArray(t)){var n=this.Canvas.createLinearGradient(e,a,i,r),s=1/t.length;for(var o in t)n.addColorStop(o*s,t[o]);this.Canvas.fillStyle=n}else this.Canvas.fillStyle=t}}function u(){this.newMethod=l,this.newMethod(),delete this.newMethod,this.ClassName="ChartKLine",this.Symbol,this.DrawType=0,this.CloseLineColor=r.JSCommonResource_Global_JSChartResource.CloseLineColor,this.CloseLineAreaColor=r.JSCommonResource_Global_JSChartResource.CloseLineAreaColor,this.UpColor=r.JSCommonResource_Global_JSChartResource.UpBarColor,this.DownColor=r.JSCommonResource_Global_JSChartResource.DownBarColor,this.UnchagneColor=r.JSCommonResource_Global_JSChartResource.UnchagneBarColor,this.ColorData,this.TradeData,this.IsShowMaxMinPrice=!0,this.TextFont=r.JSCommonResource_Global_JSChartResource.KLine.MaxMin.Font,this.TextColor=r.JSCommonResource_Global_JSChartResource.KLine.MaxMin.Color,this.InfoPointColor=r.JSCommonResource_Global_JSChartResource.KLine.Info.Color,this.InfoPointColor2=r.JSCommonResource_Global_JSChartResource.KLine.Info.Color2,this.InfoDrawType=0,this.PtMax,this.PtMin,this.MinBarWidth=r.JSCommonResource_Global_JSChartResource.MinKLineBarWidth,this.DrawAKLine=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,n=this.ChartBorder.GetLeft()+a/2+r.JSCommonResource_Global_JSChartResource.FrameLeftMargin;t&&(n=this.ChartBorder.GetTop()+a/2+r.JSCommonResource_Global_JSChartResource.FrameLeftMargin);var s=this.ChartBorder.GetRight();t&&(s=this.ChartBorder.GetBottom());for(var o=this.ChartFrame.XPointCount,h={X:null,Y:null,Value:null,Align:"left"},l={X:null,Y:null,Value:null,Align:"left"},u=this.Data.DataOffset,C=0;u<this.Data.Data.length&&C<o;++u,++C,n+=e+a){var D=this.Data.Data[u];if(null!=D.Open&&null!=D.High&&null!=D.Low&&null!=D.Close){var m=n,S=n+e;if(S>s)break;var c=m+(S-m)/2,f=this.ChartFrame.GetYFromData(D.Low),d=this.ChartFrame.GetYFromData(D.High),I=this.ChartFrame.GetYFromData(D.Open),v=this.ChartFrame.GetYFromData(D.Close);if((null==h.Value||h.Value<D.High)&&(h.X=c,h.Y=d,h.Value=D.High,h.Align=C<o/2?"left":"right"),(null==l.Value||l.Value>D.Low)&&(l.X=c,l.Y=f,l.Value=D.Low,l.Align=C<o/2?"left":"right"),D.Open<D.Close?this.Canvas.strokeStyle=this.UpColor:D.Open>D.Close?this.Canvas.strokeStyle=this.DownColor:this.Canvas.strokeStyle=this.UnchagneColor,this.Canvas.beginPath(),t?(this.Canvas.moveTo(d,U(c)),this.Canvas.lineTo(f,U(c))):(this.Canvas.moveTo(U(c),d),this.Canvas.lineTo(U(c),f)),this.Canvas.stroke(),e>=this.MinBarWidth&&(this.Canvas.beginPath(),t?(this.Canvas.moveTo(U(I),m),this.Canvas.lineTo(U(I),c)):(this.Canvas.moveTo(m,U(I)),this.Canvas.lineTo(c,U(I))),this.Canvas.stroke(),this.Canvas.beginPath(),t?(this.Canvas.moveTo(U(v),S),this.Canvas.lineTo(U(v),c)):(this.Canvas.moveTo(S,U(v)),this.Canvas.lineTo(c,U(v))),this.Canvas.stroke()),0==this.Data.DataType&&i.JSCommon_ChartData.IsDayPeriod(this.Data.Period,!0)){var p={X:c,Xleft:m,XRight:S,YMax:d,YMin:f,DayData:D,Index:C};this.DrawInfoDiv(p)}}}this.PtMax=h,this.PtMin=l},this.DrawCloseLine=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetLeft()+a/2+2;t&&(i=this.ChartBorder.GetTop()+a/2+2);var r=this.ChartBorder.GetRight();t&&(r=this.ChartBorder.GetBottom());var n=this.ChartFrame.XPointCount,s=!0;this.Canvas.beginPath(),this.Canvas.strokeStyle=this.CloseLineColor;for(var o=this.Data.DataOffset,h=0;o<this.Data.Data.length&&h<n;++o,++h,i+=e+a){var l=this.Data.Data[o];if(null!=l.Open&&null!=l.High&&null!=l.Low&&null!=l.Close){var u=i,C=i+e;if(C>r)break;var D=u+(C-u)/2,m=this.ChartFrame.GetYFromData(l.Close);s?(t?this.Canvas.moveTo(m,D):this.Canvas.moveTo(D,m),s=!1):t?this.Canvas.lineTo(m,D):this.Canvas.lineTo(D,m)}}0==s&&this.Canvas.stroke()},this.DrawCloseArea=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetLeft()+a/2+2;t&&(i=this.ChartBorder.GetTop()+a/2+2);var r=this.ChartBorder.GetRight();t&&(r=this.ChartBorder.GetBottom());var n=this.ChartFrame.XPointCount,s=!0,o=null;this.Canvas.beginPath(),this.Canvas.strokeStyle=this.CloseLineColor;for(var h=this.Data.DataOffset,l=0;h<this.Data.Data.length&&l<n;++h,++l,i+=e+a){var u=this.Data.Data[h];if(null!=u.Open&&null!=u.High&&null!=u.Low&&null!=u.Close){var C=i,D=i+e;if(D>r)break;var m=C+(D-C)/2,S=this.ChartFrame.GetYFromData(u.Close);s?(t?(this.Canvas.moveTo(S,m),o={X:S,Y:m}):(this.Canvas.moveTo(m,S),o={X:m,Y:S}),s=!1):t?this.Canvas.lineTo(S,m):this.Canvas.lineTo(m,S)}}if(!s){if(this.Canvas.stroke(),t?(this.Canvas.lineTo(this.ChartBorder.GetLeft(),m),this.Canvas.lineTo(this.ChartBorder.GetLeft(),o.Y)):(this.Canvas.lineTo(m,this.ChartBorder.GetBottom()),this.Canvas.lineTo(o.X,this.ChartBorder.GetBottom())),this.Canvas.closePath(),Array.isArray(this.CloseLineAreaColor))if(t){var c=this.Canvas.createLinearGradient(this.ChartBorder.GetRightEx(),this.ChartBorder.GetTop(),this.ChartBorder.GetLeft(),this.ChartBorder.GetTop());c.addColorStop(0,this.CloseLineAreaColor[0]),c.addColorStop(1,this.CloseLineAreaColor[1]),this.Canvas.fillStyle=c}else{var f=this.Canvas.createLinearGradient(o.X,this.ChartBorder.GetTopEx(),o.X,this.ChartBorder.GetBottom());f.addColorStop(0,this.CloseLineAreaColor[0]),f.addColorStop(1,this.CloseLineAreaColor[1]),this.Canvas.fillStyle=f}else this.Canvas.fillStyle=this.CloseLineAreaColor;this.Canvas.fill()}},this.DrawKBar=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,r=this.ChartBorder.GetLeft()+a/2+2,n=this.ChartBorder.GetRight(),s=this.ChartFrame.XPointCount;t&&(r=this.ChartBorder.GetTop()+a/2+2,n=this.ChartBorder.GetBottom());for(var o={X:null,Y:null,Value:null,Align:"left"},h={X:null,Y:null,Value:null,Align:"left"},l=this.UpColor,u=this.DownColor,C=this.UnchagneColor,D=this.Data.DataOffset,m=0;D<this.Data.Data.length&&m<s;++D,++m,r+=e+a){var S=this.Data.Data[D];if(null!=S.Open&&null!=S.High&&null!=S.Low&&null!=S.Close){var c=r,f=r+e;if(f>n)break;var d=c+(f-c)/2,I=this.ChartFrame.GetYFromData(S.Low),v=this.ChartFrame.GetYFromData(S.High),p=this.ChartFrame.GetYFromData(S.Open),T=this.ChartFrame.GetYFromData(S.Close),F=v;if((null==o.Value||o.Value<S.High)&&(o.X=d,o.Y=v,o.Value=S.High,o.Align=m<s/2?"left":"right"),(null==h.Value||h.Value>S.Low)&&(h.X=d,h.Y=I,h.Value=S.Low,h.Align=m<s/2?"left":"right"),this.ColorData&&(l=u=C=D<this.ColorData.length&&this.ColorData[D]>0?this.UpColor:this.DownColor),S.Open<S.Close?e>=this.MinBarWidth?(this.Canvas.strokeStyle=l,S.High>S.Close?(this.Canvas.beginPath(),t?(this.Canvas.moveTo(U(F),U(d)),this.Canvas.lineTo(U(3==this.DrawType?Math.max(T,p):T),U(d))):(this.Canvas.moveTo(U(d),U(F)),this.Canvas.lineTo(U(d),U(3==this.DrawType?Math.min(T,p):T))),this.Canvas.stroke(),F=T):F=T,this.Canvas.fillStyle=l,t?Math.abs(p-F)<1?this.Canvas.fillRect(W(F),W(c),1,W(e)):3==this.DrawType?(this.Canvas.beginPath(),this.Canvas.rect(U(F),U(c),W(p-F),W(e)),this.Canvas.stroke()):this.Canvas.fillRect(W(Math.min(p,F)),W(c),W(Math.abs(p-F)),W(e)):Math.abs(p-F)<1?this.Canvas.fillRect(W(c),W(F),W(e),1):3==this.DrawType?(this.Canvas.beginPath(),this.Canvas.rect(U(c),U(F),W(e),W(p-F)),this.Canvas.stroke()):this.Canvas.fillRect(W(c),W(F),W(e),W(p-F)),S.Open>S.Low&&(this.Canvas.beginPath(),t?(this.Canvas.moveTo(U(3==this.DrawType?Math.min(T,p):F),U(d)),this.Canvas.lineTo(U(I),U(d))):(this.Canvas.moveTo(U(d),U(3==this.DrawType?Math.max(T,p):F)),this.Canvas.lineTo(U(d),U(I))),this.Canvas.stroke())):(this.Canvas.beginPath(),t?(this.Canvas.moveTo(v,U(d)),this.Canvas.lineTo(I,U(d))):(this.Canvas.moveTo(U(d),v),this.Canvas.lineTo(U(d),I)),this.Canvas.strokeStyle=l,this.Canvas.stroke()):S.Open>S.Close?e>=this.MinBarWidth?(this.Canvas.strokeStyle=u,S.High>S.Close?(this.Canvas.beginPath(),t?(this.Canvas.moveTo(U(F),U(d)),this.Canvas.lineTo(U(p),U(d))):(this.Canvas.moveTo(U(d),U(F)),this.Canvas.lineTo(U(d),U(p))),this.Canvas.stroke(),F=p):F=p,this.Canvas.fillStyle=u,t?Math.abs(T-F)<1?this.Canvas.fillRect(W(F),W(c),1,W(e)):this.Canvas.fillRect(W(Math.min(T,F)),W(c),W(Math.abs(T-F)),W(e)):Math.abs(T-F)<1?this.Canvas.fillRect(W(c),W(F),W(e),1):this.Canvas.fillRect(W(c),W(F),W(e),W(T-F)),S.Open>S.Low&&(this.Canvas.beginPath(),t?(this.Canvas.moveTo(U(F),U(d)),this.Canvas.lineTo(U(I),U(d))):(this.Canvas.moveTo(U(d),U(F)),this.Canvas.lineTo(U(d),U(I))),this.Canvas.stroke())):(this.Canvas.beginPath(),t?(this.Canvas.moveTo(v,U(d)),this.Canvas.lineTo(I,U(d))):(this.Canvas.moveTo(U(d),v),this.Canvas.lineTo(U(d),I)),this.Canvas.strokeStyle=u,this.Canvas.stroke()):e>=this.MinBarWidth?(this.Canvas.strokeStyle=C,this.Canvas.beginPath(),S.High>S.Close?(t?(this.Canvas.moveTo(F,U(d)),this.Canvas.lineTo(p,U(d))):(this.Canvas.moveTo(U(d),F),this.Canvas.lineTo(U(d),p)),F=p):F=p,t?(this.Canvas.moveTo(U(F),U(c)),this.Canvas.lineTo(U(F),U(f))):(this.Canvas.moveTo(U(c),U(F)),this.Canvas.lineTo(U(f),U(F))),S.Open>S.Low&&(t?(this.Canvas.moveTo(U(F),U(d)),this.Canvas.lineTo(U(I),U(d))):(this.Canvas.moveTo(U(d),U(F)),this.Canvas.lineTo(U(d),U(I)))),this.Canvas.stroke()):(this.Canvas.beginPath(),t?(this.Canvas.moveTo(v,U(d)),this.Canvas.lineTo(I,U(d))):(this.Canvas.moveTo(U(d),v),this.Canvas.lineTo(U(d),I)),this.Canvas.strokeStyle=C,this.Canvas.stroke()),0==this.Data.DataType&&i.JSCommon_ChartData.IsDayPeriod(this.Data.Period,!0)){var A={X:d,Xleft:c,XRight:f,YMax:v,YMin:I,DayData:S,Index:m};this.DrawInfoDiv(A)}}}this.PtMax=o,this.PtMin=h},this.DrawTrade=function(){if(this.TradeData){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetLeft()+a/2+2,r=this.ChartBorder.GetRight(),n=this.ChartFrame.XPointCount;t&&(i=this.ChartBorder.GetTop()+a/2+2,r=this.ChartBorder.GetBottom());var s=this.TradeData.Sell,o=this.TradeData.Buy,h=e;h>10&&(h=10);for(var l=this.Data.DataOffset,u=0;l<this.Data.Data.length&&u<n;++l,++u,i+=e+a){var C=this.Data.Data[l];if(null!=C.Open&&null!=C.High&&null!=C.Low&&null!=C.Close){var D=!1,m=!1;if(s&&l<s.length&&(m=s[l]>0),o&&l<o.length&&(D=o[l]>0),m||D){var S=i,c=i+e;if(c>r)break;var f=S+(c-S)/2,d=this.ChartFrame.GetYFromData(C.Low),I=this.ChartFrame.GetYFromData(C.High);this.ChartFrame.GetYFromData(C.Open),this.ChartFrame.GetYFromData(C.Close);D&&(this.Canvas.fillStyle=this.UpColor,this.Canvas.strokeStyle=this.UnchagneColor,this.Canvas.beginPath(),t?(this.Canvas.moveTo(d-1,f),this.Canvas.lineTo(d-h-1,f-h/2),this.Canvas.lineTo(d-h-1,f+h/2)):(this.Canvas.moveTo(f,d+1),this.Canvas.lineTo(f-h/2,d+h+1),this.Canvas.lineTo(f+h/2,d+h+1)),this.Canvas.closePath(),this.Canvas.fill(),this.Canvas.stroke()),m&&(this.Canvas.fillStyle=this.DownColor,this.Canvas.strokeStyle=this.UnchagneColor,this.Canvas.beginPath(),t?(this.Canvas.moveTo(I+1,f),this.Canvas.lineTo(I+h+1,f-h/2),this.Canvas.lineTo(I+h+1,f+h/2)):(this.Canvas.moveTo(f,I-1),this.Canvas.lineTo(f-h/2,I-h-1),this.Canvas.lineTo(f+h/2,I-h-1)),this.Canvas.closePath(),this.Canvas.fill(),this.Canvas.stroke())}}}}},this.Draw=function(){this.PtMax={X:null,Y:null,Value:null,Align:"left"},this.PtMin={X:null,Y:null,Value:null,Align:"left"},this.ChartFrame.ChartKLine={Max:null,Min:null},0!=this.IsShow&&(1!=this.DrawType?(2==this.DrawType?this.DrawAKLine():4==this.DrawType?this.DrawCloseArea():this.DrawKBar(),this.DrawTrade(),this.IsShowMaxMinPrice&&(!0===this.ChartFrame.IsHScreen?this.HScreenDrawMaxMinPrice(this.PtMax,this.PtMin):this.DrawMaxMinPrice(this.PtMax,this.PtMin))):this.DrawCloseLine())},this.DrawMaxMinPrice=function(t,e){if(null!=t.X&&null!=t.Y&&null!=t.Value&&null!=e.X&&null!=e.Y&&null!=e.Value){var a=s.JSCommonCoordinateData.GetfloatPrecision(this.Symbol);this.Canvas.font=this.TextFont,this.Canvas.fillStyle=this.TextColor,this.Canvas.textAlign=t.Align,this.Canvas.textBaseline="bottom";var i=t.X,r=t.Value.toFixed(a);"left"==t.Align?r="←"+r:r+="→",this.Canvas.fillText(r,i,t.Y),this.ChartFrame.ChartKLine.Max={X:i,Y:t.Y,Text:{BaseLine:"bottom"}},this.Canvas.textAlign=e.Align,this.Canvas.textBaseline="top";i=e.X;r=e.Value.toFixed(a),"left"==e.Align?r="←"+r:r+="→",this.Canvas.fillText(r,i,e.Y),this.ChartFrame.ChartKLine.Min={X:i,Y:e.Y,Text:{BaseLine:"top"}}}},this.HScreenDrawMaxMinPrice=function(t,e){if(null!=t.X&&null!=t.Y&&null!=t.Value&&null!=e.X&&null!=e.Y&&null!=e.Value){var a=s.JSCommonCoordinateData.GetfloatPrecision(this.Symbol),i=t.Y,r=t.X;this.Canvas.save(),this.Canvas.translate(i,r),this.Canvas.rotate(90*Math.PI/180),this.Canvas.font=this.TextFont,this.Canvas.fillStyle=this.TextColor,this.Canvas.textAlign=t.Align,this.Canvas.textBaseline="bottom";var n=t.Value.toFixed(a);"left"==t.Align?n="←"+n:n+="→",this.Canvas.fillText(n,0,0),this.Canvas.restore();i=e.Y,r=e.X;this.Canvas.save(),this.Canvas.translate(i,r),this.Canvas.rotate(90*Math.PI/180),this.Canvas.font=this.TextFont,this.Canvas.fillStyle=this.TextColor,this.Canvas.textAlign=e.Align,this.Canvas.textBaseline="top";n=e.Value.toFixed(a);"left"==e.Align?n="←"+n:n+="→",this.Canvas.fillText(n,0,0),this.Canvas.restore()}},this.DrawInfoDiv=function(t){if(this.InfoData&&!(this.InfoData.length<=0)){var e=this.ChartFrame.DataWidth,a=(this.ChartFrame.DistanceWidth,this.InfoData.get(t.DayData.Date.toString()));if(a&&!(a.Data.length<=0)){var i=!0===this.ChartFrame.IsHScreen;if(1===this.InfoDrawType)if(this.Canvas.font=this.GetDynamicFont(e),this.Canvas.fillStyle=this.InfoPointColor2,this.Canvas.textAlign="center",this.Canvas.textBaseline="top",i){var r=t.YMin,n=t.X;this.Canvas.save(),this.Canvas.translate(r,n),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText("▲",0,0),this.Canvas.restore()}else{var s=U(t.X);this.Canvas.fillText("▲",s,t.YMin)}else{e=this.ChartFrame.DataWidth;var o=e/2;o>3&&(o=3);var h=t.X,l=this.ChartFrame.ChartBorder.GetBottom()-2-o;i&&(l=this.ChartFrame.ChartBorder.GetLeft()+2+o),this.Canvas.fillStyle=this.InfoPointColor,this.Canvas.beginPath(),i?this.Canvas.arc(l,h,o,0,2*Math.PI,!0):this.Canvas.arc(U(h),l,o,0,2*Math.PI,!0),this.Canvas.closePath(),this.Canvas.fill()}}}},this.GetTooltipData=function(t,e,a){return!1},this.GetMaxMin=function(){var t=this.ChartFrame.XPointCount,e={Max:null,Min:null};if(0==this.IsShow)return e;if(1==this.DrawType||4==this.DrawType)for(var a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];n.JSCommonSplit_IFrameSplitOperator.IsNumber(r.Close)&&(null==e.Max&&(e.Max=r.Close),null==e.Min&&(e.Min=r.Close),e.Max<r.Close&&(e.Max=r.Close),e.Min>r.Close&&(e.Min=r.Close))}else for(a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){r=this.Data.Data[a];null!=r.Open&&null!=r.High&&null!=r.Low&&null!=r.Close&&(null==e.Max&&(e.Max=r.High),null==e.Min&&(e.Min=r.Low),e.Max<r.High&&(e.Max=r.High),e.Min>r.Low&&(e.Min=r.Low))}return e}}function C(){this.newMethod=l,this.newMethod(),delete this.newMethod,this.Color="rgb(255,193,37)",this.TextFont="14px 微软雅黑",this.Text,this.TextAlign="left",this.Direction=0,this.YOffset=0,this.Position,this.TextSize={Max:r.JSCommonResource_Global_JSChartResource.DRAWICON.Text.MaxSize,Min:r.JSCommonResource_Global_JSChartResource.DRAWICON.Text.MinSize,Zoom:{Type:r.JSCommonResource_Global_JSChartResource.DRAWICON.Text.Zoom.Type,Value:r.JSCommonResource_Global_JSChartResource.DRAWICON.Text.Zoom.Value},FontName:r.JSCommonResource_Global_JSChartResource.DRAWICON.Text.FontName},this.ReloadResource=function(t){"DRAWTEXT"==this.Name?this.TextSize={Max:r.JSCommonResource_Global_JSChartResource.DRAWTEXT.MaxSize,Min:r.JSCommonResource_Global_JSChartResource.DRAWTEXT.MinSize,Zoom:{Type:r.JSCommonResource_Global_JSChartResource.DRAWTEXT.Zoom.Type,Value:r.JSCommonResource_Global_JSChartResource.DRAWTEXT.Zoom.Value},FontName:r.JSCommonResource_Global_JSChartResource.DRAWTEXT.FontName}:"DRAWNUMBER"==this.Name&&(this.TextSize={Max:r.JSCommonResource_Global_JSChartResource.DRAWNUMBER.MaxSize,Min:r.JSCommonResource_Global_JSChartResource.DRAWNUMBER.MinSize,Zoom:{Type:r.JSCommonResource_Global_JSChartResource.DRAWNUMBER.Zoom.Type,Value:r.JSCommonResource_Global_JSChartResource.DRAWNUMBER.Zoom.Value},FontName:r.JSCommonResource_Global_JSChartResource.DRAWNUMBER.FontName})},this.Draw=function(){if(this.IsShow)if(this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.Position)this.DrawPosition();else if(this.Data&&this.Data.Data){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetRight(),n=this.ChartBorder.GetTopEx(),s=this.ChartBorder.GetBottomEx();t&&(i=this.ChartBorder.GetBottom(),n=this.ChartBorder.GetRightEx(),s=this.ChartBorder.GetLeftEx());var o,h=this.ChartFrame.XPointCount,l=Array.isArray(this.Text);1==this.Direction?this.Canvas.textBaseline="bottom":2==this.Direction?this.Canvas.textBaseline="top":this.Canvas.textBaseline="middle",this.TextFont=this.GetDynamicFontEx(e,a,this.TextSize.Max,this.TextSize.Min,this.TextSize.Zoom,this.TextSize.FontName);for(var u=this.Data.DataOffset,C=0;u<this.Data.Data.length&&C<h;++u,++C){var D=this.Data.Data[u];if(null!=D){var m=this.ChartFrame.GetXFromIndex(C),S=this.ChartFrame.GetYFromData(D);if(m>i)break;if(this.Canvas.textAlign=this.TextAlign,this.Canvas.fillStyle=this.Color,this.Canvas.font=this.TextFont,this.YOffset>0&&this.Direction>0){var c=S;this.Canvas.save(),this.Canvas.setLineDash([5,10]),this.Canvas.strokeStyle=this.Color,this.Canvas.beginPath(),t?(1==this.Direction?(S=n-this.YOffset,c+=5):(S=s+this.YOffset,c-=5),this.Canvas.moveTo(U(c),U(m)),this.Canvas.lineTo(U(S),U(m))):(1==this.Direction?(S=n+this.YOffset,c+=5):(S=s-this.YOffset,c-=5),this.Canvas.moveTo(U(m),U(c)),this.Canvas.lineTo(U(m),U(S))),this.Canvas.stroke(),this.Canvas.restore()}if(l){if(o=this.Text[u],!o)continue;t?"DRAWNUMBER"==this.Name&&(1==this.Direction?S+=r.JSCommonResource_Global_JSChartResource.DRAWABOVE.YOffset:2==this.Direction&&(S-=4)):"DRAWNUMBER"==this.Name&&(1==this.Direction?S-=r.JSCommonResource_Global_JSChartResource.DRAWABOVE.YOffset:2==this.Direction&&(S+=4)),this.DrawText(o,m,S,t)}else this.DrawText(this.Text,m,S,t)}}}},this.DrawPosition=function(){if(this.Text){var t=!0===this.ChartFrame.IsHScreen;if(t)var e=this.ChartBorder.GetRightEx()-this.ChartBorder.GetWidthEx()*this.Position.Y,a=this.ChartBorder.GetTop()+this.ChartBorder.GetHeight()*this.Position.X;else a=this.ChartBorder.GetLeft()+this.ChartBorder.GetWidth()*this.Position.X,e=this.ChartBorder.GetTopEx()+this.ChartBorder.GetHeight()*this.Position.Y;this.Canvas.fillStyle=this.Color,0==this.Position.Type?this.Canvas.textAlign="left":1==this.Position.Type?this.Canvas.textAlign="right":this.Canvas.textAlign="center",1==this.Direction?this.Canvas.textBaseline="bottom":2==this.Direction?this.Canvas.textBaseline="top":this.Canvas.textBaseline="middle",this.DrawText(this.Text,a,e,t)}},this.DrawText=function(t,e,a,i){i?(this.Canvas.save(),this.Canvas.translate(a,e),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(t,0,0),this.Canvas.restore()):this.Canvas.fillText(t,e,a)}}function D(){this.newMethod=l,this.newMethod(),delete this.newMethod,this.ClassName="ChartLine",this.Color="rgb(255,193,37)",this.LineWidth,this.DrawType=0,this.IsDotLine=!1,this.Draw=function(){if(this.IsShow)if(this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.Data&&this.Data.Data)switch(this.DrawType){case 0:return this.DrawLine();case 1:return this.DrawStraightLine()}},this.DrawLine=function(){var t=!0===this.ChartFrame.IsHScreen,e=(this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight());t&&(e=this.ChartBorder.GetBottom());var a=this.ChartFrame.XPointCount;this.Canvas.save(),this.LineWidth>0&&(this.Canvas.lineWidth=this.LineWidth);for(var i=!0,r=0,n=this.Data.DataOffset,s=0;n<this.Data.Data.length&&s<a;++n,++s){var o=this.Data.Data[n];if(null!=o){var h=this.ChartFrame.GetXFromIndex(s),l=this.GetYFromData(o);if(h>e)break;i?(this.Canvas.strokeStyle=this.Color,this.Canvas.beginPath(),t?this.Canvas.moveTo(l,h):this.Canvas.moveTo(h,l),i=!1):t?this.Canvas.lineTo(l,h):this.Canvas.lineTo(h,l),++r}}r>0&&this.Canvas.stroke(),this.Canvas.restore()},this.DrawStraightLine=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.IsMinuteFrame(),a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth,n=this.ChartBorder.GetLeft()+i/2+r.JSCommonResource_Global_JSChartResource.FrameLeftMargin,s=this.ChartBorder.GetRight();t&&(s=this.ChartBorder.GetBottom()),t&&(n=this.ChartBorder.GetTop()+i/2+r.JSCommonResource_Global_JSChartResource.FrameLeftMargin);var o=this.ChartFrame.XPointCount;this.Canvas.save(),this.LineWidth>0&&(this.Canvas.lineWidth=this.LineWidth),this.Canvas.strokeStyle=this.Color,this.IsDotLine&&this.Canvas.setLineDash([3,5]);for(var h=!0,l=0,u=this.Data.DataOffset,C=0;u<this.Data.Data.length&&C<o;++u,++C,n+=a+i){var D=this.Data.Data[u];if(null!=D){if(e)var m=this.ChartFrame.GetXFromIndex(C);else{var S=n,c=n+a;if(c>s)break;m=S+(c-S)/2}var f=this.GetYFromData(D);if(m>s)break;h?(this.Canvas.beginPath(),t?this.Canvas.moveTo(f,m):this.Canvas.moveTo(m,f),h=!1):t?this.Canvas.lineTo(f,m):this.Canvas.lineTo(m,f),++l}else l>0&&this.Canvas.stroke(),h=!0,l=0}l>0&&this.Canvas.stroke(),this.Canvas.restore()},this.GetYFromData=function(t){return this.ChartFrame.GetYFromData(t)}}function m(){this.newMethod=D,this.newMethod(),delete this.newMethod,this.ClassName="ChartSubLine",this.Color="rgb(255,193,37)",this.LineWidth,this.DrawType=0,this.IsDotLine=!1,this.SubFrame={Max:null,Min:null},this.Draw=function(){if(this.IsShow&&this.Data&&this.Data.Data)switch(this.CalculateDataMaxMin(),this.DrawType){case 0:return this.DrawLine();case 1:return this.DrawStraightLine()}},this.GetYFromData=function(t){var e=!0===this.ChartFrame.IsHScreen;if(e){if(t<=this.SubFrame.Min)return this.ChartBorder.GetLeftEx();if(t>=this.SubFrame.Max)return this.ChartBorder.GetRightEx();var a=this.ChartBorder.GetWidthEx()*(t-this.SubFrame.Min)/(this.SubFrame.Max-this.SubFrame.Min);return this.ChartBorder.GetLeftEx()+a}if(t<=this.SubFrame.Min)return this.ChartBorder.GetBottomEx();if(t>=this.SubFrame.Max)return this.ChartBorder.GetTopEx();var i=this.ChartBorder.GetHeightEx()*(t-this.SubFrame.Min)/(this.SubFrame.Max-this.SubFrame.Min);return this.ChartBorder.GetBottomEx()-i},this.CalculateDataMaxMin=function(){this.SubFrame={Max:null,Min:null};var t=!0===this.ChartFrame.IsHScreen,e=this.ChartBorder.GetRight();t&&(e=this.ChartBorder.GetBottom());for(var a=this.ChartFrame.XPointCount,i=this.Data.DataOffset,r=0;i<this.Data.Data.length&&r<a;++i,++r){var n=this.Data.Data[i];if(null!=n){var s=this.ChartFrame.GetXFromIndex(r);if(s>e)break;(null==this.SubFrame.Min||this.SubFrame.Min>n)&&(this.SubFrame.Min=n),(null==this.SubFrame.Max||this.SubFrame.Max<n)&&(this.SubFrame.Max=n)}}},this.GetMaxMin=function(){var t={Min:null,Max:null};return t}}function S(){this.newMethod=l,this.newMethod(),delete this.newMethod,this.Color="rgb(255,193,37)",this.Radius=1,this.ClassName="ChartPointDot",this.Draw=function(){if(this.IsShow)if(this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.Data&&this.Data.Data){var t=!0===this.ChartFrame.IsHScreen,e=(this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight());!0===t&&(e=this.ChartBorder.GetBottom());var a=this.ChartFrame.XPointCount;this.Canvas.save(),this.Canvas.fillStyle=this.Color;for(var i=this.Data.DataOffset,r=0;i<this.Data.Data.length&&r<a;++i,++r){var n=this.Data.Data[i];if(null!=n){var s=this.ChartFrame.GetXFromIndex(r),o=this.ChartFrame.GetYFromData(n);if(s>e)break;this.Canvas.beginPath(),t?this.Canvas.arc(o,s,this.Radius,0,2*Math.PI,!0):this.Canvas.arc(s,o,this.Radius,0,2*Math.PI,!0),this.Canvas.closePath(),this.Canvas.fill()}}this.Canvas.restore()}}}function c(){this.newMethod=l,this.newMethod(),delete this.newMethod,this.Color="rgb(255,193,37)",this.LineWidth,this.ClassName="ChartStick",this.DrawLine=function(){if(this.Data&&this.Data.Data){var t=!0===this.ChartFrame.IsHScreen,e=(this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight());!0===t&&(e=this.ChartBorder.GetBottom());var a=this.ChartFrame.XPointCount;this.Canvas.save(),this.LineWidth>0&&(this.Canvas.lineWidth=this.LineWidth);for(var i=!0,r=0,n=this.Data.DataOffset,s=0;n<this.Data.Data.length&&s<a;++n,++s){var o=this.Data.Data[n];if(null!=o){var h=this.ChartFrame.GetXFromIndex(s),l=this.ChartFrame.GetYFromData(o);if(h>e)break;i?(this.Canvas.strokeStyle=this.Color,this.Canvas.beginPath(),t?this.Canvas.moveTo(l,h):this.Canvas.moveTo(h,l),i=!1):t?this.Canvas.lineTo(l,h):this.Canvas.lineTo(h,l),++r}}r>0&&this.Canvas.stroke(),this.Canvas.restore()}},this.DrawStick=function(){if(this.Data&&this.Data.Data){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartBorder.GetRight();t&&(e=this.ChartBorder.GetBottom());var a=this.ChartFrame.XPointCount,i=this.ChartBorder.GetBottom(),r=this.ChartBorder.GetLeft();this.Canvas.save(),this.Canvas.strokeStyle=this.Color,this.LineWidth&&(this.Canvas.lineWidth=this.LineWidth);for(var n=this.Data.DataOffset,s=0;n<this.Data.Data.length&&s<a;++n,++s){var o=this.Data.Data[n];if(null!=o){var h=this.ChartFrame.GetXFromIndex(s),l=this.ChartFrame.GetYFromData(o);if(h>e)break;if(this.Canvas.beginPath(),t)this.Canvas.moveTo(r,h),this.Canvas.lineTo(l,h),this.Canvas.stroke();else{var u=parseInt(h.toString())+.5;this.Canvas.moveTo(u,l),this.Canvas.lineTo(u,i)}this.Canvas.stroke()}}this.Canvas.restore()}},this.Draw=function(){this.IsShow&&(this.NotSupportMessage?this.DrawNotSupportmessage():this.DrawStick())}}function f(){this.newMethod=c,this.newMethod(),delete this.newMethod,this.ClassName="ChartLineStick",this.Draw=function(){this.IsShow&&(this.NotSupportMessage?this.DrawNotSupportmessage():(this.DrawStick(),this.DrawLine()))}}function d(){this.newMethod=l,this.newMethod(),delete this.newMethod,this.ClassName="ChartStickLine",this.Color="rgb(255,193,37)",this.LineWidth=2,this.BarType=0,this.MinBarWidth=r.JSCommonResource_Global_JSChartResource.MinKLineBarWidth,this.Draw=function(){if(this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.Data&&this.Data.Data){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetRight();t&&(i=this.ChartBorder.GetBottom());var r=this.ChartFrame.XPointCount,n=this.ChartBorder.GetLeft()+a/2+2;t&&(n=this.ChartBorder.GetTop()+a/2+2),this.Canvas.save();var s=!1,o=!1;if(50==this.LineWidth)e>=this.MinBarWidth?(o=!0,this.Canvas.fillStyle=this.Color,this.Canvas.strokeStyle=this.Color):(this.Canvas.lineWidth=1,this.Canvas.strokeStyle=this.Color);else if(this.LineWidth<100){var h=this.LineWidth;e<=4?h=1:e<h&&(h=parseInt(e)),this.Canvas.lineWidth=h,this.Canvas.strokeStyle=this.Color}else{s=!0,this.Canvas.fillStyle=this.Color;var l=2}for(var u=this.Data.DataOffset,C=0;u<this.Data.Data.length&&C<r;++u,++C,n+=e+a){var D=this.Data.Data[u];if(null!=D){var m=D.Value,S=D.Value2;null==S&&(S=0);var c=this.ChartFrame.GetXFromIndex(C),f=this.ChartFrame.GetYFromData(m),d=this.ChartFrame.GetYFromData(S);if(c>i)break;if(s){var I=n-l;if(t)this.Canvas.fillRect(Math.min(f,d),I,Math.abs(f-d),e+a+2*l);else{var v=e+a+2*l;I+v>i&&(v=i-I),this.Canvas.fillRect(I,W(Math.min(f,d)),v,W(Math.abs(f-d)))}}else if(o)1==this.BarType?t?(this.Canvas.beginPath(),this.Canvas.fillRect(W(Math.min(f,d)),W(n),W(Math.abs(f-d)),W(e)),this.Canvas.stroke()):(this.Canvas.beginPath(),this.Canvas.rect(W(n),W(Math.min(f,d)),W(e),W(Math.abs(f-d))),this.Canvas.stroke()):t?this.Canvas.fillRect(W(Math.min(f,d)),W(n),W(Math.abs(f-d)),W(e)):this.Canvas.fillRect(W(n),W(Math.min(f,d)),W(e),W(Math.abs(f-d)));else if(t)this.Canvas.beginPath(),this.Canvas.moveTo(f,U(c)),this.Canvas.lineTo(d,U(c)),this.Canvas.stroke();else{var p=parseInt(c.toString())+.5;this.Canvas.beginPath(),this.Canvas.moveTo(p,f),this.Canvas.lineTo(p,d),this.Canvas.stroke()}}}this.Canvas.restore()}},this.GetMaxMin=function(){var t=this.ChartFrame.XPointCount,e={Min:null,Max:null};if(!this.Data||!this.Data.Data)return e;for(var a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];if(null!=r){var n=r.Value2;if(null==n&&(n=0),null!=r&&!isNaN(r.Value)&&!isNaN(n)){var s=Math.max(r.Value,n),o=Math.min(r.Value,n);null==e.Max&&(e.Max=s),null==e.Min&&(e.Min=o),e.Max<s&&(e.Max=s),e.Min>o&&(e.Min=o)}}}return e}}function I(){this.newMethod=l,this.newMethod(),delete this.newMethod,this.ClassName="ChartRectangle",this.Color=[],this.Rect,this.BorderColor=r.JSCommonResource_Global_JSChartResource.FrameBorderPen,this.Draw=function(){if(this.IsShow&&this.Color&&this.Rect&&!(this.Color.length<=0)){this.Canvas.strokeStyle=this.BorderColor;var t=!1;if(2==this.Color.length)this.Canvas.fillStyle=this.Color[0],t=!0;else{if(1!=this.Color.length)return;this.Color[0]&&(this.Canvas.fillStyle=this.Color[0],t=!0)}var e=this.ChartBorder.GetWidth(),a=this.ChartBorder.GetHeightEx(),i=this.Rect.Left/1e3*e,r=this.Rect.Top/1e3*a,n=this.Rect.Right/1e3*e,s=this.Rect.Bottom/1e3*a;i=this.ChartBorder.GetLeft()+i,r=this.ChartBorder.GetTopEx()+r,n=this.ChartBorder.GetLeft()+n,s=this.ChartBorder.GetTopEx()+s;var o=Math.abs(i-n),h=Math.abs(r-s);t&&this.Canvas.fillRect(i,r,o,h),this.Canvas.rect(U(i),U(r),W(o),W(h)),this.Canvas.stroke()}}}function v(){this.newMethod=l,this.newMethod(),delete this.newMethod,this.Color="rgb(65,105,225)",this.MainData,this.SourceData,this.Name="ChartOverlayKLine",this.Title,this.DrawType=0,this.ClassName="ChartOverlayKLine",this.CustomDrawType=null,this.SetOption=function(t){t&&n.JSCommonSplit_IFrameSplitOperator.IsNumber(t.DrawType)&&(this.CustomDrawType=t.DrawType)},this.DrawKBar=function(t){var e=!0===this.ChartFrame.IsHScreen,a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth,r=this.ChartBorder.GetLeft()+i/2+2;e&&(r=this.ChartBorder.GetTop()+i/2+2);var n=this.ChartBorder.GetRight();e&&(n=this.ChartBorder.GetBottom());for(var s=this.ChartFrame.XPointCount,o=!0,h=null,l=this.Data.DataOffset,u=0;l<this.Data.Data.length&&u<s;++l,++u,r+=a+i){var C=this.Data.Data[l];if(C&&null!=C.Open&&null!=C.High&&null!=C.Low&&null!=C.Close){null==h&&(h=C.Open),o&&(this.Canvas.strokeStyle=this.Color,this.Canvas.fillStyle=this.Color,this.Canvas.beginPath(),o=!1);var D=r,m=r+a;if(m>n)break;var S=D+(m-D)/2,c=this.ChartFrame.GetYFromData(C.Low/h*t),f=this.ChartFrame.GetYFromData(C.High/h*t),d=this.ChartFrame.GetYFromData(C.Open/h*t),I=this.ChartFrame.GetYFromData(C.Close/h*t),v=f;C.Open<C.Close?a>=4?(C.High>C.Close?(e?(this.Canvas.moveTo(U(v),U(S)),this.Canvas.lineTo(U(3==this.DrawType?Math.max(I,d):I),U(S))):(this.Canvas.moveTo(U(S),U(v)),this.Canvas.lineTo(U(S),U(3==this.DrawType?Math.min(I,d):I))),v=I):v=I,e?Math.abs(d-v)<1?this.Canvas.fillRect(W(v),W(D),1,W(a)):3==this.DrawType?this.Canvas.rect(U(v),U(D),W(d-v),W(a)):this.Canvas.fillRect(W(v),W(D),W(d-v),W(a)):Math.abs(d-v)<1?this.Canvas.fillRect(W(D),W(v),W(a),1):3==this.DrawType?this.Canvas.rect(U(D),U(v),W(a),W(d-v)):this.Canvas.fillRect(W(D),W(v),W(a),W(d-v)),C.Open>C.Low&&(e?(this.Canvas.moveTo(U(3==this.DrawType?Math.min(I,d):v),U(S)),this.Canvas.lineTo(U(c),U(S))):(this.Canvas.moveTo(U(S),U(3==this.DrawType?Math.max(I,d):v)),this.Canvas.lineTo(U(S),U(c))))):e?(this.Canvas.moveTo(f,U(S)),this.Canvas.lineTo(c,U(S))):(this.Canvas.moveTo(U(S),f),this.Canvas.lineTo(U(S),c)):C.Open>C.Close?a>=4?(C.High>C.Close?(e?(this.Canvas.moveTo(U(v),U(S)),this.Canvas.lineTo(U(d),U(S))):(this.Canvas.moveTo(U(S),U(v)),this.Canvas.lineTo(U(S),U(d))),v=d):v=d,e?Math.abs(I-v)<1?this.Canvas.fillRect(W(v),W(D),1,W(a)):this.Canvas.fillRect(W(v),W(D),W(I-v),W(a)):Math.abs(I-v)<1?this.Canvas.fillRect(W(D),W(v),W(a),1):this.Canvas.fillRect(W(D),W(v),W(a),W(I-v)),C.Open>C.Low&&(e?(this.Canvas.moveTo(U(v),U(S)),this.Canvas.lineTo(U(c),U(S))):(this.Canvas.moveTo(U(S),U(v)),this.Canvas.lineTo(U(S),U(c))))):e?(this.Canvas.moveTo(f,U(S)),this.Canvas.lineTo(c,U(S))):(this.Canvas.moveTo(U(S),f),this.Canvas.lineTo(U(S),c)):a>=4?(C.High>C.Close?(e?(this.Canvas.moveTo(v,U(S)),this.Canvas.lineTo(d,U(S))):(this.Canvas.moveTo(U(S),v),this.Canvas.lineTo(U(S),d)),v=d):v=d,e?(this.Canvas.moveTo(U(v),U(D)),this.Canvas.lineTo(U(v),U(m))):(this.Canvas.moveTo(U(D),U(v)),this.Canvas.lineTo(U(m),U(v))),C.Open>C.Low&&(e?(this.Canvas.moveTo(U(v),U(S)),this.Canvas.lineTo(U(c),U(S))):(this.Canvas.moveTo(U(S),U(v)),this.Canvas.lineTo(U(S),U(c))))):e?(this.Canvas.moveTo(f,U(S)),this.Canvas.lineTo(c,U(S))):(this.Canvas.moveTo(U(S),f),this.Canvas.lineTo(U(S),c))}}0==o&&this.Canvas.stroke()},this.DrawAKLine=function(t){var e=!0===this.ChartFrame.IsHScreen,a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth,r=this.ChartBorder.GetLeft()+i/2+2;e&&(r=this.ChartBorder.GetTop()+i/2+2);var n=this.ChartBorder.GetRight();e&&(n=this.ChartBorder.GetBottom());var s=this.ChartFrame.XPointCount,o=null;this.Canvas.strokeStyle=this.Color;for(var h=this.Data.DataOffset,l=0;h<this.Data.Data.length&&l<s;++h,++l,r+=a+i){var u=this.Data.Data[h];if(null!=u.Open&&null!=u.High&&null!=u.Low&&null!=u.Close){null==o&&(o=u.Open);var C=r,D=r+a;if(D>n)break;var m=C+(D-C)/2,S=this.ChartFrame.GetYFromData(u.Low/o*t),c=this.ChartFrame.GetYFromData(u.High/o*t),f=this.ChartFrame.GetYFromData(u.Open/o*t),d=this.ChartFrame.GetYFromData(u.Close/o*t);this.Canvas.beginPath(),e?(this.Canvas.moveTo(c,U(m)),this.Canvas.lineTo(S,U(m))):(this.Canvas.moveTo(U(m),c),this.Canvas.lineTo(U(m),S)),this.Canvas.stroke(),a>=4&&(this.Canvas.beginPath(),e?(this.Canvas.moveTo(U(f),C),this.Canvas.lineTo(U(f),m)):(this.Canvas.moveTo(C,U(f)),this.Canvas.lineTo(m,U(f))),this.Canvas.stroke(),this.Canvas.beginPath(),e?(this.Canvas.moveTo(U(d),D),this.Canvas.lineTo(U(d),m)):(this.Canvas.moveTo(D,U(d)),this.Canvas.lineTo(m,U(d))),this.Canvas.stroke())}}},this.DrawCloseLine=function(t){var e=!0===this.ChartFrame.IsHScreen,a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth,r=this.ChartBorder.GetLeft()+i/2+2;e&&(r=this.ChartBorder.GetTop()+i/2+2);var n=this.ChartBorder.GetRight();e&&(n=this.ChartBorder.GetBottom());var s=this.ChartFrame.XPointCount,o=null,h=!0;this.Canvas.strokeStyle=this.Color,this.Canvas.beginPath();for(var l=this.Data.DataOffset,u=0;l<this.Data.Data.length&&u<s;++l,++u,r+=a+i){var C=this.Data.Data[l];if(null!=C.Open&&null!=C.High&&null!=C.Low&&null!=C.Close){null==o&&(o=C.Open);var D=r,m=r+a;if(m>n)break;var S=D+(m-D)/2,c=this.ChartFrame.GetYFromData(C.Close/o*t);h?(e?this.Canvas.moveTo(c,S):this.Canvas.moveTo(S,c),h=!1):e?this.Canvas.lineTo(c,S):this.Canvas.lineTo(S,c)}}0==h&&this.Canvas.stroke()},this.Draw=function(){if(this.TooltipRect=[],this.MainData&&this.Data){for(var t=this.ChartFrame.XPointCount,e=null,a=this.Data.DataOffset,i=0;a<this.MainData.Data.length&&i<t;++a,++i){var r=this.MainData.Data[a];if(null!=r.Open&&null!=r.High&&null!=r.Low&&null!=r.Close){e=r.Open;break}}if(null!=e){var n=this.DrawType;null!=this.CustomDrawType&&(this.DrawType=this.CustomDrawType),1==this.DrawType?this.DrawCloseLine(e):2==this.DrawType?this.DrawAKLine(e):this.DrawKBar(e),this.DrawType=n}}},this.GetMaxMin=function(){var t=this.ChartFrame.XPointCount,e={Max:null,Min:null};if(!this.MainData||!this.Data)return e;for(var a=null,i=this.Data.DataOffset,r=0;i<this.MainData.Data.length&&r<t;++i,++r){var n=this.MainData.Data[i];if(null!=n.Open&&null!=n.High&&null!=n.Low&&null!=n.Close){a=n.Close;break}}if(null==a)return e;var s,o,h=null;for(i=this.Data.DataOffset,r=0;i<this.Data.Data.length&&r<t;++i,++r){n=this.Data.Data[i];n&&null!=n.Open&&null!=n.High&&null!=n.Low&&null!=n.Close&&(null==h&&(h=n.Open),s=n.High/h*a,o=n.Low/h*a,null==e.Max&&(e.Max=s),null==e.Min&&(e.Min=o),e.Max<s&&(e.Max=s),e.Min>o&&(e.Min=o))}return e}}function p(){this.newMethod=l,this.newMethod(),delete this.newMethod,this.ClassName="ChartMultiText",this.Texts=[],this.Font=r.JSCommonResource_Global_JSChartResource.DefaultTextFont,this.Color=r.JSCommonResource_Global_JSChartResource.DefaultTextColor,this.IsHScreen=!1,this.Draw=function(){if(this.IsShow&&this.Data&&!(this.Data.length<=0)&&this.Texts){this.IsHScreen=!0===this.ChartFrame.IsHScreen;var t=this.ChartFrame.XPointCount,e=this.Data.DataOffset,a=this.ChartBorder.GetLeft(),i=this.ChartBorder.GetRight();for(var r in this.IsHScreen&&(a=this.ChartBorder.GetTop(),i=this.ChartBorder.GetBottom()),this.Texts){var s=this.Texts[r];if(s.Text&&n.JSCommonSplit_IFrameSplitOperator.IsNumber(s.Index)){var o=s.Index-e;if(o>=0&&o<t){var h=this.ChartFrame.GetXFromIndex(o),l=this.ChartFrame.GetYFromData(s.Value);s.Color?this.Canvas.fillStyle=s.Color:this.Canvas.fillStyle=this.Color,s.Font?this.Canvas.font=s.Font:this.Canvas.font=this.Font;var u=this.Canvas.measureText(s.Text).width;if(this.Canvas.textAlign="center",h+u/2>=i?(this.Canvas.textAlign="right",h=i):h-u/2<a&&(this.Canvas.textAlign="left",h=a),1==s.Baseline?this.Canvas.textBaseline="top":2==s.Baseline?this.Canvas.textBaseline="bottom":this.Canvas.textBaseline="middle",this.IsHScreen?(this.Canvas.save(),this.Canvas.translate(l,h),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(s.Text,0,0),this.Canvas.restore()):this.Canvas.fillText(s.Text,h,l),s.Line){var C=this.Data.Data[s.Index],D="H"==s.Line.KData?C.High:C.Low,m=this.ChartFrame.GetYFromData(D),S=l;Array.isArray(s.Line.Offset)&&2==s.Line.Offset.length&&(S>m?(S-=s.Line.Offset[1],m+=s.Line.Offset[0]):S<m&&(S+=s.Line.Offset[1],m-=s.Line.Offset[0])),this.Canvas.save(),s.Line.Dash&&this.Canvas.setLineDash(s.Line.Dash),s.Line.Width>0&&(this.Canvas.lineWidth=s.Line.Width),this.Canvas.strokeStyle=s.Line.Color,this.Canvas.beginPath(),this.IsHScreen?(this.Canvas.moveTo(S,U(h)),this.Canvas.lineTo(m,U(h))):(this.Canvas.moveTo(U(h),S),this.Canvas.lineTo(U(h),m)),this.Canvas.stroke(),this.Canvas.restore()}}}}}},this.GetMaxMin=function(){var t={Min:null,Max:null};if(!this.Texts)return t;var e=this.ChartFrame.XPointCount,a=this.Data.DataOffset,i=a+e;for(var r in this.Texts){var n=this.Texts[r];n.Index>=a&&n.Index<i&&((null==t.Max||t.Max<n.Value)&&(t.Max=n.Value),(null==t.Min||t.Min>n.Value)&&(t.Min=n.Value))}return t}}function T(){this.newMethod=l,this.newMethod(),delete this.newMethod,this.ClassName="ChartMultiHtmlDom",this.Texts=[],this.IsHScreen=!1,this.DrawCallback,this.DrawItem=[],this.Draw=function(){this.DrawItem=[],this.DrawCallback&&this.DrawCallback(1,{Self:this}),this.DrawDom(),this.DrawCallback&&this.DrawCallback(2,{Self:this,Draw:this.DrawItem})},this.DrawDom=function(){if(this.IsShow&&this.Data&&!(this.Data.length<=0)){this.IsHScreen=!0===this.ChartFrame.IsHScreen;var t=this.ChartFrame.XPointCount,e=this.Data.DataOffset;for(var a in this.Texts){var i=this.Texts[a];if(i.Text&&n.JSCommonSplit_IFrameSplitOperator.IsNumber(i.Index)){var r=i.Index-e,s=this.Data.Data[i.Index],o={KData:s,Item:i,IsShow:!1,Self:this};if(r>=0&&r<t){var h=this.ChartFrame.GetXFromIndex(r),l=this.ChartFrame.GetYFromData(i.Value);o.X=h,o.Y=l,o.IsShow=!0}this.DrawItem.push(o),this.DrawCallback&&this.DrawCallback(3,o)}}}},this.GetMaxMin=function(){var t={Min:null,Max:null},e=this.ChartFrame.XPointCount,a=this.Data.DataOffset,i=a+e;for(var r in this.Texts){var s=this.Texts[r];n.JSCommonSplit_IFrameSplitOperator.IsNumber(s.Index)&&(s.Index>=a&&s.Index<i&&((null==t.Max||t.Max<s.Value)&&(t.Max=s.Value),(null==t.Min||t.Min>s.Value)&&(t.Min=s.Value)))}return t}}function F(){this.newMethod=l,this.newMethod(),delete this.newMethod,this.Lines=[],this.IsHScreen=!1,this.Draw=function(){if(this.IsShow&&this.Data&&!(this.Data.length<=0)){this.IsHScreen=!0===this.ChartFrame.IsHScreen;var t=this.ChartFrame.XPointCount,e=this.Data.DataOffset,a=[];for(var i in this.Lines){var r=this.Lines[i],s={Point:[],Color:r.Color};for(var o in r.Point){var h=r.Point[o];if(n.JSCommonSplit_IFrameSplitOperator.IsNumber(h.Index)){var l=h.Index-e;if(l>=0&&l<t){var u=this.ChartFrame.GetXFromIndex(l),C=this.ChartFrame.GetYFromData(h.Value);s.Point.push({X:u,Y:C})}}}s.Point.length>=2&&a.push(s)}for(var i in a){var D=a[i];this.DrawLine(D)}}},this.DrawLine=function(t){for(var e in this.Canvas.strokeStyle=t.Color,t.Point){var a=t.Point[e];0==e?(this.Canvas.beginPath(),this.IsHScreen?this.Canvas.moveTo(a.Y,a.X):this.Canvas.moveTo(a.X,a.Y)):this.IsHScreen?this.Canvas.lineTo(a.Y,a.X):this.Canvas.lineTo(a.X,a.Y)}this.Canvas.stroke()},this.GetMaxMin=function(){var t={Min:null,Max:null},e=this.ChartFrame.XPointCount,a=this.Data.DataOffset,i=a+e;for(var r in this.Lines){var n=this.Lines[r];for(var s in n.Point){var o=n.Point[s];o.Index>=a&&o.Index<i&&((null==t.Max||t.Max<o.Value)&&(t.Max=o.Value),(null==t.Min||t.Min>o.Value)&&(t.Min=o.Value))}}return t}}function A(){this.newMethod=l,this.newMethod(),delete this.newMethod,this.Bars=[],this.IsHScreen=!1,this.Draw=function(){if(this.IsShow&&this.Data&&!(this.Data.length<=0)){this.IsHScreen=!0===this.ChartFrame.IsHScreen;var t=this.ChartFrame.XPointCount,e=this.Data.DataOffset,a=this.ChartFrame.DataWidth,i=[];for(var r in this.Bars){var s=this.Bars[r],o={Point:[],Color:s.Color,Width:a,Type:0};for(var h in s.Type>0&&(o.Type=s.Type),s.Width>0?(o.Width=s.Width,o.Width>a&&(o.Width=a)):o.Width<4&&(o.Width=1),s.Point){var l=s.Point[h];if(n.JSCommonSplit_IFrameSplitOperator.IsNumber(l.Index)){var u=l.Index-e;if(u>=0&&u<t){var C=this.ChartFrame.GetXFromIndex(u),D=this.ChartFrame.GetYFromData(l.Value),m=this.ChartFrame.GetYFromData(l.Value2);o.Point.push({X:C,Y:D,Y2:m})}}}o.Point.length>0&&i.push(o)}for(var r in i){s=i[r];s.Width>=4?1==s.Type?this.DrawHollowBar(s):this.DrawFillBar(s):this.DrawLineBar(s)}}},this.DrawLineBar=function(t){this.Canvas.strokeStyle=t.Color;var e=this.Canvas.lineWidth;for(var a in this.Canvas.lineWidth=t.Width,t.Point){var i=t.Point[a];this.Canvas.beginPath(),this.IsHScreen?(this.Canvas.moveTo(U(i.Y),U(i.X)),this.Canvas.lineTo(U(i.Y2),U(i.X))):(this.Canvas.moveTo(U(i.X),U(i.Y)),this.Canvas.lineTo(U(i.X),U(i.Y2))),this.Canvas.stroke()}this.Canvas.lineWidth=e},this.DrawFillBar=function(t){for(var e in this.Canvas.fillStyle=t.Color,t.Point){var a=t.Point[e],i=a.X-t.Width/2,r=Math.min(a.Y,a.Y2),n=t.Width,s=Math.abs(a.Y-a.Y2);this.IsHScreen?this.Canvas.fillRect(W(r),W(i),W(s),W(n)):this.Canvas.fillRect(W(i),W(r),W(n),W(s))}},this.DrawHollowBar=function(t){this.Canvas.strokeStyle=t.Color;var e=1;for(var a in t.Point){var i=t.Point[a],r=i.X-t.Width/2,n=Math.min(i.Y,i.Y2),s=t.Width,o=Math.abs(i.Y-i.Y2);this.Canvas.beginPath(),this.IsHScreen?this.Canvas.rect(U(n),U(r),W(o),W(s)):this.Canvas.rect(U(r),U(n),W(s),W(o)),this.Canvas.stroke()}this.Canvas.lineWidth=e},this.GetMaxMin=function(){var t={Min:null,Max:null},e=this.ChartFrame.XPointCount,a=this.Data.DataOffset,i=a+e;for(var r in this.Bars){var n=this.Bars[r];for(var s in n.Point){var o=n.Point[s];if(o.Index>=a&&o.Index<i){var h=Math.min(o.Value,o.Value2),l=Math.max(o.Value,o.Value2);(null==t.Max||t.Max<l)&&(t.Max=l),(null==t.Min||t.Min>h)&&(t.Min=h)}}}return t}}function M(){this.newMethod=l,this.newMethod(),delete this.newMethod,this.ClassName="ChartMinuteInfo",this.Data=new Map,this.SourceData,this.ChartMinutePrice,this.YClose,this.TextColor=r.JSCommonResource_Global_JSChartResource.MinuteInfo.TextColor,this.Font=r.JSCommonResource_Global_JSChartResource.MinuteInfo.Font,this.PointColor=r.JSCommonResource_Global_JSChartResource.MinuteInfo.PointColor,this.LineColor=r.JSCommonResource_Global_JSChartResource.MinuteInfo.LineColor,this.TextBGColor=r.JSCommonResource_Global_JSChartResource.MinuteInfo.TextBGColor,this.TextHeight=18,this.TextRectCache=[],this.InfoDrawCache=[],this.FrameBottom,this.FrameTop,this.FrameLeft,this.FrameRight,this.YOffset=5,this.IsHScreen=!1,this.SetOption=function(t){t.TextColor&&(this.TextColor=t.TextColor),t.TextBGColor&&(this.TextBGColor=t.TextBGColor),t.Font&&(this.Font=t.Font),t.PointColor&&(this.PointColor=t.PointColor),t.LineColor&&(this.LineColor=t.LineColor),t.TextHeight>0&&(this.TextHeight=t.TextHeight)},this.Draw=function(){if(this.ChartMinutePrice&&this.Data&&!(this.Data.size<=0)){this.TextRectCache=[],this.InfoDrawCache=[],this.IsHScreen=!0===this.ChartFrame.IsHScreen;var t=this.ChartFrame.XPointCount;this.ChartFrame.MinuteCount;this.FrameBottom=this.ChartBorder.GetBottom(),this.FrameTop=this.ChartBorder.GetTop(),this.FrameLeft=this.ChartBorder.GetLeft(),this.FrameRight=this.ChartBorder.GetRight(),this.IsHScreen&&(this.FrameRight=this.ChartBorder.GetBottom(),this.FrameLeft=this.ChartBorder.GetTop(),this.FrameBottom=this.ChartBorder.GetLeft(),this.FrameTop=this.ChartBorder.GetRight()),this.YClose=this.ChartMinutePrice.YClose;var e=this.ChartMinutePrice.Data,a=!1;this.ChartMinutePrice.SourceData&&(e=this.ChartMinutePrice.SourceData,a=!0),this.Canvas.font=this.Font;for(var i=e.DataOffset,r=0;i<e.Data.length&&r<t;++i,++r){var n=this.SourceData.Data[i];if((!a||!n.Before)&&n){var s=n.DateTime;this.Data.has(s)&&(this.IsHScreen?this.CalcuateInfoHScreenPosition(this.Data.get(s),r,n):this.CalcuateInfoPosition(this.Data.get(s),r,n))}}for(var i in this.InfoDrawCache){n=this.InfoDrawCache[i];this.DrawInfoLines(n)}for(var i in this.InfoDrawCache){n=this.InfoDrawCache[i];this.DrawInfoText(n)}this.TextRectCache=[],this.InfoDrawCache=[]}},this.CalcuateInfoPosition=function(t,e,a){if(t&&t.Data&&!(t.Data.length<=0)){var i=t.Data[0],r=this.Canvas.measureText(i.Title).width+4,n=this.TextHeight,s=this.ChartFrame.GetXFromIndex(e),o=this.ChartFrame.GetYFromData(a.Close);s=U(s);var h=s<this.FrameLeft+Math.abs(this.FrameLeft-this.FrameRight)/2,l=[2,4,3,2,3,3,2],u=n+l[e%l.length],C={Y:[{Value:o+(n+this.YOffset),Offset:u},{Value:o-(2*n+this.YOffset),Offset:-u}]};a.Close<this.YClose&&(C.Y=C.Y.reverse());var D={X:s,Y:null,Width:r,Height:n};h||(D.X-=D.Width),this.FixTextRect(D,C);var m={Border:D,Start:{X:s,Y:o},IsLeft:h,Title:i.Title};this.InfoDrawCache.push(m),this.TextRectCache.push(D)}},this.CalcuateInfoHScreenPosition=function(t,e,a){if(t&&t.Data&&!(t.Data.length<=0)){var i=t.Data[0],r=this.Canvas.measureText(i.Title).width+4,n=this.TextHeight,s=this.ChartFrame.GetXFromIndex(e),o=this.ChartFrame.GetYFromData(a.Close);s=U(s);var h=s<this.FrameLeft+Math.abs(this.FrameLeft-this.FrameRight)/2,l=[2,4,3,2,3,3,2],u=n+l[e%l.length],C={X:[{Value:o+(n+this.YOffset),Offset:u},{Value:o-(2*n+this.YOffset),Offset:-u}]};a.Close>this.YClose&&(C.X=C.X.reverse());var D={X:null,Y:s,Width:n,Height:r};h||(D.Y-=D.Height),this.FixHScreenTextRect(D,C);var m={Border:D,Start:{X:o,Y:s},IsLeft:h,Title:i.Title};this.InfoDrawCache.push(m),this.TextRectCache.push(D)}},this.DrawInfoLines=function(t){var e=t.Border,a=t.IsLeft;this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(t.Start.X,t.Start.Y),a?this.Canvas.lineTo(e.X,e.Y):this.IsHScreen?this.Canvas.lineTo(e.X,e.Y+e.Height):this.Canvas.lineTo(e.X+e.Width,e.Y),this.Canvas.stroke(),this.Canvas.fillStyle=this.PointColor,this.Canvas.beginPath(),this.Canvas.arc(t.Start.X,t.Start.Y,5,0,2*Math.PI),this.Canvas.closePath(),this.Canvas.fill()},this.DrawInfoText=function(t){var e=t.Border,a=e.X,i=e.Y;this.Canvas.fillStyle=this.TextBGColor,this.Canvas.fillRect(a,i,e.Width,e.Height),this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.rect(a,i,e.Width,e.Height),this.Canvas.stroke(),this.IsHScreen&&(this.Canvas.save(),this.Canvas.translate(e.X,e.Y),this.Canvas.rotate(90*Math.PI/180),a=0,i=0),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.font=this.Font,this.IsHScreen?this.Canvas.fillText(t.Title,a+2,i-e.Width/2):this.Canvas.fillText(t.Title,a+2,i+e.Height/2),this.IsHScreen&&this.Canvas.restore()},this.FixTextRect=function(t,e){for(var a in e.Y){var i,r=e.Y[a];t.Y=r.Value;for(var n=0;n<10;++n){var s=!1;for(var o in this.TextRectCache){var h=this.TextRectCache[o];if(this.IsOverlap(h,t)){s=!0;break}}if(0==s)return;if(i=t.Y,i+=r.Offset,i+t.Height>this.FrameBottom||i<this.FrameTop)break;t.Y=i}}},this.FixHScreenTextRect=function(t,e){for(var a in e.X){var i,r=e.X[a];t.X=r.Value;for(var n=0;n<10;++n){var s=!1;for(var o in this.TextRectCache){var h=this.TextRectCache[o];if(this.IsOverlap(h,t)){s=!0;break}}if(0==s)return;if(i=t.X,i+=r.Offset,i+t.Width<this.FrameBottom||i>this.FrameTop)break;t.X=i}}},this.IsOverlap=function(t,e){return t.X+t.Width>e.X&&e.X+e.Width>t.X&&t.Y+t.Height>e.Y&&e.Y+e.Height>t.Y},this.GetMaxMin=function(){var t={Min:null,Max:null};return t}}function E(){this.newMethod=C,this.newMethod(),delete this.newMethod,this.ClassName="ChartBuySell",this.TextFont=r.JSCommonResource_Global_JSChartResource.KLineTrain.Font,this.LastDataIcon=r.JSCommonResource_Global_JSChartResource.KLineTrain.LastDataIcon,this.BuyIcon=r.JSCommonResource_Global_JSChartResource.KLineTrain.BuyIcon,this.SellIcon=r.JSCommonResource_Global_JSChartResource.KLineTrain.SellIcon,this.BuySellData=new Map,this.AddTradeItem=function(t){if(this.BuySellData.has(t.Key)){var e=this.BuySellData.get(t.Key);e.Data.push(t)}else this.BuySellData.set(t.Key,{Data:[t]})},this.ClearTradeData=function(){this.BuySellData=new Map},this.Draw=function(){if(this.Data&&this.Data.Data){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=(this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight());!0===t&&(a=this.ChartBorder.GetBottom());var i=this.ChartFrame.XPointCount,r=this.ChartBorder.GetBottomEx(),n=this.ChartBorder.GetTopEx(),s=this.ChartBorder.GetHeightEx();t&&(n=this.ChartBorder.GetRightEx(),r=this.ChartBorder.GetLeftEx(),s=this.ChartBorder.GetWidthEx()),this.Canvas.font=this.TextFont;for(var o=this.Data.DataOffset,h=0;o<this.Data.Data.length&&h<i;++o,++h){var l=this.Data.Data[o];if(null!=l){if(u>a)break;if(o==this.Data.Data.length-1){var u=this.ChartFrame.GetXFromIndex(h),C=this.ChartFrame.GetYFromData(l.High);if(this.LastDataIcon.Text)this.Canvas.textAlign="center",this.Canvas.textBaseline="bottom",this.Canvas.fillStyle=this.LastDataIcon.Color,this.Canvas.font=this.TextFont,this.DrawText(this.LastDataIcon.Text,u,C,t);else{var D={X:u,Top:n,Bottom:r,Height:s,DataWidth:e,Color:this.LastDataIcon.Color,IsHScreen:t};this.DrawLastData(D)}}var m=o;if(this.BuySellData.has(m)){var S=this.BuySellData.get(m),c=(u=this.ChartFrame.GetXFromIndex(h),C=this.ChartFrame.GetYFromData(l.High),this.ChartFrame.GetYFromData(l.Low)),f=[!1,!1];for(var d in S.Data){if(1==f[0]&&1==f[1])break;var I=S.Data[d];0==I.Op&&0==f[0]?(this.Canvas.textAlign="center",this.Canvas.textBaseline="top",this.Canvas.fillStyle=this.BuyIcon.Color,this.DrawText(this.BuyIcon.Text,u,c,t),f[0]=!0):1==I.Op&&0==f[1]&&(this.Canvas.textAlign="center",this.Canvas.textBaseline="bottom",this.Canvas.fillStyle=this.SellIcon.Color,this.DrawText(this.SellIcon.Text,u,C,t),f[1]=!0)}}}}}},this.DrawLastData=function(t){this.Canvas.fillStyle=t.Color;var e=t.DataWidth;this.LastDataIcon.Width>=2&&this.LastDataIcon.Width<t.DataWidth&&(e=this.LastDataIcon.Width);var a=t.X-e/2;if(t.IsHScreen)this.Canvas.fillRect(W(t.Bottom),W(a),W(t.Height),W(e));else{a=t.X-e/2;this.Canvas.fillRect(W(a),W(t.Top),W(e),W(t.Height))}}}function L(){this.newMethod=l,this.newMethod(),delete this.newMethod,this.UpColor=r.JSCommonResource_Global_JSChartResource.UpBarColor,this.DownColor=r.JSCommonResource_Global_JSChartResource.DownBarColor,this.CustomColor=r.JSCommonResource_Global_JSChartResource.Minute.VolBarColor,this.YClose,this.Draw=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartBorder.GetRight();t&&(e=this.ChartBorder.GetBottom());var a=this.ChartFrame.XPointCount,i=this.ChartFrame.GetYFromData(0),r=this.YClose;this.CustomColor&&(this.Canvas.strokeStyle=this.CustomColor);for(var n=this.Data.DataOffset,s=0;n<this.Data.Data.length&&s<a;++n,++s){var o=this.Data.Data[n];if(o&&o.Vol){var h=this.ChartFrame.GetYFromData(o.Vol),l=this.ChartFrame.GetXFromIndex(n);if(l>e)break;this.CustomColor||(this.Canvas.strokeStyle=o.Close>=r?this.UpColor:this.DownColor),this.Canvas.beginPath(),t?(this.Canvas.moveTo(h,U(l)),this.Canvas.lineTo(i,U(l))):(this.Canvas.moveTo(U(l),h),this.Canvas.lineTo(U(l),i)),this.Canvas.stroke(),r=o.Close}}},this.GetMaxMin=function(){for(var t=this.ChartFrame.XPointCount,e={Min:0,Max:null},a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];r&&r.Vol&&(null==e.Max&&(e.Max=r.Vol),e.Max<r.Vol&&(e.Max=r.Vol))}return e}}function g(){this.newMethod=l,this.newMethod(),delete this.newMethod,this.ClassName="ChartMACD",this.UpColor=r.JSCommonResource_Global_JSChartResource.UpBarColor,this.DownColor=r.JSCommonResource_Global_JSChartResource.DownBarColor,this.LineWidth=1,this.Draw=function(){if(this.NotSupportMessage)this.DrawNotSupportmessage();else if(!0!==this.ChartFrame.IsHScreen){var t=this.IsMinuteFrame(),e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetLeft()+a/2+r.JSCommonResource_Global_JSChartResource.FrameLeftMargin,n=this.ChartBorder.GetRight(),s=this.ChartFrame.XPointCount,o=this.LineWidth;(50==this.LineWidth||o>e)&&(o=e),this.Canvas.save(),this.Canvas.lineWidth=o;for(var h=this.ChartFrame.GetYFromData(0),l=this.Data.DataOffset,u=0;l<this.Data.Data.length&&u<s;++l,++u,i+=e+a){var C=this.Data.Data[l];if(null!=C){if(t)var D=this.ChartFrame.GetXFromIndex(u);else{var m=i,S=i+e;if(S>n)break;D=m+(S-m)/2}var c=this.ChartFrame.GetYFromData(C);if(D>n)break;var f=parseInt(D.toString())+.5;this.Canvas.beginPath(),this.Canvas.moveTo(f,h),this.Canvas.lineTo(f,c),this.Canvas.strokeStyle=C>=0?this.UpColor:this.DownColor,this.Canvas.stroke(),this.Canvas.closePath()}}this.Canvas.restore()}else this.HScreenDraw()},this.HScreenDraw=function(){var t=this.IsMinuteFrame(),e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetTop()+a/2+r.JSCommonResource_Global_JSChartResource.FrameLeftMargin,n=this.ChartBorder.GetBottom(),s=this.ChartFrame.XPointCount,o=this.ChartFrame.GetYFromData(0),h=this.LineWidth;(50==this.LineWidth||h>e)&&(h=e),this.Canvas.save(),this.Canvas.lineWidth=h;for(var l=this.Data.DataOffset,u=0;l<this.Data.Data.length&&u<s;++l,++u,i+=e+a){var C=this.Data.Data[l];if(null!=C){if(t)var D=this.ChartFrame.GetXFromIndex(u);else{var m=i,S=i+e;if(S>n)break;D=m+(S-m)/2}var c=this.ChartFrame.GetYFromData(C);if(D>n)break;this.Canvas.beginPath(),this.Canvas.moveTo(o,U(D)),this.Canvas.lineTo(c,U(D)),this.Canvas.strokeStyle=C>=0?this.UpColor:this.DownColor,this.Canvas.stroke(),this.Canvas.closePath()}}this.Canvas.restore()}}function N(){this.newMethod=l,this.newMethod(),delete this.newMethod,this.Font=r.JSCommonResource_Global_JSChartResource.DefaultTextFont,this.TextColor=r.JSCommonResource_Global_JSChartResource.DefaultTextColor,this.IsEnableSplash=!1,this.SplashTitle="数据加载中.....",this.HQChart,this.EnableSplash=function(t){if(this.IsEnableSplash=t,this.HQChart){var e=this.HQChart.GetEnableSplashEvent();if(e){var a={Enable:t};e.Callback(e,a,this)}}},this.SetTitle=function(t){this.SplashTitle=t},this.Draw=function(){if(this.IsEnableSplash)if(!0!==this.Frame.IsHScreen){var t=(this.Frame.ChartBorder.GetLeft()+this.Frame.ChartBorder.GetRight())/2,e=(this.Frame.ChartBorder.GetTop()+this.Frame.ChartBorder.GetBottom())/2;this.Canvas.textAlign="center",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.font=this.Font,this.Canvas.fillText(this.SplashTitle,t,e)}else this.HScreenDraw()},this.HScreenDraw=function(){var t=(this.Frame.ChartBorder.GetLeft()+this.Frame.ChartBorder.GetRight())/2,e=(this.Frame.ChartBorder.GetTop()+this.Frame.ChartBorder.GetBottom())/2;this.Canvas.save(),this.Canvas.translate(t,e),this.Canvas.rotate(90*Math.PI/180),this.Canvas.textAlign="center",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.font=this.Font,this.Canvas.fillText(this.SplashTitle,0,0),this.Canvas.restore()}}function x(){this.newMethod=l,this.newMethod(),delete this.newMethod,this.ClassName="ChartBackground",this.Color=null,this.ColorAngle=0,this.IsDrawFirst=!0,this.IsHScreen=!1,this.Draw=function(){if(this.IsShow&&this.Color&&!(this.Color.length<=0)){if(this.IsHScreen=!0===this.ChartFrame.IsHScreen,2==this.Color.length){if(this.IsHScreen)if(0==this.ColorAngle)var t={X:this.ChartBorder.GetRight(),Y:this.ChartBorder.GetTopEx()},e={X:this.ChartBorder.GetLeft(),Y:this.ChartBorder.GetTopEx()};else t={X:this.ChartBorder.GetLeft(),Y:this.ChartBorder.GetTopEx()},e={X:this.ChartBorder.GetLeft(),Y:this.ChartBorder.GetBottomEx()};else if(0==this.ColorAngle)t={X:this.ChartBorder.GetLeft(),Y:this.ChartBorder.GetTopEx()},e={X:this.ChartBorder.GetLeft(),Y:this.ChartBorder.GetBottomEx()};else t={X:this.ChartBorder.GetLeft(),Y:this.ChartBorder.GetTopEx()},e={X:this.ChartBorder.GetRight(),Y:this.ChartBorder.GetTopEx()};var a=this.Canvas.createLinearGradient(t.X,t.Y,e.X,e.Y);a.addColorStop(0,this.Color[0]),a.addColorStop(1,this.Color[1]),this.Canvas.fillStyle=a}else{if(1!=this.Color.length)return;this.Canvas.fillStyle=this.Color[0]}if("DRAWGBK2"!=this.Name&&"KLINE_BG"!=this.Name){if(this.IsHScreen)var i=this.ChartBorder.GetLeftEx(),r=this.ChartBorder.GetTop(),n=this.ChartBorder.GetWidthEx(),s=this.ChartBorder.GetHeight();else i=this.ChartBorder.GetLeft(),r=this.ChartBorder.GetTopEx(),n=this.ChartBorder.GetWidth(),s=this.ChartBorder.GetHeightEx();this.Canvas.fillRect(i,r,n,s)}else this.DrawRegion()}},this.DrawRegion=function(){var t=this.ChartFrame.XPointCount,e=this.ChartBorder.GetLeft()+i/2+r.JSCommonResource_Global_JSChartResource.FrameLeftMargin,a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth,s=this.ChartBorder.GetTopEx(),o=this.ChartBorder.GetBottomEx();this.IsHScreen&&(s=this.ChartBorder.GetRightEx(),o=this.ChartBorder.GetLeftEx());for(var h=[],l=this.Data.DataOffset,u=0;l<this.Data.Data.length&&u<t;++l,++u,e+=a+i){var C=this.Data.Data[l];if(h[l]=null,n.JSCommonSplit_IFrameSplitOperator.IsNumber(C)&&!(C<=0)){var D=this.ChartFrame.GetXFromIndex(u);this.ChartFrame.GetYFromData(C.Value);this.IsHScreen?h[l]={Line:{X:o,Y:D},Line2:{X:s,Y:D}}:h[l]={Line:{X:D,Y:s},Line2:{X:D,Y:o}}}}this.DrawBG(h)},this.DrawBG=function(t){var e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=(a+e)/2,r=!0,n=0,s=[],o=null;for(var h in t){var l=t[h];if(!l||o&&l.Color!=o){if(n>0){for(var u=s.length-1;u>=0;--u){var C=s[u];this.IsHScreen?(this.Canvas.lineTo(C.Line2.X,C.Line2.Y+i),this.Canvas.lineTo(C.Line2.X,C.Line2.Y-i)):(this.Canvas.lineTo(C.Line2.X+i,C.Line2.Y),this.Canvas.lineTo(C.Line2.X-i,C.Line2.Y))}this.Canvas.closePath(),this.Canvas.fill()}r=!0,n=0,s=[],o=null}l&&(r?(this.Canvas.beginPath(),this.IsHScreen?(this.Canvas.moveTo(l.Line.X,l.Line.Y-i),this.Canvas.lineTo(l.Line.X,l.Line.Y+i)):(this.Canvas.moveTo(l.Line.X-i,l.Line.Y),this.Canvas.lineTo(l.Line.X+i,l.Line.Y)),r=!1,o=l.Color):this.IsHScreen?(this.Canvas.lineTo(l.Line.X,l.Line.Y-i),this.Canvas.lineTo(l.Line.X,l.Line.Y+i)):(this.Canvas.lineTo(l.Line.X-i,l.Line.Y),this.Canvas.lineTo(l.Line.X+i,l.Line.Y)),s.push(l),++n)}if(n>0){for(u=s.length-1;u>=0;--u){C=s[u];this.IsHScreen?(this.Canvas.lineTo(C.Line2.X,C.Line2.Y+i),this.Canvas.lineTo(C.Line2.X,C.Line2.Y-i)):(this.Canvas.lineTo(C.Line2.X+i,C.Line2.Y),this.Canvas.lineTo(C.Line2.X-i,C.Line2.Y))}this.Canvas.closePath(),this.Canvas.fill()}},this.GetMaxMin=function(){return{Min:null,Max:null}}}function R(){this.newMethod=l,this.newMethod(),delete this.newMethod,this.WidthDiv=.2,this.LockCount=10,this.BGColor=r.JSCommonResource_Global_JSChartResource.LockBGColor,this.TextColor=r.JSCommonResource_Global_JSChartResource.LockTextColor,this.Font=r.JSCommonResource_Global_JSChartResource.DefaultTextFont,this.Title="🔒开通权限",this.LockRect=null,this.LockID,this.Callback,this.IndexName,this.Draw=function(){if(this.LockRect=null,this.NotSupportMessage)this.DrawNotSupportmessage();else if(!0!==this.ChartFrame.IsHScreen){var t=this.ChartBorder.GetRight(),e=0;if(null!=this.ChartFrame.Data){var a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth;t=this.ChartBorder.GetLeft()+i/2+2;for(var r=this.ChartBorder.GetRight(),n=this.ChartFrame.XPointCount,s=this.ChartFrame.Data.DataOffset,o=0;s<this.ChartFrame.Data.Data.length&&o<n;++s,++o,t+=a+i){var h=this.ChartFrame.Data.Data[s];if(null!=h.Open&&null!=h.High&&null!=h.Low&&null!=h.Close){var l=t+a;if(l>r)break}}e=(a+i)*this.LockCount}0==e&&(e=(t-this.ChartBorder.GetLeft())*this.WidthDiv);var u=t-e;u<this.ChartBorder.GetLeft()&&(u=this.ChartBorder.GetLeft());var C=this.ChartBorder.GetBottom()-this.ChartBorder.GetTop(),D=this.ChartBorder.GetRight()-u;this.Canvas.fillStyle=this.BGColor,this.Canvas.fillRect(u,this.ChartBorder.GetTop(),D,C);var m=u+D/2,S=this.ChartBorder.GetTop()+C/2;this.Canvas.textAlign="center",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.font=this.Font,this.Canvas.fillText(this.Title,m,S),this.LockRect={Left:u,Top:this.ChartBorder.GetTop(),Width:D,Heigh:C}}else this.HScreenDraw()},this.HScreenDraw=function(){var t=this.ChartBorder.GetBottom(),e=0;if(null!=this.ChartFrame.Data){var a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth;t=this.ChartBorder.GetTop()+i/2+2;for(var r=this.ChartBorder.GetBottom(),n=this.ChartFrame.XPointCount,s=this.ChartFrame.Data.DataOffset,o=0;s<this.ChartFrame.Data.Data.length&&o<n;++s,++o,t+=a+i){var h=this.ChartFrame.Data.Data[s];if(null!=h.Open&&null!=h.High&&null!=h.Low&&null!=h.Close){var l=t+a;if(l>r)break}}e=(a+i)*this.LockCount}0==e&&(e=(t-this.ChartBorder.GetTop())*this.WidthDiv);var u=t-e;u<this.ChartBorder.GetTop()&&(u=this.ChartBorder.GetTop());var C=this.ChartBorder.GetRight()-this.ChartBorder.GetLeft(),D=this.ChartBorder.GetBottom()-u;this.Canvas.fillStyle=this.BGColor,this.Canvas.fillRect(this.ChartBorder.GetLeft(),u,C,D);var m=this.ChartBorder.GetLeft()+C/2,S=u+D/2;this.Canvas.save(),this.Canvas.translate(m,S),this.Canvas.rotate(90*Math.PI/180),this.Canvas.textAlign="center",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.font=this.Font,this.Canvas.fillText(this.Title,0,0),this.Canvas.restore(),this.LockRect={Left:this.ChartBorder.GetLeft(),Top:u,Width:C,Heigh:D}},this.GetTooltipData=function(t,e,a){return null!=this.LockRect&&(!!this.IsPointInRect(t,e,this.LockRect.Left,this.LockRect.Top,this.LockRect.Width,this.LockRect.Heigh)&&(a.Data={ID:this.LockID,Callback:this.Callback,IndexName:this.IndexName},a.ChartPaint=this,!0))},this.IsPointInRect=function(t,e,a,i,r,n){return t>a&&t<a+r&&e>i&&e<i+n}}function O(){this.newMethod=l,this.newMethod(),delete this.newMethod,this.UpColor=r.JSCommonResource_Global_JSChartResource.UpBarColor,this.DownColor=r.JSCommonResource_Global_JSChartResource.DownBarColor,this.HistoryData,this.KLineDrawType=0,this.ClassName="ChartVolStick",this.MinBarWidth=r.JSCommonResource_Global_JSChartResource.MinKLineBarWidth,this.Draw=function(){if(!0!==this.ChartFrame.IsHScreen){var t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartBorder.GetLeft()+e/2+2,i=this.ChartBorder.GetRight(),r=this.ChartFrame.XPointCount,n=this.ChartFrame.GetYFromData(0);if(t>=this.MinBarWidth){n=W(n);for(var s=this.Data.DataOffset,o=0;s<this.Data.Data.length&&o<r;++s,++o,a+=t+e){var h=this.Data.Data[s],l=this.HistoryData.Data[s];if(null!=h&&null!=l){var u=a,C=a+t;if(C>i)break;var D=this.ChartFrame.GetYFromData(h),m=!1;l.Close>=l.Open?(this.Canvas.fillStyle=this.UpColor,m=!0):this.Canvas.fillStyle=this.DownColor;var S=W(Math.abs(n-D)>=1?n-D:1);D=n-S,!m||1!=this.KLineDrawType&&2!=this.KLineDrawType&&3!=this.KLineDrawType?this.Canvas.fillRect(W(u),D,W(t),S):(this.Canvas.strokeStyle=this.UpColor,this.Canvas.beginPath(),this.Canvas.rect(U(u),U(D),W(t),S),this.Canvas.stroke())}}}else for(s=this.Data.DataOffset,o=0;s<this.Data.Data.length&&o<r;++s,++o,a+=t+e){h=this.Data.Data[s],l=this.HistoryData.Data[s];if(null!=h&&null!=l){D=this.ChartFrame.GetYFromData(h);var c=this.ChartFrame.GetXFromIndex(o);if(c>i)break;l.Close>l.Open?this.Canvas.strokeStyle=this.UpColor:this.Canvas.strokeStyle=this.DownColor;c=this.ChartFrame.GetXFromIndex(o);this.Canvas.beginPath(),this.Canvas.moveTo(U(c),D),this.Canvas.lineTo(U(c),n),this.Canvas.stroke()}}}else this.HScreenDraw()},this.HScreenDraw=function(){var t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartBorder.GetTop()+e/2+2,i=this.ChartBorder.GetBottom(),r=this.ChartFrame.XPointCount,n=this.ChartFrame.GetYFromData(0);if(t>=this.MinBarWidth){n=W(n);for(var s=this.Data.DataOffset,o=0;s<this.Data.Data.length&&o<r;++s,++o,a+=t+e){var h=this.Data.Data[s],l=this.HistoryData.Data[s];if(null!=h&&null!=l){var u=a,C=a+t;if(C>i)break;var D=this.ChartFrame.GetYFromData(h),m=!1;l.Close>=l.Open?(m=!0,this.Canvas.fillStyle=this.UpColor):this.Canvas.fillStyle=this.DownColor;var S=W(D-n);!m||1!=this.KLineDrawType&&2!=this.KLineDrawType&&3!=this.KLineDrawType?this.Canvas.fillRect(n,W(u),S,W(t)):(this.Canvas.strokeStyle=this.UpColor,this.Canvas.beginPath(),this.Canvas.rect(U(n),U(u),S,W(t)),this.Canvas.stroke())}}}else for(s=this.Data.DataOffset,o=0;s<this.Data.Data.length&&o<r;++s,++o,a+=t+e){h=this.Data.Data[s],l=this.HistoryData.Data[s];if(null!=h&&null!=l){D=this.ChartFrame.GetYFromData(h);var c=this.ChartFrame.GetXFromIndex(o);if(c>i)break;l.Close>l.Open?this.Canvas.strokeStyle=this.UpColor:this.Canvas.strokeStyle=this.DownColor;c=this.ChartFrame.GetXFromIndex(o);this.Canvas.beginPath(),this.Canvas.moveTo(D,U(c)),this.Canvas.lineTo(n,U(c)),this.Canvas.stroke()}}},this.GetMaxMin=function(){for(var t=this.ChartFrame.XPointCount,e={Min:0,Max:null},a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];null==e.Max&&(e.Max=r),e.Max<r&&(e.Max=r)}return e}}function B(){this.newMethod=l,this.newMethod(),delete this.newMethod,this.TextFont="14px 微软雅黑",this.Draw=function(){if(this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.Data&&this.Data.Data){this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth;var t=this.ChartBorder.GetRight();this.ChartFrame.XPointCount;for(var e in this.Data.Data){var a=this.Data.Data[e];if(null!=a){var i=a.Value,r=a.Position;if("Left"==r){var n=this.ChartFrame.GetXFromIndex(0),s=this.ChartFrame.GetYFromData(i);if(n>t)continue;this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=a.Color,this.Canvas.font=this.TextFont,this.Canvas.fillText(a.Message,n,s)}}}}},this.GetMaxMin=function(){this.ChartFrame.XPointCount;var t={Min:null,Max:null};if(!this.Data||!this.Data.Data)return t;for(var e in this.Data.Data){var a=this.Data.Data[e];if(null!=a&&!isNaN(a.Value)){var i=a.Value;null==t.Max&&(t.Max=i),null==t.Min&&(t.Min=i),t.Max<i&&(t.Max=i),t.Min>i&&(t.Min=i)}}return t}}function y(){this.newMethod=l,this.newMethod(),delete this.newMethod,this.Color="rgb(255,193,37)",this.Font="11px 微软雅黑",this.Draw=function(){if(this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.Data&&this.Data.Data)if(!0!==this.ChartFrame.IsHScreen){this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight(),this.ChartBorder.GetBottom();var t=this.ChartBorder.GetLeft(),e=this.ChartFrame.XPointCount,a=this.ChartFrame.GetXFromIndex(e-1);for(var i in this.Data.Data){var r=this.Data.Data[i];if(null!=r&&!isNaN(r.Value)&&!isNaN(r.Value2)&&null!=r.Color){var n=Math.max(r.Value,r.Value2),s=Math.min(r.Value,r.Value2),o=this.ChartFrame.GetYFromData(n),h=this.ChartFrame.GetYFromData(s);this.Canvas.fillStyle=r.Color,this.Canvas.fillRect(W(t),W(o),W(a-t),W(h-o))}}for(var l in this.Data.Data){var u=this.Data.Data[l];if(null!=u&&!isNaN(u.Value)&&!isNaN(u.Value2)&&null!=u.Color){var C=Math.max(u.Value,u.Value2),D=Math.min(u.Value,u.Value2),m=this.ChartFrame.GetYFromData(C),S=this.ChartFrame.GetYFromData(D);if(u.Title&&u.TitleColor){var c=a;"left"==u.Align?(this.Canvas.textAlign="left",c=t):(this.Canvas.textAlign="right",c=a),this.Canvas.textBaseline="middle",this.Canvas.fillStyle=u.TitleColor,this.Canvas.font=this.Font;var f=m+(S-m)/2;this.Canvas.fillText(u.Title,c,f)}}}}else this.HScreenDraw()},this.HScreenDraw=function(){var t=this.ChartBorder.GetBottom(),e=this.ChartBorder.GetTop(),a=this.ChartBorder.GetHeight();for(var i in this.Data.Data){var r=this.Data.Data[i];if(null!=r&&!isNaN(r.Value)&&!isNaN(r.Value2)&&null!=r.Color){var n=Math.max(r.Value,r.Value2),s=Math.min(r.Value,r.Value2),o=this.ChartFrame.GetYFromData(n),h=this.ChartFrame.GetYFromData(s);if(this.Canvas.fillStyle=r.Color,this.Canvas.fillRect(W(h),W(e),W(o-h),W(a)),r.Title&&r.TitleColor){var l=o+(h-o)/2,u=t;this.Canvas.save(),this.Canvas.translate(l,u),this.Canvas.rotate(90*Math.PI/180),this.Canvas.textAlign="right",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=r.TitleColor,this.Canvas.font=this.Font,this.Canvas.fillText(r.Title,0,-2),this.Canvas.restore()}}}},this.GetMaxMin=function(){this.ChartFrame.XPointCount;var t={Min:null,Max:null};if(!this.Data||!this.Data.Data)return t;for(var e in this.Data.Data){var a=this.Data.Data[e];if(null!=a&&!isNaN(a.Value)&&!isNaN(a.Value2)){var i=Math.max(a.Value,a.Value2),r=Math.min(a.Value,a.Value2);null==t.Max&&(t.Max=i),null==t.Min&&(t.Min=r),t.Max<i&&(t.Max=i),t.Min>r&&(t.Min=r)}}return t}}function P(){this.newMethod=l,this.newMethod(),delete this.newMethod,this.IsDrawFirst=!0,this.FirstColor=r.JSCommonResource_Global_JSChartResource.Index.LineColor[0],this.SecondColor=r.JSCommonResource_Global_JSChartResource.Index.LineColor[1],this.Draw=function(){if(this.NotSupportMessage)this.DrawNotSupportmessage();else{for(var t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartFrame.XPointCount,i=this.ChartBorder.GetLeft()+e/2+2,r=0,n=0,s=0,o=[],h=[],l=0,u=this.Data.DataOffset,C=0;u<this.Data.Data.length&&C<a;++u,++C,i+=t+e){var D=this.Data.Data[u];null!=D&&null!=D.Value&&null!=D.Value2&&(r=this.ChartFrame.GetXFromIndex(C),n=this.ChartFrame.GetYFromData(D.Value),s=this.ChartFrame.GetYFromData(D.Value2),o[l]={x:r,y:n},h[l]={x:r,y:s},l++)}if(o.length>1){this.Canvas.save(),this.Canvas.beginPath();for(u=0;u<o.length;++u)0==u?this.Canvas.moveTo(o[u].x,o[u].y):this.Canvas.lineTo(o[u].x,o[u].y);for(C=h.length-1;C>=0;--C)this.Canvas.lineTo(h[C].x,h[C].y);this.Canvas.closePath(),this.Canvas.strokeStyle="rgba(255,255,255,0)",this.Canvas.stroke(),this.Canvas.clip(),this.Canvas.beginPath(),this.Canvas.moveTo(o[0].x,this.ChartBorder.GetBottom());for(u=0;u<o.length;++u)this.Canvas.lineTo(o[u].x,o[u].y);this.Canvas.lineTo(o[o.length-1].x,this.ChartBorder.GetBottom()),this.Canvas.closePath(),this.Canvas.fillStyle=this.FirstColor,this.Canvas.fill(),this.Canvas.beginPath(),this.Canvas.moveTo(h[0].x,this.ChartBorder.GetBottom());for(u=0;u<h.length;++u)this.Canvas.lineTo(h[u].x,h[u].y);this.Canvas.lineTo(h[h.length-1].x,this.ChartBorder.GetBottom()),this.Canvas.closePath(),this.Canvas.fillStyle=this.SecondColor,this.Canvas.fill(),this.Canvas.restore()}}},this.GetMaxMin=function(){for(var t=this.ChartFrame.XPointCount,e={Min:null,Max:null},a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];if(null!=r&&null!=r.Value&&null!=r.Value2){var n=r.Value>r.Value2?r.Value:r.Value2,s=r.Value<r.Value2?r.Value:r.Value2;(null==e.Max||e.Max<n)&&(e.Max=n),(null==e.Min||e.Min>s)&&(e.Min=s)}}return e}}function w(){this.newMethod=l,this.newMethod(),delete this.newMethod,this.Draw=function(){if(!this.Data||!this.Data.Data||!(this.Data.Data.length>0))return this.DrawEmptyData();var t=this.ChartBorder.GetLeft(),e=this.ChartBorder.GetRight(),a=this.ChartBorder.GetTop(),i=(this.ChartBorder.GetBottom(),this.ChartBorder.GetWidth()),r=this.ChartBorder.GetHeight(),n=i/4*.8;this.Canvas.save(),this.Canvas.translate(t+n,a+r/2);var s=0;for(var o in this.Data.Data)s+=this.Data.Data[o].Value;var h=1.5*Math.PI,l=h,u=h;for(var C in this.Data.Data){var D=this.Data.Data[C],m=D.Value/s;this.Canvas.beginPath(),this.Canvas.moveTo(0,0),u+=2*m*Math.PI,this.Canvas.strokeStyle="white",this.Canvas.fillStyle=D.Color,this.Canvas.arc(0,0,n,l,u),this.Canvas.fill(),this.Canvas.closePath(),this.Canvas.stroke(),l+=2*m*Math.PI}this.Canvas.restore();var S=t+i/2+5,c=a;this.Canvas.textBaseline="bottom",this.Canvas.font="12px 微软雅黑";for(var f=0,d=0;f<this.Data.Data.length;++f){var I=this.Data.Data[f];if(I.Text&&(this.Canvas.fillStyle=I.Color,this.Canvas.fillRect(S,c-15,13,13),this.Canvas.fillStyle="rgb(102,102,102)",this.Canvas.fillText(I.Text,S+16,c),c+=17,c>a+r/2+n)){if(++d,d>=2)break;c=a,S=e-i/4+5}}},this.DrawEmptyData=function(){console.log("[ChartPie::DrawEmptyData]");var t=this.ChartBorder.GetLeft(),e=(this.ChartBorder.GetRight(),this.ChartBorder.GetTop()),a=(this.ChartBorder.GetBottom(),this.ChartBorder.GetWidth()),i=this.ChartBorder.GetHeight(),r=a/4*.8;this.Canvas.save(),this.Canvas.translate(t+r,e+i/2),this.Canvas.beginPath(),this.Canvas.fillStyle="rgb(211,211,211)",this.Canvas.strokeStyle="white",this.Canvas.arc(0,0,.8*r,0,2*Math.PI),this.Canvas.fill(),this.Canvas.closePath(),this.Canvas.stroke(),this.Canvas.restore()}}function b(){this.newMethod=l,this.newMethod(),delete this.newMethod,this.BGColor="white",this.TextHeight=25,this.DrawEmptyData=function(){console.log("[ChartCircle::DrawEmptyData]")},this.Draw=function(){if(!this.Data||!this.Data.Data||!(this.Data.Data.length>0))return this.DrawEmptyData();var t=this.ChartBorder.GetLeft(),e=(this.ChartBorder.GetRight(),this.ChartBorder.GetTop()),a=this.ChartBorder.GetBottom(),i=this.ChartBorder.GetWidth(),r=this.ChartBorder.GetHeight(),n=this.TextHeight,s=i-n;s>r-n&&(s=r-n);var o=(s-n)/2;this.Canvas.save(),this.Canvas.translate(t+i/2,e+r/2-n/2);var h=0;for(var l in this.Data.Data)h+=this.Data.Data[l].Value;var u=1.5*Math.PI,C=u,D=u;for(var m in this.Data.Data){var S=this.Data.Data[m],c=S.Value/h;this.Canvas.beginPath(),this.Canvas.moveTo(0,0),D+=2*c*Math.PI,this.Canvas.strokeStyle="white",this.Canvas.fillStyle=S.Color,this.Canvas.arc(0,0,o,C,D),this.Canvas.fill(),this.Canvas.closePath(),this.Canvas.stroke(),C+=2*c*Math.PI}this.Canvas.beginPath(),this.Canvas.fillStyle=this.BGColor,this.Canvas.arc(0,0,.5*o,0,2*Math.PI),this.Canvas.fill(),this.Canvas.closePath(),this.Canvas.stroke(),this.Canvas.restore(),this.Canvas.restore();var f=t,d=e+r/2-n/2+o+5+20;this.Canvas.textBaseline="bottom",this.Canvas.textAlign="left",this.Canvas.font="14px 微软雅黑";for(var I=0,v=0,p=0;v<this.Data.Data.length;++v){var T=this.Data.Data[v];if(T.Text){if(this.Canvas.fillStyle=T.Color,p%2==0?(f=t+i/2-10,I=this.Canvas.measureText(T.Text).width,f=f-I-16,this.Canvas.fillRect(f,d-15,13,13),this.Canvas.fillStyle="rgb(102,102,102)",this.Canvas.fillText(T.Text,f+16,d)):(f=t+i/2+10+10,this.Canvas.fillRect(f,d-15,13,13),this.Canvas.fillStyle="rgb(102,102,102)",this.Canvas.fillText(T.Text,f+16,d),d+=20),d>a)break;++p}}}}function G(){this.newMethod=l,this.newMethod(),delete this.newMethod,this.ImageData=null,this.Left,this.Top,this.Width,this.Height,this.ImageWidth,this.ImageHeight,this.DefaultColor=[217,222,239],this.Color=[{Name:"海南",Color:"rgb(217,222,223)"},{Name:"内蒙古",Color:"rgb(217,222,225)"},{Name:"新疆",Color:"rgb(217,222,226)"},{Name:"青海",Color:"rgb(217,222,227)"},{Name:"西藏",Color:"rgb(217,222,228)"},{Name:"云南",Color:"rgb(217,222,229)"},{Name:"黑龙江",Color:"rgb(217,222,230)"},{Name:"吉林",Color:"rgb(217,222,231)"},{Name:"辽宁",Color:"rgb(217,222,232)"},{Name:"河北",Color:"rgb(217,222,233)"},{Name:"山东",Color:"rgb(217,222,234)"},{Name:"江苏",Color:"rgb(217,222,235)"},{Name:"浙江",Color:"rgb(217,222,236)"},{Name:"福建",Color:"rgb(217,222,237)"},{Name:"广东",Color:"rgb(217,222,238)"},{Name:"广西",Color:"rgb(217,222,239)"},{Name:"贵州",Color:"rgb(217,222,240)"},{Name:"湖南",Color:"rgb(217,222,241)"},{Name:"江西",Color:"rgb(217,222,242)"},{Name:"安徽",Color:"rgb(217,222,243)"},{Name:"湖北",Color:"rgb(217,222,244)"},{Name:"重庆",Color:"rgb(217,222,245)"},{Name:"四川",Color:"rgb(217,222,246)"},{Name:"甘肃",Color:"rgb(217,222,247)"},{Name:"陕西",Color:"rgb(217,222,248)"},{Name:"山西",Color:"rgb(217,222,249)"},{Name:"河南",Color:"rgb(217,222,250)"}],this.Draw=function(){var t=this.ChartBorder.GetLeft()+1,e=(this.ChartBorder.GetRight(),this.ChartBorder.GetTop()+1),a=(this.ChartBorder.GetBottom(),this.ChartBorder.GetWidth()-2),i=this.ChartBorder.GetHeight()-2,r=CHINA_MAP_IMAGE.width,n=CHINA_MAP_IMAGE.height,s=r,o=n;if(i<o||a<s)this.ImageData=null;else if(this.Left==t&&this.Top==e&&this.Width==a&&this.Height==i&&this.ImageWidth==r&&this.ImageHeight==n||(this.ImageData=null,this.ImageWidth=r,this.ImageHeight=n,this.Left=t,this.Top=e,this.Width=a,this.Height=i,console.log(r,n)),null==this.ImageData){this.Canvas.drawImage(CHINA_MAP_IMAGE,0,0,r,n,t,e,s,o),this.ImageData=this.Canvas.getImageData(t,e,s,o);var h,l=new Set,u=new Map,C=new Map;if(this.Data.length>0)for(var D in this.Data){var m=this.Data[D];C.set(m.Name,m.Color)}for(var S in console.log(this.Data),this.Color){var c=this.Color[S];C.has(c.Name)?u.set(c.Color,C.get(c.Name)):l.add(c.Color)}for(var f=0;f<this.ImageData.data.length;f+=4)if(h="rgb("+this.ImageData.data[f]+","+this.ImageData.data[f+1]+","+this.ImageData.data[f+2]+")",l.has(h))this.ImageData.data[f]=this.DefaultColor[0],this.ImageData.data[f+1]=this.DefaultColor[1],this.ImageData.data[f+2]=this.DefaultColor[2];else if(u.has(h)){var d=u.get(h);this.ImageData.data[f]=d[0],this.ImageData.data[f+1]=d[1],this.ImageData.data[f+2]=d[2]}this.Canvas.clearRect(t,e,s,o),this.Canvas.putImageData(this.ImageData,t,e,0,0,s,o)}else this.Canvas.putImageData(this.ImageData,t,e,0,0,s,o)}}function V(){this.newMethod=l,this.newMethod(),delete this.newMethod,this.BorderPoint=[],this.DataPoint=[],this.CenterPoint={},this.StartAngle=0,this.Color="rgb(198,198,198)",this.AreaColor="rgba(242,154,118,0.4)",this.AreaLineColor="rgb(242,154,118)",this.TitleFont="24px 微软雅黑",this.TitleColor="rgb(102,102,102)",this.BGColor=["rgb(255,255,255)","rgb(224,224,224)"],this.DrawBorder=function(){if(!(this.BorderPoint.length<=0)){this.Canvas.font=this.TitleFont,this.Canvas.strokeStyle=this.Color;var t=[1,.8,.6,.4,.2];for(var e in t){var a=t[e],i=!0;for(var r in this.BorderPoint){var n=this.BorderPoint[r];n.X=this.CenterPoint.X+n.Radius*Math.cos(n.Angle*Math.PI/180)*a,n.Y=this.CenterPoint.Y+n.Radius*Math.sin(n.Angle*Math.PI/180)*a,i?(this.Canvas.beginPath(),this.Canvas.moveTo(n.X,n.Y),i=!1):this.Canvas.lineTo(n.X,n.Y),0==e&&this.DrawText(n)}this.Canvas.closePath(),this.Canvas.stroke(),this.Canvas.fillStyle=this.BGColor[e%2==0?0:1],this.Canvas.fill()}for(var s in this.Canvas.beginPath(),this.BorderPoint){n=this.BorderPoint[s];n.X=this.CenterPoint.X+n.Radius*Math.cos(n.Angle*Math.PI/180),n.Y=this.CenterPoint.Y+n.Radius*Math.sin(n.Angle*Math.PI/180),this.Canvas.moveTo(this.CenterPoint.X,this.CenterPoint.Y),this.Canvas.lineTo(n.X,n.Y)}this.Canvas.stroke()}},this.DrawArea=function(){if(this.DataPoint&&!(this.DataPoint.length<=0)){this.Canvas.fillStyle=this.AreaColor,this.Canvas.strokeStyle=this.AreaLineColor,this.Canvas.beginPath();var t=!0;for(var e in this.DataPoint){var a=this.DataPoint[e];t?(this.Canvas.beginPath(),this.Canvas.moveTo(a.X,a.Y),t=!1):this.Canvas.lineTo(a.X,a.Y)}this.Canvas.closePath(),this.Canvas.fill(),this.Canvas.stroke()}},this.DrawText=function(t){if(t.Text){this.Canvas.fillStyle=this.TitleColor;var e=t.X,a=t.Y;t.Angle>0&&t.Angle<45?(this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",e+=2):t.Angle>=0&&t.Angle<90?(this.Canvas.textAlign="left",this.Canvas.textBaseline="top",e+=2):t.Angle>=90&&t.Angle<135||t.Angle>=135&&t.Angle<180?(this.Canvas.textAlign="right",this.Canvas.textBaseline="top",e-=2):t.Angle>=180&&t.Angle<225?(this.Canvas.textAlign="right",this.Canvas.textBaseline="middle",e-=2):t.Angle>=225&&t.Angle<=270?(this.Canvas.textAlign="center",this.Canvas.textBaseline="bottom"):t.Angle>270&&t.Angle<315?(this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom",e+=2):(this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",e+=2),this.Canvas.fillText(t.Text,e,a)}},this.Draw=function(){this.BorderPoint=[],this.DataPoint=[],this.InternalBorderPoint=[],this.CenterPoint={},this.Data&&this.Data.Data&&this.Data.Data.length>0?this.CalculatePoints(this.Data.Data):this.CalculatePoints(null),this.DrawBorder(),this.DrawArea()},this.CalculatePoints=function(t){for(var e=this.ChartBorder.GetLeft(),a=(this.ChartBorder.GetRight(),this.ChartBorder.GetTop()),i=(this.ChartBorder.GetBottom(),this.ChartBorder.GetWidth()),r=this.ChartBorder.GetHeight(),n={X:e+i/2,Y:a+r/2},s=Math.min(i/2,r/2)-2,o=Math.max(5,t?t.length:0),h=360/o,l=0;l<o;++l){var u={Index:l,Radius:s,Angle:l*h+this.StartAngle},C=u.Angle;if(t&&l<t.length){var D=t[l],m={Index:l,Text:D.Text};if(u.Text=D.Name,D.Value){var S=D.Value;S>=1&&(S=1);var c=s*S;m.X=n.X+c*Math.cos(C*Math.PI/180),m.Y=n.Y+c*Math.sin(C*Math.PI/180)}else m.X=n.X,m.Y=n.Y;this.DataPoint.push(m)}this.BorderPoint.push(u)}this.CenterPoint=n}}function _(){this.Frame,this.Canvas,this.HPenColor=r.JSCommonResource_Global_JSChartResource.CorssCursorHPenColor,this.HPenType=0,this.VPenColor=r.JSCommonResource_Global_JSChartResource.CorssCursorVPenColor,this.VPenType=0,this.Font=r.JSCommonResource_Global_JSChartResource.CorssCursorTextFont,this.TextColor=r.JSCommonResource_Global_JSChartResource.CorssCursorTextColor,this.TextBGColor=r.JSCommonResource_Global_JSChartResource.CorssCursorBGColor,this.TextHeight=15,this.LastPoint,this.CursorIndex,this.PointX,this.PointY,this.StringFormatX,this.StringFormatY,this.IsShow=!0,this.ShowTextMode={Left:1,Right:1,Bottom:1},this.IsShowCorss=!0,this.IsShowClose=!1,this.IsFixXLastTime=!1,this.Close=null,this.GetCloseYPoint=function(t){if(this.Close=null,!this.StringFormatX.Data)return null;var e=this.StringFormatX.Data;if(!e.Data||e.Data.length<=0)return null;var a=e.DataOffset+t;if(a>=e.Data.length&&(a=e.Data.length-1),a<0)return null;var i=e.Data[a];if(!i)return null;this.Close=i.Close;var r=this.Frame.GetYFromData(this.Close);return r},this.FixMinuteLastTimeXPoint=function(t){if(!n.JSCommonSplit_IFrameSplitOperator.IsNumber(t))return null;if(t=parseInt(t),!this.StringFormatX.Data)return null;var e=this.StringFormatX.Data;if(!e.Data||e.Data.length<=0)return null;var a=e.DataOffset+t;if(a<e.Data.length)return null;a=e.Data.length-1,a-=e.DataOffset;var i=this.Frame.GetXFromIndex(a);return{X:i,Index:a}},this.Draw=function(){if(this.LastPoint){var t=this.LastPoint.X,e=this.LastPoint.Y,a=!1,r=new i.JSCommon_Rect(this.Frame.ChartBorder.GetLeft(),this.Frame.ChartBorder.GetTop(),this.Frame.ChartBorder.GetWidth(),this.Frame.ChartBorder.GetHeight());if(a=r.IsPointIn(t,e),this.PointY=null,this.PointY,a)if(!0!==this.Frame.IsHScreen){var n=this.Frame.ChartBorder.GetLeft(),s=this.Frame.ChartBorder.GetRight(),o=this.Frame.ChartBorder.GetTopTitle(),h=this.Frame.ChartBorder.GetBottom(),l=this.Frame.ChartBorder.Right,u=this.Frame.ChartBorder.GetChartWidth();if(t=this.Frame.GetXFromIndex(this.CursorIndex),this.IsShowClose){var C=this.GetCloseYPoint(this.CursorIndex);null!=C&&(e=C)}if(this.IsFixXLastTime){var D=this.FixMinuteLastTimeXPoint(this.CursorIndex);D&&(t=D.X,this.CursorIndex=D.Index)}if(this.PointY=[[n,e],[s,e]],this.PointX=[[t,o],[t,h]],this.IsShowCorss){if(1!=this.HPenType&&0!=this.HPenType||(this.Canvas.strokeStyle=this.HPenColor,0==this.HPenType&&this.Canvas.setLineDash([3,2]),this.Canvas.beginPath(),this.Canvas.moveTo(n,U(e)),this.Canvas.lineTo(s,U(e)),this.Canvas.stroke(),this.Canvas.setLineDash([])),this.Canvas.save(),this.Canvas.strokeStyle=this.VPenColor,0==this.VPenType)this.Canvas.setLineDash([3,2]);else if(2==this.VPenType){var m=this.Frame.SubFrame[0].Frame.DataWidth;m>2&&(this.Canvas.lineWidth=m)}if(this.Canvas.beginPath(),this.Frame.SubFrame.length>0)for(var S in this.Frame.SubFrame){var c=this.Frame.SubFrame[S].Frame;o=c.ChartBorder.GetTopTitle(),h=c.ChartBorder.GetBottom(),this.Canvas.moveTo(U(t),o),this.Canvas.lineTo(U(t),h)}else this.Canvas.moveTo(U(t),o),this.Canvas.lineTo(U(t),h);this.Canvas.stroke(),this.Canvas.restore()}this.Frame.GetXData(t);var f={},d=this.Frame.GetYData(e,f);if(this.StringFormatY.RValue=f.RightYValue,this.IsShowClose&&null!=this.Close&&(d=this.Close),this.StringFormatX.Value=this.CursorIndex,this.StringFormatY.Value=d,this.StringFormatY.FrameID=f.FrameID,(1==this.ShowTextMode.Left&&this.Frame.ChartBorder.Left>=30||2==this.ShowTextMode.Left||1==this.ShowTextMode.Right&&this.Frame.ChartBorder.Right>=30||2==this.ShowTextMode.Right)&&this.StringFormatY.Operator()){var I=this.StringFormatY.Text;this.Canvas.font=this.Font;var v=this.Canvas.measureText(I).width+4;if(this.Frame.ChartBorder.Left>=30&&1==this.ShowTextMode.Left?(this.Canvas.fillStyle=this.TextBGColor,n<v?(this.Canvas.fillRect(2,e-this.TextHeight/2,v,this.TextHeight),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(I,4,e,v)):(this.Canvas.fillRect(n-2,e-this.TextHeight/2,-v,this.TextHeight),this.Canvas.textAlign="right",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(I,n-4,e,v))):2==this.ShowTextMode.Left&&(this.Canvas.fillStyle=this.TextBGColor,this.Canvas.fillRect(n,e-this.TextHeight/2,v,this.TextHeight),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(I,n+2,e,v)),this.StringFormatY.RText){I=this.StringFormatY.RText;v=this.Canvas.measureText(I).width+4}if(this.Frame.ChartBorder.Right>=30&&1==this.ShowTextMode.Right)this.Canvas.fillStyle=this.TextBGColor,l>v?(this.Canvas.fillRect(s+2,e-this.TextHeight/2,v,this.TextHeight),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(I,s+4,e,v)):(this.Canvas.fillRect(u-2-v,e-this.TextHeight/2,v,this.TextHeight),this.Canvas.textAlign="right",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(I,u-4,e,v));else if(2==this.ShowTextMode.Right){this.Canvas.fillStyle=this.TextBGColor;var p=s-v;this.Canvas.fillRect(p,e-this.TextHeight/2,v,this.TextHeight),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(I,p+2,e,v)}}if(1==this.ShowTextMode.Bottom&&this.StringFormatX.Operator()){I=this.StringFormatX.Text;this.Canvas.font=this.Font,this.Canvas.fillStyle=this.TextBGColor;v=this.Canvas.measureText(I).width+4;t-v/2<3?(this.Canvas.fillRect(t-1,h+2,v,this.TextHeight),this.Canvas.textAlign="left",this.Canvas.textBaseline="top",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(I,t+1,h+2,v)):s-n-t<v?(this.Canvas.fillRect(t-v,h+2,v,this.TextHeight),this.Canvas.textAlign="right",this.Canvas.textBaseline="top",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(I,t-1,h+2,v)):(this.Canvas.fillRect(t-v/2,h+2,v,this.TextHeight),this.Canvas.textAlign="center",this.Canvas.textBaseline="top",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(I,t,h+2,v))}}else this.HScreenDraw()}},this.HScreenDraw=function(){var t=this.LastPoint.X,e=this.LastPoint.Y;e=this.Frame.GetXFromIndex(this.CursorIndex);var a=this.Frame.ChartBorder.GetLeft(),i=this.Frame.ChartBorder.GetRightEx(),r=this.Frame.ChartBorder.GetTop(),n=this.Frame.ChartBorder.GetBottom(),s=this.Frame.ChartBorder.Bottom;if(this.PointY=[[a,e],[i,e]],this.PointX=[[t,r],[t,n]],this.IsShowCorss){if(this.Canvas.save(),this.Canvas.strokeStyle=this.HPenColor,0==this.HPenType&&this.Canvas.setLineDash([3,2]),this.Canvas.beginPath(),this.Canvas.moveTo(U(t),r),this.Canvas.lineTo(U(t),n),this.Canvas.stroke(),this.Canvas.restore(),this.Canvas.save(),this.Canvas.strokeStyle=this.VPenColor,0==this.VPenType)this.Canvas.setLineDash([3,2]);else if(2==this.VPenType){var o=this.Frame.SubFrame[0].Frame.DataWidth;o>2&&(this.Canvas.lineWidth=o)}if(this.Canvas.beginPath(),this.Frame.SubFrame.length>0)for(var h in this.Frame.SubFrame){var l=this.Frame.SubFrame[h].Frame;this.Canvas.moveTo(l.ChartBorder.GetLeft(),U(e)),this.Canvas.lineTo(l.ChartBorder.GetRightTitle(),U(e))}else this.Canvas.moveTo(a,U(e)),this.Canvas.lineTo(i,U(e));this.Canvas.stroke(),this.Canvas.restore()}var u=this.Frame.GetXData(e),C={},D=this.Frame.GetYData(t,C);if(this.StringFormatX.Value=u,this.StringFormatY.Value=D,this.StringFormatY.FrameID=C.FrameID,(1==this.ShowTextMode.Left&&this.Frame.ChartBorder.Top>=30||2==this.ShowTextMode.Left||1==this.ShowTextMode.Right&&this.Frame.ChartBorder.Bottom>=30||2==this.ShowTextMode.Right)&&this.StringFormatY.Operator()){var m=this.StringFormatY.Text;this.Canvas.font=this.Font;var S=this.Canvas.measureText(m).width+4;if(this.Frame.ChartBorder.Top>=30&&1==this.ShowTextMode.Left){var c=t,f=r;this.Canvas.save(),this.Canvas.translate(c,f),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillStyle=this.TextBGColor,r>=S?(this.Canvas.fillRect(-S,-this.TextHeight/2,S,this.TextHeight),this.Canvas.textAlign="right",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(m,-2,0,S)):(this.Canvas.fillRect(S-r,-this.TextHeight/2,-S,this.TextHeight),this.Canvas.textAlign="right",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(m,S-r-2,0,S)),this.Canvas.restore()}else if(2==this.ShowTextMode.Left){c=t,f=r;this.Canvas.save(),this.Canvas.translate(c,f),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillStyle=this.TextBGColor,this.Canvas.fillRect(0,-this.TextHeight/2,S,this.TextHeight),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(m,2,0,S),this.Canvas.restore()}if(this.Frame.ChartBorder.Bottom>=30&&1==this.ShowTextMode.Right){c=t,f=n;this.Canvas.save(),this.Canvas.translate(c,f),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillStyle=this.TextBGColor,s>S?(this.Canvas.fillRect(0,-this.TextHeight/2,S,this.TextHeight),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(m,2,0,S)):(this.Canvas.fillRect(s-S,-this.TextHeight/2,S,this.TextHeight),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(m,s-S+2,0,S)),this.Canvas.restore()}else if(2==this.ShowTextMode.Right){c=t,f=n;this.Canvas.save(),this.Canvas.translate(c,f),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillStyle=this.TextBGColor,this.Canvas.fillRect(0,-this.TextHeight/2,-S,this.TextHeight),this.Canvas.textAlign="right",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(m,-2,0,S),this.Canvas.restore()}}if(1===this.ShowTextMode.Bottom&&this.StringFormatX.Operator()){m=this.StringFormatX.Text;this.Canvas.font=this.Font,this.Canvas.fillStyle=this.TextBGColor;S=this.Canvas.measureText(m).width+4;if(e-S/2<3){c=a,f=e;this.Canvas.save(),this.Canvas.translate(c,f),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillRect(0,0,S,this.TextHeight),this.Canvas.textAlign="center",this.Canvas.textBaseline="top",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(m,0,0,S),this.Canvas.restore()}else{c=a,f=e;this.Canvas.save(),this.Canvas.translate(c,f),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillRect(-S/2,0,S,this.TextHeight),this.Canvas.textAlign="center",this.Canvas.textBaseline="top",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(m,0,0,S),this.Canvas.restore()}}}}function H(){this.newMethod=D,this.newMethod(),delete this.newMethod,this.YClose,this.IsDrawArea=!0,this.AreaColor="rgba(0,191,255,0.1)",this.Draw=function(){if(this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.IsShow&&this.Data){var t=!0===this.ChartFrame.IsHScreen;this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight();!0===t&&this.ChartBorder.GetBottom();for(var e=this.ChartFrame.XPointCount,a=this.ChartFrame.MinuteCount,i=this.ChartBorder.GetBottomEx(),r=this.ChartBorder.GetLeftEx(),n=!0,s={},o=0,h=this.Data.DataOffset,l=0;h<this.Data.Data.length&&l<e;++h,++l){var u=this.Data.Data[h];if(null!=u){var C=this.ChartFrame.GetXFromIndex(l),D=this.ChartFrame.GetYFromData(u);n?(this.Canvas.strokeStyle=this.Color,this.Canvas.beginPath(),t?this.Canvas.moveTo(D,C):this.Canvas.moveTo(C,D),n=!1,s={X:C,Y:D}):t?this.Canvas.lineTo(D,C):this.Canvas.lineTo(C,D),++o,o>=a&&(n=!0,this.Canvas.stroke(),this.IsDrawArea&&(t?(this.Canvas.lineTo(r,C),this.Canvas.lineTo(r,s.X),this.SetFillStyle(this.AreaColor,this.ChartBorder.GetRightEx(),i,this.ChartBorder.GetLeftEx(),i)):(this.Canvas.lineTo(C,i),this.Canvas.lineTo(s.X,i),this.SetFillStyle(this.AreaColor,r,this.ChartBorder.GetTopEx(),r,i)),this.Canvas.fill()),o=0)}}o>0&&(this.Canvas.stroke(),this.IsDrawArea&&(t?(this.Canvas.lineTo(r,C),this.Canvas.lineTo(r,s.X),this.SetFillStyle(this.AreaColor,this.ChartBorder.GetRightEx(),i,this.ChartBorder.GetLeftEx(),i)):(this.Canvas.lineTo(C,i),this.Canvas.lineTo(s.X,i),this.SetFillStyle(this.AreaColor,r,this.ChartBorder.GetTopEx(),r,i)),this.Canvas.fill()))}},this.GetMaxMin=function(){var t=this.ChartFrame.XPointCount,e={};if(null==this.YClose)return e;e.Min=this.YClose,e.Max=this.YClose;for(var a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];r&&(null==e.Max&&(e.Max=r),null==e.Min&&(e.Min=r),e.Max<r&&(e.Max=r),e.Min>r&&(e.Min=r))}if(e.Max==this.YClose&&e.Min==this.YClose)return e.Max=this.YClose+.1*this.YClose,e.Min=this.YClose-.1*this.YClose,e;var n=Math.max(Math.abs(this.YClose-e.Max),Math.abs(this.YClose-e.Min));return e.Max=this.YClose+n,e.Min=this.YClose-n,e}}function J(){this.Frame,this.Canvas,this.Data,this.Symbol,this.HQChart,this.HPenType=0,this.VPenType=0,this.LineDash=r.JSCommonResource_Global_JSChartResource.DepthCorss.LineDash,this.AskColor=r.JSCommonResource_Global_JSChartResource.DepthCorss.AskColor.Line,this.BidColor=r.JSCommonResource_Global_JSChartResource.DepthCorss.BidColor.Line,this.LineWidth=r.JSCommonResource_Global_JSChartResource.DepthCorss.LineWidth,this.IsShowTooltip=!0,this.Tooltip={LineHeight:r.JSCommonResource_Global_JSChartResource.DepthCorss.Tooltip.LineHeight,Border:{Top:r.JSCommonResource_Global_JSChartResource.DepthCorss.Tooltip.Border.Top,Left:r.JSCommonResource_Global_JSChartResource.DepthCorss.Tooltip.Border.Left,Bottom:r.JSCommonResource_Global_JSChartResource.DepthCorss.Tooltip.Border.Bottom,Center:r.JSCommonResource_Global_JSChartResource.DepthCorss.Tooltip.Border.Center},Font:r.JSCommonResource_Global_JSChartResource.DepthCorss.Tooltip.Font,TextColor:r.JSCommonResource_Global_JSChartResource.DepthCorss.Tooltip.TextColor,BGColor:r.JSCommonResource_Global_JSChartResource.DepthCorss.Tooltip.BGColor},this.Font=r.JSCommonResource_Global_JSChartResource.CorssCursorTextFont,this.TextColor=r.JSCommonResource_Global_JSChartResource.CorssCursorTextColor,this.TextBGColor=r.JSCommonResource_Global_JSChartResource.CorssCursorBGColor,this.TextHeight=20,this.LastPoint,this.PointX,this.PointY,this.StringFormatX,this.StringFormatY,this.IsShowCorss=!0,this.IsShow=!0,this.GetVol=function(t,e){if(!this.Data)return null;var a=e?this.Data.Asks:this.Data.Bids;if(!a||!Array.isArray(a)||a.length<=0)return null;for(var i in a){var r=a[i];if(r.Price==t)return r.Vol}return null},this.Draw=function(){if(this.Status=0,this.LastPoint&&this.Data&&this.IsShow){var t=this.LastPoint.X,e=this.LastPoint.Y,a=!1,r=new i.JSCommon_Rect(this.Frame.ChartBorder.GetLeft(),this.Frame.ChartBorder.GetTop(),this.Frame.ChartBorder.GetWidth(),this.Frame.ChartBorder.GetHeight());if(a=r.IsPointIn(t,e),this.PointY=null,this.PointY,a&&!0!==this.Frame.IsHScreen){var n=this.Frame.ChartBorder.GetLeft(),s=this.Frame.ChartBorder.GetRight(),o=this.Frame.ChartBorder.GetTopTitle(),h=this.Frame.ChartBorder.GetBottom(),l=(this.Frame.ChartBorder.Right,this.Frame.ChartBorder.GetChartWidth(),this.Frame.GetXData(t)),u=this.Frame.GetXFromPrice(l);if(u){var C=this.GetVol(u.Price,u.IsAsk);if(e=this.Frame.GetYFromData(C),u.Vol=C,u.Y=e,this.PointY=[[n,e],[s,e]],this.PointX=[[t,o],[t,h]],this.IsShowCorss){u.IsAsk?this.Canvas.strokeStyle=this.AskColor:this.Canvas.strokeStyle=this.BidColor,this.Canvas.save(),this.Canvas.lineWidth=this.LineWidth;this.Canvas.lineWidth;if(1==this.HPenType||0==this.HPenType){0==this.HPenType&&this.Canvas.setLineDash(this.LineDash);var D=U(e);this.Canvas.beginPath(),this.Canvas.moveTo(n,D),this.Canvas.lineTo(s,D),this.Canvas.stroke(),0==this.HPenType&&this.Canvas.setLineDash([])}0==this.VPenType&&this.Canvas.setLineDash(this.LineDash);var m=U(u.X);this.Canvas.beginPath(),this.Canvas.moveTo(m,o),this.Canvas.lineTo(m,h),this.Canvas.stroke(),0==this.VPenType&&this.Canvas.setLineDash([]),this.Canvas.restore()}if(this.HQChart){var S=this.HQChart.GetEvent(25);S&&S.Callback(S,u,this)}this.IsShowTooltip&&this.DrawTooltip(u)}}}},this.DrawTooltip=function(t){t.Price,t.Vol;var e=this.Tooltip.Border;this.Canvas.font=this.Tooltip.Font;var a=2;this.Symbol&&(a=s.JSCommonCoordinateData.GetfloatPrecision(this.Symbol));var i="擎擎: 9999.99亿 ";a>=5&&(i="擎擎: ".concat(99.99.toFixed(a)," ")),this.Tooltip.Width=this.Canvas.measureText(i).width+e.Left,this.Tooltip.Height=4*this.Tooltip.LineHeight+e.Top+e.Bottom+e.Center;var r=this.Frame.ChartBorder.GetRight(),n=this.Frame.ChartBorder.GetTop(),o=t.X+2,h=t.Y-this.Tooltip.Height-2;o+this.Tooltip.Width>=r&&(o=t.X-this.Tooltip.Width-2),h<n&&(h=t.Y+2),this.Canvas.fillStyle=this.Tooltip.BGColor,this.Canvas.fillRect(o,h,this.Tooltip.Width,this.Tooltip.Height);var l=e.Left+o,u=e.Top+h;this.Canvas.textBaseline="top",this.Canvas.textAlign="left",this.Canvas.fillStyle=this.Tooltip.TextColor,this.Canvas.fillText("委托价",l,u),u+=this.Tooltip.LineHeight,this.Canvas.fillText(t.Price.toFixed(a),l,u),u+=this.Tooltip.LineHeight,u+=e.Center,this.Canvas.fillText("累计",l,u),u+=this.Tooltip.LineHeight,this.Canvas.fillText(t.Vol.toFixed(4),l,u)}}function k(){this.newMethod=l,this.newMethod(),delete this.newMethod,this.ClassName="ChartOrderbookDepth",this.Data=null,this.AskColor={Line:r.JSCommonResource_Global_JSChartResource.DepthChart.AskColor.Line,Area:r.JSCommonResource_Global_JSChartResource.DepthChart.AskColor.Area},this.BidColor={Line:r.JSCommonResource_Global_JSChartResource.DepthChart.BidColor.Line,Area:r.JSCommonResource_Global_JSChartResource.DepthChart.BidColor.Area},this.LineWidth=r.JSCommonResource_Global_JSChartResource.DepthChart.LineWidth,this.Draw=function(){this.Data&&(this.Canvas.save(),this.Canvas.lineWidth=this.LineWidth,this.DrawArea(this.Data.Bids,this.BidColor.Line,this.BidColor.Area,!0),this.DrawArea(this.Data.Asks,this.AskColor.Line,this.AskColor.Area,!1),this.Canvas.restore())},this.DrawArea=function(t,e,a,i){var r=this.ChartFrame.VerticalRange,n=[];for(var s in t){var o=t[s];if(i){if(o.Price<r.Min)break}else if(o.Price>r.Max)break;var h=this.ChartFrame.GetXFromIndex(o.Price),l=this.ChartFrame.GetYFromData(o.Vol);n.push({X:h,Y:l})}if(!(n.length<=1)){var u=this.ChartBorder.GetLeft(),C=this.ChartBorder.GetBottom(),D=this.ChartBorder.GetRight();for(var s in this.Canvas.beginPath(),this.Canvas.moveTo(n[0].X,C),n){o=n[s];this.Canvas.lineTo(o.X,o.Y)}for(var s in this.Canvas.lineTo(i?u:D,n[n.length-1].Y),this.Canvas.lineTo(i?u:D,C),this.Canvas.lineTo(n[0].X,C),this.Canvas.closePath(),this.Canvas.fillStyle=a,this.Canvas.fill(),this.Canvas.beginPath(),this.Canvas.moveTo(n[0].X,C),n){o=n[s];this.Canvas.lineTo(o.X,o.Y)}this.Canvas.lineTo(i?u:D,n[n.length-1].Y),this.Canvas.strokeStyle=e,this.Canvas.stroke()}},this.GetMaxMin=function(){var t={Min:null,Max:null,XMin:null,XMax:null},e=this.ChartFrame.VerticalRange;for(var a in this.Data.Asks){var i=this.Data.Asks[a];if(i.Price>e.Max)break;(null==t.XMin||t.XMin>i.Price)&&(t.XMin=i.Price),(null==t.XMax||t.XMax<i.Price)&&(t.XMax=i.Price),(null==t.Min||t.Min>i.Vol)&&(t.Min=i.Vol),(null==t.Max||t.Max<i.Vol)&&(t.Max=i.Vol)}for(var a in this.Data.Bids){i=this.Data.Bids[a];if(i.Price<e.Min)break;(null==t.XMin||t.XMin>i.Price)&&(t.XMin=i.Price),(null==t.XMax||t.XMax<i.Price)&&(t.XMax=i.Price),(null==t.Min||t.Min>i.Vol)&&(t.Min=i.Vol),(null==t.Max||t.Max<i.Vol)&&(t.Max=i.Vol)}return t}}function U(t){return parseInt(t)+.5}function W(t){return.5+t<<0}t.exports={JSCommonChartPaint:{IChartPaintin:l,ChartKLine:u,ChartLine:D,ChartSubLine:m,ChartSingleText:C,ChartPointDot:S,ChartStick:c,ChartLineStick:f,ChartStickLine:d,ChartOverlayKLine:v,ChartMinuteInfo:M,ChartRectangle:I,ChartMultiText:p,ChartMultiHtmlDom:T,ChartMultiLine:F,ChartBackground:x,ChartBuySell:E,ChartMultiBar:A,ChartMACD:g,ChartMinutePriceLine:H,ChartLock:R,ChartVolStick:O,ChartBand:P,ChartMinuteVolumBar:L,ChartText:B,ChartStraightArea:y,ChartSplashPaint:N,ChartPie:w,ChartCircle:b,ChartChinaMap:G,ChartRadar:V,ChartCorssCursor:_,DepthChartCorssCursor:J,ChartOrderbookDepth:k},JSCommonChartPaint_IChartPainting:l,JSCommonChartPaint_ChartKLine:u,JSCommonChartPaint_ChartLine:D,JSCommonChartPaint_ChartSubLine:m,JSCommonChartPaint_ChartSingleText:C,JSCommonChartPaint_ChartPointDot:S,JSCommonChartPaint_ChartStick:c,JSCommonChartPaint_ChartLineStick:f,JSCommonChartPaint_ChartStickLine:d,JSCommonChartPaint_ChartBackground:x,JSCommonChartPaint_ChartMinuteVolumBar:L,JSCommonChartPaint_ChartOverlayKLine:v,JSCommonChartPaint_ChartLock:R,JSCommonChartPaint_ChartVolStick:O,JSCommonChartPaint_ChartBand:P,JSCommonChartPaint_ChartMinutePriceLine:H,JSCommonChartPaint_ChartPie:w,JSCommonChartPaint_ChartCircle:b,JSCommonChartPaint_ChartChinaMap:G,JSCommonChartPaint_ChartRadar:V,JSCommonChartPaint_ChartMinuteInfo:M,JSCommonChartPaint_ChartRectangle:I,JSCommonChartPaint_ChartMultiText:p,JSCommonChartPaint_ChartMultiLine:F,JSCommonChartPaint_ChartMultiHtmlDom:T,JSCommonChartPaint_ChartMultiBar:A,JSCommonChartPaint_ChartBuySell:E,JSCommonChartPaint_ChartMACD:g,JSCommonChartPaint_ChartText:B,JSCommonChartPaint_ChartStraightArea:y,JSCommonChartPaint_ChartCorssCursor:_,JSCommonChartPaint_DepthChartCorssCursor:J,JSCommonChartPaint_ChartOrderbookDepth:k,JSCommonChartPaint_ChartSplashPaint:N}},f96d:function(t,e,a){function i(){}a("e25e"),a("ac1f"),a("841c"),a("1276"),i.MeasureText=function(t,e){var a=e.font,i=12,r=a.search("px");if(r>0){var n=a.substring(0,r);i=parseInt(n)}t=String(t);t=t.split("");for(var s=0,o=0;o<t.length;o++){var h=t[o];/[a-zA-Z]/.test(h)?s+=7:/[0-9]/.test(h)?s+=5.5:/\./.test(h)?s+=2.7:/-/.test(h)?s+=3.25:/[\u4e00-\u9fa5]/.test(h)?s+=10:/\(|\)/.test(h)?s+=3.73:/\s/.test(h)?s+=2.5:/%/.test(h)?s+=8:s+=10}return s*i/10},t.exports={JSCommonUniApp:{JSUniAppCanvasHelper:i}}}}]);